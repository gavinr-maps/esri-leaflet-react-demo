(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))p(y);new MutationObserver(y=>{for(const b of y)if(b.type==="childList")for(const k of b.addedNodes)k.tagName==="LINK"&&k.rel==="modulepreload"&&p(k)}).observe(document,{childList:!0,subtree:!0});function l(y){const b={};return y.integrity&&(b.integrity=y.integrity),y.referrerPolicy&&(b.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?b.credentials="include":y.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function p(y){if(y.ep)return;y.ep=!0;const b=l(y);fetch(y.href,b)}})();var uv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ew(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ef={},Pw={get exports(){return Ef},set exports(e){Ef=e}},Wd={},$l={},Cw={get exports(){return $l},set exports(e){$l=e}},ii={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ph=Symbol.for("react.element"),Iw=Symbol.for("react.portal"),kw=Symbol.for("react.fragment"),Aw=Symbol.for("react.strict_mode"),zw=Symbol.for("react.profiler"),Mw=Symbol.for("react.provider"),Lw=Symbol.for("react.context"),Dw=Symbol.for("react.forward_ref"),Rw=Symbol.for("react.suspense"),Bw=Symbol.for("react.memo"),Ow=Symbol.for("react.lazy"),Kg=Symbol.iterator;function Fw(e){return e===null||typeof e!="object"?null:(e=Kg&&e[Kg]||e["@@iterator"],typeof e=="function"?e:null)}var cv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hv=Object.assign,dv={};function Xu(e,n,l){this.props=e,this.context=n,this.refs=dv,this.updater=l||cv}Xu.prototype.isReactComponent={};Xu.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};Xu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function pv(){}pv.prototype=Xu.prototype;function Pm(e,n,l){this.props=e,this.context=n,this.refs=dv,this.updater=l||cv}var Cm=Pm.prototype=new pv;Cm.constructor=Pm;hv(Cm,Xu.prototype);Cm.isPureReactComponent=!0;var Jg=Array.isArray,fv=Object.prototype.hasOwnProperty,Im={current:null},mv={key:!0,ref:!0,__self:!0,__source:!0};function _v(e,n,l){var p,y={},b=null,k=null;if(n!=null)for(p in n.ref!==void 0&&(k=n.ref),n.key!==void 0&&(b=""+n.key),n)fv.call(n,p)&&!mv.hasOwnProperty(p)&&(y[p]=n[p]);var c=arguments.length-2;if(c===1)y.children=l;else if(1<c){for(var q=Array(c),le=0;le<c;le++)q[le]=arguments[le+2];y.children=q}if(e&&e.defaultProps)for(p in c=e.defaultProps,c)y[p]===void 0&&(y[p]=c[p]);return{$$typeof:ph,type:e,key:b,ref:k,props:y,_owner:Im.current}}function Nw(e,n){return{$$typeof:ph,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function km(e){return typeof e=="object"&&e!==null&&e.$$typeof===ph}function Uw(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(l){return n[l]})}var Yg=/\/+/g;function Jp(e,n){return typeof e=="object"&&e!==null&&e.key!=null?Uw(""+e.key):n.toString(36)}function ld(e,n,l,p,y){var b=typeof e;(b==="undefined"||b==="boolean")&&(e=null);var k=!1;if(e===null)k=!0;else switch(b){case"string":case"number":k=!0;break;case"object":switch(e.$$typeof){case ph:case Iw:k=!0}}if(k)return k=e,y=y(k),e=p===""?"."+Jp(k,0):p,Jg(y)?(l="",e!=null&&(l=e.replace(Yg,"$&/")+"/"),ld(y,n,l,"",function(le){return le})):y!=null&&(km(y)&&(y=Nw(y,l+(!y.key||k&&k.key===y.key?"":(""+y.key).replace(Yg,"$&/")+"/")+e)),n.push(y)),1;if(k=0,p=p===""?".":p+":",Jg(e))for(var c=0;c<e.length;c++){b=e[c];var q=p+Jp(b,c);k+=ld(b,n,l,q,y)}else if(q=Fw(e),typeof q=="function")for(e=q.call(e),c=0;!(b=e.next()).done;)b=b.value,q=p+Jp(b,c++),k+=ld(b,n,l,q,y);else if(b==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return k}function jh(e,n,l){if(e==null)return e;var p=[],y=0;return ld(e,p,"","",function(b){return n.call(l,b,y++)}),p}function Vw(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(l){(e._status===0||e._status===-1)&&(e._status=1,e._result=l)},function(l){(e._status===0||e._status===-1)&&(e._status=2,e._result=l)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var yr={current:null},ud={transition:null},Zw={ReactCurrentDispatcher:yr,ReactCurrentBatchConfig:ud,ReactCurrentOwner:Im};ii.Children={map:jh,forEach:function(e,n,l){jh(e,function(){n.apply(this,arguments)},l)},count:function(e){var n=0;return jh(e,function(){n++}),n},toArray:function(e){return jh(e,function(n){return n})||[]},only:function(e){if(!km(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ii.Component=Xu;ii.Fragment=kw;ii.Profiler=zw;ii.PureComponent=Pm;ii.StrictMode=Aw;ii.Suspense=Rw;ii.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zw;ii.cloneElement=function(e,n,l){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var p=hv({},e.props),y=e.key,b=e.ref,k=e._owner;if(n!=null){if(n.ref!==void 0&&(b=n.ref,k=Im.current),n.key!==void 0&&(y=""+n.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(q in n)fv.call(n,q)&&!mv.hasOwnProperty(q)&&(p[q]=n[q]===void 0&&c!==void 0?c[q]:n[q])}var q=arguments.length-2;if(q===1)p.children=l;else if(1<q){c=Array(q);for(var le=0;le<q;le++)c[le]=arguments[le+2];p.children=c}return{$$typeof:ph,type:e.type,key:y,ref:b,props:p,_owner:k}};ii.createContext=function(e){return e={$$typeof:Lw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Mw,_context:e},e.Consumer=e};ii.createElement=_v;ii.createFactory=function(e){var n=_v.bind(null,e);return n.type=e,n};ii.createRef=function(){return{current:null}};ii.forwardRef=function(e){return{$$typeof:Dw,render:e}};ii.isValidElement=km;ii.lazy=function(e){return{$$typeof:Ow,_payload:{_status:-1,_result:e},_init:Vw}};ii.memo=function(e,n){return{$$typeof:Bw,type:e,compare:n===void 0?null:n}};ii.startTransition=function(e){var n=ud.transition;ud.transition={};try{e()}finally{ud.transition=n}};ii.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ii.useCallback=function(e,n){return yr.current.useCallback(e,n)};ii.useContext=function(e){return yr.current.useContext(e)};ii.useDebugValue=function(){};ii.useDeferredValue=function(e){return yr.current.useDeferredValue(e)};ii.useEffect=function(e,n){return yr.current.useEffect(e,n)};ii.useId=function(){return yr.current.useId()};ii.useImperativeHandle=function(e,n,l){return yr.current.useImperativeHandle(e,n,l)};ii.useInsertionEffect=function(e,n){return yr.current.useInsertionEffect(e,n)};ii.useLayoutEffect=function(e,n){return yr.current.useLayoutEffect(e,n)};ii.useMemo=function(e,n){return yr.current.useMemo(e,n)};ii.useReducer=function(e,n,l){return yr.current.useReducer(e,n,l)};ii.useRef=function(e){return yr.current.useRef(e)};ii.useState=function(e){return yr.current.useState(e)};ii.useSyncExternalStore=function(e,n,l){return yr.current.useSyncExternalStore(e,n,l)};ii.useTransition=function(){return yr.current.useTransition()};ii.version="18.2.0";(function(e){e.exports=ii})(Cw);const Gw=Ew($l);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jw=$l,qw=Symbol.for("react.element"),$w=Symbol.for("react.fragment"),Ww=Object.prototype.hasOwnProperty,Hw=jw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Xw={key:!0,ref:!0,__self:!0,__source:!0};function gv(e,n,l){var p,y={},b=null,k=null;l!==void 0&&(b=""+l),n.key!==void 0&&(b=""+n.key),n.ref!==void 0&&(k=n.ref);for(p in n)Ww.call(n,p)&&!Xw.hasOwnProperty(p)&&(y[p]=n[p]);if(e&&e.defaultProps)for(p in n=e.defaultProps,n)y[p]===void 0&&(y[p]=n[p]);return{$$typeof:qw,type:e,key:b,ref:k,props:y,_owner:Hw.current}}Wd.Fragment=$w;Wd.jsx=gv;Wd.jsxs=gv;(function(e){e.exports=Wd})(Pw);const Hc=Ef.jsx;var Pf={},Cf={},Kw={get exports(){return Cf},set exports(e){Cf=e}},lo={},If={},Jw={get exports(){return If},set exports(e){If=e}},yv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(Re,vt){var Ge=Re.length;Re.push(vt);e:for(;0<Ge;){var Tt=Ge-1>>>1,Ut=Re[Tt];if(0<y(Ut,vt))Re[Tt]=vt,Re[Ge]=Ut,Ge=Tt;else break e}}function l(Re){return Re.length===0?null:Re[0]}function p(Re){if(Re.length===0)return null;var vt=Re[0],Ge=Re.pop();if(Ge!==vt){Re[0]=Ge;e:for(var Tt=0,Ut=Re.length,bi=Ut>>>1;Tt<bi;){var ni=2*(Tt+1)-1,Lt=Re[ni],Dt=ni+1,Ai=Re[Dt];if(0>y(Lt,Ge))Dt<Ut&&0>y(Ai,Lt)?(Re[Tt]=Ai,Re[Dt]=Ge,Tt=Dt):(Re[Tt]=Lt,Re[ni]=Ge,Tt=ni);else if(Dt<Ut&&0>y(Ai,Ge))Re[Tt]=Ai,Re[Dt]=Ge,Tt=Dt;else break e}}return vt}function y(Re,vt){var Ge=Re.sortIndex-vt.sortIndex;return Ge!==0?Ge:Re.id-vt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var b=performance;e.unstable_now=function(){return b.now()}}else{var k=Date,c=k.now();e.unstable_now=function(){return k.now()-c}}var q=[],le=[],Ie=1,ge=null,K=3,Ze=!1,Ve=!1,De=!1,Qt=typeof setTimeout=="function"?setTimeout:null,ye=typeof clearTimeout=="function"?clearTimeout:null,ue=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function me(Re){for(var vt=l(le);vt!==null;){if(vt.callback===null)p(le);else if(vt.startTime<=Re)p(le),vt.sortIndex=vt.expirationTime,n(q,vt);else break;vt=l(le)}}function Ue(Re){if(De=!1,me(Re),!Ve)if(l(q)!==null)Ve=!0,ut($e);else{var vt=l(le);vt!==null&&Ji(Ue,vt.startTime-Re)}}function $e(Re,vt){Ve=!1,De&&(De=!1,ye(pt),pt=-1),Ze=!0;var Ge=K;try{for(me(vt),ge=l(q);ge!==null&&(!(ge.expirationTime>vt)||Re&&!ei());){var Tt=ge.callback;if(typeof Tt=="function"){ge.callback=null,K=ge.priorityLevel;var Ut=Tt(ge.expirationTime<=vt);vt=e.unstable_now(),typeof Ut=="function"?ge.callback=Ut:ge===l(q)&&p(q),me(vt)}else p(q);ge=l(q)}if(ge!==null)var bi=!0;else{var ni=l(le);ni!==null&&Ji(Ue,ni.startTime-vt),bi=!1}return bi}finally{ge=null,K=Ge,Ze=!1}}var lt=!1,dt=null,pt=-1,ci=5,Ct=-1;function ei(){return!(e.unstable_now()-Ct<ci)}function _i(){if(dt!==null){var Re=e.unstable_now();Ct=Re;var vt=!0;try{vt=dt(!0,Re)}finally{vt?$n():(lt=!1,dt=null)}}else lt=!1}var $n;if(typeof ue=="function")$n=function(){ue(_i)};else if(typeof MessageChannel<"u"){var Ni=new MessageChannel,xr=Ni.port2;Ni.port1.onmessage=_i,$n=function(){xr.postMessage(null)}}else $n=function(){Qt(_i,0)};function ut(Re){dt=Re,lt||(lt=!0,$n())}function Ji(Re,vt){pt=Qt(function(){Re(e.unstable_now())},vt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Re){Re.callback=null},e.unstable_continueExecution=function(){Ve||Ze||(Ve=!0,ut($e))},e.unstable_forceFrameRate=function(Re){0>Re||125<Re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ci=0<Re?Math.floor(1e3/Re):5},e.unstable_getCurrentPriorityLevel=function(){return K},e.unstable_getFirstCallbackNode=function(){return l(q)},e.unstable_next=function(Re){switch(K){case 1:case 2:case 3:var vt=3;break;default:vt=K}var Ge=K;K=vt;try{return Re()}finally{K=Ge}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Re,vt){switch(Re){case 1:case 2:case 3:case 4:case 5:break;default:Re=3}var Ge=K;K=Re;try{return vt()}finally{K=Ge}},e.unstable_scheduleCallback=function(Re,vt,Ge){var Tt=e.unstable_now();switch(typeof Ge=="object"&&Ge!==null?(Ge=Ge.delay,Ge=typeof Ge=="number"&&0<Ge?Tt+Ge:Tt):Ge=Tt,Re){case 1:var Ut=-1;break;case 2:Ut=250;break;case 5:Ut=1073741823;break;case 4:Ut=1e4;break;default:Ut=5e3}return Ut=Ge+Ut,Re={id:Ie++,callback:vt,priorityLevel:Re,startTime:Ge,expirationTime:Ut,sortIndex:-1},Ge>Tt?(Re.sortIndex=Ge,n(le,Re),l(q)===null&&Re===l(le)&&(De?(ye(pt),pt=-1):De=!0,Ji(Ue,Ge-Tt))):(Re.sortIndex=Ut,n(q,Re),Ve||Ze||(Ve=!0,ut($e))),Re},e.unstable_shouldYield=ei,e.unstable_wrapCallback=function(Re){var vt=K;return function(){var Ge=K;K=vt;try{return Re.apply(this,arguments)}finally{K=Ge}}}})(yv);(function(e){e.exports=yv})(Jw);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vv=$l,ao=If;function qe(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,l=1;l<arguments.length;l++)n+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xv=new Set,Xc={};function Yl(e,n){Zu(e,n),Zu(e+"Capture",n)}function Zu(e,n){for(Xc[e]=n,e=0;e<n.length;e++)xv.add(n[e])}var _a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kf=Object.prototype.hasOwnProperty,Yw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Qg={},ey={};function Qw(e){return kf.call(ey,e)?!0:kf.call(Qg,e)?!1:Yw.test(e)?ey[e]=!0:(Qg[e]=!0,!1)}function eb(e,n,l,p){if(l!==null&&l.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return p?!1:l!==null?!l.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function tb(e,n,l,p){if(n===null||typeof n>"u"||eb(e,n,l,p))return!0;if(p)return!1;if(l!==null)switch(l.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function vr(e,n,l,p,y,b,k){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=p,this.attributeNamespace=y,this.mustUseProperty=l,this.propertyName=e,this.type=n,this.sanitizeURL=b,this.removeEmptyString=k}var qn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qn[e]=new vr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];qn[n]=new vr(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qn[e]=new vr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qn[e]=new vr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qn[e]=new vr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qn[e]=new vr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qn[e]=new vr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qn[e]=new vr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qn[e]=new vr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Am=/[\-:]([a-z])/g;function zm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(Am,zm);qn[n]=new vr(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(Am,zm);qn[n]=new vr(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(Am,zm);qn[n]=new vr(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qn[e]=new vr(e,1,!1,e.toLowerCase(),null,!1,!1)});qn.xlinkHref=new vr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qn[e]=new vr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Mm(e,n,l,p){var y=qn.hasOwnProperty(n)?qn[n]:null;(y!==null?y.type!==0:p||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(tb(n,l,y,p)&&(l=null),p||y===null?Qw(n)&&(l===null?e.removeAttribute(n):e.setAttribute(n,""+l)):y.mustUseProperty?e[y.propertyName]=l===null?y.type===3?!1:"":l:(n=y.attributeName,p=y.attributeNamespace,l===null?e.removeAttribute(n):(y=y.type,l=y===3||y===4&&l===!0?"":""+l,p?e.setAttributeNS(p,n,l):e.setAttribute(n,l))))}var xa=vv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qh=Symbol.for("react.element"),Su=Symbol.for("react.portal"),Eu=Symbol.for("react.fragment"),Lm=Symbol.for("react.strict_mode"),Af=Symbol.for("react.profiler"),wv=Symbol.for("react.provider"),bv=Symbol.for("react.context"),Dm=Symbol.for("react.forward_ref"),zf=Symbol.for("react.suspense"),Mf=Symbol.for("react.suspense_list"),Rm=Symbol.for("react.memo"),Wa=Symbol.for("react.lazy"),Tv=Symbol.for("react.offscreen"),ty=Symbol.iterator;function Pc(e){return e===null||typeof e!="object"?null:(e=ty&&e[ty]||e["@@iterator"],typeof e=="function"?e:null)}var qi=Object.assign,Yp;function Dc(e){if(Yp===void 0)try{throw Error()}catch(l){var n=l.stack.trim().match(/\n( *(at )?)/);Yp=n&&n[1]||""}return`
`+Yp+e}var Qp=!1;function ef(e,n){if(!e||Qp)return"";Qp=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(le){var p=le}Reflect.construct(e,[],n)}else{try{n.call()}catch(le){p=le}e.call(n.prototype)}else{try{throw Error()}catch(le){p=le}e()}}catch(le){if(le&&p&&typeof le.stack=="string"){for(var y=le.stack.split(`
`),b=p.stack.split(`
`),k=y.length-1,c=b.length-1;1<=k&&0<=c&&y[k]!==b[c];)c--;for(;1<=k&&0<=c;k--,c--)if(y[k]!==b[c]){if(k!==1||c!==1)do if(k--,c--,0>c||y[k]!==b[c]){var q=`
`+y[k].replace(" at new "," at ");return e.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",e.displayName)),q}while(1<=k&&0<=c);break}}}finally{Qp=!1,Error.prepareStackTrace=l}return(e=e?e.displayName||e.name:"")?Dc(e):""}function ib(e){switch(e.tag){case 5:return Dc(e.type);case 16:return Dc("Lazy");case 13:return Dc("Suspense");case 19:return Dc("SuspenseList");case 0:case 2:case 15:return e=ef(e.type,!1),e;case 11:return e=ef(e.type.render,!1),e;case 1:return e=ef(e.type,!0),e;default:return""}}function Lf(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Eu:return"Fragment";case Su:return"Portal";case Af:return"Profiler";case Lm:return"StrictMode";case zf:return"Suspense";case Mf:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bv:return(e.displayName||"Context")+".Consumer";case wv:return(e._context.displayName||"Context")+".Provider";case Dm:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Rm:return n=e.displayName||null,n!==null?n:Lf(e.type)||"Memo";case Wa:n=e._payload,e=e._init;try{return Lf(e(n))}catch{}}return null}function nb(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Lf(n);case 8:return n===Lm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function ll(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Sv(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function rb(e){var n=Sv(e)?"checked":"value",l=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),p=""+e[n];if(!e.hasOwnProperty(n)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var y=l.get,b=l.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return y.call(this)},set:function(k){p=""+k,b.call(this,k)}}),Object.defineProperty(e,n,{enumerable:l.enumerable}),{getValue:function(){return p},setValue:function(k){p=""+k},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function $h(e){e._valueTracker||(e._valueTracker=rb(e))}function Ev(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var l=n.getValue(),p="";return e&&(p=Sv(e)?e.checked?"true":"false":e.value),e=p,e!==l?(n.setValue(e),!0):!1}function xd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Df(e,n){var l=n.checked;return qi({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??e._wrapperState.initialChecked})}function iy(e,n){var l=n.defaultValue==null?"":n.defaultValue,p=n.checked!=null?n.checked:n.defaultChecked;l=ll(n.value!=null?n.value:l),e._wrapperState={initialChecked:p,initialValue:l,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Pv(e,n){n=n.checked,n!=null&&Mm(e,"checked",n,!1)}function Rf(e,n){Pv(e,n);var l=ll(n.value),p=n.type;if(l!=null)p==="number"?(l===0&&e.value===""||e.value!=l)&&(e.value=""+l):e.value!==""+l&&(e.value=""+l);else if(p==="submit"||p==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Bf(e,n.type,l):n.hasOwnProperty("defaultValue")&&Bf(e,n.type,ll(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function ny(e,n,l){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var p=n.type;if(!(p!=="submit"&&p!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,l||n===e.value||(e.value=n),e.defaultValue=n}l=e.name,l!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,l!==""&&(e.name=l)}function Bf(e,n,l){(n!=="number"||xd(e.ownerDocument)!==e)&&(l==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+l&&(e.defaultValue=""+l))}var Rc=Array.isArray;function Bu(e,n,l,p){if(e=e.options,n){n={};for(var y=0;y<l.length;y++)n["$"+l[y]]=!0;for(l=0;l<e.length;l++)y=n.hasOwnProperty("$"+e[l].value),e[l].selected!==y&&(e[l].selected=y),y&&p&&(e[l].defaultSelected=!0)}else{for(l=""+ll(l),n=null,y=0;y<e.length;y++){if(e[y].value===l){e[y].selected=!0,p&&(e[y].defaultSelected=!0);return}n!==null||e[y].disabled||(n=e[y])}n!==null&&(n.selected=!0)}}function Of(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(qe(91));return qi({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ry(e,n){var l=n.value;if(l==null){if(l=n.children,n=n.defaultValue,l!=null){if(n!=null)throw Error(qe(92));if(Rc(l)){if(1<l.length)throw Error(qe(93));l=l[0]}n=l}n==null&&(n=""),l=n}e._wrapperState={initialValue:ll(l)}}function Cv(e,n){var l=ll(n.value),p=ll(n.defaultValue);l!=null&&(l=""+l,l!==e.value&&(e.value=l),n.defaultValue==null&&e.defaultValue!==l&&(e.defaultValue=l)),p!=null&&(e.defaultValue=""+p)}function oy(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Iv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ff(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Iv(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Wh,kv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,l,p,y){MSApp.execUnsafeLocalFunction(function(){return e(n,l,p,y)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(Wh=Wh||document.createElement("div"),Wh.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Wh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Kc(e,n){if(n){var l=e.firstChild;if(l&&l===e.lastChild&&l.nodeType===3){l.nodeValue=n;return}}e.textContent=n}var Nc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ob=["Webkit","ms","Moz","O"];Object.keys(Nc).forEach(function(e){ob.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Nc[n]=Nc[e]})});function Av(e,n,l){return n==null||typeof n=="boolean"||n===""?"":l||typeof n!="number"||n===0||Nc.hasOwnProperty(e)&&Nc[e]?(""+n).trim():n+"px"}function zv(e,n){e=e.style;for(var l in n)if(n.hasOwnProperty(l)){var p=l.indexOf("--")===0,y=Av(l,n[l],p);l==="float"&&(l="cssFloat"),p?e.setProperty(l,y):e[l]=y}}var sb=qi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nf(e,n){if(n){if(sb[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(qe(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(qe(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(qe(61))}if(n.style!=null&&typeof n.style!="object")throw Error(qe(62))}}function Uf(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vf=null;function Bm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Zf=null,Ou=null,Fu=null;function sy(e){if(e=_h(e)){if(typeof Zf!="function")throw Error(qe(280));var n=e.stateNode;n&&(n=Yd(n),Zf(e.stateNode,e.type,n))}}function Mv(e){Ou?Fu?Fu.push(e):Fu=[e]:Ou=e}function Lv(){if(Ou){var e=Ou,n=Fu;if(Fu=Ou=null,sy(e),n)for(e=0;e<n.length;e++)sy(n[e])}}function Dv(e,n){return e(n)}function Rv(){}var tf=!1;function Bv(e,n,l){if(tf)return e(n,l);tf=!0;try{return Dv(e,n,l)}finally{tf=!1,(Ou!==null||Fu!==null)&&(Rv(),Lv())}}function Jc(e,n){var l=e.stateNode;if(l===null)return null;var p=Yd(l);if(p===null)return null;l=p[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(e=e.type,p=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!p;break e;default:e=!1}if(e)return null;if(l&&typeof l!="function")throw Error(qe(231,n,typeof l));return l}var Gf=!1;if(_a)try{var Cc={};Object.defineProperty(Cc,"passive",{get:function(){Gf=!0}}),window.addEventListener("test",Cc,Cc),window.removeEventListener("test",Cc,Cc)}catch{Gf=!1}function ab(e,n,l,p,y,b,k,c,q){var le=Array.prototype.slice.call(arguments,3);try{n.apply(l,le)}catch(Ie){this.onError(Ie)}}var Uc=!1,wd=null,bd=!1,jf=null,lb={onError:function(e){Uc=!0,wd=e}};function ub(e,n,l,p,y,b,k,c,q){Uc=!1,wd=null,ab.apply(lb,arguments)}function cb(e,n,l,p,y,b,k,c,q){if(ub.apply(this,arguments),Uc){if(Uc){var le=wd;Uc=!1,wd=null}else throw Error(qe(198));bd||(bd=!0,jf=le)}}function Ql(e){var n=e,l=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(l=n.return),e=n.return;while(e)}return n.tag===3?l:null}function Ov(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function ay(e){if(Ql(e)!==e)throw Error(qe(188))}function hb(e){var n=e.alternate;if(!n){if(n=Ql(e),n===null)throw Error(qe(188));return n!==e?null:e}for(var l=e,p=n;;){var y=l.return;if(y===null)break;var b=y.alternate;if(b===null){if(p=y.return,p!==null){l=p;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===l)return ay(y),e;if(b===p)return ay(y),n;b=b.sibling}throw Error(qe(188))}if(l.return!==p.return)l=y,p=b;else{for(var k=!1,c=y.child;c;){if(c===l){k=!0,l=y,p=b;break}if(c===p){k=!0,p=y,l=b;break}c=c.sibling}if(!k){for(c=b.child;c;){if(c===l){k=!0,l=b,p=y;break}if(c===p){k=!0,p=b,l=y;break}c=c.sibling}if(!k)throw Error(qe(189))}}if(l.alternate!==p)throw Error(qe(190))}if(l.tag!==3)throw Error(qe(188));return l.stateNode.current===l?e:n}function Fv(e){return e=hb(e),e!==null?Nv(e):null}function Nv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Nv(e);if(n!==null)return n;e=e.sibling}return null}var Uv=ao.unstable_scheduleCallback,ly=ao.unstable_cancelCallback,db=ao.unstable_shouldYield,pb=ao.unstable_requestPaint,tn=ao.unstable_now,fb=ao.unstable_getCurrentPriorityLevel,Om=ao.unstable_ImmediatePriority,Vv=ao.unstable_UserBlockingPriority,Td=ao.unstable_NormalPriority,mb=ao.unstable_LowPriority,Zv=ao.unstable_IdlePriority,Hd=null,As=null;function _b(e){if(As&&typeof As.onCommitFiberRoot=="function")try{As.onCommitFiberRoot(Hd,e,void 0,(e.current.flags&128)===128)}catch{}}var cs=Math.clz32?Math.clz32:vb,gb=Math.log,yb=Math.LN2;function vb(e){return e>>>=0,e===0?32:31-(gb(e)/yb|0)|0}var Hh=64,Xh=4194304;function Bc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Sd(e,n){var l=e.pendingLanes;if(l===0)return 0;var p=0,y=e.suspendedLanes,b=e.pingedLanes,k=l&268435455;if(k!==0){var c=k&~y;c!==0?p=Bc(c):(b&=k,b!==0&&(p=Bc(b)))}else k=l&~y,k!==0?p=Bc(k):b!==0&&(p=Bc(b));if(p===0)return 0;if(n!==0&&n!==p&&!(n&y)&&(y=p&-p,b=n&-n,y>=b||y===16&&(b&4194240)!==0))return n;if(p&4&&(p|=l&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=p;0<n;)l=31-cs(n),y=1<<l,p|=e[l],n&=~y;return p}function xb(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wb(e,n){for(var l=e.suspendedLanes,p=e.pingedLanes,y=e.expirationTimes,b=e.pendingLanes;0<b;){var k=31-cs(b),c=1<<k,q=y[k];q===-1?(!(c&l)||c&p)&&(y[k]=xb(c,n)):q<=n&&(e.expiredLanes|=c),b&=~c}}function qf(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Gv(){var e=Hh;return Hh<<=1,!(Hh&4194240)&&(Hh=64),e}function nf(e){for(var n=[],l=0;31>l;l++)n.push(e);return n}function fh(e,n,l){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-cs(n),e[n]=l}function bb(e,n){var l=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var p=e.eventTimes;for(e=e.expirationTimes;0<l;){var y=31-cs(l),b=1<<y;n[y]=0,p[y]=-1,e[y]=-1,l&=~b}}function Fm(e,n){var l=e.entangledLanes|=n;for(e=e.entanglements;l;){var p=31-cs(l),y=1<<p;y&n|e[p]&n&&(e[p]|=n),l&=~y}}var wi=0;function jv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var qv,Nm,$v,Wv,Hv,$f=!1,Kh=[],el=null,tl=null,il=null,Yc=new Map,Qc=new Map,Xa=[],Tb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function uy(e,n){switch(e){case"focusin":case"focusout":el=null;break;case"dragenter":case"dragleave":tl=null;break;case"mouseover":case"mouseout":il=null;break;case"pointerover":case"pointerout":Yc.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qc.delete(n.pointerId)}}function Ic(e,n,l,p,y,b){return e===null||e.nativeEvent!==b?(e={blockedOn:n,domEventName:l,eventSystemFlags:p,nativeEvent:b,targetContainers:[y]},n!==null&&(n=_h(n),n!==null&&Nm(n)),e):(e.eventSystemFlags|=p,n=e.targetContainers,y!==null&&n.indexOf(y)===-1&&n.push(y),e)}function Sb(e,n,l,p,y){switch(n){case"focusin":return el=Ic(el,e,n,l,p,y),!0;case"dragenter":return tl=Ic(tl,e,n,l,p,y),!0;case"mouseover":return il=Ic(il,e,n,l,p,y),!0;case"pointerover":var b=y.pointerId;return Yc.set(b,Ic(Yc.get(b)||null,e,n,l,p,y)),!0;case"gotpointercapture":return b=y.pointerId,Qc.set(b,Ic(Qc.get(b)||null,e,n,l,p,y)),!0}return!1}function Xv(e){var n=Vl(e.target);if(n!==null){var l=Ql(n);if(l!==null){if(n=l.tag,n===13){if(n=Ov(l),n!==null){e.blockedOn=n,Hv(e.priority,function(){$v(l)});return}}else if(n===3&&l.stateNode.current.memoizedState.isDehydrated){e.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cd(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var l=Wf(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(l===null){l=e.nativeEvent;var p=new l.constructor(l.type,l);Vf=p,l.target.dispatchEvent(p),Vf=null}else return n=_h(l),n!==null&&Nm(n),e.blockedOn=l,!1;n.shift()}return!0}function cy(e,n,l){cd(e)&&l.delete(n)}function Eb(){$f=!1,el!==null&&cd(el)&&(el=null),tl!==null&&cd(tl)&&(tl=null),il!==null&&cd(il)&&(il=null),Yc.forEach(cy),Qc.forEach(cy)}function kc(e,n){e.blockedOn===n&&(e.blockedOn=null,$f||($f=!0,ao.unstable_scheduleCallback(ao.unstable_NormalPriority,Eb)))}function eh(e){function n(y){return kc(y,e)}if(0<Kh.length){kc(Kh[0],e);for(var l=1;l<Kh.length;l++){var p=Kh[l];p.blockedOn===e&&(p.blockedOn=null)}}for(el!==null&&kc(el,e),tl!==null&&kc(tl,e),il!==null&&kc(il,e),Yc.forEach(n),Qc.forEach(n),l=0;l<Xa.length;l++)p=Xa[l],p.blockedOn===e&&(p.blockedOn=null);for(;0<Xa.length&&(l=Xa[0],l.blockedOn===null);)Xv(l),l.blockedOn===null&&Xa.shift()}var Nu=xa.ReactCurrentBatchConfig,Ed=!0;function Pb(e,n,l,p){var y=wi,b=Nu.transition;Nu.transition=null;try{wi=1,Um(e,n,l,p)}finally{wi=y,Nu.transition=b}}function Cb(e,n,l,p){var y=wi,b=Nu.transition;Nu.transition=null;try{wi=4,Um(e,n,l,p)}finally{wi=y,Nu.transition=b}}function Um(e,n,l,p){if(Ed){var y=Wf(e,n,l,p);if(y===null)pf(e,n,p,Pd,l),uy(e,p);else if(Sb(y,e,n,l,p))p.stopPropagation();else if(uy(e,p),n&4&&-1<Tb.indexOf(e)){for(;y!==null;){var b=_h(y);if(b!==null&&qv(b),b=Wf(e,n,l,p),b===null&&pf(e,n,p,Pd,l),b===y)break;y=b}y!==null&&p.stopPropagation()}else pf(e,n,p,null,l)}}var Pd=null;function Wf(e,n,l,p){if(Pd=null,e=Bm(p),e=Vl(e),e!==null)if(n=Ql(e),n===null)e=null;else if(l=n.tag,l===13){if(e=Ov(n),e!==null)return e;e=null}else if(l===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return Pd=e,null}function Kv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fb()){case Om:return 1;case Vv:return 4;case Td:case mb:return 16;case Zv:return 536870912;default:return 16}default:return 16}}var Ya=null,Vm=null,hd=null;function Jv(){if(hd)return hd;var e,n=Vm,l=n.length,p,y="value"in Ya?Ya.value:Ya.textContent,b=y.length;for(e=0;e<l&&n[e]===y[e];e++);var k=l-e;for(p=1;p<=k&&n[l-p]===y[b-p];p++);return hd=y.slice(e,1<p?1-p:void 0)}function dd(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Jh(){return!0}function hy(){return!1}function uo(e){function n(l,p,y,b,k){this._reactName=l,this._targetInst=y,this.type=p,this.nativeEvent=b,this.target=k,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(l=e[c],this[c]=l?l(b):b[c]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Jh:hy,this.isPropagationStopped=hy,this}return qi(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Jh)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Jh)},persist:function(){},isPersistent:Jh}),n}var Ku={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zm=uo(Ku),mh=qi({},Ku,{view:0,detail:0}),Ib=uo(mh),rf,of,Ac,Xd=qi({},mh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gm,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ac&&(Ac&&e.type==="mousemove"?(rf=e.screenX-Ac.screenX,of=e.screenY-Ac.screenY):of=rf=0,Ac=e),rf)},movementY:function(e){return"movementY"in e?e.movementY:of}}),dy=uo(Xd),kb=qi({},Xd,{dataTransfer:0}),Ab=uo(kb),zb=qi({},mh,{relatedTarget:0}),sf=uo(zb),Mb=qi({},Ku,{animationName:0,elapsedTime:0,pseudoElement:0}),Lb=uo(Mb),Db=qi({},Ku,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Rb=uo(Db),Bb=qi({},Ku,{data:0}),py=uo(Bb),Ob={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ub(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=Nb[e])?!!n[e]:!1}function Gm(){return Ub}var Vb=qi({},mh,{key:function(e){if(e.key){var n=Ob[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=dd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Fb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gm,charCode:function(e){return e.type==="keypress"?dd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?dd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Zb=uo(Vb),Gb=qi({},Xd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fy=uo(Gb),jb=qi({},mh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gm}),qb=uo(jb),$b=qi({},Ku,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wb=uo($b),Hb=qi({},Xd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Xb=uo(Hb),Kb=[9,13,27,32],jm=_a&&"CompositionEvent"in window,Vc=null;_a&&"documentMode"in document&&(Vc=document.documentMode);var Jb=_a&&"TextEvent"in window&&!Vc,Yv=_a&&(!jm||Vc&&8<Vc&&11>=Vc),my=String.fromCharCode(32),_y=!1;function Qv(e,n){switch(e){case"keyup":return Kb.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ex(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Pu=!1;function Yb(e,n){switch(e){case"compositionend":return ex(n);case"keypress":return n.which!==32?null:(_y=!0,my);case"textInput":return e=n.data,e===my&&_y?null:e;default:return null}}function Qb(e,n){if(Pu)return e==="compositionend"||!jm&&Qv(e,n)?(e=Jv(),hd=Vm=Ya=null,Pu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return Yv&&n.locale!=="ko"?null:n.data;default:return null}}var e2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gy(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!e2[e.type]:n==="textarea"}function tx(e,n,l,p){Mv(p),n=Cd(n,"onChange"),0<n.length&&(l=new Zm("onChange","change",null,l,p),e.push({event:l,listeners:n}))}var Zc=null,th=null;function t2(e){dx(e,0)}function Kd(e){var n=ku(e);if(Ev(n))return e}function i2(e,n){if(e==="change")return n}var ix=!1;if(_a){var af;if(_a){var lf="oninput"in document;if(!lf){var yy=document.createElement("div");yy.setAttribute("oninput","return;"),lf=typeof yy.oninput=="function"}af=lf}else af=!1;ix=af&&(!document.documentMode||9<document.documentMode)}function vy(){Zc&&(Zc.detachEvent("onpropertychange",nx),th=Zc=null)}function nx(e){if(e.propertyName==="value"&&Kd(th)){var n=[];tx(n,th,e,Bm(e)),Bv(t2,n)}}function n2(e,n,l){e==="focusin"?(vy(),Zc=n,th=l,Zc.attachEvent("onpropertychange",nx)):e==="focusout"&&vy()}function r2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Kd(th)}function o2(e,n){if(e==="click")return Kd(n)}function s2(e,n){if(e==="input"||e==="change")return Kd(n)}function a2(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var ds=typeof Object.is=="function"?Object.is:a2;function ih(e,n){if(ds(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var l=Object.keys(e),p=Object.keys(n);if(l.length!==p.length)return!1;for(p=0;p<l.length;p++){var y=l[p];if(!kf.call(n,y)||!ds(e[y],n[y]))return!1}return!0}function xy(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wy(e,n){var l=xy(e);e=0;for(var p;l;){if(l.nodeType===3){if(p=e+l.textContent.length,e<=n&&p>=n)return{node:l,offset:n-e};e=p}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=xy(l)}}function rx(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?rx(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function ox(){for(var e=window,n=xd();n instanceof e.HTMLIFrameElement;){try{var l=typeof n.contentWindow.location.href=="string"}catch{l=!1}if(l)e=n.contentWindow;else break;n=xd(e.document)}return n}function qm(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function l2(e){var n=ox(),l=e.focusedElem,p=e.selectionRange;if(n!==l&&l&&l.ownerDocument&&rx(l.ownerDocument.documentElement,l)){if(p!==null&&qm(l)){if(n=p.start,e=p.end,e===void 0&&(e=n),"selectionStart"in l)l.selectionStart=n,l.selectionEnd=Math.min(e,l.value.length);else if(e=(n=l.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var y=l.textContent.length,b=Math.min(p.start,y);p=p.end===void 0?b:Math.min(p.end,y),!e.extend&&b>p&&(y=p,p=b,b=y),y=wy(l,b);var k=wy(l,p);y&&k&&(e.rangeCount!==1||e.anchorNode!==y.node||e.anchorOffset!==y.offset||e.focusNode!==k.node||e.focusOffset!==k.offset)&&(n=n.createRange(),n.setStart(y.node,y.offset),e.removeAllRanges(),b>p?(e.addRange(n),e.extend(k.node,k.offset)):(n.setEnd(k.node,k.offset),e.addRange(n)))}}for(n=[],e=l;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<n.length;l++)e=n[l],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var u2=_a&&"documentMode"in document&&11>=document.documentMode,Cu=null,Hf=null,Gc=null,Xf=!1;function by(e,n,l){var p=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Xf||Cu==null||Cu!==xd(p)||(p=Cu,"selectionStart"in p&&qm(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Gc&&ih(Gc,p)||(Gc=p,p=Cd(Hf,"onSelect"),0<p.length&&(n=new Zm("onSelect","select",null,n,l),e.push({event:n,listeners:p}),n.target=Cu)))}function Yh(e,n){var l={};return l[e.toLowerCase()]=n.toLowerCase(),l["Webkit"+e]="webkit"+n,l["Moz"+e]="moz"+n,l}var Iu={animationend:Yh("Animation","AnimationEnd"),animationiteration:Yh("Animation","AnimationIteration"),animationstart:Yh("Animation","AnimationStart"),transitionend:Yh("Transition","TransitionEnd")},uf={},sx={};_a&&(sx=document.createElement("div").style,"AnimationEvent"in window||(delete Iu.animationend.animation,delete Iu.animationiteration.animation,delete Iu.animationstart.animation),"TransitionEvent"in window||delete Iu.transitionend.transition);function Jd(e){if(uf[e])return uf[e];if(!Iu[e])return e;var n=Iu[e],l;for(l in n)if(n.hasOwnProperty(l)&&l in sx)return uf[e]=n[l];return e}var ax=Jd("animationend"),lx=Jd("animationiteration"),ux=Jd("animationstart"),cx=Jd("transitionend"),hx=new Map,Ty="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function hl(e,n){hx.set(e,n),Yl(n,[e])}for(var cf=0;cf<Ty.length;cf++){var hf=Ty[cf],c2=hf.toLowerCase(),h2=hf[0].toUpperCase()+hf.slice(1);hl(c2,"on"+h2)}hl(ax,"onAnimationEnd");hl(lx,"onAnimationIteration");hl(ux,"onAnimationStart");hl("dblclick","onDoubleClick");hl("focusin","onFocus");hl("focusout","onBlur");hl(cx,"onTransitionEnd");Zu("onMouseEnter",["mouseout","mouseover"]);Zu("onMouseLeave",["mouseout","mouseover"]);Zu("onPointerEnter",["pointerout","pointerover"]);Zu("onPointerLeave",["pointerout","pointerover"]);Yl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Yl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Yl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Yl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Yl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Yl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Oc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),d2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Oc));function Sy(e,n,l){var p=e.type||"unknown-event";e.currentTarget=l,cb(p,n,void 0,e),e.currentTarget=null}function dx(e,n){n=(n&4)!==0;for(var l=0;l<e.length;l++){var p=e[l],y=p.event;p=p.listeners;e:{var b=void 0;if(n)for(var k=p.length-1;0<=k;k--){var c=p[k],q=c.instance,le=c.currentTarget;if(c=c.listener,q!==b&&y.isPropagationStopped())break e;Sy(y,c,le),b=q}else for(k=0;k<p.length;k++){if(c=p[k],q=c.instance,le=c.currentTarget,c=c.listener,q!==b&&y.isPropagationStopped())break e;Sy(y,c,le),b=q}}}if(bd)throw e=jf,bd=!1,jf=null,e}function Mi(e,n){var l=n[em];l===void 0&&(l=n[em]=new Set);var p=e+"__bubble";l.has(p)||(px(n,e,2,!1),l.add(p))}function df(e,n,l){var p=0;n&&(p|=4),px(l,e,p,n)}var Qh="_reactListening"+Math.random().toString(36).slice(2);function nh(e){if(!e[Qh]){e[Qh]=!0,xv.forEach(function(l){l!=="selectionchange"&&(d2.has(l)||df(l,!1,e),df(l,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Qh]||(n[Qh]=!0,df("selectionchange",!1,n))}}function px(e,n,l,p){switch(Kv(n)){case 1:var y=Pb;break;case 4:y=Cb;break;default:y=Um}l=y.bind(null,n,l,e),y=void 0,!Gf||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(y=!0),p?y!==void 0?e.addEventListener(n,l,{capture:!0,passive:y}):e.addEventListener(n,l,!0):y!==void 0?e.addEventListener(n,l,{passive:y}):e.addEventListener(n,l,!1)}function pf(e,n,l,p,y){var b=p;if(!(n&1)&&!(n&2)&&p!==null)e:for(;;){if(p===null)return;var k=p.tag;if(k===3||k===4){var c=p.stateNode.containerInfo;if(c===y||c.nodeType===8&&c.parentNode===y)break;if(k===4)for(k=p.return;k!==null;){var q=k.tag;if((q===3||q===4)&&(q=k.stateNode.containerInfo,q===y||q.nodeType===8&&q.parentNode===y))return;k=k.return}for(;c!==null;){if(k=Vl(c),k===null)return;if(q=k.tag,q===5||q===6){p=b=k;continue e}c=c.parentNode}}p=p.return}Bv(function(){var le=b,Ie=Bm(l),ge=[];e:{var K=hx.get(e);if(K!==void 0){var Ze=Zm,Ve=e;switch(e){case"keypress":if(dd(l)===0)break e;case"keydown":case"keyup":Ze=Zb;break;case"focusin":Ve="focus",Ze=sf;break;case"focusout":Ve="blur",Ze=sf;break;case"beforeblur":case"afterblur":Ze=sf;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=dy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Ab;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=qb;break;case ax:case lx:case ux:Ze=Lb;break;case cx:Ze=Wb;break;case"scroll":Ze=Ib;break;case"wheel":Ze=Xb;break;case"copy":case"cut":case"paste":Ze=Rb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=fy}var De=(n&4)!==0,Qt=!De&&e==="scroll",ye=De?K!==null?K+"Capture":null:K;De=[];for(var ue=le,me;ue!==null;){me=ue;var Ue=me.stateNode;if(me.tag===5&&Ue!==null&&(me=Ue,ye!==null&&(Ue=Jc(ue,ye),Ue!=null&&De.push(rh(ue,Ue,me)))),Qt)break;ue=ue.return}0<De.length&&(K=new Ze(K,Ve,null,l,Ie),ge.push({event:K,listeners:De}))}}if(!(n&7)){e:{if(K=e==="mouseover"||e==="pointerover",Ze=e==="mouseout"||e==="pointerout",K&&l!==Vf&&(Ve=l.relatedTarget||l.fromElement)&&(Vl(Ve)||Ve[ga]))break e;if((Ze||K)&&(K=Ie.window===Ie?Ie:(K=Ie.ownerDocument)?K.defaultView||K.parentWindow:window,Ze?(Ve=l.relatedTarget||l.toElement,Ze=le,Ve=Ve?Vl(Ve):null,Ve!==null&&(Qt=Ql(Ve),Ve!==Qt||Ve.tag!==5&&Ve.tag!==6)&&(Ve=null)):(Ze=null,Ve=le),Ze!==Ve)){if(De=dy,Ue="onMouseLeave",ye="onMouseEnter",ue="mouse",(e==="pointerout"||e==="pointerover")&&(De=fy,Ue="onPointerLeave",ye="onPointerEnter",ue="pointer"),Qt=Ze==null?K:ku(Ze),me=Ve==null?K:ku(Ve),K=new De(Ue,ue+"leave",Ze,l,Ie),K.target=Qt,K.relatedTarget=me,Ue=null,Vl(Ie)===le&&(De=new De(ye,ue+"enter",Ve,l,Ie),De.target=me,De.relatedTarget=Qt,Ue=De),Qt=Ue,Ze&&Ve)t:{for(De=Ze,ye=Ve,ue=0,me=De;me;me=Tu(me))ue++;for(me=0,Ue=ye;Ue;Ue=Tu(Ue))me++;for(;0<ue-me;)De=Tu(De),ue--;for(;0<me-ue;)ye=Tu(ye),me--;for(;ue--;){if(De===ye||ye!==null&&De===ye.alternate)break t;De=Tu(De),ye=Tu(ye)}De=null}else De=null;Ze!==null&&Ey(ge,K,Ze,De,!1),Ve!==null&&Qt!==null&&Ey(ge,Qt,Ve,De,!0)}}e:{if(K=le?ku(le):window,Ze=K.nodeName&&K.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&K.type==="file")var $e=i2;else if(gy(K))if(ix)$e=s2;else{$e=r2;var lt=n2}else(Ze=K.nodeName)&&Ze.toLowerCase()==="input"&&(K.type==="checkbox"||K.type==="radio")&&($e=o2);if($e&&($e=$e(e,le))){tx(ge,$e,l,Ie);break e}lt&&lt(e,K,le),e==="focusout"&&(lt=K._wrapperState)&&lt.controlled&&K.type==="number"&&Bf(K,"number",K.value)}switch(lt=le?ku(le):window,e){case"focusin":(gy(lt)||lt.contentEditable==="true")&&(Cu=lt,Hf=le,Gc=null);break;case"focusout":Gc=Hf=Cu=null;break;case"mousedown":Xf=!0;break;case"contextmenu":case"mouseup":case"dragend":Xf=!1,by(ge,l,Ie);break;case"selectionchange":if(u2)break;case"keydown":case"keyup":by(ge,l,Ie)}var dt;if(jm)e:{switch(e){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else Pu?Qv(e,l)&&(pt="onCompositionEnd"):e==="keydown"&&l.keyCode===229&&(pt="onCompositionStart");pt&&(Yv&&l.locale!=="ko"&&(Pu||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&Pu&&(dt=Jv()):(Ya=Ie,Vm="value"in Ya?Ya.value:Ya.textContent,Pu=!0)),lt=Cd(le,pt),0<lt.length&&(pt=new py(pt,e,null,l,Ie),ge.push({event:pt,listeners:lt}),dt?pt.data=dt:(dt=ex(l),dt!==null&&(pt.data=dt)))),(dt=Jb?Yb(e,l):Qb(e,l))&&(le=Cd(le,"onBeforeInput"),0<le.length&&(Ie=new py("onBeforeInput","beforeinput",null,l,Ie),ge.push({event:Ie,listeners:le}),Ie.data=dt))}dx(ge,n)})}function rh(e,n,l){return{instance:e,listener:n,currentTarget:l}}function Cd(e,n){for(var l=n+"Capture",p=[];e!==null;){var y=e,b=y.stateNode;y.tag===5&&b!==null&&(y=b,b=Jc(e,l),b!=null&&p.unshift(rh(e,b,y)),b=Jc(e,n),b!=null&&p.push(rh(e,b,y))),e=e.return}return p}function Tu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ey(e,n,l,p,y){for(var b=n._reactName,k=[];l!==null&&l!==p;){var c=l,q=c.alternate,le=c.stateNode;if(q!==null&&q===p)break;c.tag===5&&le!==null&&(c=le,y?(q=Jc(l,b),q!=null&&k.unshift(rh(l,q,c))):y||(q=Jc(l,b),q!=null&&k.push(rh(l,q,c)))),l=l.return}k.length!==0&&e.push({event:n,listeners:k})}var p2=/\r\n?/g,f2=/\u0000|\uFFFD/g;function Py(e){return(typeof e=="string"?e:""+e).replace(p2,`
`).replace(f2,"")}function ed(e,n,l){if(n=Py(n),Py(e)!==n&&l)throw Error(qe(425))}function Id(){}var Kf=null,Jf=null;function Yf(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var Qf=typeof setTimeout=="function"?setTimeout:void 0,m2=typeof clearTimeout=="function"?clearTimeout:void 0,Cy=typeof Promise=="function"?Promise:void 0,_2=typeof queueMicrotask=="function"?queueMicrotask:typeof Cy<"u"?function(e){return Cy.resolve(null).then(e).catch(g2)}:Qf;function g2(e){setTimeout(function(){throw e})}function ff(e,n){var l=n,p=0;do{var y=l.nextSibling;if(e.removeChild(l),y&&y.nodeType===8)if(l=y.data,l==="/$"){if(p===0){e.removeChild(y),eh(n);return}p--}else l!=="$"&&l!=="$?"&&l!=="$!"||p++;l=y}while(l);eh(n)}function nl(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Iy(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="$"||l==="$!"||l==="$?"){if(n===0)return e;n--}else l==="/$"&&n++}e=e.previousSibling}return null}var Ju=Math.random().toString(36).slice(2),ks="__reactFiber$"+Ju,oh="__reactProps$"+Ju,ga="__reactContainer$"+Ju,em="__reactEvents$"+Ju,y2="__reactListeners$"+Ju,v2="__reactHandles$"+Ju;function Vl(e){var n=e[ks];if(n)return n;for(var l=e.parentNode;l;){if(n=l[ga]||l[ks]){if(l=n.alternate,n.child!==null||l!==null&&l.child!==null)for(e=Iy(e);e!==null;){if(l=e[ks])return l;e=Iy(e)}return n}e=l,l=e.parentNode}return null}function _h(e){return e=e[ks]||e[ga],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ku(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(qe(33))}function Yd(e){return e[oh]||null}var tm=[],Au=-1;function dl(e){return{current:e}}function Li(e){0>Au||(e.current=tm[Au],tm[Au]=null,Au--)}function ki(e,n){Au++,tm[Au]=e.current,e.current=n}var ul={},rr=dl(ul),Fr=dl(!1),Wl=ul;function Gu(e,n){var l=e.type.contextTypes;if(!l)return ul;var p=e.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===n)return p.__reactInternalMemoizedMaskedChildContext;var y={},b;for(b in l)y[b]=n[b];return p&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=y),y}function Nr(e){return e=e.childContextTypes,e!=null}function kd(){Li(Fr),Li(rr)}function ky(e,n,l){if(rr.current!==ul)throw Error(qe(168));ki(rr,n),ki(Fr,l)}function fx(e,n,l){var p=e.stateNode;if(n=n.childContextTypes,typeof p.getChildContext!="function")return l;p=p.getChildContext();for(var y in p)if(!(y in n))throw Error(qe(108,nb(e)||"Unknown",y));return qi({},l,p)}function Ad(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ul,Wl=rr.current,ki(rr,e),ki(Fr,Fr.current),!0}function Ay(e,n,l){var p=e.stateNode;if(!p)throw Error(qe(169));l?(e=fx(e,n,Wl),p.__reactInternalMemoizedMergedChildContext=e,Li(Fr),Li(rr),ki(rr,e)):Li(Fr),ki(Fr,l)}var ha=null,Qd=!1,mf=!1;function mx(e){ha===null?ha=[e]:ha.push(e)}function x2(e){Qd=!0,mx(e)}function pl(){if(!mf&&ha!==null){mf=!0;var e=0,n=wi;try{var l=ha;for(wi=1;e<l.length;e++){var p=l[e];do p=p(!0);while(p!==null)}ha=null,Qd=!1}catch(y){throw ha!==null&&(ha=ha.slice(e+1)),Uv(Om,pl),y}finally{wi=n,mf=!1}}return null}var zu=[],Mu=0,zd=null,Md=0,Ao=[],zo=0,Hl=null,da=1,pa="";function Nl(e,n){zu[Mu++]=Md,zu[Mu++]=zd,zd=e,Md=n}function _x(e,n,l){Ao[zo++]=da,Ao[zo++]=pa,Ao[zo++]=Hl,Hl=e;var p=da;e=pa;var y=32-cs(p)-1;p&=~(1<<y),l+=1;var b=32-cs(n)+y;if(30<b){var k=y-y%5;b=(p&(1<<k)-1).toString(32),p>>=k,y-=k,da=1<<32-cs(n)+y|l<<y|p,pa=b+e}else da=1<<b|l<<y|p,pa=e}function $m(e){e.return!==null&&(Nl(e,1),_x(e,1,0))}function Wm(e){for(;e===zd;)zd=zu[--Mu],zu[Mu]=null,Md=zu[--Mu],zu[Mu]=null;for(;e===Hl;)Hl=Ao[--zo],Ao[zo]=null,pa=Ao[--zo],Ao[zo]=null,da=Ao[--zo],Ao[zo]=null}var so=null,oo=null,Fi=!1,us=null;function gx(e,n){var l=Mo(5,null,null,0);l.elementType="DELETED",l.stateNode=n,l.return=e,n=e.deletions,n===null?(e.deletions=[l],e.flags|=16):n.push(l)}function zy(e,n){switch(e.tag){case 5:var l=e.type;return n=n.nodeType!==1||l.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,so=e,oo=nl(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,so=e,oo=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(l=Hl!==null?{id:da,overflow:pa}:null,e.memoizedState={dehydrated:n,treeContext:l,retryLane:1073741824},l=Mo(18,null,null,0),l.stateNode=n,l.return=e,e.child=l,so=e,oo=null,!0):!1;default:return!1}}function im(e){return(e.mode&1)!==0&&(e.flags&128)===0}function nm(e){if(Fi){var n=oo;if(n){var l=n;if(!zy(e,n)){if(im(e))throw Error(qe(418));n=nl(l.nextSibling);var p=so;n&&zy(e,n)?gx(p,l):(e.flags=e.flags&-4097|2,Fi=!1,so=e)}}else{if(im(e))throw Error(qe(418));e.flags=e.flags&-4097|2,Fi=!1,so=e}}}function My(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;so=e}function td(e){if(e!==so)return!1;if(!Fi)return My(e),Fi=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!Yf(e.type,e.memoizedProps)),n&&(n=oo)){if(im(e))throw yx(),Error(qe(418));for(;n;)gx(e,n),n=nl(n.nextSibling)}if(My(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qe(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var l=e.data;if(l==="/$"){if(n===0){oo=nl(e.nextSibling);break e}n--}else l!=="$"&&l!=="$!"&&l!=="$?"||n++}e=e.nextSibling}oo=null}}else oo=so?nl(e.stateNode.nextSibling):null;return!0}function yx(){for(var e=oo;e;)e=nl(e.nextSibling)}function ju(){oo=so=null,Fi=!1}function Hm(e){us===null?us=[e]:us.push(e)}var w2=xa.ReactCurrentBatchConfig;function as(e,n){if(e&&e.defaultProps){n=qi({},n),e=e.defaultProps;for(var l in e)n[l]===void 0&&(n[l]=e[l]);return n}return n}var Ld=dl(null),Dd=null,Lu=null,Xm=null;function Km(){Xm=Lu=Dd=null}function Jm(e){var n=Ld.current;Li(Ld),e._currentValue=n}function rm(e,n,l){for(;e!==null;){var p=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,p!==null&&(p.childLanes|=n)):p!==null&&(p.childLanes&n)!==n&&(p.childLanes|=n),e===l)break;e=e.return}}function Uu(e,n){Dd=e,Xm=Lu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(Or=!0),e.firstContext=null)}function Do(e){var n=e._currentValue;if(Xm!==e)if(e={context:e,memoizedValue:n,next:null},Lu===null){if(Dd===null)throw Error(qe(308));Lu=e,Dd.dependencies={lanes:0,firstContext:e}}else Lu=Lu.next=e;return n}var Zl=null;function Ym(e){Zl===null?Zl=[e]:Zl.push(e)}function vx(e,n,l,p){var y=n.interleaved;return y===null?(l.next=l,Ym(n)):(l.next=y.next,y.next=l),n.interleaved=l,ya(e,p)}function ya(e,n){e.lanes|=n;var l=e.alternate;for(l!==null&&(l.lanes|=n),l=e,e=e.return;e!==null;)e.childLanes|=n,l=e.alternate,l!==null&&(l.childLanes|=n),l=e,e=e.return;return l.tag===3?l.stateNode:null}var Ha=!1;function Qm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xx(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fa(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function rl(e,n,l){var p=e.updateQueue;if(p===null)return null;if(p=p.shared,ui&2){var y=p.pending;return y===null?n.next=n:(n.next=y.next,y.next=n),p.pending=n,ya(e,l)}return y=p.interleaved,y===null?(n.next=n,Ym(p)):(n.next=y.next,y.next=n),p.interleaved=n,ya(e,l)}function pd(e,n,l){if(n=n.updateQueue,n!==null&&(n=n.shared,(l&4194240)!==0)){var p=n.lanes;p&=e.pendingLanes,l|=p,n.lanes=l,Fm(e,l)}}function Ly(e,n){var l=e.updateQueue,p=e.alternate;if(p!==null&&(p=p.updateQueue,l===p)){var y=null,b=null;if(l=l.firstBaseUpdate,l!==null){do{var k={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};b===null?y=b=k:b=b.next=k,l=l.next}while(l!==null);b===null?y=b=n:b=b.next=n}else y=b=n;l={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:p.shared,effects:p.effects},e.updateQueue=l;return}e=l.lastBaseUpdate,e===null?l.firstBaseUpdate=n:e.next=n,l.lastBaseUpdate=n}function Rd(e,n,l,p){var y=e.updateQueue;Ha=!1;var b=y.firstBaseUpdate,k=y.lastBaseUpdate,c=y.shared.pending;if(c!==null){y.shared.pending=null;var q=c,le=q.next;q.next=null,k===null?b=le:k.next=le,k=q;var Ie=e.alternate;Ie!==null&&(Ie=Ie.updateQueue,c=Ie.lastBaseUpdate,c!==k&&(c===null?Ie.firstBaseUpdate=le:c.next=le,Ie.lastBaseUpdate=q))}if(b!==null){var ge=y.baseState;k=0,Ie=le=q=null,c=b;do{var K=c.lane,Ze=c.eventTime;if((p&K)===K){Ie!==null&&(Ie=Ie.next={eventTime:Ze,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var Ve=e,De=c;switch(K=n,Ze=l,De.tag){case 1:if(Ve=De.payload,typeof Ve=="function"){ge=Ve.call(Ze,ge,K);break e}ge=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=De.payload,K=typeof Ve=="function"?Ve.call(Ze,ge,K):Ve,K==null)break e;ge=qi({},ge,K);break e;case 2:Ha=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,K=y.effects,K===null?y.effects=[c]:K.push(c))}else Ze={eventTime:Ze,lane:K,tag:c.tag,payload:c.payload,callback:c.callback,next:null},Ie===null?(le=Ie=Ze,q=ge):Ie=Ie.next=Ze,k|=K;if(c=c.next,c===null){if(c=y.shared.pending,c===null)break;K=c,c=K.next,K.next=null,y.lastBaseUpdate=K,y.shared.pending=null}}while(1);if(Ie===null&&(q=ge),y.baseState=q,y.firstBaseUpdate=le,y.lastBaseUpdate=Ie,n=y.shared.interleaved,n!==null){y=n;do k|=y.lane,y=y.next;while(y!==n)}else b===null&&(y.shared.lanes=0);Kl|=k,e.lanes=k,e.memoizedState=ge}}function Dy(e,n,l){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var p=e[n],y=p.callback;if(y!==null){if(p.callback=null,p=l,typeof y!="function")throw Error(qe(191,y));y.call(p)}}}var wx=new vv.Component().refs;function om(e,n,l,p){n=e.memoizedState,l=l(p,n),l=l==null?n:qi({},n,l),e.memoizedState=l,e.lanes===0&&(e.updateQueue.baseState=l)}var ep={isMounted:function(e){return(e=e._reactInternals)?Ql(e)===e:!1},enqueueSetState:function(e,n,l){e=e._reactInternals;var p=gr(),y=sl(e),b=fa(p,y);b.payload=n,l!=null&&(b.callback=l),n=rl(e,b,y),n!==null&&(hs(n,e,y,p),pd(n,e,y))},enqueueReplaceState:function(e,n,l){e=e._reactInternals;var p=gr(),y=sl(e),b=fa(p,y);b.tag=1,b.payload=n,l!=null&&(b.callback=l),n=rl(e,b,y),n!==null&&(hs(n,e,y,p),pd(n,e,y))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var l=gr(),p=sl(e),y=fa(l,p);y.tag=2,n!=null&&(y.callback=n),n=rl(e,y,p),n!==null&&(hs(n,e,p,l),pd(n,e,p))}};function Ry(e,n,l,p,y,b,k){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(p,b,k):n.prototype&&n.prototype.isPureReactComponent?!ih(l,p)||!ih(y,b):!0}function bx(e,n,l){var p=!1,y=ul,b=n.contextType;return typeof b=="object"&&b!==null?b=Do(b):(y=Nr(n)?Wl:rr.current,p=n.contextTypes,b=(p=p!=null)?Gu(e,y):ul),n=new n(l,b),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=ep,e.stateNode=n,n._reactInternals=e,p&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=y,e.__reactInternalMemoizedMaskedChildContext=b),n}function By(e,n,l,p){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(l,p),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(l,p),n.state!==e&&ep.enqueueReplaceState(n,n.state,null)}function sm(e,n,l,p){var y=e.stateNode;y.props=l,y.state=e.memoizedState,y.refs=wx,Qm(e);var b=n.contextType;typeof b=="object"&&b!==null?y.context=Do(b):(b=Nr(n)?Wl:rr.current,y.context=Gu(e,b)),y.state=e.memoizedState,b=n.getDerivedStateFromProps,typeof b=="function"&&(om(e,n,b,l),y.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(n=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),n!==y.state&&ep.enqueueReplaceState(y,y.state,null),Rd(e,l,y,p),y.state=e.memoizedState),typeof y.componentDidMount=="function"&&(e.flags|=4194308)}function zc(e,n,l){if(e=l.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(qe(309));var p=l.stateNode}if(!p)throw Error(qe(147,e));var y=p,b=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===b?n.ref:(n=function(k){var c=y.refs;c===wx&&(c=y.refs={}),k===null?delete c[b]:c[b]=k},n._stringRef=b,n)}if(typeof e!="string")throw Error(qe(284));if(!l._owner)throw Error(qe(290,e))}return e}function id(e,n){throw e=Object.prototype.toString.call(n),Error(qe(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Oy(e){var n=e._init;return n(e._payload)}function Tx(e){function n(ye,ue){if(e){var me=ye.deletions;me===null?(ye.deletions=[ue],ye.flags|=16):me.push(ue)}}function l(ye,ue){if(!e)return null;for(;ue!==null;)n(ye,ue),ue=ue.sibling;return null}function p(ye,ue){for(ye=new Map;ue!==null;)ue.key!==null?ye.set(ue.key,ue):ye.set(ue.index,ue),ue=ue.sibling;return ye}function y(ye,ue){return ye=al(ye,ue),ye.index=0,ye.sibling=null,ye}function b(ye,ue,me){return ye.index=me,e?(me=ye.alternate,me!==null?(me=me.index,me<ue?(ye.flags|=2,ue):me):(ye.flags|=2,ue)):(ye.flags|=1048576,ue)}function k(ye){return e&&ye.alternate===null&&(ye.flags|=2),ye}function c(ye,ue,me,Ue){return ue===null||ue.tag!==6?(ue=bf(me,ye.mode,Ue),ue.return=ye,ue):(ue=y(ue,me),ue.return=ye,ue)}function q(ye,ue,me,Ue){var $e=me.type;return $e===Eu?Ie(ye,ue,me.props.children,Ue,me.key):ue!==null&&(ue.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Wa&&Oy($e)===ue.type)?(Ue=y(ue,me.props),Ue.ref=zc(ye,ue,me),Ue.return=ye,Ue):(Ue=vd(me.type,me.key,me.props,null,ye.mode,Ue),Ue.ref=zc(ye,ue,me),Ue.return=ye,Ue)}function le(ye,ue,me,Ue){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==me.containerInfo||ue.stateNode.implementation!==me.implementation?(ue=Tf(me,ye.mode,Ue),ue.return=ye,ue):(ue=y(ue,me.children||[]),ue.return=ye,ue)}function Ie(ye,ue,me,Ue,$e){return ue===null||ue.tag!==7?(ue=ql(me,ye.mode,Ue,$e),ue.return=ye,ue):(ue=y(ue,me),ue.return=ye,ue)}function ge(ye,ue,me){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=bf(""+ue,ye.mode,me),ue.return=ye,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case qh:return me=vd(ue.type,ue.key,ue.props,null,ye.mode,me),me.ref=zc(ye,null,ue),me.return=ye,me;case Su:return ue=Tf(ue,ye.mode,me),ue.return=ye,ue;case Wa:var Ue=ue._init;return ge(ye,Ue(ue._payload),me)}if(Rc(ue)||Pc(ue))return ue=ql(ue,ye.mode,me,null),ue.return=ye,ue;id(ye,ue)}return null}function K(ye,ue,me,Ue){var $e=ue!==null?ue.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return $e!==null?null:c(ye,ue,""+me,Ue);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case qh:return me.key===$e?q(ye,ue,me,Ue):null;case Su:return me.key===$e?le(ye,ue,me,Ue):null;case Wa:return $e=me._init,K(ye,ue,$e(me._payload),Ue)}if(Rc(me)||Pc(me))return $e!==null?null:Ie(ye,ue,me,Ue,null);id(ye,me)}return null}function Ze(ye,ue,me,Ue,$e){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return ye=ye.get(me)||null,c(ue,ye,""+Ue,$e);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case qh:return ye=ye.get(Ue.key===null?me:Ue.key)||null,q(ue,ye,Ue,$e);case Su:return ye=ye.get(Ue.key===null?me:Ue.key)||null,le(ue,ye,Ue,$e);case Wa:var lt=Ue._init;return Ze(ye,ue,me,lt(Ue._payload),$e)}if(Rc(Ue)||Pc(Ue))return ye=ye.get(me)||null,Ie(ue,ye,Ue,$e,null);id(ue,Ue)}return null}function Ve(ye,ue,me,Ue){for(var $e=null,lt=null,dt=ue,pt=ue=0,ci=null;dt!==null&&pt<me.length;pt++){dt.index>pt?(ci=dt,dt=null):ci=dt.sibling;var Ct=K(ye,dt,me[pt],Ue);if(Ct===null){dt===null&&(dt=ci);break}e&&dt&&Ct.alternate===null&&n(ye,dt),ue=b(Ct,ue,pt),lt===null?$e=Ct:lt.sibling=Ct,lt=Ct,dt=ci}if(pt===me.length)return l(ye,dt),Fi&&Nl(ye,pt),$e;if(dt===null){for(;pt<me.length;pt++)dt=ge(ye,me[pt],Ue),dt!==null&&(ue=b(dt,ue,pt),lt===null?$e=dt:lt.sibling=dt,lt=dt);return Fi&&Nl(ye,pt),$e}for(dt=p(ye,dt);pt<me.length;pt++)ci=Ze(dt,ye,pt,me[pt],Ue),ci!==null&&(e&&ci.alternate!==null&&dt.delete(ci.key===null?pt:ci.key),ue=b(ci,ue,pt),lt===null?$e=ci:lt.sibling=ci,lt=ci);return e&&dt.forEach(function(ei){return n(ye,ei)}),Fi&&Nl(ye,pt),$e}function De(ye,ue,me,Ue){var $e=Pc(me);if(typeof $e!="function")throw Error(qe(150));if(me=$e.call(me),me==null)throw Error(qe(151));for(var lt=$e=null,dt=ue,pt=ue=0,ci=null,Ct=me.next();dt!==null&&!Ct.done;pt++,Ct=me.next()){dt.index>pt?(ci=dt,dt=null):ci=dt.sibling;var ei=K(ye,dt,Ct.value,Ue);if(ei===null){dt===null&&(dt=ci);break}e&&dt&&ei.alternate===null&&n(ye,dt),ue=b(ei,ue,pt),lt===null?$e=ei:lt.sibling=ei,lt=ei,dt=ci}if(Ct.done)return l(ye,dt),Fi&&Nl(ye,pt),$e;if(dt===null){for(;!Ct.done;pt++,Ct=me.next())Ct=ge(ye,Ct.value,Ue),Ct!==null&&(ue=b(Ct,ue,pt),lt===null?$e=Ct:lt.sibling=Ct,lt=Ct);return Fi&&Nl(ye,pt),$e}for(dt=p(ye,dt);!Ct.done;pt++,Ct=me.next())Ct=Ze(dt,ye,pt,Ct.value,Ue),Ct!==null&&(e&&Ct.alternate!==null&&dt.delete(Ct.key===null?pt:Ct.key),ue=b(Ct,ue,pt),lt===null?$e=Ct:lt.sibling=Ct,lt=Ct);return e&&dt.forEach(function(_i){return n(ye,_i)}),Fi&&Nl(ye,pt),$e}function Qt(ye,ue,me,Ue){if(typeof me=="object"&&me!==null&&me.type===Eu&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case qh:e:{for(var $e=me.key,lt=ue;lt!==null;){if(lt.key===$e){if($e=me.type,$e===Eu){if(lt.tag===7){l(ye,lt.sibling),ue=y(lt,me.props.children),ue.return=ye,ye=ue;break e}}else if(lt.elementType===$e||typeof $e=="object"&&$e!==null&&$e.$$typeof===Wa&&Oy($e)===lt.type){l(ye,lt.sibling),ue=y(lt,me.props),ue.ref=zc(ye,lt,me),ue.return=ye,ye=ue;break e}l(ye,lt);break}else n(ye,lt);lt=lt.sibling}me.type===Eu?(ue=ql(me.props.children,ye.mode,Ue,me.key),ue.return=ye,ye=ue):(Ue=vd(me.type,me.key,me.props,null,ye.mode,Ue),Ue.ref=zc(ye,ue,me),Ue.return=ye,ye=Ue)}return k(ye);case Su:e:{for(lt=me.key;ue!==null;){if(ue.key===lt)if(ue.tag===4&&ue.stateNode.containerInfo===me.containerInfo&&ue.stateNode.implementation===me.implementation){l(ye,ue.sibling),ue=y(ue,me.children||[]),ue.return=ye,ye=ue;break e}else{l(ye,ue);break}else n(ye,ue);ue=ue.sibling}ue=Tf(me,ye.mode,Ue),ue.return=ye,ye=ue}return k(ye);case Wa:return lt=me._init,Qt(ye,ue,lt(me._payload),Ue)}if(Rc(me))return Ve(ye,ue,me,Ue);if(Pc(me))return De(ye,ue,me,Ue);id(ye,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,ue!==null&&ue.tag===6?(l(ye,ue.sibling),ue=y(ue,me),ue.return=ye,ye=ue):(l(ye,ue),ue=bf(me,ye.mode,Ue),ue.return=ye,ye=ue),k(ye)):l(ye,ue)}return Qt}var qu=Tx(!0),Sx=Tx(!1),gh={},zs=dl(gh),sh=dl(gh),ah=dl(gh);function Gl(e){if(e===gh)throw Error(qe(174));return e}function e_(e,n){switch(ki(ah,n),ki(sh,e),ki(zs,gh),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Ff(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Ff(n,e)}Li(zs),ki(zs,n)}function $u(){Li(zs),Li(sh),Li(ah)}function Ex(e){Gl(ah.current);var n=Gl(zs.current),l=Ff(n,e.type);n!==l&&(ki(sh,e),ki(zs,l))}function t_(e){sh.current===e&&(Li(zs),Li(sh))}var Gi=dl(0);function Bd(e){for(var n=e;n!==null;){if(n.tag===13){var l=n.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var _f=[];function i_(){for(var e=0;e<_f.length;e++)_f[e]._workInProgressVersionPrimary=null;_f.length=0}var fd=xa.ReactCurrentDispatcher,gf=xa.ReactCurrentBatchConfig,Xl=0,ji=null,xn=null,Mn=null,Od=!1,jc=!1,lh=0,b2=0;function tr(){throw Error(qe(321))}function n_(e,n){if(n===null)return!1;for(var l=0;l<n.length&&l<e.length;l++)if(!ds(e[l],n[l]))return!1;return!0}function r_(e,n,l,p,y,b){if(Xl=b,ji=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,fd.current=e===null||e.memoizedState===null?P2:C2,e=l(p,y),jc){b=0;do{if(jc=!1,lh=0,25<=b)throw Error(qe(301));b+=1,Mn=xn=null,n.updateQueue=null,fd.current=I2,e=l(p,y)}while(jc)}if(fd.current=Fd,n=xn!==null&&xn.next!==null,Xl=0,Mn=xn=ji=null,Od=!1,n)throw Error(qe(300));return e}function o_(){var e=lh!==0;return lh=0,e}function Is(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mn===null?ji.memoizedState=Mn=e:Mn=Mn.next=e,Mn}function Ro(){if(xn===null){var e=ji.alternate;e=e!==null?e.memoizedState:null}else e=xn.next;var n=Mn===null?ji.memoizedState:Mn.next;if(n!==null)Mn=n,xn=e;else{if(e===null)throw Error(qe(310));xn=e,e={memoizedState:xn.memoizedState,baseState:xn.baseState,baseQueue:xn.baseQueue,queue:xn.queue,next:null},Mn===null?ji.memoizedState=Mn=e:Mn=Mn.next=e}return Mn}function uh(e,n){return typeof n=="function"?n(e):n}function yf(e){var n=Ro(),l=n.queue;if(l===null)throw Error(qe(311));l.lastRenderedReducer=e;var p=xn,y=p.baseQueue,b=l.pending;if(b!==null){if(y!==null){var k=y.next;y.next=b.next,b.next=k}p.baseQueue=y=b,l.pending=null}if(y!==null){b=y.next,p=p.baseState;var c=k=null,q=null,le=b;do{var Ie=le.lane;if((Xl&Ie)===Ie)q!==null&&(q=q.next={lane:0,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null}),p=le.hasEagerState?le.eagerState:e(p,le.action);else{var ge={lane:Ie,action:le.action,hasEagerState:le.hasEagerState,eagerState:le.eagerState,next:null};q===null?(c=q=ge,k=p):q=q.next=ge,ji.lanes|=Ie,Kl|=Ie}le=le.next}while(le!==null&&le!==b);q===null?k=p:q.next=c,ds(p,n.memoizedState)||(Or=!0),n.memoizedState=p,n.baseState=k,n.baseQueue=q,l.lastRenderedState=p}if(e=l.interleaved,e!==null){y=e;do b=y.lane,ji.lanes|=b,Kl|=b,y=y.next;while(y!==e)}else y===null&&(l.lanes=0);return[n.memoizedState,l.dispatch]}function vf(e){var n=Ro(),l=n.queue;if(l===null)throw Error(qe(311));l.lastRenderedReducer=e;var p=l.dispatch,y=l.pending,b=n.memoizedState;if(y!==null){l.pending=null;var k=y=y.next;do b=e(b,k.action),k=k.next;while(k!==y);ds(b,n.memoizedState)||(Or=!0),n.memoizedState=b,n.baseQueue===null&&(n.baseState=b),l.lastRenderedState=b}return[b,p]}function Px(){}function Cx(e,n){var l=ji,p=Ro(),y=n(),b=!ds(p.memoizedState,y);if(b&&(p.memoizedState=y,Or=!0),p=p.queue,s_(Ax.bind(null,l,p,e),[e]),p.getSnapshot!==n||b||Mn!==null&&Mn.memoizedState.tag&1){if(l.flags|=2048,ch(9,kx.bind(null,l,p,y,n),void 0,null),Ln===null)throw Error(qe(349));Xl&30||Ix(l,n,y)}return y}function Ix(e,n,l){e.flags|=16384,e={getSnapshot:n,value:l},n=ji.updateQueue,n===null?(n={lastEffect:null,stores:null},ji.updateQueue=n,n.stores=[e]):(l=n.stores,l===null?n.stores=[e]:l.push(e))}function kx(e,n,l,p){n.value=l,n.getSnapshot=p,zx(n)&&Mx(e)}function Ax(e,n,l){return l(function(){zx(n)&&Mx(e)})}function zx(e){var n=e.getSnapshot;e=e.value;try{var l=n();return!ds(e,l)}catch{return!0}}function Mx(e){var n=ya(e,1);n!==null&&hs(n,e,1,-1)}function Fy(e){var n=Is();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uh,lastRenderedState:e},n.queue=e,e=e.dispatch=E2.bind(null,ji,e),[n.memoizedState,e]}function ch(e,n,l,p){return e={tag:e,create:n,destroy:l,deps:p,next:null},n=ji.updateQueue,n===null?(n={lastEffect:null,stores:null},ji.updateQueue=n,n.lastEffect=e.next=e):(l=n.lastEffect,l===null?n.lastEffect=e.next=e:(p=l.next,l.next=e,e.next=p,n.lastEffect=e)),e}function Lx(){return Ro().memoizedState}function md(e,n,l,p){var y=Is();ji.flags|=e,y.memoizedState=ch(1|n,l,void 0,p===void 0?null:p)}function tp(e,n,l,p){var y=Ro();p=p===void 0?null:p;var b=void 0;if(xn!==null){var k=xn.memoizedState;if(b=k.destroy,p!==null&&n_(p,k.deps)){y.memoizedState=ch(n,l,b,p);return}}ji.flags|=e,y.memoizedState=ch(1|n,l,b,p)}function Ny(e,n){return md(8390656,8,e,n)}function s_(e,n){return tp(2048,8,e,n)}function Dx(e,n){return tp(4,2,e,n)}function Rx(e,n){return tp(4,4,e,n)}function Bx(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function Ox(e,n,l){return l=l!=null?l.concat([e]):null,tp(4,4,Bx.bind(null,n,e),l)}function a_(){}function Fx(e,n){var l=Ro();n=n===void 0?null:n;var p=l.memoizedState;return p!==null&&n!==null&&n_(n,p[1])?p[0]:(l.memoizedState=[e,n],e)}function Nx(e,n){var l=Ro();n=n===void 0?null:n;var p=l.memoizedState;return p!==null&&n!==null&&n_(n,p[1])?p[0]:(e=e(),l.memoizedState=[e,n],e)}function Ux(e,n,l){return Xl&21?(ds(l,n)||(l=Gv(),ji.lanes|=l,Kl|=l,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,Or=!0),e.memoizedState=l)}function T2(e,n){var l=wi;wi=l!==0&&4>l?l:4,e(!0);var p=gf.transition;gf.transition={};try{e(!1),n()}finally{wi=l,gf.transition=p}}function Vx(){return Ro().memoizedState}function S2(e,n,l){var p=sl(e);if(l={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null},Zx(e))Gx(n,l);else if(l=vx(e,n,l,p),l!==null){var y=gr();hs(l,e,p,y),jx(l,n,p)}}function E2(e,n,l){var p=sl(e),y={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null};if(Zx(e))Gx(n,y);else{var b=e.alternate;if(e.lanes===0&&(b===null||b.lanes===0)&&(b=n.lastRenderedReducer,b!==null))try{var k=n.lastRenderedState,c=b(k,l);if(y.hasEagerState=!0,y.eagerState=c,ds(c,k)){var q=n.interleaved;q===null?(y.next=y,Ym(n)):(y.next=q.next,q.next=y),n.interleaved=y;return}}catch{}finally{}l=vx(e,n,y,p),l!==null&&(y=gr(),hs(l,e,p,y),jx(l,n,p))}}function Zx(e){var n=e.alternate;return e===ji||n!==null&&n===ji}function Gx(e,n){jc=Od=!0;var l=e.pending;l===null?n.next=n:(n.next=l.next,l.next=n),e.pending=n}function jx(e,n,l){if(l&4194240){var p=n.lanes;p&=e.pendingLanes,l|=p,n.lanes=l,Fm(e,l)}}var Fd={readContext:Do,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},P2={readContext:Do,useCallback:function(e,n){return Is().memoizedState=[e,n===void 0?null:n],e},useContext:Do,useEffect:Ny,useImperativeHandle:function(e,n,l){return l=l!=null?l.concat([e]):null,md(4194308,4,Bx.bind(null,n,e),l)},useLayoutEffect:function(e,n){return md(4194308,4,e,n)},useInsertionEffect:function(e,n){return md(4,2,e,n)},useMemo:function(e,n){var l=Is();return n=n===void 0?null:n,e=e(),l.memoizedState=[e,n],e},useReducer:function(e,n,l){var p=Is();return n=l!==void 0?l(n):n,p.memoizedState=p.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},p.queue=e,e=e.dispatch=S2.bind(null,ji,e),[p.memoizedState,e]},useRef:function(e){var n=Is();return e={current:e},n.memoizedState=e},useState:Fy,useDebugValue:a_,useDeferredValue:function(e){return Is().memoizedState=e},useTransition:function(){var e=Fy(!1),n=e[0];return e=T2.bind(null,e[1]),Is().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,l){var p=ji,y=Is();if(Fi){if(l===void 0)throw Error(qe(407));l=l()}else{if(l=n(),Ln===null)throw Error(qe(349));Xl&30||Ix(p,n,l)}y.memoizedState=l;var b={value:l,getSnapshot:n};return y.queue=b,Ny(Ax.bind(null,p,b,e),[e]),p.flags|=2048,ch(9,kx.bind(null,p,b,l,n),void 0,null),l},useId:function(){var e=Is(),n=Ln.identifierPrefix;if(Fi){var l=pa,p=da;l=(p&~(1<<32-cs(p)-1)).toString(32)+l,n=":"+n+"R"+l,l=lh++,0<l&&(n+="H"+l.toString(32)),n+=":"}else l=b2++,n=":"+n+"r"+l.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},C2={readContext:Do,useCallback:Fx,useContext:Do,useEffect:s_,useImperativeHandle:Ox,useInsertionEffect:Dx,useLayoutEffect:Rx,useMemo:Nx,useReducer:yf,useRef:Lx,useState:function(){return yf(uh)},useDebugValue:a_,useDeferredValue:function(e){var n=Ro();return Ux(n,xn.memoizedState,e)},useTransition:function(){var e=yf(uh)[0],n=Ro().memoizedState;return[e,n]},useMutableSource:Px,useSyncExternalStore:Cx,useId:Vx,unstable_isNewReconciler:!1},I2={readContext:Do,useCallback:Fx,useContext:Do,useEffect:s_,useImperativeHandle:Ox,useInsertionEffect:Dx,useLayoutEffect:Rx,useMemo:Nx,useReducer:vf,useRef:Lx,useState:function(){return vf(uh)},useDebugValue:a_,useDeferredValue:function(e){var n=Ro();return xn===null?n.memoizedState=e:Ux(n,xn.memoizedState,e)},useTransition:function(){var e=vf(uh)[0],n=Ro().memoizedState;return[e,n]},useMutableSource:Px,useSyncExternalStore:Cx,useId:Vx,unstable_isNewReconciler:!1};function Wu(e,n){try{var l="",p=n;do l+=ib(p),p=p.return;while(p);var y=l}catch(b){y=`
Error generating stack: `+b.message+`
`+b.stack}return{value:e,source:n,stack:y,digest:null}}function xf(e,n,l){return{value:e,source:null,stack:l??null,digest:n??null}}function am(e,n){try{console.error(n.value)}catch(l){setTimeout(function(){throw l})}}var k2=typeof WeakMap=="function"?WeakMap:Map;function qx(e,n,l){l=fa(-1,l),l.tag=3,l.payload={element:null};var p=n.value;return l.callback=function(){Ud||(Ud=!0,gm=p),am(e,n)},l}function $x(e,n,l){l=fa(-1,l),l.tag=3;var p=e.type.getDerivedStateFromError;if(typeof p=="function"){var y=n.value;l.payload=function(){return p(y)},l.callback=function(){am(e,n)}}var b=e.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(l.callback=function(){am(e,n),typeof p!="function"&&(ol===null?ol=new Set([this]):ol.add(this));var k=n.stack;this.componentDidCatch(n.value,{componentStack:k!==null?k:""})}),l}function Uy(e,n,l){var p=e.pingCache;if(p===null){p=e.pingCache=new k2;var y=new Set;p.set(n,y)}else y=p.get(n),y===void 0&&(y=new Set,p.set(n,y));y.has(l)||(y.add(l),e=G2.bind(null,e,n,l),n.then(e,e))}function Vy(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function Zy(e,n,l,p,y){return e.mode&1?(e.flags|=65536,e.lanes=y,e):(e===n?e.flags|=65536:(e.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(n=fa(-1,1),n.tag=2,rl(l,n,1))),l.lanes|=1),e)}var A2=xa.ReactCurrentOwner,Or=!1;function _r(e,n,l,p){n.child=e===null?Sx(n,null,l,p):qu(n,e.child,l,p)}function Gy(e,n,l,p,y){l=l.render;var b=n.ref;return Uu(n,y),p=r_(e,n,l,p,b,y),l=o_(),e!==null&&!Or?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~y,va(e,n,y)):(Fi&&l&&$m(n),n.flags|=1,_r(e,n,p,y),n.child)}function jy(e,n,l,p,y){if(e===null){var b=l.type;return typeof b=="function"&&!m_(b)&&b.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(n.tag=15,n.type=b,Wx(e,n,b,p,y)):(e=vd(l.type,null,p,n,n.mode,y),e.ref=n.ref,e.return=n,n.child=e)}if(b=e.child,!(e.lanes&y)){var k=b.memoizedProps;if(l=l.compare,l=l!==null?l:ih,l(k,p)&&e.ref===n.ref)return va(e,n,y)}return n.flags|=1,e=al(b,p),e.ref=n.ref,e.return=n,n.child=e}function Wx(e,n,l,p,y){if(e!==null){var b=e.memoizedProps;if(ih(b,p)&&e.ref===n.ref)if(Or=!1,n.pendingProps=p=b,(e.lanes&y)!==0)e.flags&131072&&(Or=!0);else return n.lanes=e.lanes,va(e,n,y)}return lm(e,n,l,p,y)}function Hx(e,n,l){var p=n.pendingProps,y=p.children,b=e!==null?e.memoizedState:null;if(p.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},ki(Ru,ro),ro|=l;else{if(!(l&1073741824))return e=b!==null?b.baseLanes|l:l,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,ki(Ru,ro),ro|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=b!==null?b.baseLanes:l,ki(Ru,ro),ro|=p}else b!==null?(p=b.baseLanes|l,n.memoizedState=null):p=l,ki(Ru,ro),ro|=p;return _r(e,n,y,l),n.child}function Xx(e,n){var l=n.ref;(e===null&&l!==null||e!==null&&e.ref!==l)&&(n.flags|=512,n.flags|=2097152)}function lm(e,n,l,p,y){var b=Nr(l)?Wl:rr.current;return b=Gu(n,b),Uu(n,y),l=r_(e,n,l,p,b,y),p=o_(),e!==null&&!Or?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~y,va(e,n,y)):(Fi&&p&&$m(n),n.flags|=1,_r(e,n,l,y),n.child)}function qy(e,n,l,p,y){if(Nr(l)){var b=!0;Ad(n)}else b=!1;if(Uu(n,y),n.stateNode===null)_d(e,n),bx(n,l,p),sm(n,l,p,y),p=!0;else if(e===null){var k=n.stateNode,c=n.memoizedProps;k.props=c;var q=k.context,le=l.contextType;typeof le=="object"&&le!==null?le=Do(le):(le=Nr(l)?Wl:rr.current,le=Gu(n,le));var Ie=l.getDerivedStateFromProps,ge=typeof Ie=="function"||typeof k.getSnapshotBeforeUpdate=="function";ge||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(c!==p||q!==le)&&By(n,k,p,le),Ha=!1;var K=n.memoizedState;k.state=K,Rd(n,p,k,y),q=n.memoizedState,c!==p||K!==q||Fr.current||Ha?(typeof Ie=="function"&&(om(n,l,Ie,p),q=n.memoizedState),(c=Ha||Ry(n,l,c,p,K,q,le))?(ge||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(n.flags|=4194308)):(typeof k.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=p,n.memoizedState=q),k.props=p,k.state=q,k.context=le,p=c):(typeof k.componentDidMount=="function"&&(n.flags|=4194308),p=!1)}else{k=n.stateNode,xx(e,n),c=n.memoizedProps,le=n.type===n.elementType?c:as(n.type,c),k.props=le,ge=n.pendingProps,K=k.context,q=l.contextType,typeof q=="object"&&q!==null?q=Do(q):(q=Nr(l)?Wl:rr.current,q=Gu(n,q));var Ze=l.getDerivedStateFromProps;(Ie=typeof Ze=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(c!==ge||K!==q)&&By(n,k,p,q),Ha=!1,K=n.memoizedState,k.state=K,Rd(n,p,k,y);var Ve=n.memoizedState;c!==ge||K!==Ve||Fr.current||Ha?(typeof Ze=="function"&&(om(n,l,Ze,p),Ve=n.memoizedState),(le=Ha||Ry(n,l,le,p,K,Ve,q)||!1)?(Ie||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(p,Ve,q),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(p,Ve,q)),typeof k.componentDidUpdate=="function"&&(n.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof k.componentDidUpdate!="function"||c===e.memoizedProps&&K===e.memoizedState||(n.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&K===e.memoizedState||(n.flags|=1024),n.memoizedProps=p,n.memoizedState=Ve),k.props=p,k.state=Ve,k.context=q,p=le):(typeof k.componentDidUpdate!="function"||c===e.memoizedProps&&K===e.memoizedState||(n.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&K===e.memoizedState||(n.flags|=1024),p=!1)}return um(e,n,l,p,b,y)}function um(e,n,l,p,y,b){Xx(e,n);var k=(n.flags&128)!==0;if(!p&&!k)return y&&Ay(n,l,!1),va(e,n,b);p=n.stateNode,A2.current=n;var c=k&&typeof l.getDerivedStateFromError!="function"?null:p.render();return n.flags|=1,e!==null&&k?(n.child=qu(n,e.child,null,b),n.child=qu(n,null,c,b)):_r(e,n,c,b),n.memoizedState=p.state,y&&Ay(n,l,!0),n.child}function Kx(e){var n=e.stateNode;n.pendingContext?ky(e,n.pendingContext,n.pendingContext!==n.context):n.context&&ky(e,n.context,!1),e_(e,n.containerInfo)}function $y(e,n,l,p,y){return ju(),Hm(y),n.flags|=256,_r(e,n,l,p),n.child}var cm={dehydrated:null,treeContext:null,retryLane:0};function hm(e){return{baseLanes:e,cachePool:null,transitions:null}}function Jx(e,n,l){var p=n.pendingProps,y=Gi.current,b=!1,k=(n.flags&128)!==0,c;if((c=k)||(c=e!==null&&e.memoizedState===null?!1:(y&2)!==0),c?(b=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(y|=1),ki(Gi,y&1),e===null)return nm(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(k=p.children,e=p.fallback,b?(p=n.mode,b=n.child,k={mode:"hidden",children:k},!(p&1)&&b!==null?(b.childLanes=0,b.pendingProps=k):b=rp(k,p,0,null),e=ql(e,p,l,null),b.return=n,e.return=n,b.sibling=e,n.child=b,n.child.memoizedState=hm(l),n.memoizedState=cm,e):l_(n,k));if(y=e.memoizedState,y!==null&&(c=y.dehydrated,c!==null))return z2(e,n,k,p,c,y,l);if(b){b=p.fallback,k=n.mode,y=e.child,c=y.sibling;var q={mode:"hidden",children:p.children};return!(k&1)&&n.child!==y?(p=n.child,p.childLanes=0,p.pendingProps=q,n.deletions=null):(p=al(y,q),p.subtreeFlags=y.subtreeFlags&14680064),c!==null?b=al(c,b):(b=ql(b,k,l,null),b.flags|=2),b.return=n,p.return=n,p.sibling=b,n.child=p,p=b,b=n.child,k=e.child.memoizedState,k=k===null?hm(l):{baseLanes:k.baseLanes|l,cachePool:null,transitions:k.transitions},b.memoizedState=k,b.childLanes=e.childLanes&~l,n.memoizedState=cm,p}return b=e.child,e=b.sibling,p=al(b,{mode:"visible",children:p.children}),!(n.mode&1)&&(p.lanes=l),p.return=n,p.sibling=null,e!==null&&(l=n.deletions,l===null?(n.deletions=[e],n.flags|=16):l.push(e)),n.child=p,n.memoizedState=null,p}function l_(e,n){return n=rp({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function nd(e,n,l,p){return p!==null&&Hm(p),qu(n,e.child,null,l),e=l_(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function z2(e,n,l,p,y,b,k){if(l)return n.flags&256?(n.flags&=-257,p=xf(Error(qe(422))),nd(e,n,k,p)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(b=p.fallback,y=n.mode,p=rp({mode:"visible",children:p.children},y,0,null),b=ql(b,y,k,null),b.flags|=2,p.return=n,b.return=n,p.sibling=b,n.child=p,n.mode&1&&qu(n,e.child,null,k),n.child.memoizedState=hm(k),n.memoizedState=cm,b);if(!(n.mode&1))return nd(e,n,k,null);if(y.data==="$!"){if(p=y.nextSibling&&y.nextSibling.dataset,p)var c=p.dgst;return p=c,b=Error(qe(419)),p=xf(b,p,void 0),nd(e,n,k,p)}if(c=(k&e.childLanes)!==0,Or||c){if(p=Ln,p!==null){switch(k&-k){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=y&(p.suspendedLanes|k)?0:y,y!==0&&y!==b.retryLane&&(b.retryLane=y,ya(e,y),hs(p,e,y,-1))}return f_(),p=xf(Error(qe(421))),nd(e,n,k,p)}return y.data==="$?"?(n.flags|=128,n.child=e.child,n=j2.bind(null,e),y._reactRetry=n,null):(e=b.treeContext,oo=nl(y.nextSibling),so=n,Fi=!0,us=null,e!==null&&(Ao[zo++]=da,Ao[zo++]=pa,Ao[zo++]=Hl,da=e.id,pa=e.overflow,Hl=n),n=l_(n,p.children),n.flags|=4096,n)}function Wy(e,n,l){e.lanes|=n;var p=e.alternate;p!==null&&(p.lanes|=n),rm(e.return,n,l)}function wf(e,n,l,p,y){var b=e.memoizedState;b===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:p,tail:l,tailMode:y}:(b.isBackwards=n,b.rendering=null,b.renderingStartTime=0,b.last=p,b.tail=l,b.tailMode=y)}function Yx(e,n,l){var p=n.pendingProps,y=p.revealOrder,b=p.tail;if(_r(e,n,p.children,l),p=Gi.current,p&2)p=p&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Wy(e,l,n);else if(e.tag===19)Wy(e,l,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}p&=1}if(ki(Gi,p),!(n.mode&1))n.memoizedState=null;else switch(y){case"forwards":for(l=n.child,y=null;l!==null;)e=l.alternate,e!==null&&Bd(e)===null&&(y=l),l=l.sibling;l=y,l===null?(y=n.child,n.child=null):(y=l.sibling,l.sibling=null),wf(n,!1,y,l,b);break;case"backwards":for(l=null,y=n.child,n.child=null;y!==null;){if(e=y.alternate,e!==null&&Bd(e)===null){n.child=y;break}e=y.sibling,y.sibling=l,l=y,y=e}wf(n,!0,l,null,b);break;case"together":wf(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function _d(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function va(e,n,l){if(e!==null&&(n.dependencies=e.dependencies),Kl|=n.lanes,!(l&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(qe(153));if(n.child!==null){for(e=n.child,l=al(e,e.pendingProps),n.child=l,l.return=n;e.sibling!==null;)e=e.sibling,l=l.sibling=al(e,e.pendingProps),l.return=n;l.sibling=null}return n.child}function M2(e,n,l){switch(n.tag){case 3:Kx(n),ju();break;case 5:Ex(n);break;case 1:Nr(n.type)&&Ad(n);break;case 4:e_(n,n.stateNode.containerInfo);break;case 10:var p=n.type._context,y=n.memoizedProps.value;ki(Ld,p._currentValue),p._currentValue=y;break;case 13:if(p=n.memoizedState,p!==null)return p.dehydrated!==null?(ki(Gi,Gi.current&1),n.flags|=128,null):l&n.child.childLanes?Jx(e,n,l):(ki(Gi,Gi.current&1),e=va(e,n,l),e!==null?e.sibling:null);ki(Gi,Gi.current&1);break;case 19:if(p=(l&n.childLanes)!==0,e.flags&128){if(p)return Yx(e,n,l);n.flags|=128}if(y=n.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),ki(Gi,Gi.current),p)break;return null;case 22:case 23:return n.lanes=0,Hx(e,n,l)}return va(e,n,l)}var Qx,dm,e0,t0;Qx=function(e,n){for(var l=n.child;l!==null;){if(l.tag===5||l.tag===6)e.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===n)break;for(;l.sibling===null;){if(l.return===null||l.return===n)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};dm=function(){};e0=function(e,n,l,p){var y=e.memoizedProps;if(y!==p){e=n.stateNode,Gl(zs.current);var b=null;switch(l){case"input":y=Df(e,y),p=Df(e,p),b=[];break;case"select":y=qi({},y,{value:void 0}),p=qi({},p,{value:void 0}),b=[];break;case"textarea":y=Of(e,y),p=Of(e,p),b=[];break;default:typeof y.onClick!="function"&&typeof p.onClick=="function"&&(e.onclick=Id)}Nf(l,p);var k;l=null;for(le in y)if(!p.hasOwnProperty(le)&&y.hasOwnProperty(le)&&y[le]!=null)if(le==="style"){var c=y[le];for(k in c)c.hasOwnProperty(k)&&(l||(l={}),l[k]="")}else le!=="dangerouslySetInnerHTML"&&le!=="children"&&le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&le!=="autoFocus"&&(Xc.hasOwnProperty(le)?b||(b=[]):(b=b||[]).push(le,null));for(le in p){var q=p[le];if(c=y!=null?y[le]:void 0,p.hasOwnProperty(le)&&q!==c&&(q!=null||c!=null))if(le==="style")if(c){for(k in c)!c.hasOwnProperty(k)||q&&q.hasOwnProperty(k)||(l||(l={}),l[k]="");for(k in q)q.hasOwnProperty(k)&&c[k]!==q[k]&&(l||(l={}),l[k]=q[k])}else l||(b||(b=[]),b.push(le,l)),l=q;else le==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,c=c?c.__html:void 0,q!=null&&c!==q&&(b=b||[]).push(le,q)):le==="children"?typeof q!="string"&&typeof q!="number"||(b=b||[]).push(le,""+q):le!=="suppressContentEditableWarning"&&le!=="suppressHydrationWarning"&&(Xc.hasOwnProperty(le)?(q!=null&&le==="onScroll"&&Mi("scroll",e),b||c===q||(b=[])):(b=b||[]).push(le,q))}l&&(b=b||[]).push("style",l);var le=b;(n.updateQueue=le)&&(n.flags|=4)}};t0=function(e,n,l,p){l!==p&&(n.flags|=4)};function Mc(e,n){if(!Fi)switch(e.tailMode){case"hidden":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?e.tail=null:l.sibling=null;break;case"collapsed":l=e.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:p.sibling=null}}function ir(e){var n=e.alternate!==null&&e.alternate.child===e.child,l=0,p=0;if(n)for(var y=e.child;y!==null;)l|=y.lanes|y.childLanes,p|=y.subtreeFlags&14680064,p|=y.flags&14680064,y.return=e,y=y.sibling;else for(y=e.child;y!==null;)l|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=e,y=y.sibling;return e.subtreeFlags|=p,e.childLanes=l,n}function L2(e,n,l){var p=n.pendingProps;switch(Wm(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ir(n),null;case 1:return Nr(n.type)&&kd(),ir(n),null;case 3:return p=n.stateNode,$u(),Li(Fr),Li(rr),i_(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(e===null||e.child===null)&&(td(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,us!==null&&(xm(us),us=null))),dm(e,n),ir(n),null;case 5:t_(n);var y=Gl(ah.current);if(l=n.type,e!==null&&n.stateNode!=null)e0(e,n,l,p,y),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!p){if(n.stateNode===null)throw Error(qe(166));return ir(n),null}if(e=Gl(zs.current),td(n)){p=n.stateNode,l=n.type;var b=n.memoizedProps;switch(p[ks]=n,p[oh]=b,e=(n.mode&1)!==0,l){case"dialog":Mi("cancel",p),Mi("close",p);break;case"iframe":case"object":case"embed":Mi("load",p);break;case"video":case"audio":for(y=0;y<Oc.length;y++)Mi(Oc[y],p);break;case"source":Mi("error",p);break;case"img":case"image":case"link":Mi("error",p),Mi("load",p);break;case"details":Mi("toggle",p);break;case"input":iy(p,b),Mi("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!b.multiple},Mi("invalid",p);break;case"textarea":ry(p,b),Mi("invalid",p)}Nf(l,b),y=null;for(var k in b)if(b.hasOwnProperty(k)){var c=b[k];k==="children"?typeof c=="string"?p.textContent!==c&&(b.suppressHydrationWarning!==!0&&ed(p.textContent,c,e),y=["children",c]):typeof c=="number"&&p.textContent!==""+c&&(b.suppressHydrationWarning!==!0&&ed(p.textContent,c,e),y=["children",""+c]):Xc.hasOwnProperty(k)&&c!=null&&k==="onScroll"&&Mi("scroll",p)}switch(l){case"input":$h(p),ny(p,b,!0);break;case"textarea":$h(p),oy(p);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(p.onclick=Id)}p=y,n.updateQueue=p,p!==null&&(n.flags|=4)}else{k=y.nodeType===9?y:y.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Iv(l)),e==="http://www.w3.org/1999/xhtml"?l==="script"?(e=k.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof p.is=="string"?e=k.createElement(l,{is:p.is}):(e=k.createElement(l),l==="select"&&(k=e,p.multiple?k.multiple=!0:p.size&&(k.size=p.size))):e=k.createElementNS(e,l),e[ks]=n,e[oh]=p,Qx(e,n,!1,!1),n.stateNode=e;e:{switch(k=Uf(l,p),l){case"dialog":Mi("cancel",e),Mi("close",e),y=p;break;case"iframe":case"object":case"embed":Mi("load",e),y=p;break;case"video":case"audio":for(y=0;y<Oc.length;y++)Mi(Oc[y],e);y=p;break;case"source":Mi("error",e),y=p;break;case"img":case"image":case"link":Mi("error",e),Mi("load",e),y=p;break;case"details":Mi("toggle",e),y=p;break;case"input":iy(e,p),y=Df(e,p),Mi("invalid",e);break;case"option":y=p;break;case"select":e._wrapperState={wasMultiple:!!p.multiple},y=qi({},p,{value:void 0}),Mi("invalid",e);break;case"textarea":ry(e,p),y=Of(e,p),Mi("invalid",e);break;default:y=p}Nf(l,y),c=y;for(b in c)if(c.hasOwnProperty(b)){var q=c[b];b==="style"?zv(e,q):b==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,q!=null&&kv(e,q)):b==="children"?typeof q=="string"?(l!=="textarea"||q!=="")&&Kc(e,q):typeof q=="number"&&Kc(e,""+q):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(Xc.hasOwnProperty(b)?q!=null&&b==="onScroll"&&Mi("scroll",e):q!=null&&Mm(e,b,q,k))}switch(l){case"input":$h(e),ny(e,p,!1);break;case"textarea":$h(e),oy(e);break;case"option":p.value!=null&&e.setAttribute("value",""+ll(p.value));break;case"select":e.multiple=!!p.multiple,b=p.value,b!=null?Bu(e,!!p.multiple,b,!1):p.defaultValue!=null&&Bu(e,!!p.multiple,p.defaultValue,!0);break;default:typeof y.onClick=="function"&&(e.onclick=Id)}switch(l){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return ir(n),null;case 6:if(e&&n.stateNode!=null)t0(e,n,e.memoizedProps,p);else{if(typeof p!="string"&&n.stateNode===null)throw Error(qe(166));if(l=Gl(ah.current),Gl(zs.current),td(n)){if(p=n.stateNode,l=n.memoizedProps,p[ks]=n,(b=p.nodeValue!==l)&&(e=so,e!==null))switch(e.tag){case 3:ed(p.nodeValue,l,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ed(p.nodeValue,l,(e.mode&1)!==0)}b&&(n.flags|=4)}else p=(l.nodeType===9?l:l.ownerDocument).createTextNode(p),p[ks]=n,n.stateNode=p}return ir(n),null;case 13:if(Li(Gi),p=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Fi&&oo!==null&&n.mode&1&&!(n.flags&128))yx(),ju(),n.flags|=98560,b=!1;else if(b=td(n),p!==null&&p.dehydrated!==null){if(e===null){if(!b)throw Error(qe(318));if(b=n.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(qe(317));b[ks]=n}else ju(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;ir(n),b=!1}else us!==null&&(xm(us),us=null),b=!0;if(!b)return n.flags&65536?n:null}return n.flags&128?(n.lanes=l,n):(p=p!==null,p!==(e!==null&&e.memoizedState!==null)&&p&&(n.child.flags|=8192,n.mode&1&&(e===null||Gi.current&1?wn===0&&(wn=3):f_())),n.updateQueue!==null&&(n.flags|=4),ir(n),null);case 4:return $u(),dm(e,n),e===null&&nh(n.stateNode.containerInfo),ir(n),null;case 10:return Jm(n.type._context),ir(n),null;case 17:return Nr(n.type)&&kd(),ir(n),null;case 19:if(Li(Gi),b=n.memoizedState,b===null)return ir(n),null;if(p=(n.flags&128)!==0,k=b.rendering,k===null)if(p)Mc(b,!1);else{if(wn!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(k=Bd(e),k!==null){for(n.flags|=128,Mc(b,!1),p=k.updateQueue,p!==null&&(n.updateQueue=p,n.flags|=4),n.subtreeFlags=0,p=l,l=n.child;l!==null;)b=l,e=p,b.flags&=14680066,k=b.alternate,k===null?(b.childLanes=0,b.lanes=e,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=k.childLanes,b.lanes=k.lanes,b.child=k.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=k.memoizedProps,b.memoizedState=k.memoizedState,b.updateQueue=k.updateQueue,b.type=k.type,e=k.dependencies,b.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),l=l.sibling;return ki(Gi,Gi.current&1|2),n.child}e=e.sibling}b.tail!==null&&tn()>Hu&&(n.flags|=128,p=!0,Mc(b,!1),n.lanes=4194304)}else{if(!p)if(e=Bd(k),e!==null){if(n.flags|=128,p=!0,l=e.updateQueue,l!==null&&(n.updateQueue=l,n.flags|=4),Mc(b,!0),b.tail===null&&b.tailMode==="hidden"&&!k.alternate&&!Fi)return ir(n),null}else 2*tn()-b.renderingStartTime>Hu&&l!==1073741824&&(n.flags|=128,p=!0,Mc(b,!1),n.lanes=4194304);b.isBackwards?(k.sibling=n.child,n.child=k):(l=b.last,l!==null?l.sibling=k:n.child=k,b.last=k)}return b.tail!==null?(n=b.tail,b.rendering=n,b.tail=n.sibling,b.renderingStartTime=tn(),n.sibling=null,l=Gi.current,ki(Gi,p?l&1|2:l&1),n):(ir(n),null);case 22:case 23:return p_(),p=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==p&&(n.flags|=8192),p&&n.mode&1?ro&1073741824&&(ir(n),n.subtreeFlags&6&&(n.flags|=8192)):ir(n),null;case 24:return null;case 25:return null}throw Error(qe(156,n.tag))}function D2(e,n){switch(Wm(n),n.tag){case 1:return Nr(n.type)&&kd(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return $u(),Li(Fr),Li(rr),i_(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return t_(n),null;case 13:if(Li(Gi),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(qe(340));ju()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return Li(Gi),null;case 4:return $u(),null;case 10:return Jm(n.type._context),null;case 22:case 23:return p_(),null;case 24:return null;default:return null}}var rd=!1,nr=!1,R2=typeof WeakSet=="function"?WeakSet:Set,mt=null;function Du(e,n){var l=e.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(p){Ki(e,n,p)}else l.current=null}function pm(e,n,l){try{l()}catch(p){Ki(e,n,p)}}var Hy=!1;function B2(e,n){if(Kf=Ed,e=ox(),qm(e)){if("selectionStart"in e)var l={start:e.selectionStart,end:e.selectionEnd};else e:{l=(l=e.ownerDocument)&&l.defaultView||window;var p=l.getSelection&&l.getSelection();if(p&&p.rangeCount!==0){l=p.anchorNode;var y=p.anchorOffset,b=p.focusNode;p=p.focusOffset;try{l.nodeType,b.nodeType}catch{l=null;break e}var k=0,c=-1,q=-1,le=0,Ie=0,ge=e,K=null;t:for(;;){for(var Ze;ge!==l||y!==0&&ge.nodeType!==3||(c=k+y),ge!==b||p!==0&&ge.nodeType!==3||(q=k+p),ge.nodeType===3&&(k+=ge.nodeValue.length),(Ze=ge.firstChild)!==null;)K=ge,ge=Ze;for(;;){if(ge===e)break t;if(K===l&&++le===y&&(c=k),K===b&&++Ie===p&&(q=k),(Ze=ge.nextSibling)!==null)break;ge=K,K=ge.parentNode}ge=Ze}l=c===-1||q===-1?null:{start:c,end:q}}else l=null}l=l||{start:0,end:0}}else l=null;for(Jf={focusedElem:e,selectionRange:l},Ed=!1,mt=n;mt!==null;)if(n=mt,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,mt=e;else for(;mt!==null;){n=mt;try{var Ve=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(Ve!==null){var De=Ve.memoizedProps,Qt=Ve.memoizedState,ye=n.stateNode,ue=ye.getSnapshotBeforeUpdate(n.elementType===n.type?De:as(n.type,De),Qt);ye.__reactInternalSnapshotBeforeUpdate=ue}break;case 3:var me=n.stateNode.containerInfo;me.nodeType===1?me.textContent="":me.nodeType===9&&me.documentElement&&me.removeChild(me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch(Ue){Ki(n,n.return,Ue)}if(e=n.sibling,e!==null){e.return=n.return,mt=e;break}mt=n.return}return Ve=Hy,Hy=!1,Ve}function qc(e,n,l){var p=n.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var y=p=p.next;do{if((y.tag&e)===e){var b=y.destroy;y.destroy=void 0,b!==void 0&&pm(n,l,b)}y=y.next}while(y!==p)}}function ip(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var l=n=n.next;do{if((l.tag&e)===e){var p=l.create;l.destroy=p()}l=l.next}while(l!==n)}}function fm(e){var n=e.ref;if(n!==null){var l=e.stateNode;switch(e.tag){case 5:e=l;break;default:e=l}typeof n=="function"?n(e):n.current=e}}function i0(e){var n=e.alternate;n!==null&&(e.alternate=null,i0(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[ks],delete n[oh],delete n[em],delete n[y2],delete n[v2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function n0(e){return e.tag===5||e.tag===3||e.tag===4}function Xy(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||n0(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function mm(e,n,l){var p=e.tag;if(p===5||p===6)e=e.stateNode,n?l.nodeType===8?l.parentNode.insertBefore(e,n):l.insertBefore(e,n):(l.nodeType===8?(n=l.parentNode,n.insertBefore(e,l)):(n=l,n.appendChild(e)),l=l._reactRootContainer,l!=null||n.onclick!==null||(n.onclick=Id));else if(p!==4&&(e=e.child,e!==null))for(mm(e,n,l),e=e.sibling;e!==null;)mm(e,n,l),e=e.sibling}function _m(e,n,l){var p=e.tag;if(p===5||p===6)e=e.stateNode,n?l.insertBefore(e,n):l.appendChild(e);else if(p!==4&&(e=e.child,e!==null))for(_m(e,n,l),e=e.sibling;e!==null;)_m(e,n,l),e=e.sibling}var Gn=null,ls=!1;function qa(e,n,l){for(l=l.child;l!==null;)r0(e,n,l),l=l.sibling}function r0(e,n,l){if(As&&typeof As.onCommitFiberUnmount=="function")try{As.onCommitFiberUnmount(Hd,l)}catch{}switch(l.tag){case 5:nr||Du(l,n);case 6:var p=Gn,y=ls;Gn=null,qa(e,n,l),Gn=p,ls=y,Gn!==null&&(ls?(e=Gn,l=l.stateNode,e.nodeType===8?e.parentNode.removeChild(l):e.removeChild(l)):Gn.removeChild(l.stateNode));break;case 18:Gn!==null&&(ls?(e=Gn,l=l.stateNode,e.nodeType===8?ff(e.parentNode,l):e.nodeType===1&&ff(e,l),eh(e)):ff(Gn,l.stateNode));break;case 4:p=Gn,y=ls,Gn=l.stateNode.containerInfo,ls=!0,qa(e,n,l),Gn=p,ls=y;break;case 0:case 11:case 14:case 15:if(!nr&&(p=l.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){y=p=p.next;do{var b=y,k=b.destroy;b=b.tag,k!==void 0&&(b&2||b&4)&&pm(l,n,k),y=y.next}while(y!==p)}qa(e,n,l);break;case 1:if(!nr&&(Du(l,n),p=l.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=l.memoizedProps,p.state=l.memoizedState,p.componentWillUnmount()}catch(c){Ki(l,n,c)}qa(e,n,l);break;case 21:qa(e,n,l);break;case 22:l.mode&1?(nr=(p=nr)||l.memoizedState!==null,qa(e,n,l),nr=p):qa(e,n,l);break;default:qa(e,n,l)}}function Ky(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var l=e.stateNode;l===null&&(l=e.stateNode=new R2),n.forEach(function(p){var y=q2.bind(null,e,p);l.has(p)||(l.add(p),p.then(y,y))})}}function ss(e,n){var l=n.deletions;if(l!==null)for(var p=0;p<l.length;p++){var y=l[p];try{var b=e,k=n,c=k;e:for(;c!==null;){switch(c.tag){case 5:Gn=c.stateNode,ls=!1;break e;case 3:Gn=c.stateNode.containerInfo,ls=!0;break e;case 4:Gn=c.stateNode.containerInfo,ls=!0;break e}c=c.return}if(Gn===null)throw Error(qe(160));r0(b,k,y),Gn=null,ls=!1;var q=y.alternate;q!==null&&(q.return=null),y.return=null}catch(le){Ki(y,n,le)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)o0(n,e),n=n.sibling}function o0(e,n){var l=e.alternate,p=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ss(n,e),Cs(e),p&4){try{qc(3,e,e.return),ip(3,e)}catch(De){Ki(e,e.return,De)}try{qc(5,e,e.return)}catch(De){Ki(e,e.return,De)}}break;case 1:ss(n,e),Cs(e),p&512&&l!==null&&Du(l,l.return);break;case 5:if(ss(n,e),Cs(e),p&512&&l!==null&&Du(l,l.return),e.flags&32){var y=e.stateNode;try{Kc(y,"")}catch(De){Ki(e,e.return,De)}}if(p&4&&(y=e.stateNode,y!=null)){var b=e.memoizedProps,k=l!==null?l.memoizedProps:b,c=e.type,q=e.updateQueue;if(e.updateQueue=null,q!==null)try{c==="input"&&b.type==="radio"&&b.name!=null&&Pv(y,b),Uf(c,k);var le=Uf(c,b);for(k=0;k<q.length;k+=2){var Ie=q[k],ge=q[k+1];Ie==="style"?zv(y,ge):Ie==="dangerouslySetInnerHTML"?kv(y,ge):Ie==="children"?Kc(y,ge):Mm(y,Ie,ge,le)}switch(c){case"input":Rf(y,b);break;case"textarea":Cv(y,b);break;case"select":var K=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!b.multiple;var Ze=b.value;Ze!=null?Bu(y,!!b.multiple,Ze,!1):K!==!!b.multiple&&(b.defaultValue!=null?Bu(y,!!b.multiple,b.defaultValue,!0):Bu(y,!!b.multiple,b.multiple?[]:"",!1))}y[oh]=b}catch(De){Ki(e,e.return,De)}}break;case 6:if(ss(n,e),Cs(e),p&4){if(e.stateNode===null)throw Error(qe(162));y=e.stateNode,b=e.memoizedProps;try{y.nodeValue=b}catch(De){Ki(e,e.return,De)}}break;case 3:if(ss(n,e),Cs(e),p&4&&l!==null&&l.memoizedState.isDehydrated)try{eh(n.containerInfo)}catch(De){Ki(e,e.return,De)}break;case 4:ss(n,e),Cs(e);break;case 13:ss(n,e),Cs(e),y=e.child,y.flags&8192&&(b=y.memoizedState!==null,y.stateNode.isHidden=b,!b||y.alternate!==null&&y.alternate.memoizedState!==null||(h_=tn())),p&4&&Ky(e);break;case 22:if(Ie=l!==null&&l.memoizedState!==null,e.mode&1?(nr=(le=nr)||Ie,ss(n,e),nr=le):ss(n,e),Cs(e),p&8192){if(le=e.memoizedState!==null,(e.stateNode.isHidden=le)&&!Ie&&e.mode&1)for(mt=e,Ie=e.child;Ie!==null;){for(ge=mt=Ie;mt!==null;){switch(K=mt,Ze=K.child,K.tag){case 0:case 11:case 14:case 15:qc(4,K,K.return);break;case 1:Du(K,K.return);var Ve=K.stateNode;if(typeof Ve.componentWillUnmount=="function"){p=K,l=K.return;try{n=p,Ve.props=n.memoizedProps,Ve.state=n.memoizedState,Ve.componentWillUnmount()}catch(De){Ki(p,l,De)}}break;case 5:Du(K,K.return);break;case 22:if(K.memoizedState!==null){Yy(ge);continue}}Ze!==null?(Ze.return=K,mt=Ze):Yy(ge)}Ie=Ie.sibling}e:for(Ie=null,ge=e;;){if(ge.tag===5){if(Ie===null){Ie=ge;try{y=ge.stateNode,le?(b=y.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(c=ge.stateNode,q=ge.memoizedProps.style,k=q!=null&&q.hasOwnProperty("display")?q.display:null,c.style.display=Av("display",k))}catch(De){Ki(e,e.return,De)}}}else if(ge.tag===6){if(Ie===null)try{ge.stateNode.nodeValue=le?"":ge.memoizedProps}catch(De){Ki(e,e.return,De)}}else if((ge.tag!==22&&ge.tag!==23||ge.memoizedState===null||ge===e)&&ge.child!==null){ge.child.return=ge,ge=ge.child;continue}if(ge===e)break e;for(;ge.sibling===null;){if(ge.return===null||ge.return===e)break e;Ie===ge&&(Ie=null),ge=ge.return}Ie===ge&&(Ie=null),ge.sibling.return=ge.return,ge=ge.sibling}}break;case 19:ss(n,e),Cs(e),p&4&&Ky(e);break;case 21:break;default:ss(n,e),Cs(e)}}function Cs(e){var n=e.flags;if(n&2){try{e:{for(var l=e.return;l!==null;){if(n0(l)){var p=l;break e}l=l.return}throw Error(qe(160))}switch(p.tag){case 5:var y=p.stateNode;p.flags&32&&(Kc(y,""),p.flags&=-33);var b=Xy(e);_m(e,b,y);break;case 3:case 4:var k=p.stateNode.containerInfo,c=Xy(e);mm(e,c,k);break;default:throw Error(qe(161))}}catch(q){Ki(e,e.return,q)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function O2(e,n,l){mt=e,s0(e)}function s0(e,n,l){for(var p=(e.mode&1)!==0;mt!==null;){var y=mt,b=y.child;if(y.tag===22&&p){var k=y.memoizedState!==null||rd;if(!k){var c=y.alternate,q=c!==null&&c.memoizedState!==null||nr;c=rd;var le=nr;if(rd=k,(nr=q)&&!le)for(mt=y;mt!==null;)k=mt,q=k.child,k.tag===22&&k.memoizedState!==null?Qy(y):q!==null?(q.return=k,mt=q):Qy(y);for(;b!==null;)mt=b,s0(b),b=b.sibling;mt=y,rd=c,nr=le}Jy(e)}else y.subtreeFlags&8772&&b!==null?(b.return=y,mt=b):Jy(e)}}function Jy(e){for(;mt!==null;){var n=mt;if(n.flags&8772){var l=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:nr||ip(5,n);break;case 1:var p=n.stateNode;if(n.flags&4&&!nr)if(l===null)p.componentDidMount();else{var y=n.elementType===n.type?l.memoizedProps:as(n.type,l.memoizedProps);p.componentDidUpdate(y,l.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var b=n.updateQueue;b!==null&&Dy(n,b,p);break;case 3:var k=n.updateQueue;if(k!==null){if(l=null,n.child!==null)switch(n.child.tag){case 5:l=n.child.stateNode;break;case 1:l=n.child.stateNode}Dy(n,k,l)}break;case 5:var c=n.stateNode;if(l===null&&n.flags&4){l=c;var q=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":q.autoFocus&&l.focus();break;case"img":q.src&&(l.src=q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var le=n.alternate;if(le!==null){var Ie=le.memoizedState;if(Ie!==null){var ge=Ie.dehydrated;ge!==null&&eh(ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}nr||n.flags&512&&fm(n)}catch(K){Ki(n,n.return,K)}}if(n===e){mt=null;break}if(l=n.sibling,l!==null){l.return=n.return,mt=l;break}mt=n.return}}function Yy(e){for(;mt!==null;){var n=mt;if(n===e){mt=null;break}var l=n.sibling;if(l!==null){l.return=n.return,mt=l;break}mt=n.return}}function Qy(e){for(;mt!==null;){var n=mt;try{switch(n.tag){case 0:case 11:case 15:var l=n.return;try{ip(4,n)}catch(q){Ki(n,l,q)}break;case 1:var p=n.stateNode;if(typeof p.componentDidMount=="function"){var y=n.return;try{p.componentDidMount()}catch(q){Ki(n,y,q)}}var b=n.return;try{fm(n)}catch(q){Ki(n,b,q)}break;case 5:var k=n.return;try{fm(n)}catch(q){Ki(n,k,q)}}}catch(q){Ki(n,n.return,q)}if(n===e){mt=null;break}var c=n.sibling;if(c!==null){c.return=n.return,mt=c;break}mt=n.return}}var F2=Math.ceil,Nd=xa.ReactCurrentDispatcher,u_=xa.ReactCurrentOwner,Lo=xa.ReactCurrentBatchConfig,ui=0,Ln=null,dn=null,jn=0,ro=0,Ru=dl(0),wn=0,hh=null,Kl=0,np=0,c_=0,$c=null,Br=null,h_=0,Hu=1/0,ca=null,Ud=!1,gm=null,ol=null,od=!1,Qa=null,Vd=0,Wc=0,ym=null,gd=-1,yd=0;function gr(){return ui&6?tn():gd!==-1?gd:gd=tn()}function sl(e){return e.mode&1?ui&2&&jn!==0?jn&-jn:w2.transition!==null?(yd===0&&(yd=Gv()),yd):(e=wi,e!==0||(e=window.event,e=e===void 0?16:Kv(e.type)),e):1}function hs(e,n,l,p){if(50<Wc)throw Wc=0,ym=null,Error(qe(185));fh(e,l,p),(!(ui&2)||e!==Ln)&&(e===Ln&&(!(ui&2)&&(np|=l),wn===4&&Ka(e,jn)),Ur(e,p),l===1&&ui===0&&!(n.mode&1)&&(Hu=tn()+500,Qd&&pl()))}function Ur(e,n){var l=e.callbackNode;wb(e,n);var p=Sd(e,e===Ln?jn:0);if(p===0)l!==null&&ly(l),e.callbackNode=null,e.callbackPriority=0;else if(n=p&-p,e.callbackPriority!==n){if(l!=null&&ly(l),n===1)e.tag===0?x2(ev.bind(null,e)):mx(ev.bind(null,e)),_2(function(){!(ui&6)&&pl()}),l=null;else{switch(jv(p)){case 1:l=Om;break;case 4:l=Vv;break;case 16:l=Td;break;case 536870912:l=Zv;break;default:l=Td}l=f0(l,a0.bind(null,e))}e.callbackPriority=n,e.callbackNode=l}}function a0(e,n){if(gd=-1,yd=0,ui&6)throw Error(qe(327));var l=e.callbackNode;if(Vu()&&e.callbackNode!==l)return null;var p=Sd(e,e===Ln?jn:0);if(p===0)return null;if(p&30||p&e.expiredLanes||n)n=Zd(e,p);else{n=p;var y=ui;ui|=2;var b=u0();(Ln!==e||jn!==n)&&(ca=null,Hu=tn()+500,jl(e,n));do try{V2();break}catch(c){l0(e,c)}while(1);Km(),Nd.current=b,ui=y,dn!==null?n=0:(Ln=null,jn=0,n=wn)}if(n!==0){if(n===2&&(y=qf(e),y!==0&&(p=y,n=vm(e,y))),n===1)throw l=hh,jl(e,0),Ka(e,p),Ur(e,tn()),l;if(n===6)Ka(e,p);else{if(y=e.current.alternate,!(p&30)&&!N2(y)&&(n=Zd(e,p),n===2&&(b=qf(e),b!==0&&(p=b,n=vm(e,b))),n===1))throw l=hh,jl(e,0),Ka(e,p),Ur(e,tn()),l;switch(e.finishedWork=y,e.finishedLanes=p,n){case 0:case 1:throw Error(qe(345));case 2:Ul(e,Br,ca);break;case 3:if(Ka(e,p),(p&130023424)===p&&(n=h_+500-tn(),10<n)){if(Sd(e,0)!==0)break;if(y=e.suspendedLanes,(y&p)!==p){gr(),e.pingedLanes|=e.suspendedLanes&y;break}e.timeoutHandle=Qf(Ul.bind(null,e,Br,ca),n);break}Ul(e,Br,ca);break;case 4:if(Ka(e,p),(p&4194240)===p)break;for(n=e.eventTimes,y=-1;0<p;){var k=31-cs(p);b=1<<k,k=n[k],k>y&&(y=k),p&=~b}if(p=y,p=tn()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*F2(p/1960))-p,10<p){e.timeoutHandle=Qf(Ul.bind(null,e,Br,ca),p);break}Ul(e,Br,ca);break;case 5:Ul(e,Br,ca);break;default:throw Error(qe(329))}}}return Ur(e,tn()),e.callbackNode===l?a0.bind(null,e):null}function vm(e,n){var l=$c;return e.current.memoizedState.isDehydrated&&(jl(e,n).flags|=256),e=Zd(e,n),e!==2&&(n=Br,Br=l,n!==null&&xm(n)),e}function xm(e){Br===null?Br=e:Br.push.apply(Br,e)}function N2(e){for(var n=e;;){if(n.flags&16384){var l=n.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var p=0;p<l.length;p++){var y=l[p],b=y.getSnapshot;y=y.value;try{if(!ds(b(),y))return!1}catch{return!1}}}if(l=n.child,n.subtreeFlags&16384&&l!==null)l.return=n,n=l;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Ka(e,n){for(n&=~c_,n&=~np,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var l=31-cs(n),p=1<<l;e[l]=-1,n&=~p}}function ev(e){if(ui&6)throw Error(qe(327));Vu();var n=Sd(e,0);if(!(n&1))return Ur(e,tn()),null;var l=Zd(e,n);if(e.tag!==0&&l===2){var p=qf(e);p!==0&&(n=p,l=vm(e,p))}if(l===1)throw l=hh,jl(e,0),Ka(e,n),Ur(e,tn()),l;if(l===6)throw Error(qe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,Ul(e,Br,ca),Ur(e,tn()),null}function d_(e,n){var l=ui;ui|=1;try{return e(n)}finally{ui=l,ui===0&&(Hu=tn()+500,Qd&&pl())}}function Jl(e){Qa!==null&&Qa.tag===0&&!(ui&6)&&Vu();var n=ui;ui|=1;var l=Lo.transition,p=wi;try{if(Lo.transition=null,wi=1,e)return e()}finally{wi=p,Lo.transition=l,ui=n,!(ui&6)&&pl()}}function p_(){ro=Ru.current,Li(Ru)}function jl(e,n){e.finishedWork=null,e.finishedLanes=0;var l=e.timeoutHandle;if(l!==-1&&(e.timeoutHandle=-1,m2(l)),dn!==null)for(l=dn.return;l!==null;){var p=l;switch(Wm(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&kd();break;case 3:$u(),Li(Fr),Li(rr),i_();break;case 5:t_(p);break;case 4:$u();break;case 13:Li(Gi);break;case 19:Li(Gi);break;case 10:Jm(p.type._context);break;case 22:case 23:p_()}l=l.return}if(Ln=e,dn=e=al(e.current,null),jn=ro=n,wn=0,hh=null,c_=np=Kl=0,Br=$c=null,Zl!==null){for(n=0;n<Zl.length;n++)if(l=Zl[n],p=l.interleaved,p!==null){l.interleaved=null;var y=p.next,b=l.pending;if(b!==null){var k=b.next;b.next=y,p.next=k}l.pending=p}Zl=null}return e}function l0(e,n){do{var l=dn;try{if(Km(),fd.current=Fd,Od){for(var p=ji.memoizedState;p!==null;){var y=p.queue;y!==null&&(y.pending=null),p=p.next}Od=!1}if(Xl=0,Mn=xn=ji=null,jc=!1,lh=0,u_.current=null,l===null||l.return===null){wn=1,hh=n,dn=null;break}e:{var b=e,k=l.return,c=l,q=n;if(n=jn,c.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var le=q,Ie=c,ge=Ie.tag;if(!(Ie.mode&1)&&(ge===0||ge===11||ge===15)){var K=Ie.alternate;K?(Ie.updateQueue=K.updateQueue,Ie.memoizedState=K.memoizedState,Ie.lanes=K.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var Ze=Vy(k);if(Ze!==null){Ze.flags&=-257,Zy(Ze,k,c,b,n),Ze.mode&1&&Uy(b,le,n),n=Ze,q=le;var Ve=n.updateQueue;if(Ve===null){var De=new Set;De.add(q),n.updateQueue=De}else Ve.add(q);break e}else{if(!(n&1)){Uy(b,le,n),f_();break e}q=Error(qe(426))}}else if(Fi&&c.mode&1){var Qt=Vy(k);if(Qt!==null){!(Qt.flags&65536)&&(Qt.flags|=256),Zy(Qt,k,c,b,n),Hm(Wu(q,c));break e}}b=q=Wu(q,c),wn!==4&&(wn=2),$c===null?$c=[b]:$c.push(b),b=k;do{switch(b.tag){case 3:b.flags|=65536,n&=-n,b.lanes|=n;var ye=qx(b,q,n);Ly(b,ye);break e;case 1:c=q;var ue=b.type,me=b.stateNode;if(!(b.flags&128)&&(typeof ue.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(ol===null||!ol.has(me)))){b.flags|=65536,n&=-n,b.lanes|=n;var Ue=$x(b,c,n);Ly(b,Ue);break e}}b=b.return}while(b!==null)}h0(l)}catch($e){n=$e,dn===l&&l!==null&&(dn=l=l.return);continue}break}while(1)}function u0(){var e=Nd.current;return Nd.current=Fd,e===null?Fd:e}function f_(){(wn===0||wn===3||wn===2)&&(wn=4),Ln===null||!(Kl&268435455)&&!(np&268435455)||Ka(Ln,jn)}function Zd(e,n){var l=ui;ui|=2;var p=u0();(Ln!==e||jn!==n)&&(ca=null,jl(e,n));do try{U2();break}catch(y){l0(e,y)}while(1);if(Km(),ui=l,Nd.current=p,dn!==null)throw Error(qe(261));return Ln=null,jn=0,wn}function U2(){for(;dn!==null;)c0(dn)}function V2(){for(;dn!==null&&!db();)c0(dn)}function c0(e){var n=p0(e.alternate,e,ro);e.memoizedProps=e.pendingProps,n===null?h0(e):dn=n,u_.current=null}function h0(e){var n=e;do{var l=n.alternate;if(e=n.return,n.flags&32768){if(l=D2(l,n),l!==null){l.flags&=32767,dn=l;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{wn=6,dn=null;return}}else if(l=L2(l,n,ro),l!==null){dn=l;return}if(n=n.sibling,n!==null){dn=n;return}dn=n=e}while(n!==null);wn===0&&(wn=5)}function Ul(e,n,l){var p=wi,y=Lo.transition;try{Lo.transition=null,wi=1,Z2(e,n,l,p)}finally{Lo.transition=y,wi=p}return null}function Z2(e,n,l,p){do Vu();while(Qa!==null);if(ui&6)throw Error(qe(327));l=e.finishedWork;var y=e.finishedLanes;if(l===null)return null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error(qe(177));e.callbackNode=null,e.callbackPriority=0;var b=l.lanes|l.childLanes;if(bb(e,b),e===Ln&&(dn=Ln=null,jn=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||od||(od=!0,f0(Td,function(){return Vu(),null})),b=(l.flags&15990)!==0,l.subtreeFlags&15990||b){b=Lo.transition,Lo.transition=null;var k=wi;wi=1;var c=ui;ui|=4,u_.current=null,B2(e,l),o0(l,e),l2(Jf),Ed=!!Kf,Jf=Kf=null,e.current=l,O2(l),pb(),ui=c,wi=k,Lo.transition=b}else e.current=l;if(od&&(od=!1,Qa=e,Vd=y),b=e.pendingLanes,b===0&&(ol=null),_b(l.stateNode),Ur(e,tn()),n!==null)for(p=e.onRecoverableError,l=0;l<n.length;l++)y=n[l],p(y.value,{componentStack:y.stack,digest:y.digest});if(Ud)throw Ud=!1,e=gm,gm=null,e;return Vd&1&&e.tag!==0&&Vu(),b=e.pendingLanes,b&1?e===ym?Wc++:(Wc=0,ym=e):Wc=0,pl(),null}function Vu(){if(Qa!==null){var e=jv(Vd),n=Lo.transition,l=wi;try{if(Lo.transition=null,wi=16>e?16:e,Qa===null)var p=!1;else{if(e=Qa,Qa=null,Vd=0,ui&6)throw Error(qe(331));var y=ui;for(ui|=4,mt=e.current;mt!==null;){var b=mt,k=b.child;if(mt.flags&16){var c=b.deletions;if(c!==null){for(var q=0;q<c.length;q++){var le=c[q];for(mt=le;mt!==null;){var Ie=mt;switch(Ie.tag){case 0:case 11:case 15:qc(8,Ie,b)}var ge=Ie.child;if(ge!==null)ge.return=Ie,mt=ge;else for(;mt!==null;){Ie=mt;var K=Ie.sibling,Ze=Ie.return;if(i0(Ie),Ie===le){mt=null;break}if(K!==null){K.return=Ze,mt=K;break}mt=Ze}}}var Ve=b.alternate;if(Ve!==null){var De=Ve.child;if(De!==null){Ve.child=null;do{var Qt=De.sibling;De.sibling=null,De=Qt}while(De!==null)}}mt=b}}if(b.subtreeFlags&2064&&k!==null)k.return=b,mt=k;else e:for(;mt!==null;){if(b=mt,b.flags&2048)switch(b.tag){case 0:case 11:case 15:qc(9,b,b.return)}var ye=b.sibling;if(ye!==null){ye.return=b.return,mt=ye;break e}mt=b.return}}var ue=e.current;for(mt=ue;mt!==null;){k=mt;var me=k.child;if(k.subtreeFlags&2064&&me!==null)me.return=k,mt=me;else e:for(k=ue;mt!==null;){if(c=mt,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:ip(9,c)}}catch($e){Ki(c,c.return,$e)}if(c===k){mt=null;break e}var Ue=c.sibling;if(Ue!==null){Ue.return=c.return,mt=Ue;break e}mt=c.return}}if(ui=y,pl(),As&&typeof As.onPostCommitFiberRoot=="function")try{As.onPostCommitFiberRoot(Hd,e)}catch{}p=!0}return p}finally{wi=l,Lo.transition=n}}return!1}function tv(e,n,l){n=Wu(l,n),n=qx(e,n,1),e=rl(e,n,1),n=gr(),e!==null&&(fh(e,1,n),Ur(e,n))}function Ki(e,n,l){if(e.tag===3)tv(e,e,l);else for(;n!==null;){if(n.tag===3){tv(n,e,l);break}else if(n.tag===1){var p=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(ol===null||!ol.has(p))){e=Wu(l,e),e=$x(n,e,1),n=rl(n,e,1),e=gr(),n!==null&&(fh(n,1,e),Ur(n,e));break}}n=n.return}}function G2(e,n,l){var p=e.pingCache;p!==null&&p.delete(n),n=gr(),e.pingedLanes|=e.suspendedLanes&l,Ln===e&&(jn&l)===l&&(wn===4||wn===3&&(jn&130023424)===jn&&500>tn()-h_?jl(e,0):c_|=l),Ur(e,n)}function d0(e,n){n===0&&(e.mode&1?(n=Xh,Xh<<=1,!(Xh&130023424)&&(Xh=4194304)):n=1);var l=gr();e=ya(e,n),e!==null&&(fh(e,n,l),Ur(e,l))}function j2(e){var n=e.memoizedState,l=0;n!==null&&(l=n.retryLane),d0(e,l)}function q2(e,n){var l=0;switch(e.tag){case 13:var p=e.stateNode,y=e.memoizedState;y!==null&&(l=y.retryLane);break;case 19:p=e.stateNode;break;default:throw Error(qe(314))}p!==null&&p.delete(n),d0(e,l)}var p0;p0=function(e,n,l){if(e!==null)if(e.memoizedProps!==n.pendingProps||Fr.current)Or=!0;else{if(!(e.lanes&l)&&!(n.flags&128))return Or=!1,M2(e,n,l);Or=!!(e.flags&131072)}else Or=!1,Fi&&n.flags&1048576&&_x(n,Md,n.index);switch(n.lanes=0,n.tag){case 2:var p=n.type;_d(e,n),e=n.pendingProps;var y=Gu(n,rr.current);Uu(n,l),y=r_(null,n,p,e,y,l);var b=o_();return n.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Nr(p)?(b=!0,Ad(n)):b=!1,n.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,Qm(n),y.updater=ep,n.stateNode=y,y._reactInternals=n,sm(n,p,e,l),n=um(null,n,p,!0,b,l)):(n.tag=0,Fi&&b&&$m(n),_r(null,n,y,l),n=n.child),n;case 16:p=n.elementType;e:{switch(_d(e,n),e=n.pendingProps,y=p._init,p=y(p._payload),n.type=p,y=n.tag=W2(p),e=as(p,e),y){case 0:n=lm(null,n,p,e,l);break e;case 1:n=qy(null,n,p,e,l);break e;case 11:n=Gy(null,n,p,e,l);break e;case 14:n=jy(null,n,p,as(p.type,e),l);break e}throw Error(qe(306,p,""))}return n;case 0:return p=n.type,y=n.pendingProps,y=n.elementType===p?y:as(p,y),lm(e,n,p,y,l);case 1:return p=n.type,y=n.pendingProps,y=n.elementType===p?y:as(p,y),qy(e,n,p,y,l);case 3:e:{if(Kx(n),e===null)throw Error(qe(387));p=n.pendingProps,b=n.memoizedState,y=b.element,xx(e,n),Rd(n,p,null,l);var k=n.memoizedState;if(p=k.element,b.isDehydrated)if(b={element:p,isDehydrated:!1,cache:k.cache,pendingSuspenseBoundaries:k.pendingSuspenseBoundaries,transitions:k.transitions},n.updateQueue.baseState=b,n.memoizedState=b,n.flags&256){y=Wu(Error(qe(423)),n),n=$y(e,n,p,l,y);break e}else if(p!==y){y=Wu(Error(qe(424)),n),n=$y(e,n,p,l,y);break e}else for(oo=nl(n.stateNode.containerInfo.firstChild),so=n,Fi=!0,us=null,l=Sx(n,null,p,l),n.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(ju(),p===y){n=va(e,n,l);break e}_r(e,n,p,l)}n=n.child}return n;case 5:return Ex(n),e===null&&nm(n),p=n.type,y=n.pendingProps,b=e!==null?e.memoizedProps:null,k=y.children,Yf(p,y)?k=null:b!==null&&Yf(p,b)&&(n.flags|=32),Xx(e,n),_r(e,n,k,l),n.child;case 6:return e===null&&nm(n),null;case 13:return Jx(e,n,l);case 4:return e_(n,n.stateNode.containerInfo),p=n.pendingProps,e===null?n.child=qu(n,null,p,l):_r(e,n,p,l),n.child;case 11:return p=n.type,y=n.pendingProps,y=n.elementType===p?y:as(p,y),Gy(e,n,p,y,l);case 7:return _r(e,n,n.pendingProps,l),n.child;case 8:return _r(e,n,n.pendingProps.children,l),n.child;case 12:return _r(e,n,n.pendingProps.children,l),n.child;case 10:e:{if(p=n.type._context,y=n.pendingProps,b=n.memoizedProps,k=y.value,ki(Ld,p._currentValue),p._currentValue=k,b!==null)if(ds(b.value,k)){if(b.children===y.children&&!Fr.current){n=va(e,n,l);break e}}else for(b=n.child,b!==null&&(b.return=n);b!==null;){var c=b.dependencies;if(c!==null){k=b.child;for(var q=c.firstContext;q!==null;){if(q.context===p){if(b.tag===1){q=fa(-1,l&-l),q.tag=2;var le=b.updateQueue;if(le!==null){le=le.shared;var Ie=le.pending;Ie===null?q.next=q:(q.next=Ie.next,Ie.next=q),le.pending=q}}b.lanes|=l,q=b.alternate,q!==null&&(q.lanes|=l),rm(b.return,l,n),c.lanes|=l;break}q=q.next}}else if(b.tag===10)k=b.type===n.type?null:b.child;else if(b.tag===18){if(k=b.return,k===null)throw Error(qe(341));k.lanes|=l,c=k.alternate,c!==null&&(c.lanes|=l),rm(k,l,n),k=b.sibling}else k=b.child;if(k!==null)k.return=b;else for(k=b;k!==null;){if(k===n){k=null;break}if(b=k.sibling,b!==null){b.return=k.return,k=b;break}k=k.return}b=k}_r(e,n,y.children,l),n=n.child}return n;case 9:return y=n.type,p=n.pendingProps.children,Uu(n,l),y=Do(y),p=p(y),n.flags|=1,_r(e,n,p,l),n.child;case 14:return p=n.type,y=as(p,n.pendingProps),y=as(p.type,y),jy(e,n,p,y,l);case 15:return Wx(e,n,n.type,n.pendingProps,l);case 17:return p=n.type,y=n.pendingProps,y=n.elementType===p?y:as(p,y),_d(e,n),n.tag=1,Nr(p)?(e=!0,Ad(n)):e=!1,Uu(n,l),bx(n,p,y),sm(n,p,y,l),um(null,n,p,!0,e,l);case 19:return Yx(e,n,l);case 22:return Hx(e,n,l)}throw Error(qe(156,n.tag))};function f0(e,n){return Uv(e,n)}function $2(e,n,l,p){this.tag=e,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mo(e,n,l,p){return new $2(e,n,l,p)}function m_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function W2(e){if(typeof e=="function")return m_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Dm)return 11;if(e===Rm)return 14}return 2}function al(e,n){var l=e.alternate;return l===null?(l=Mo(e.tag,n,e.key,e.mode),l.elementType=e.elementType,l.type=e.type,l.stateNode=e.stateNode,l.alternate=e,e.alternate=l):(l.pendingProps=n,l.type=e.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=e.flags&14680064,l.childLanes=e.childLanes,l.lanes=e.lanes,l.child=e.child,l.memoizedProps=e.memoizedProps,l.memoizedState=e.memoizedState,l.updateQueue=e.updateQueue,n=e.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},l.sibling=e.sibling,l.index=e.index,l.ref=e.ref,l}function vd(e,n,l,p,y,b){var k=2;if(p=e,typeof e=="function")m_(e)&&(k=1);else if(typeof e=="string")k=5;else e:switch(e){case Eu:return ql(l.children,y,b,n);case Lm:k=8,y|=8;break;case Af:return e=Mo(12,l,n,y|2),e.elementType=Af,e.lanes=b,e;case zf:return e=Mo(13,l,n,y),e.elementType=zf,e.lanes=b,e;case Mf:return e=Mo(19,l,n,y),e.elementType=Mf,e.lanes=b,e;case Tv:return rp(l,y,b,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case wv:k=10;break e;case bv:k=9;break e;case Dm:k=11;break e;case Rm:k=14;break e;case Wa:k=16,p=null;break e}throw Error(qe(130,e==null?e:typeof e,""))}return n=Mo(k,l,n,y),n.elementType=e,n.type=p,n.lanes=b,n}function ql(e,n,l,p){return e=Mo(7,e,p,n),e.lanes=l,e}function rp(e,n,l,p){return e=Mo(22,e,p,n),e.elementType=Tv,e.lanes=l,e.stateNode={isHidden:!1},e}function bf(e,n,l){return e=Mo(6,e,null,n),e.lanes=l,e}function Tf(e,n,l){return n=Mo(4,e.children!==null?e.children:[],e.key,n),n.lanes=l,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function H2(e,n,l,p,y){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nf(0),this.expirationTimes=nf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nf(0),this.identifierPrefix=p,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function __(e,n,l,p,y,b,k,c,q){return e=new H2(e,n,l,c,q),n===1?(n=1,b===!0&&(n|=8)):n=0,b=Mo(3,null,null,n),e.current=b,b.stateNode=e,b.memoizedState={element:p,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qm(b),e}function X2(e,n,l){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Su,key:p==null?null:""+p,children:e,containerInfo:n,implementation:l}}function m0(e){if(!e)return ul;e=e._reactInternals;e:{if(Ql(e)!==e||e.tag!==1)throw Error(qe(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Nr(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(qe(171))}if(e.tag===1){var l=e.type;if(Nr(l))return fx(e,l,n)}return n}function _0(e,n,l,p,y,b,k,c,q){return e=__(l,p,!0,e,y,b,k,c,q),e.context=m0(null),l=e.current,p=gr(),y=sl(l),b=fa(p,y),b.callback=n??null,rl(l,b,y),e.current.lanes=y,fh(e,y,p),Ur(e,p),e}function op(e,n,l,p){var y=n.current,b=gr(),k=sl(y);return l=m0(l),n.context===null?n.context=l:n.pendingContext=l,n=fa(b,k),n.payload={element:e},p=p===void 0?null:p,p!==null&&(n.callback=p),e=rl(y,n,k),e!==null&&(hs(e,y,k,b),pd(e,y,k)),k}function Gd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function iv(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var l=e.retryLane;e.retryLane=l!==0&&l<n?l:n}}function g_(e,n){iv(e,n),(e=e.alternate)&&iv(e,n)}function K2(){return null}var g0=typeof reportError=="function"?reportError:function(e){console.error(e)};function y_(e){this._internalRoot=e}sp.prototype.render=y_.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(qe(409));op(e,n,null,null)};sp.prototype.unmount=y_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Jl(function(){op(null,e,null,null)}),n[ga]=null}};function sp(e){this._internalRoot=e}sp.prototype.unstable_scheduleHydration=function(e){if(e){var n=Wv();e={blockedOn:null,target:e,priority:n};for(var l=0;l<Xa.length&&n!==0&&n<Xa[l].priority;l++);Xa.splice(l,0,e),l===0&&Xv(e)}};function v_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ap(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function nv(){}function J2(e,n,l,p,y){if(y){if(typeof p=="function"){var b=p;p=function(){var le=Gd(k);b.call(le)}}var k=_0(n,p,e,0,null,!1,!1,"",nv);return e._reactRootContainer=k,e[ga]=k.current,nh(e.nodeType===8?e.parentNode:e),Jl(),k}for(;y=e.lastChild;)e.removeChild(y);if(typeof p=="function"){var c=p;p=function(){var le=Gd(q);c.call(le)}}var q=__(e,0,!1,null,null,!1,!1,"",nv);return e._reactRootContainer=q,e[ga]=q.current,nh(e.nodeType===8?e.parentNode:e),Jl(function(){op(n,q,l,p)}),q}function lp(e,n,l,p,y){var b=l._reactRootContainer;if(b){var k=b;if(typeof y=="function"){var c=y;y=function(){var q=Gd(k);c.call(q)}}op(n,k,e,y)}else k=J2(l,n,e,y,p);return Gd(k)}qv=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var l=Bc(n.pendingLanes);l!==0&&(Fm(n,l|1),Ur(n,tn()),!(ui&6)&&(Hu=tn()+500,pl()))}break;case 13:Jl(function(){var p=ya(e,1);if(p!==null){var y=gr();hs(p,e,1,y)}}),g_(e,1)}};Nm=function(e){if(e.tag===13){var n=ya(e,134217728);if(n!==null){var l=gr();hs(n,e,134217728,l)}g_(e,134217728)}};$v=function(e){if(e.tag===13){var n=sl(e),l=ya(e,n);if(l!==null){var p=gr();hs(l,e,n,p)}g_(e,n)}};Wv=function(){return wi};Hv=function(e,n){var l=wi;try{return wi=e,n()}finally{wi=l}};Zf=function(e,n,l){switch(n){case"input":if(Rf(e,l),n=l.name,l.type==="radio"&&n!=null){for(l=e;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<l.length;n++){var p=l[n];if(p!==e&&p.form===e.form){var y=Yd(p);if(!y)throw Error(qe(90));Ev(p),Rf(p,y)}}}break;case"textarea":Cv(e,l);break;case"select":n=l.value,n!=null&&Bu(e,!!l.multiple,n,!1)}};Dv=d_;Rv=Jl;var Y2={usingClientEntryPoint:!1,Events:[_h,ku,Yd,Mv,Lv,d_]},Lc={findFiberByHostInstance:Vl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Q2={bundleType:Lc.bundleType,version:Lc.version,rendererPackageName:Lc.rendererPackageName,rendererConfig:Lc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Fv(e),e===null?null:e.stateNode},findFiberByHostInstance:Lc.findFiberByHostInstance||K2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sd.isDisabled&&sd.supportsFiber)try{Hd=sd.inject(Q2),As=sd}catch{}}lo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y2;lo.createPortal=function(e,n){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v_(n))throw Error(qe(200));return X2(e,n,null,l)};lo.createRoot=function(e,n){if(!v_(e))throw Error(qe(299));var l=!1,p="",y=g0;return n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(p=n.identifierPrefix),n.onRecoverableError!==void 0&&(y=n.onRecoverableError)),n=__(e,1,!1,null,null,l,!1,p,y),e[ga]=n.current,nh(e.nodeType===8?e.parentNode:e),new y_(n)};lo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(qe(188)):(e=Object.keys(e).join(","),Error(qe(268,e)));return e=Fv(n),e=e===null?null:e.stateNode,e};lo.flushSync=function(e){return Jl(e)};lo.hydrate=function(e,n,l){if(!ap(n))throw Error(qe(200));return lp(null,e,n,!0,l)};lo.hydrateRoot=function(e,n,l){if(!v_(e))throw Error(qe(405));var p=l!=null&&l.hydratedSources||null,y=!1,b="",k=g0;if(l!=null&&(l.unstable_strictMode===!0&&(y=!0),l.identifierPrefix!==void 0&&(b=l.identifierPrefix),l.onRecoverableError!==void 0&&(k=l.onRecoverableError)),n=_0(n,null,e,1,l??null,y,!1,b,k),e[ga]=n.current,nh(e),p)for(e=0;e<p.length;e++)l=p[e],y=l._getVersion,y=y(l._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[l,y]:n.mutableSourceEagerHydrationData.push(l,y);return new sp(n)};lo.render=function(e,n,l){if(!ap(n))throw Error(qe(200));return lp(null,e,n,!1,l)};lo.unmountComponentAtNode=function(e){if(!ap(e))throw Error(qe(40));return e._reactRootContainer?(Jl(function(){lp(null,null,e,!1,function(){e._reactRootContainer=null,e[ga]=null})}),!0):!1};lo.unstable_batchedUpdates=d_;lo.unstable_renderSubtreeIntoContainer=function(e,n,l,p){if(!ap(l))throw Error(qe(200));if(e==null||e._reactInternals===void 0)throw Error(qe(38));return lp(e,n,l,!1,p)};lo.version="18.2.0-next-9e3b772b8-20220608";(function(e){function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(l){console.error(l)}}n(),e.exports=lo})(Kw);var rv=Cf;Pf.createRoot=rv.createRoot,Pf.hydrateRoot=rv.hydrateRoot;var Te={},eT={get exports(){return Te},set exports(e){Te=e}};/* @preserve
 * Leaflet 1.9.3, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2022 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(e,n){(function(l,p){p(n)})(uv,function(l){var p="1.9.3";function y(s){var d,w,E,M;for(w=1,E=arguments.length;w<E;w++){M=arguments[w];for(d in M)s[d]=M[d]}return s}var b=Object.create||function(){function s(){}return function(d){return s.prototype=d,new s}}();function k(s,d){var w=Array.prototype.slice;if(s.bind)return s.bind.apply(s,w.call(arguments,1));var E=w.call(arguments,2);return function(){return s.apply(d,E.length?E.concat(w.call(arguments)):arguments)}}var c=0;function q(s){return"_leaflet_id"in s||(s._leaflet_id=++c),s._leaflet_id}function le(s,d,w){var E,M,V,re;return re=function(){E=!1,M&&(V.apply(w,M),M=!1)},V=function(){E?M=arguments:(s.apply(w,arguments),setTimeout(re,d),E=!0)},V}function Ie(s,d,w){var E=d[1],M=d[0],V=E-M;return s===E&&w?s:((s-M)%V+V)%V+M}function ge(){return!1}function K(s,d){if(d===!1)return s;var w=Math.pow(10,d===void 0?6:d);return Math.round(s*w)/w}function Ze(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function Ve(s){return Ze(s).split(/\s+/)}function De(s,d){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?b(s.options):{});for(var w in d)s.options[w]=d[w];return s.options}function Qt(s,d,w){var E=[];for(var M in s)E.push(encodeURIComponent(w?M.toUpperCase():M)+"="+encodeURIComponent(s[M]));return(!d||d.indexOf("?")===-1?"?":"&")+E.join("&")}var ye=/\{ *([\w_ -]+) *\}/g;function ue(s,d){return s.replace(ye,function(w,E){var M=d[E];if(M===void 0)throw new Error("No value provided for variable "+w);return typeof M=="function"&&(M=M(d)),M})}var me=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function Ue(s,d){for(var w=0;w<s.length;w++)if(s[w]===d)return w;return-1}var $e="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function lt(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var dt=0;function pt(s){var d=+new Date,w=Math.max(0,16-(d-dt));return dt=d+w,window.setTimeout(s,w)}var ci=window.requestAnimationFrame||lt("RequestAnimationFrame")||pt,Ct=window.cancelAnimationFrame||lt("CancelAnimationFrame")||lt("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function ei(s,d,w){if(w&&ci===pt)s.call(d);else return ci.call(window,k(s,d))}function _i(s){s&&Ct.call(window,s)}var $n={__proto__:null,extend:y,create:b,bind:k,get lastId(){return c},stamp:q,throttle:le,wrapNum:Ie,falseFn:ge,formatNum:K,trim:Ze,splitWords:Ve,setOptions:De,getParamString:Qt,template:ue,isArray:me,indexOf:Ue,emptyImageUrl:$e,requestFn:ci,cancelFn:Ct,requestAnimFrame:ei,cancelAnimFrame:_i};function Ni(){}Ni.extend=function(s){var d=function(){De(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},w=d.__super__=this.prototype,E=b(w);E.constructor=d,d.prototype=E;for(var M in this)Object.prototype.hasOwnProperty.call(this,M)&&M!=="prototype"&&M!=="__super__"&&(d[M]=this[M]);return s.statics&&y(d,s.statics),s.includes&&(xr(s.includes),y.apply(null,[E].concat(s.includes))),y(E,s),delete E.statics,delete E.includes,E.options&&(E.options=w.options?b(w.options):{},y(E.options,s.options)),E._initHooks=[],E.callInitHooks=function(){if(!this._initHooksCalled){w.callInitHooks&&w.callInitHooks.call(this),this._initHooksCalled=!0;for(var V=0,re=E._initHooks.length;V<re;V++)E._initHooks[V].call(this)}},d},Ni.include=function(s){var d=this.prototype.options;return y(this.prototype,s),s.options&&(this.prototype.options=d,this.mergeOptions(s.options)),this},Ni.mergeOptions=function(s){return y(this.prototype.options,s),this},Ni.addInitHook=function(s){var d=Array.prototype.slice.call(arguments,1),w=typeof s=="function"?s:function(){this[s].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(w),this};function xr(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=me(s)?s:[s];for(var d=0;d<s.length;d++)s[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ut={on:function(s,d,w){if(typeof s=="object")for(var E in s)this._on(E,s[E],d);else{s=Ve(s);for(var M=0,V=s.length;M<V;M++)this._on(s[M],d,w)}return this},off:function(s,d,w){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var E in s)this._off(E,s[E],d);else{s=Ve(s);for(var M=arguments.length===1,V=0,re=s.length;V<re;V++)M?this._off(s[V]):this._off(s[V],d,w)}return this},_on:function(s,d,w,E){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(s,d,w)===!1){w===this&&(w=void 0);var M={fn:d,ctx:w};E&&(M.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(M)}},_off:function(s,d,w){var E,M,V;if(this._events&&(E=this._events[s],!!E)){if(arguments.length===1){if(this._firingCount)for(M=0,V=E.length;M<V;M++)E[M].fn=ge;delete this._events[s];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var re=this._listens(s,d,w);if(re!==!1){var oe=E[re];this._firingCount&&(oe.fn=ge,this._events[s]=E=E.slice()),E.splice(re,1)}}},fire:function(s,d,w){if(!this.listens(s,w))return this;var E=y({},d,{type:s,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var M=this._events[s];if(M){this._firingCount=this._firingCount+1||1;for(var V=0,re=M.length;V<re;V++){var oe=M[V],he=oe.fn;oe.once&&this.off(s,he,oe.ctx),he.call(oe.ctx||this,E)}this._firingCount--}}return w&&this._propagateEvent(E),this},listens:function(s,d,w,E){typeof s!="string"&&console.warn('"string" type argument expected');var M=d;typeof d!="function"&&(E=!!d,M=void 0,w=void 0);var V=this._events&&this._events[s];if(V&&V.length&&this._listens(s,M,w)!==!1)return!0;if(E){for(var re in this._eventParents)if(this._eventParents[re].listens(s,d,w,E))return!0}return!1},_listens:function(s,d,w){if(!this._events)return!1;var E=this._events[s]||[];if(!d)return!!E.length;w===this&&(w=void 0);for(var M=0,V=E.length;M<V;M++)if(E[M].fn===d&&E[M].ctx===w)return M;return!1},once:function(s,d,w){if(typeof s=="object")for(var E in s)this._on(E,s[E],d,!0);else{s=Ve(s);for(var M=0,V=s.length;M<V;M++)this._on(s[M],d,w,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[q(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[q(s)],this},_propagateEvent:function(s){for(var d in this._eventParents)this._eventParents[d].fire(s.type,y({layer:s.target,propagatedFrom:s.target},s),!0)}};ut.addEventListener=ut.on,ut.removeEventListener=ut.clearAllEventListeners=ut.off,ut.addOneTimeEventListener=ut.once,ut.fireEvent=ut.fire,ut.hasEventListeners=ut.listens;var Ji=Ni.extend(ut);function Re(s,d,w){this.x=w?Math.round(s):s,this.y=w?Math.round(d):d}var vt=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};Re.prototype={clone:function(){return new Re(this.x,this.y)},add:function(s){return this.clone()._add(Ge(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(Ge(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new Re(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new Re(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=vt(this.x),this.y=vt(this.y),this},distanceTo:function(s){s=Ge(s);var d=s.x-this.x,w=s.y-this.y;return Math.sqrt(d*d+w*w)},equals:function(s){return s=Ge(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=Ge(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+K(this.x)+", "+K(this.y)+")"}};function Ge(s,d,w){return s instanceof Re?s:me(s)?new Re(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new Re(s.x,s.y):new Re(s,d,w)}function Tt(s,d){if(s)for(var w=d?[s,d]:s,E=0,M=w.length;E<M;E++)this.extend(w[E])}Tt.prototype={extend:function(s){var d,w;if(!s)return this;if(s instanceof Re||typeof s[0]=="number"||"x"in s)d=w=Ge(s);else if(s=Ut(s),d=s.min,w=s.max,!d||!w)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=w.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(w.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(w.y,this.max.y)),this},getCenter:function(s){return Ge((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return Ge(this.min.x,this.max.y)},getTopRight:function(){return Ge(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var d,w;return typeof s[0]=="number"||s instanceof Re?s=Ge(s):s=Ut(s),s instanceof Tt?(d=s.min,w=s.max):d=w=s,d.x>=this.min.x&&w.x<=this.max.x&&d.y>=this.min.y&&w.y<=this.max.y},intersects:function(s){s=Ut(s);var d=this.min,w=this.max,E=s.min,M=s.max,V=M.x>=d.x&&E.x<=w.x,re=M.y>=d.y&&E.y<=w.y;return V&&re},overlaps:function(s){s=Ut(s);var d=this.min,w=this.max,E=s.min,M=s.max,V=M.x>d.x&&E.x<w.x,re=M.y>d.y&&E.y<w.y;return V&&re},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var d=this.min,w=this.max,E=Math.abs(d.x-w.x)*s,M=Math.abs(d.y-w.y)*s;return Ut(Ge(d.x-E,d.y-M),Ge(w.x+E,w.y+M))},equals:function(s){return s?(s=Ut(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Ut(s,d){return!s||s instanceof Tt?s:new Tt(s,d)}function bi(s,d){if(s)for(var w=d?[s,d]:s,E=0,M=w.length;E<M;E++)this.extend(w[E])}bi.prototype={extend:function(s){var d=this._southWest,w=this._northEast,E,M;if(s instanceof Lt)E=s,M=s;else if(s instanceof bi){if(E=s._southWest,M=s._northEast,!E||!M)return this}else return s?this.extend(Dt(s)||ni(s)):this;return!d&&!w?(this._southWest=new Lt(E.lat,E.lng),this._northEast=new Lt(M.lat,M.lng)):(d.lat=Math.min(E.lat,d.lat),d.lng=Math.min(E.lng,d.lng),w.lat=Math.max(M.lat,w.lat),w.lng=Math.max(M.lng,w.lng)),this},pad:function(s){var d=this._southWest,w=this._northEast,E=Math.abs(d.lat-w.lat)*s,M=Math.abs(d.lng-w.lng)*s;return new bi(new Lt(d.lat-E,d.lng-M),new Lt(w.lat+E,w.lng+M))},getCenter:function(){return new Lt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Lt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Lt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Lt||"lat"in s?s=Dt(s):s=ni(s);var d=this._southWest,w=this._northEast,E,M;return s instanceof bi?(E=s.getSouthWest(),M=s.getNorthEast()):E=M=s,E.lat>=d.lat&&M.lat<=w.lat&&E.lng>=d.lng&&M.lng<=w.lng},intersects:function(s){s=ni(s);var d=this._southWest,w=this._northEast,E=s.getSouthWest(),M=s.getNorthEast(),V=M.lat>=d.lat&&E.lat<=w.lat,re=M.lng>=d.lng&&E.lng<=w.lng;return V&&re},overlaps:function(s){s=ni(s);var d=this._southWest,w=this._northEast,E=s.getSouthWest(),M=s.getNorthEast(),V=M.lat>d.lat&&E.lat<w.lat,re=M.lng>d.lng&&E.lng<w.lng;return V&&re},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,d){return s?(s=ni(s),this._southWest.equals(s.getSouthWest(),d)&&this._northEast.equals(s.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ni(s,d){return s instanceof bi?s:new bi(s,d)}function Lt(s,d,w){if(isNaN(s)||isNaN(d))throw new Error("Invalid LatLng object: ("+s+", "+d+")");this.lat=+s,this.lng=+d,w!==void 0&&(this.alt=+w)}Lt.prototype={equals:function(s,d){if(!s)return!1;s=Dt(s);var w=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return w<=(d===void 0?1e-9:d)},toString:function(s){return"LatLng("+K(this.lat,s)+", "+K(this.lng,s)+")"},distanceTo:function(s){return pn.distance(this,Dt(s))},wrap:function(){return pn.wrapLatLng(this)},toBounds:function(s){var d=180*s/40075017,w=d/Math.cos(Math.PI/180*this.lat);return ni([this.lat-d,this.lng-w],[this.lat+d,this.lng+w])},clone:function(){return new Lt(this.lat,this.lng,this.alt)}};function Dt(s,d,w){return s instanceof Lt?s:me(s)&&typeof s[0]!="object"?s.length===3?new Lt(s[0],s[1],s[2]):s.length===2?new Lt(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Lt(s.lat,"lng"in s?s.lng:s.lon,s.alt):d===void 0?null:new Lt(s,d,w)}var Ai={latLngToPoint:function(s,d){var w=this.projection.project(s),E=this.scale(d);return this.transformation._transform(w,E)},pointToLatLng:function(s,d){var w=this.scale(d),E=this.transformation.untransform(s,w);return this.projection.unproject(E)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var d=this.projection.bounds,w=this.scale(s),E=this.transformation.transform(d.min,w),M=this.transformation.transform(d.max,w);return new Tt(E,M)},infinite:!1,wrapLatLng:function(s){var d=this.wrapLng?Ie(s.lng,this.wrapLng,!0):s.lng,w=this.wrapLat?Ie(s.lat,this.wrapLat,!0):s.lat,E=s.alt;return new Lt(w,d,E)},wrapLatLngBounds:function(s){var d=s.getCenter(),w=this.wrapLatLng(d),E=d.lat-w.lat,M=d.lng-w.lng;if(E===0&&M===0)return s;var V=s.getSouthWest(),re=s.getNorthEast(),oe=new Lt(V.lat-E,V.lng-M),he=new Lt(re.lat-E,re.lng-M);return new bi(oe,he)}},pn=y({},Ai,{wrapLng:[-180,180],R:6371e3,distance:function(s,d){var w=Math.PI/180,E=s.lat*w,M=d.lat*w,V=Math.sin((d.lat-s.lat)*w/2),re=Math.sin((d.lng-s.lng)*w/2),oe=V*V+Math.cos(E)*Math.cos(M)*re*re,he=2*Math.atan2(Math.sqrt(oe),Math.sqrt(1-oe));return this.R*he}}),fn=6378137,co={R:fn,MAX_LATITUDE:85.0511287798,project:function(s){var d=Math.PI/180,w=this.MAX_LATITUDE,E=Math.max(Math.min(w,s.lat),-w),M=Math.sin(E*d);return new Re(this.R*s.lng*d,this.R*Math.log((1+M)/(1-M))/2)},unproject:function(s){var d=180/Math.PI;return new Lt((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*d,s.x*d/this.R)},bounds:function(){var s=fn*Math.PI;return new Tt([-s,-s],[s,s])}()};function Bo(s,d,w,E){if(me(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=d,this._c=w,this._d=E}Bo.prototype={transform:function(s,d){return this._transform(s.clone(),d)},_transform:function(s,d){return d=d||1,s.x=d*(this._a*s.x+this._b),s.y=d*(this._c*s.y+this._d),s},untransform:function(s,d){return d=d||1,new Re((s.x/d-this._b)/this._a,(s.y/d-this._d)/this._c)}};function Dn(s,d,w,E){return new Bo(s,d,w,E)}var mn=y({},pn,{code:"EPSG:3857",projection:co,transformation:function(){var s=.5/(Math.PI*co.R);return Dn(s,.5,-s,.5)}()}),Ms=y({},mn,{code:"EPSG:900913"});function Vr(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Oo(s,d){var w="",E,M,V,re,oe,he;for(E=0,V=s.length;E<V;E++){for(oe=s[E],M=0,re=oe.length;M<re;M++)he=oe[M],w+=(M?"L":"M")+he.x+" "+he.y;w+=d?Z.svg?"z":"x":""}return w||"M0 0"}var ho=document.documentElement.style,po="ActiveXObject"in window,qt=po&&!document.addEventListener,or="msLaunchUri"in navigator&&!("documentMode"in document),wr=nn("webkit"),Zr=nn("android"),ps=nn("android 2")||nn("android 3"),Gr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),jr=Zr&&nn("Google")&&Gr<537&&!("AudioNode"in window),fo=!!window.opera,br=!or&&nn("chrome"),ke=nn("gecko")&&!wr&&!fo&&!po,Xe=!br&&nn("safari"),mo=nn("phantom"),Wn="OTransition"in ho,$t=navigator.platform.indexOf("Win")===0,Rn=po&&"transition"in ho,_n="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ps,bn="MozPerspective"in ho,_o=!window.L_DISABLE_3D&&(Rn||_n||bn)&&!Wn&&!mo,je=typeof orientation<"u"||nn("mobile"),At=je&&wr,Pt=je&&_n,$i=!window.PointerEvent&&window.MSPointerEvent,qr=!!(window.PointerEvent||$i),St="ontouchstart"in window||!!window.TouchEvent,$r=!window.L_NO_TOUCH&&(St||qr),Wi=je&&fo,fs=je&&ke,Di=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,gn=function(){var s=!1;try{var d=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",ge,d),window.removeEventListener("testPassiveEventSupport",ge,d)}catch{}return s}(),oi=function(){return!!document.createElement("canvas").getContext}(),go=!!(document.createElementNS&&Vr("svg").createSVGRect),Tr=!!go&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Fo=!go&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var d=s.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}}(),No=navigator.platform.indexOf("Mac")===0,ms=navigator.platform.indexOf("Linux")===0;function nn(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Z={ie:po,ielt9:qt,edge:or,webkit:wr,android:Zr,android23:ps,androidStock:jr,opera:fo,chrome:br,gecko:ke,safari:Xe,phantom:mo,opera12:Wn,win:$t,ie3d:Rn,webkit3d:_n,gecko3d:bn,any3d:_o,mobile:je,mobileWebkit:At,mobileWebkit3d:Pt,msPointer:$i,pointer:qr,touch:$r,touchNative:St,mobileOpera:Wi,mobileGecko:fs,retina:Di,passiveEvents:gn,canvas:oi,svg:go,vml:Fo,inlineSvg:Tr,mac:No,linux:ms},D=Z.msPointer?"MSPointerDown":"pointerdown",F=Z.msPointer?"MSPointerMove":"pointermove",W=Z.msPointer?"MSPointerUp":"pointerup",H=Z.msPointer?"MSPointerCancel":"pointercancel",ie={touchstart:D,touchmove:F,touchend:W,touchcancel:H},ce={touchstart:yt,touchmove:Ye,touchend:Ye,touchcancel:Ye},se={},ne=!1;function de(s,d,w){return d==="touchstart"&&ct(),ce[d]?(w=ce[d].bind(this,w),s.addEventListener(ie[d],w,!1),w):(console.warn("wrong event specified:",d),ge)}function Pe(s,d,w){if(!ie[d]){console.warn("wrong event specified:",d);return}s.removeEventListener(ie[d],w,!1)}function Be(s){se[s.pointerId]=s}function Ee(s){se[s.pointerId]&&(se[s.pointerId]=s)}function at(s){delete se[s.pointerId]}function ct(){ne||(document.addEventListener(D,Be,!0),document.addEventListener(F,Ee,!0),document.addEventListener(W,at,!0),document.addEventListener(H,at,!0),ne=!0)}function Ye(s,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var w in se)d.touches.push(se[w]);d.changedTouches=[d],s(d)}}function yt(s,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&zi(d),Ye(s,d)}function xt(s){var d={},w,E;for(E in s)w=s[E],d[E]=w&&w.bind?w.bind(s):w;return s=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Wt=200;function Et(s,d){s.addEventListener("dblclick",d);var w=0,E;function M(V){if(V.detail!==1){E=V.detail;return}if(!(V.pointerType==="mouse"||V.sourceCapabilities&&!V.sourceCapabilities.firesTouchEvents)){var re=_l(V);if(!(re.some(function(he){return he instanceof HTMLLabelElement&&he.attributes.for})&&!re.some(function(he){return he instanceof HTMLInputElement||he instanceof HTMLSelectElement}))){var oe=Date.now();oe-w<=Wt?(E++,E===2&&d(xt(V))):E=1,w=oe}}}return s.addEventListener("click",M),{dblclick:d,simDblclick:M}}function zt(s,d){s.removeEventListener("dblclick",d.dblclick),s.removeEventListener("click",d.simDblclick)}var Vt=Ls(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Jt=Ls(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ui=Jt==="webkitTransition"||Jt==="OTransition"?Jt+"End":"transitionend";function gi(s){return typeof s=="string"?document.getElementById(s):s}function Ri(s,d){var w=s.style[d]||s.currentStyle&&s.currentStyle[d];if((!w||w==="auto")&&document.defaultView){var E=document.defaultView.getComputedStyle(s,null);w=E?E[d]:null}return w==="auto"?null:w}function Gt(s,d,w){var E=document.createElement(s);return E.className=d||"",w&&w.appendChild(E),E}function di(s){var d=s.parentNode;d&&d.removeChild(s)}function ti(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function yo(s){var d=s.parentNode;d&&d.lastChild!==s&&d.appendChild(s)}function vo(s){var d=s.parentNode;d&&d.firstChild!==s&&d.insertBefore(s,d.firstChild)}function wa(s,d){if(s.classList!==void 0)return s.classList.contains(d);var w=Uo(s);return w.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(w)}function Rt(s,d){if(s.classList!==void 0)for(var w=Ve(d),E=0,M=w.length;E<M;E++)s.classList.add(w[E]);else if(!wa(s,d)){var V=Uo(s);fl(s,(V?V+" ":"")+d)}}function Ei(s,d){s.classList!==void 0?s.classList.remove(d):fl(s,Ze((" "+Uo(s)+" ").replace(" "+d+" "," ")))}function fl(s,d){s.className.baseVal===void 0?s.className=d:s.className.baseVal=d}function Uo(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Tn(s,d){"opacity"in s.style?s.style.opacity=d:"filter"in s.style&&eu(s,d)}function eu(s,d){var w=!1,E="DXImageTransform.Microsoft.Alpha";try{w=s.filters.item(E)}catch{if(d===1)return}d=Math.round(d*100),w?(w.Enabled=d!==100,w.Opacity=d):s.style.filter+=" progid:"+E+"(opacity="+d+")"}function Ls(s){for(var d=document.documentElement.style,w=0;w<s.length;w++)if(s[w]in d)return s[w];return!1}function xo(s,d,w){var E=d||new Re(0,0);s.style[Vt]=(Z.ie3d?"translate("+E.x+"px,"+E.y+"px)":"translate3d("+E.x+"px,"+E.y+"px,0)")+(w?" scale("+w+")":"")}function yi(s,d){s._leaflet_pos=d,Z.any3d?xo(s,d):(s.style.left=d.x+"px",s.style.top=d.y+"px")}function sr(s){return s._leaflet_pos||new Re(0,0)}var Sr,wo,_s;if("onselectstart"in document)Sr=function(){Mt(window,"selectstart",zi)},wo=function(){vi(window,"selectstart",zi)};else{var Er=Ls(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Sr=function(){if(Er){var s=document.documentElement.style;_s=s[Er],s[Er]="none"}},wo=function(){Er&&(document.documentElement.style[Er]=_s,_s=void 0)}}function Ds(){Mt(window,"dragstart",zi)}function gs(){vi(window,"dragstart",zi)}var bo,pi;function Vo(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Rs(),bo=s,pi=s.style.outline,s.style.outline="none",Mt(window,"keydown",Rs))}function Rs(){bo&&(bo.style.outline=pi,bo=void 0,pi=void 0,vi(window,"keydown",Rs))}function ml(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Bs(s){var d=s.getBoundingClientRect();return{x:d.width/s.offsetWidth||1,y:d.height/s.offsetHeight||1,boundingClientRect:d}}var ba={__proto__:null,TRANSFORM:Vt,TRANSITION:Jt,TRANSITION_END:Ui,get:gi,getStyle:Ri,create:Gt,remove:di,empty:ti,toFront:yo,toBack:vo,hasClass:wa,addClass:Rt,removeClass:Ei,setClass:fl,getClass:Uo,setOpacity:Tn,testProp:Ls,setTransform:xo,setPosition:yi,getPosition:sr,get disableTextSelection(){return Sr},get enableTextSelection(){return wo},disableImageDrag:Ds,enableImageDrag:gs,preventOutline:Vo,restoreOutline:Rs,getSizedParentNode:ml,getScale:Bs};function Mt(s,d,w,E){if(d&&typeof d=="object")for(var M in d)Fs(s,M,d[M],w);else{d=Ve(d);for(var V=0,re=d.length;V<re;V++)Fs(s,d[V],w,E)}return this}var Pr="_leaflet_events";function vi(s,d,w,E){if(arguments.length===1)Ta(s),delete s[Pr];else if(d&&typeof d=="object")for(var M in d)Ns(s,M,d[M],w);else if(d=Ve(d),arguments.length===2)Ta(s,function(oe){return Ue(d,oe)!==-1});else for(var V=0,re=d.length;V<re;V++)Ns(s,d[V],w,E);return this}function Ta(s,d){for(var w in s[Pr]){var E=w.split(/\d/)[0];(!d||d(E))&&Ns(s,E,null,null,w)}}var Os={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Fs(s,d,w,E){var M=d+q(w)+(E?"_"+q(E):"");if(s[Pr]&&s[Pr][M])return this;var V=function(oe){return w.call(E||s,oe||window.event)},re=V;!Z.touchNative&&Z.pointer&&d.indexOf("touch")===0?V=de(s,d,V):Z.touch&&d==="dblclick"?V=Et(s,V):"addEventListener"in s?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?s.addEventListener(Os[d]||d,V,Z.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(V=function(oe){oe=oe||window.event,ys(s,oe)&&re(oe)},s.addEventListener(Os[d],V,!1)):s.addEventListener(d,re,!1):s.attachEvent("on"+d,V),s[Pr]=s[Pr]||{},s[Pr][M]=V}function Ns(s,d,w,E,M){M=M||d+q(w)+(E?"_"+q(E):"");var V=s[Pr]&&s[Pr][M];if(!V)return this;!Z.touchNative&&Z.pointer&&d.indexOf("touch")===0?Pe(s,d,V):Z.touch&&d==="dblclick"?zt(s,V):"removeEventListener"in s?s.removeEventListener(Os[d]||d,V,!1):s.detachEvent("on"+d,V),s[Pr][M]=null}function Ft(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Sa(s){return Fs(s,"wheel",Ft),this}function Us(s){return Mt(s,"mousedown touchstart dblclick contextmenu",Ft),s._leaflet_disable_click=!0,this}function zi(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function ar(s){return zi(s),Ft(s),this}function _l(s){if(s.composedPath)return s.composedPath();for(var d=[],w=s.target;w;)d.push(w),w=w.parentNode;return d}function Sn(s,d){if(!d)return new Re(s.clientX,s.clientY);var w=Bs(d),E=w.boundingClientRect;return new Re((s.clientX-E.left)/w.x-d.clientLeft,(s.clientY-E.top)/w.y-d.clientTop)}var gl=Z.linux&&Z.chrome?window.devicePixelRatio:Z.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Vs(s){return Z.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/gl:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function ys(s,d){var w=d.relatedTarget;if(!w)return!0;try{for(;w&&w!==s;)w=w.parentNode}catch{return!1}return w!==s}var yl={__proto__:null,on:Mt,off:vi,stopPropagation:Ft,disableScrollPropagation:Sa,disableClickPropagation:Us,preventDefault:zi,stop:ar,getPropagationPath:_l,getMousePosition:Sn,getWheelDelta:Vs,isExternalTarget:ys,addListener:Mt,removeListener:vi},Ea=Ji.extend({run:function(s,d,w,E){this.stop(),this._el=s,this._inProgress=!0,this._duration=w||.25,this._easeOutPower=1/Math.max(E||.5,.2),this._startPos=sr(s),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ei(this._animate,this),this._step()},_step:function(s){var d=+new Date-this._startTime,w=this._duration*1e3;d<w?this._runFrame(this._easeOut(d/w),s):(this._runFrame(1),this._complete())},_runFrame:function(s,d){var w=this._startPos.add(this._offset.multiplyBy(s));d&&w._round(),yi(this._el,w),this.fire("step")},_complete:function(){_i(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),jt=Ji.extend({options:{crs:mn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,d){d=De(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=k(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(Dt(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Jt&&Z.any3d&&!Z.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Mt(this._proxy,Ui,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,d,w){if(d=d===void 0?this._zoom:this._limitZoom(d),s=this._limitCenter(Dt(s),d,this.options.maxBounds),w=w||{},this._stop(),this._loaded&&!w.reset&&w!==!0){w.animate!==void 0&&(w.zoom=y({animate:w.animate},w.zoom),w.pan=y({animate:w.animate,duration:w.duration},w.pan));var E=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,d,w.zoom):this._tryAnimatedPan(s,w.pan);if(E)return clearTimeout(this._sizeTimer),this}return this._resetView(s,d,w.pan&&w.pan.noMoveStart),this},setZoom:function(s,d){return this._loaded?this.setView(this.getCenter(),s,{zoom:d}):(this._zoom=s,this)},zoomIn:function(s,d){return s=s||(Z.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,d)},zoomOut:function(s,d){return s=s||(Z.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,d)},setZoomAround:function(s,d,w){var E=this.getZoomScale(d),M=this.getSize().divideBy(2),V=s instanceof Re?s:this.latLngToContainerPoint(s),re=V.subtract(M).multiplyBy(1-1/E),oe=this.containerPointToLatLng(M.add(re));return this.setView(oe,d,{zoom:w})},_getBoundsCenterZoom:function(s,d){d=d||{},s=s.getBounds?s.getBounds():ni(s);var w=Ge(d.paddingTopLeft||d.padding||[0,0]),E=Ge(d.paddingBottomRight||d.padding||[0,0]),M=this.getBoundsZoom(s,!1,w.add(E));if(M=typeof d.maxZoom=="number"?Math.min(d.maxZoom,M):M,M===1/0)return{center:s.getCenter(),zoom:M};var V=E.subtract(w).divideBy(2),re=this.project(s.getSouthWest(),M),oe=this.project(s.getNorthEast(),M),he=this.unproject(re.add(oe).divideBy(2).add(V),M);return{center:he,zoom:M}},fitBounds:function(s,d){if(s=ni(s),!s.isValid())throw new Error("Bounds are not valid.");var w=this._getBoundsCenterZoom(s,d);return this.setView(w.center,w.zoom,d)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,d){return this.setView(s,this._zoom,{pan:d})},panBy:function(s,d){if(s=Ge(s).round(),d=d||{},!s.x&&!s.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ea,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){Rt(this._mapPane,"leaflet-pan-anim");var w=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,w,d.duration||.25,d.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,d,w){if(w=w||{},w.animate===!1||!Z.any3d)return this.setView(s,d,w);this._stop();var E=this.project(this.getCenter()),M=this.project(s),V=this.getSize(),re=this._zoom;s=Dt(s),d=d===void 0?re:d;var oe=Math.max(V.x,V.y),he=oe*this.getZoomScale(re,d),Oe=M.distanceTo(E)||1,rt=1.42,wt=rt*rt;function bt(h){var _=h?-1:1,v=h?he:oe,T=he*he-oe*oe+_*wt*wt*Oe*Oe,C=2*v*wt*Oe,I=T/C,z=Math.sqrt(I*I+1)-I,B=z<1e-9?-18:Math.log(z);return B}function Vi(h){return(Math.exp(h)-Math.exp(-h))/2}function on(h){return(Math.exp(h)+Math.exp(-h))/2}function ea(h){return Vi(h)/on(h)}var yn=bt(0);function Ti(h){return oe*(on(yn)/on(yn+rt*h))}function Bi(h){return oe*(on(yn)*ea(yn+rt*h)-Vi(yn))/wt}function Ml(h){return 1-Math.pow(1-h,1.5)}var es=Date.now(),f=(bt(1)-yn)/rt,i=w.duration?1e3*w.duration:1e3*f*.8;function a(){var h=(Date.now()-es)/i,_=Ml(h)*f;h<=1?(this._flyToFrame=ei(a,this),this._move(this.unproject(E.add(M.subtract(E).multiplyBy(Bi(_)/Oe)),re),this.getScaleZoom(oe/Ti(_),re),{flyTo:!0})):this._move(s,d)._moveEnd(!0)}return this._moveStart(!0,w.noMoveStart),a.call(this),this},flyToBounds:function(s,d){var w=this._getBoundsCenterZoom(s,d);return this.flyTo(w.center,w.zoom,d)},setMaxBounds:function(s){return s=ni(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var d=this.options.minZoom;return this.options.minZoom=s,this._loaded&&d!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var d=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&d!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,d){this._enforcingBounds=!0;var w=this.getCenter(),E=this._limitCenter(w,this._zoom,ni(s));return w.equals(E)||this.panTo(E,d),this._enforcingBounds=!1,this},panInside:function(s,d){d=d||{};var w=Ge(d.paddingTopLeft||d.padding||[0,0]),E=Ge(d.paddingBottomRight||d.padding||[0,0]),M=this.project(this.getCenter()),V=this.project(s),re=this.getPixelBounds(),oe=Ut([re.min.add(w),re.max.subtract(E)]),he=oe.getSize();if(!oe.contains(V)){this._enforcingBounds=!0;var Oe=V.subtract(oe.getCenter()),rt=oe.extend(V).getSize().subtract(he);M.x+=Oe.x<0?-rt.x:rt.x,M.y+=Oe.y<0?-rt.y:rt.y,this.panTo(this.unproject(M),d),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=y({animate:!1,pan:!0},s===!0?{animate:!0}:s);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var w=this.getSize(),E=d.divideBy(2).round(),M=w.divideBy(2).round(),V=E.subtract(M);return!V.x&&!V.y?this:(s.animate&&s.pan?this.panBy(V):(s.pan&&this._rawPanBy(V),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(k(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:w}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=y({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=k(this._handleGeolocationResponse,this),w=k(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,w,s):navigator.geolocation.getCurrentPosition(d,w,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var d=s.code,w=s.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+w+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var d=s.coords.latitude,w=s.coords.longitude,E=new Lt(d,w),M=E.toBounds(s.coords.accuracy*2),V=this._locateOptions;if(V.setView){var re=this.getBoundsZoom(M);this.setView(E,V.maxZoom?Math.min(re,V.maxZoom):re)}var oe={latlng:E,bounds:M,timestamp:s.timestamp};for(var he in s.coords)typeof s.coords[he]=="number"&&(oe[he]=s.coords[he]);this.fire("locationfound",oe)}},addHandler:function(s,d){if(!d)return this;var w=this[s]=new d(this);return this._handlers.push(w),this.options[s]&&w.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),di(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(_i(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)di(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,d){var w="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),E=Gt("div",w,d||this._mapPane);return s&&(this._panes[s]=E),E},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),d=this.unproject(s.getBottomLeft()),w=this.unproject(s.getTopRight());return new bi(d,w)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,d,w){s=ni(s),w=Ge(w||[0,0]);var E=this.getZoom()||0,M=this.getMinZoom(),V=this.getMaxZoom(),re=s.getNorthWest(),oe=s.getSouthEast(),he=this.getSize().subtract(w),Oe=Ut(this.project(oe,E),this.project(re,E)).getSize(),rt=Z.any3d?this.options.zoomSnap:1,wt=he.x/Oe.x,bt=he.y/Oe.y,Vi=d?Math.max(wt,bt):Math.min(wt,bt);return E=this.getScaleZoom(Vi,E),rt&&(E=Math.round(E/(rt/100))*(rt/100),E=d?Math.ceil(E/rt)*rt:Math.floor(E/rt)*rt),Math.max(M,Math.min(V,E))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Re(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,d){var w=this._getTopLeftPoint(s,d);return new Tt(w,w.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,d){var w=this.options.crs;return d=d===void 0?this._zoom:d,w.scale(s)/w.scale(d)},getScaleZoom:function(s,d){var w=this.options.crs;d=d===void 0?this._zoom:d;var E=w.zoom(s*w.scale(d));return isNaN(E)?1/0:E},project:function(s,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(Dt(s),d)},unproject:function(s,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(Ge(s),d)},layerPointToLatLng:function(s){var d=Ge(s).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(s){var d=this.project(Dt(s))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(Dt(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(ni(s))},distance:function(s,d){return this.options.crs.distance(Dt(s),Dt(d))},containerPointToLayerPoint:function(s){return Ge(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return Ge(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var d=this.containerPointToLayerPoint(Ge(s));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Dt(s)))},mouseEventToContainerPoint:function(s){return Sn(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var d=this._container=gi(s);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Mt(d,"scroll",this._onScroll,this),this._containerId=q(d)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Z.any3d,Rt(s,"leaflet-container"+(Z.touch?" leaflet-touch":"")+(Z.retina?" leaflet-retina":"")+(Z.ielt9?" leaflet-oldie":"")+(Z.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=Ri(s,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),yi(this._mapPane,new Re(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Rt(s.markerPane,"leaflet-zoom-hide"),Rt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,d,w){yi(this._mapPane,new Re(0,0));var E=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var M=this._zoom!==d;this._moveStart(M,w)._move(s,d)._moveEnd(M),this.fire("viewreset"),E&&this.fire("load")},_moveStart:function(s,d){return s&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(s,d,w,E){d===void 0&&(d=this._zoom);var M=this._zoom!==d;return this._zoom=d,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),E?w&&w.pinch&&this.fire("zoom",w):((M||w&&w.pinch)&&this.fire("zoom",w),this.fire("move",w)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return _i(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){yi(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[q(this._container)]=this;var d=s?vi:Mt;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),Z.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){_i(this._resizeRequest),this._resizeRequest=ei(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,d){for(var w=[],E,M=d==="mouseout"||d==="mouseover",V=s.target||s.srcElement,re=!1;V;){if(E=this._targets[q(V)],E&&(d==="click"||d==="preclick")&&this._draggableMoved(E)){re=!0;break}if(E&&E.listens(d,!0)&&(M&&!ys(V,s)||(w.push(E),M))||V===this._container)break;V=V.parentNode}return!w.length&&!re&&!M&&this.listens(d,!0)&&(w=[this]),w},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var d=s.target||s.srcElement;if(!(!this._loaded||d._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(d))){var w=s.type;w==="mousedown"&&Vo(d),this._fireDOMEvent(s,w)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,d,w){if(s.type==="click"){var E=y({},s);E.type="preclick",this._fireDOMEvent(E,E.type,w)}var M=this._findEventTargets(s,d);if(w){for(var V=[],re=0;re<w.length;re++)w[re].listens(d,!0)&&V.push(w[re]);M=V.concat(M)}if(M.length){d==="contextmenu"&&zi(s);var oe=M[0],he={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Oe=oe.getLatLng&&(!oe._radius||oe._radius<=10);he.containerPoint=Oe?this.latLngToContainerPoint(oe.getLatLng()):this.mouseEventToContainerPoint(s),he.layerPoint=this.containerPointToLayerPoint(he.containerPoint),he.latlng=Oe?oe.getLatLng():this.layerPointToLatLng(he.layerPoint)}for(re=0;re<M.length;re++)if(M[re].fire(d,he,!0),he.originalEvent._stopped||M[re].options.bubblingMouseEvents===!1&&Ue(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,d=this._handlers.length;s<d;s++)this._handlers[s].disable()},whenReady:function(s,d){return this._loaded?s.call(d||this,{target:this}):this.on("load",s,d),this},_getMapPanePos:function(){return sr(this._mapPane)||new Re(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,d){var w=s&&d!==void 0?this._getNewPixelOrigin(s,d):this.getPixelOrigin();return w.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,d){var w=this.getSize()._divideBy(2);return this.project(s,d)._subtract(w)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,d,w){var E=this._getNewPixelOrigin(w,d);return this.project(s,d)._subtract(E)},_latLngBoundsToNewLayerBounds:function(s,d,w){var E=this._getNewPixelOrigin(w,d);return Ut([this.project(s.getSouthWest(),d)._subtract(E),this.project(s.getNorthWest(),d)._subtract(E),this.project(s.getSouthEast(),d)._subtract(E),this.project(s.getNorthEast(),d)._subtract(E)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,d,w){if(!w)return s;var E=this.project(s,d),M=this.getSize().divideBy(2),V=new Tt(E.subtract(M),E.add(M)),re=this._getBoundsOffset(V,w,d);return Math.abs(re.x)<=1&&Math.abs(re.y)<=1?s:this.unproject(E.add(re),d)},_limitOffset:function(s,d){if(!d)return s;var w=this.getPixelBounds(),E=new Tt(w.min.add(s),w.max.add(s));return s.add(this._getBoundsOffset(E,d))},_getBoundsOffset:function(s,d,w){var E=Ut(this.project(d.getNorthEast(),w),this.project(d.getSouthWest(),w)),M=E.min.subtract(s.min),V=E.max.subtract(s.max),re=this._rebound(M.x,-V.x),oe=this._rebound(M.y,-V.y);return new Re(re,oe)},_rebound:function(s,d){return s+d>0?Math.round(s-d)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(d))},_limitZoom:function(s){var d=this.getMinZoom(),w=this.getMaxZoom(),E=Z.any3d?this.options.zoomSnap:1;return E&&(s=Math.round(s/E)*E),Math.max(d,Math.min(w,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Ei(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,d){var w=this._getCenterOffset(s)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(w)?!1:(this.panBy(w,d),!0)},_createAnimProxy:function(){var s=this._proxy=Gt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(d){var w=Vt,E=this._proxy.style[w];xo(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),E===this._proxy.style[w]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){di(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),d=this.getZoom();xo(this._proxy,this.project(s,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,d,w){if(this._animatingZoom)return!0;if(w=w||{},!this._zoomAnimated||w.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var E=this.getZoomScale(d),M=this._getCenterOffset(s)._divideBy(1-1/E);return w.animate!==!0&&!this.getSize().contains(M)?!1:(ei(function(){this._moveStart(!0,!1)._animateZoom(s,d,!0)},this),!0)},_animateZoom:function(s,d,w,E){this._mapPane&&(w&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=d,Rt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:d,noUpdate:E}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(k(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Ei(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function vl(s,d){return new jt(s,d)}var Bn=Ni.extend({options:{position:"topright"},initialize:function(s){De(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var d=this._map;return d&&d.removeControl(this),this.options.position=s,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var d=this._container=this.onAdd(s),w=this.getPosition(),E=s._controlCorners[w];return Rt(d,"leaflet-control"),w.indexOf("bottom")!==-1?E.insertBefore(d,E.firstChild):E.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(di(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),To=function(s){return new Bn(s)};jt.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},d="leaflet-",w=this._controlContainer=Gt("div",d+"control-container",this._container);function E(M,V){var re=d+M+" "+d+V;s[M+V]=Gt("div",re,w)}E("top","left"),E("top","right"),E("bottom","left"),E("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)di(this._controlCorners[s]);di(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var xl=Bn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,d,w,E){return w<E?-1:E<w?1:0}},initialize:function(s,d,w){De(this,w),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var E in s)this._addLayer(s[E],E);for(E in d)this._addLayer(d[E],E,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Bn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,d){return this._addLayer(s,d),this._map?this._update():this},addOverlay:function(s,d){return this._addLayer(s,d,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var d=this._getLayer(q(s));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){Rt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(Rt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Ei(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Ei(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",d=this._container=Gt("div",s),w=this.options.collapsed;d.setAttribute("aria-haspopup",!0),Us(d),Sa(d);var E=this._section=Gt("section",s+"-list");w&&(this._map.on("click",this.collapse,this),Mt(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var M=this._layersLink=Gt("a",s+"-toggle",d);M.href="#",M.title="Layers",M.setAttribute("role","button"),Mt(M,{keydown:function(V){V.keyCode===13&&this._expandSafely()},click:function(V){zi(V),this._expandSafely()}},this),w||this.expand(),this._baseLayersList=Gt("div",s+"-base",E),this._separator=Gt("div",s+"-separator",E),this._overlaysList=Gt("div",s+"-overlays",E),d.appendChild(E)},_getLayer:function(s){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&q(this._layers[d].layer)===s)return this._layers[d]},_addLayer:function(s,d,w){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:d,overlay:w}),this.options.sortLayers&&this._layers.sort(k(function(E,M){return this.options.sortFunction(E.layer,M.layer,E.name,M.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ti(this._baseLayersList),ti(this._overlaysList),this._layerControlInputs=[];var s,d,w,E,M=0;for(w=0;w<this._layers.length;w++)E=this._layers[w],this._addItem(E),d=d||E.overlay,s=s||!E.overlay,M+=E.overlay?0:1;return this.options.hideSingleBase&&(s=s&&M>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=d&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var d=this._getLayer(q(s.target)),w=d.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;w&&this._map.fire(w,d)},_createRadioElement:function(s,d){var w='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(d?' checked="checked"':"")+"/>",E=document.createElement("div");return E.innerHTML=w,E.firstChild},_addItem:function(s){var d=document.createElement("label"),w=this._map.hasLayer(s.layer),E;s.overlay?(E=document.createElement("input"),E.type="checkbox",E.className="leaflet-control-layers-selector",E.defaultChecked=w):E=this._createRadioElement("leaflet-base-layers_"+q(this),w),this._layerControlInputs.push(E),E.layerId=q(s.layer),Mt(E,"click",this._onInputClick,this);var M=document.createElement("span");M.innerHTML=" "+s.name;var V=document.createElement("span");d.appendChild(V),V.appendChild(E),V.appendChild(M);var re=s.overlay?this._overlaysList:this._baseLayersList;return re.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){var s=this._layerControlInputs,d,w,E=[],M=[];this._handlingClick=!0;for(var V=s.length-1;V>=0;V--)d=s[V],w=this._getLayer(d.layerId).layer,d.checked?E.push(w):d.checked||M.push(w);for(V=0;V<M.length;V++)this._map.hasLayer(M[V])&&this._map.removeLayer(M[V]);for(V=0;V<E.length;V++)this._map.hasLayer(E[V])||this._map.addLayer(E[V]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,d,w,E=this._map.getZoom(),M=s.length-1;M>=0;M--)d=s[M],w=this._getLayer(d.layerId).layer,d.disabled=w.options.minZoom!==void 0&&E<w.options.minZoom||w.options.maxZoom!==void 0&&E>w.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;Mt(s,"click",zi),this.expand(),setTimeout(function(){vi(s,"click",zi)})}}),tu=function(s,d,w){return new xl(s,d,w)},So=Bn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var d="leaflet-control-zoom",w=Gt("div",d+" leaflet-bar"),E=this.options;return this._zoomInButton=this._createButton(E.zoomInText,E.zoomInTitle,d+"-in",w,this._zoomIn),this._zoomOutButton=this._createButton(E.zoomOutText,E.zoomOutTitle,d+"-out",w,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),w},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,d,w,E,M){var V=Gt("a",w,E);return V.innerHTML=s,V.href="#",V.title=d,V.setAttribute("role","button"),V.setAttribute("aria-label",d),Us(V),Mt(V,"click",ar),Mt(V,"click",M,this),Mt(V,"click",this._refocusOnMap,this),V},_updateDisabled:function(){var s=this._map,d="leaflet-disabled";Ei(this._zoomInButton,d),Ei(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(Rt(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(Rt(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});jt.mergeOptions({zoomControl:!0}),jt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new So,this.addControl(this.zoomControl))});var Qu=function(s){return new So(s)},iu=Bn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var d="leaflet-control-scale",w=Gt("div",d),E=this.options;return this._addScales(E,d+"-line",w),s.on(E.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),w},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,d,w){s.metric&&(this._mScale=Gt("div",d,w)),s.imperial&&(this._iScale=Gt("div",d,w))},_update:function(){var s=this._map,d=s.getSize().y/2,w=s.distance(s.containerPointToLatLng([0,d]),s.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(w)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var d=this._getRoundNum(s),w=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,w,d/s)},_updateImperial:function(s){var d=s*3.2808399,w,E,M;d>5280?(w=d/5280,E=this._getRoundNum(w),this._updateScale(this._iScale,E+" mi",E/w)):(M=this._getRoundNum(d),this._updateScale(this._iScale,M+" ft",M/d))},_updateScale:function(s,d,w){s.style.width=Math.round(this.options.maxWidth*w)+"px",s.innerHTML=d},_getRoundNum:function(s){var d=Math.pow(10,(Math.floor(s)+"").length-1),w=s/d;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:1,d*w}}),ec=function(s){return new iu(s)},tc='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',wl=Bn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Z.inlineSvg?tc+" ":"")+"Leaflet</a>"},initialize:function(s){De(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Gt("div","leaflet-control-attribution"),Us(this._container);for(var d in s._layers)s._layers[d].getAttribution&&this.addAttribution(s._layers[d].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var d in this._attributions)this._attributions[d]&&s.push(d);var w=[];this.options.prefix&&w.push(this.options.prefix),s.length&&w.push(s.join(", ")),this._container.innerHTML=w.join(' <span aria-hidden="true">|</span> ')}}});jt.mergeOptions({attributionControl:!0}),jt.addInitHook(function(){this.options.attributionControl&&new wl().addTo(this)});var ic=function(s){return new wl(s)};Bn.Layers=xl,Bn.Zoom=So,Bn.Scale=iu,Bn.Attribution=wl,To.layers=tu,To.zoom=Qu,To.scale=ec,To.attribution=ic;var Hn=Ni.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Hn.addTo=function(s,d){return s.addHandler(d,this),this};var Pa={Events:ut},Ca=Z.touch?"touchstart mousedown":"mousedown",Cr=Ji.extend({options:{clickTolerance:3},initialize:function(s,d,w,E){De(this,E),this._element=s,this._dragStartTarget=d||s,this._preventOutline=w},enable:function(){this._enabled||(Mt(this._dragStartTarget,Ca,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Cr._dragging===this&&this.finishDrag(!0),vi(this._dragStartTarget,Ca,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!wa(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Cr._dragging===this&&this.finishDrag();return}if(!(Cr._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Cr._dragging=this,this._preventOutline&&Vo(this._element),Ds(),Sr(),!this._moving)){this.fire("down");var d=s.touches?s.touches[0]:s,w=ml(this._element);this._startPoint=new Re(d.clientX,d.clientY),this._startPos=sr(this._element),this._parentScale=Bs(w);var E=s.type==="mousedown";Mt(document,E?"mousemove":"touchmove",this._onMove,this),Mt(document,E?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var d=s.touches&&s.touches.length===1?s.touches[0]:s,w=new Re(d.clientX,d.clientY)._subtract(this._startPoint);!w.x&&!w.y||Math.abs(w.x)+Math.abs(w.y)<this.options.clickTolerance||(w.x/=this._parentScale.x,w.y/=this._parentScale.y,zi(s),this._moved||(this.fire("dragstart"),this._moved=!0,Rt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Rt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(w),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),yi(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Ei(document.body,"leaflet-dragging"),this._lastTarget&&(Ei(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),vi(document,"mousemove touchmove",this._onMove,this),vi(document,"mouseup touchend touchcancel",this._onUp,this),gs(),wo(),this._moved&&this._moving&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,Cr._dragging=!1}});function Zo(s,d){if(!d||!s.length)return s.slice();var w=d*d;return s=ru(s,w),s=Ia(s,w),s}function bl(s,d,w){return Math.sqrt(ri(s,d,w,!0))}function nu(s,d,w){return ri(s,d,w)}function Ia(s,d){var w=s.length,E=typeof Uint8Array!=void 0+""?Uint8Array:Array,M=new E(w);M[0]=M[w-1]=1,Wr(s,M,d,0,w-1);var V,re=[];for(V=0;V<w;V++)M[V]&&re.push(s[V]);return re}function Wr(s,d,w,E,M){var V=0,re,oe,he;for(oe=E+1;oe<=M-1;oe++)he=ri(s[oe],s[E],s[M],!0),he>V&&(re=oe,V=he);V>w&&(d[re]=1,Wr(s,d,w,E,re),Wr(s,d,w,re,M))}function ru(s,d){for(var w=[s[0]],E=1,M=0,V=s.length;E<V;E++)Yt(s[E],s[M])>d&&(w.push(s[E]),M=E);return M<V-1&&w.push(s[V-1]),w}var Go;function fi(s,d,w,E,M){var V=E?Go:It(s,w),re=It(d,w),oe,he,Oe;for(Go=re;;){if(!(V|re))return[s,d];if(V&re)return!1;oe=V||re,he=Zs(s,d,oe,w,M),Oe=It(he,w),oe===V?(s=he,V=Oe):(d=he,re=Oe)}}function Zs(s,d,w,E,M){var V=d.x-s.x,re=d.y-s.y,oe=E.min,he=E.max,Oe,rt;return w&8?(Oe=s.x+V*(he.y-s.y)/re,rt=he.y):w&4?(Oe=s.x+V*(oe.y-s.y)/re,rt=oe.y):w&2?(Oe=he.x,rt=s.y+re*(he.x-s.x)/V):w&1&&(Oe=oe.x,rt=s.y+re*(oe.x-s.x)/V),new Re(Oe,rt,M)}function It(s,d){var w=0;return s.x<d.min.x?w|=1:s.x>d.max.x&&(w|=2),s.y<d.min.y?w|=4:s.y>d.max.y&&(w|=8),w}function Yt(s,d){var w=d.x-s.x,E=d.y-s.y;return w*w+E*E}function ri(s,d,w,E){var M=d.x,V=d.y,re=w.x-M,oe=w.y-V,he=re*re+oe*oe,Oe;return he>0&&(Oe=((s.x-M)*re+(s.y-V)*oe)/he,Oe>1?(M=w.x,V=w.y):Oe>0&&(M+=re*Oe,V+=oe*Oe)),re=s.x-M,oe=s.y-V,E?re*re+oe*oe:new Re(M,V)}function Ht(s){return!me(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function vs(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ht(s)}function jo(s,d){var w,E,M,V,re,oe,he,Oe;if(!s||s.length===0)throw new Error("latlngs not passed");Ht(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var rt=[];for(var wt in s)rt.push(d.project(Dt(s[wt])));var bt=rt.length;for(w=0,E=0;w<bt-1;w++)E+=rt[w].distanceTo(rt[w+1])/2;if(E===0)Oe=rt[0];else for(w=0,V=0;w<bt-1;w++)if(re=rt[w],oe=rt[w+1],M=re.distanceTo(oe),V+=M,V>E){he=(V-E)/M,Oe=[oe.x-he*(oe.x-re.x),oe.y-he*(oe.y-re.y)];break}return d.unproject(Ge(Oe))}var nc={__proto__:null,simplify:Zo,pointToSegmentDistance:bl,closestPointOnSegment:nu,clipSegment:fi,_getEdgeIntersection:Zs,_getBitCode:It,_sqClosestPointOnSegment:ri,isFlat:Ht,_flat:vs,polylineCenter:jo};function ou(s,d,w){var E,M=[1,4,2,8],V,re,oe,he,Oe,rt,wt,bt;for(V=0,rt=s.length;V<rt;V++)s[V]._code=It(s[V],d);for(oe=0;oe<4;oe++){for(wt=M[oe],E=[],V=0,rt=s.length,re=rt-1;V<rt;re=V++)he=s[V],Oe=s[re],he._code&wt?Oe._code&wt||(bt=Zs(Oe,he,wt,d,w),bt._code=It(bt,d),E.push(bt)):(Oe._code&wt&&(bt=Zs(Oe,he,wt,d,w),bt._code=It(bt,d),E.push(bt)),E.push(he));s=E}return s}function Tl(s,d){var w,E,M,V,re,oe,he,Oe,rt;if(!s||s.length===0)throw new Error("latlngs not passed");Ht(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var wt=[];for(var bt in s)wt.push(d.project(Dt(s[bt])));var Vi=wt.length;for(oe=he=Oe=0,w=0,E=Vi-1;w<Vi;E=w++)M=wt[w],V=wt[E],re=M.y*V.x-V.y*M.x,he+=(M.x+V.x)*re,Oe+=(M.y+V.y)*re,oe+=re*3;return oe===0?rt=wt[0]:rt=[he/oe,Oe/oe],d.unproject(Ge(rt))}var rc={__proto__:null,clipPolygon:ou,polygonCenter:Tl},xs={project:function(s){return new Re(s.lng,s.lat)},unproject:function(s){return new Lt(s.y,s.x)},bounds:new Tt([-180,-90],[180,90])},qo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Tt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var d=Math.PI/180,w=this.R,E=s.lat*d,M=this.R_MINOR/w,V=Math.sqrt(1-M*M),re=V*Math.sin(E),oe=Math.tan(Math.PI/4-E/2)/Math.pow((1-re)/(1+re),V/2);return E=-w*Math.log(Math.max(oe,1e-10)),new Re(s.lng*d*w,E)},unproject:function(s){for(var d=180/Math.PI,w=this.R,E=this.R_MINOR/w,M=Math.sqrt(1-E*E),V=Math.exp(-s.y/w),re=Math.PI/2-2*Math.atan(V),oe=0,he=.1,Oe;oe<15&&Math.abs(he)>1e-7;oe++)Oe=M*Math.sin(re),Oe=Math.pow((1-Oe)/(1+Oe),M/2),he=Math.PI/2-2*Math.atan(V*Oe)-re,re+=he;return new Lt(re*d,s.x*d/w)}},Gs={__proto__:null,LonLat:xs,Mercator:qo,SphericalMercator:co},js=y({},pn,{code:"EPSG:3395",projection:qo,transformation:function(){var s=.5/(Math.PI*qo.R);return Dn(s,.5,-s,.5)}()}),ka=y({},pn,{code:"EPSG:4326",projection:xs,transformation:Dn(1/180,1,-1/180,.5)}),su=y({},Ai,{projection:xs,transformation:Dn(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,d){var w=d.lng-s.lng,E=d.lat-s.lat;return Math.sqrt(w*w+E*E)},infinite:!0});Ai.Earth=pn,Ai.EPSG3395=js,Ai.EPSG3857=mn,Ai.EPSG900913=Ms,Ai.EPSG4326=ka,Ai.Simple=su;var En=Ji.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[q(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[q(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var d=s.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var w=this.getEvents();d.on(w,this),this.once("remove",function(){d.off(w,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});jt.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var d=q(s);return this._layers[d]?this:(this._layers[d]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var d=q(s);return this._layers[d]?(this._loaded&&s.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return q(s)in this._layers},eachLayer:function(s,d){for(var w in this._layers)s.call(d,this._layers[w]);return this},_addLayers:function(s){s=s?me(s)?s:[s]:[];for(var d=0,w=s.length;d<w;d++)this.addLayer(s[d])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[q(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var d=q(s);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,d=-1/0,w=this._getZoomSpan();for(var E in this._zoomBoundLayers){var M=this._zoomBoundLayers[E].options;s=M.minZoom===void 0?s:Math.min(s,M.minZoom),d=M.maxZoom===void 0?d:Math.max(d,M.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=s===1/0?void 0:s,w!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Hr=En.extend({initialize:function(s,d){De(this,d),this._layers={};var w,E;if(s)for(w=0,E=s.length;w<E;w++)this.addLayer(s[w])},addLayer:function(s){var d=this.getLayerId(s);return this._layers[d]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var d=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(s){var d=typeof s=="number"?s:this.getLayerId(s);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var d=Array.prototype.slice.call(arguments,1),w,E;for(w in this._layers)E=this._layers[w],E[s]&&E[s].apply(E,d);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,d){for(var w in this._layers)s.call(d,this._layers[w]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return q(s)}}),lr=function(s,d){return new Hr(s,d)},Ir=Hr.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Hr.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Hr.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new bi;for(var d in this._layers){var w=this._layers[d];s.extend(w.getBounds?w.getBounds():w.getLatLng())}return s}}),Sl=function(s,d){return new Ir(s,d)},$o=Ni.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){De(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,d){var w=this._getIconUrl(s);if(!w){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var E=this._createImg(w,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(E,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(E.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),E},_setIconStyles:function(s,d){var w=this.options,E=w[d+"Size"];typeof E=="number"&&(E=[E,E]);var M=Ge(E),V=Ge(d==="shadow"&&w.shadowAnchor||w.iconAnchor||M&&M.divideBy(2,!0));s.className="leaflet-marker-"+d+" "+(w.className||""),V&&(s.style.marginLeft=-V.x+"px",s.style.marginTop=-V.y+"px"),M&&(s.style.width=M.x+"px",s.style.height=M.y+"px")},_createImg:function(s,d){return d=d||document.createElement("img"),d.src=s,d},_getIconUrl:function(s){return Z.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function Wo(s){return new $o(s)}var Xr=$o.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Xr.imagePath!="string"&&(Xr.imagePath=this._detectIconPath()),(this.options.imagePath||Xr.imagePath)+$o.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var d=function(w,E,M){var V=E.exec(w);return V&&V[M]};return s=d(s,/^url\((['"])?(.+)\1\)$/,2),s&&d(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Gt("div","leaflet-default-icon-path",document.body),d=Ri(s,"background-image")||Ri(s,"backgroundImage");if(document.body.removeChild(s),d=this._stripUrl(d),d)return d;var w=document.querySelector('link[href$="leaflet.css"]');return w?w.href.substring(0,w.href.length-11-1):""}}),Ho=Hn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Cr(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Rt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Ei(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var d=this._marker,w=d._map,E=this._marker.options.autoPanSpeed,M=this._marker.options.autoPanPadding,V=sr(d._icon),re=w.getPixelBounds(),oe=w.getPixelOrigin(),he=Ut(re.min._subtract(oe).add(M),re.max._subtract(oe).subtract(M));if(!he.contains(V)){var Oe=Ge((Math.max(he.max.x,V.x)-he.max.x)/(re.max.x-he.max.x)-(Math.min(he.min.x,V.x)-he.min.x)/(re.min.x-he.min.x),(Math.max(he.max.y,V.y)-he.max.y)/(re.max.y-he.max.y)-(Math.min(he.min.y,V.y)-he.min.y)/(re.min.y-he.min.y)).multiplyBy(E);w.panBy(Oe,{animate:!1}),this._draggable._newPos._add(Oe),this._draggable._startPos._add(Oe),yi(d._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=ei(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(_i(this._panRequest),this._panRequest=ei(this._adjustPan.bind(this,s)))},_onDrag:function(s){var d=this._marker,w=d._shadow,E=sr(d._icon),M=d._map.layerPointToLatLng(E);w&&yi(w,E),d._latlng=M,s.latlng=M,s.oldLatLng=this._oldLatLng,d.fire("move",s).fire("drag",s)},_onDragEnd:function(s){_i(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Aa=En.extend({options:{icon:new Xr,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,d){De(this,d),this._latlng=Dt(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var d=this._latlng;return this._latlng=Dt(s),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),w=s.icon.createIcon(this._icon),E=!1;w!==this._icon&&(this._icon&&this._removeIcon(),E=!0,s.title&&(w.title=s.title),w.tagName==="IMG"&&(w.alt=s.alt||"")),Rt(w,d),s.keyboard&&(w.tabIndex="0",w.setAttribute("role","button")),this._icon=w,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Mt(w,"focus",this._panOnFocus,this);var M=s.icon.createShadow(this._shadow),V=!1;M!==this._shadow&&(this._removeShadow(),V=!0),M&&(Rt(M,d),M.alt=""),this._shadow=M,s.opacity<1&&this._updateOpacity(),E&&this.getPane().appendChild(this._icon),this._initInteraction(),M&&V&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&vi(this._icon,"focus",this._panOnFocus,this),di(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&di(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&yi(this._icon,s),this._shadow&&yi(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(Rt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ho)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ho(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Tn(this._icon,s),this._shadow&&Tn(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var d=this.options.icon.options,w=d.iconSize?Ge(d.iconSize):Ge(0,0),E=d.iconAnchor?Ge(d.iconAnchor):Ge(0,0);s.panInside(this._latlng,{paddingTopLeft:E,paddingBottomRight:w.subtract(E)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function za(s,d){return new Aa(s,d)}var Kr=En.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return De(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),qs=Kr.extend({options:{fill:!0,radius:10},initialize:function(s,d){De(this,d),this._latlng=Dt(s),this._radius=this.options.radius},setLatLng:function(s){var d=this._latlng;return this._latlng=Dt(s),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var d=s&&s.radius||this._radius;return Kr.prototype.setStyle.call(this,s),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,d=this._radiusY||s,w=this._clickTolerance(),E=[s+w,d+w];this._pxBounds=new Tt(this._point.subtract(E),this._point.add(E))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function $s(s,d){return new qs(s,d)}var Ws=qs.extend({initialize:function(s,d,w){if(typeof d=="number"&&(d=y({},w,{radius:d})),De(this,d),this._latlng=Dt(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new bi(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Kr.prototype.setStyle,_project:function(){var s=this._latlng.lng,d=this._latlng.lat,w=this._map,E=w.options.crs;if(E.distance===pn.distance){var M=Math.PI/180,V=this._mRadius/pn.R/M,re=w.project([d+V,s]),oe=w.project([d-V,s]),he=re.add(oe).divideBy(2),Oe=w.unproject(he).lat,rt=Math.acos((Math.cos(V*M)-Math.sin(d*M)*Math.sin(Oe*M))/(Math.cos(d*M)*Math.cos(Oe*M)))/M;(isNaN(rt)||rt===0)&&(rt=V/Math.cos(Math.PI/180*d)),this._point=he.subtract(w.getPixelOrigin()),this._radius=isNaN(rt)?0:he.x-w.project([Oe,s-rt]).x,this._radiusY=he.y-re.y}else{var wt=E.unproject(E.project(this._latlng).subtract([this._mRadius,0]));this._point=w.latLngToLayerPoint(this._latlng),this._radius=this._point.x-w.latLngToLayerPoint(wt).x}this._updateBounds()}});function Ma(s,d,w){return new Ws(s,d,w)}var On=Kr.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,d){De(this,d),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var d=1/0,w=null,E=ri,M,V,re=0,oe=this._parts.length;re<oe;re++)for(var he=this._parts[re],Oe=1,rt=he.length;Oe<rt;Oe++){M=he[Oe-1],V=he[Oe];var wt=E(s,M,V,!0);wt<d&&(d=wt,w=E(s,M,V))}return w&&(w.distance=Math.sqrt(d)),w},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return jo(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,d){return d=d||this._defaultShape(),s=Dt(s),d.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new bi,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Ht(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var d=[],w=Ht(s),E=0,M=s.length;E<M;E++)w?(d[E]=Dt(s[E]),this._bounds.extend(d[E])):d[E]=this._convertLatLngs(s[E]);return d},_project:function(){var s=new Tt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),d=new Re(s,s);this._rawPxBounds&&(this._pxBounds=new Tt([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(s,d,w){var E=s[0]instanceof Lt,M=s.length,V,re;if(E){for(re=[],V=0;V<M;V++)re[V]=this._map.latLngToLayerPoint(s[V]),w.extend(re[V]);d.push(re)}else for(V=0;V<M;V++)this._projectLatlngs(s[V],d,w)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,w,E,M,V,re,oe,he;for(w=0,M=0,V=this._rings.length;w<V;w++)for(he=this._rings[w],E=0,re=he.length;E<re-1;E++)oe=fi(he[E],he[E+1],s,E,!0),oe&&(d[M]=d[M]||[],d[M].push(oe[0]),(oe[1]!==he[E+1]||E===re-2)&&(d[M].push(oe[1]),M++))}},_simplifyPoints:function(){for(var s=this._parts,d=this.options.smoothFactor,w=0,E=s.length;w<E;w++)s[w]=Zo(s[w],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,d){var w,E,M,V,re,oe,he=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(w=0,V=this._parts.length;w<V;w++)for(oe=this._parts[w],E=0,re=oe.length,M=re-1;E<re;M=E++)if(!(!d&&E===0)&&bl(s,oe[M],oe[E])<=he)return!0;return!1}});function ws(s,d){return new On(s,d)}On._flat=vs;var kr=On.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Tl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var d=On.prototype._convertLatLngs.call(this,s),w=d.length;return w>=2&&d[0]instanceof Lt&&d[0].equals(d[w-1])&&d.pop(),d},_setLatLngs:function(s){On.prototype._setLatLngs.call(this,s),Ht(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ht(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,d=this.options.weight,w=new Re(d,d);if(s=new Tt(s.min.subtract(w),s.max.add(w)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var E=0,M=this._rings.length,V;E<M;E++)V=ou(this._rings[E],s,!0),V.length&&this._parts.push(V)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var d=!1,w,E,M,V,re,oe,he,Oe;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(V=0,he=this._parts.length;V<he;V++)for(w=this._parts[V],re=0,Oe=w.length,oe=Oe-1;re<Oe;oe=re++)E=w[re],M=w[oe],E.y>s.y!=M.y>s.y&&s.x<(M.x-E.x)*(s.y-E.y)/(M.y-E.y)+E.x&&(d=!d);return d||On.prototype._containsPoint.call(this,s,!0)}});function au(s,d){return new kr(s,d)}var Fn=Ir.extend({initialize:function(s,d){De(this,d),this._layers={},s&&this.addData(s)},addData:function(s){var d=me(s)?s:s.features,w,E,M;if(d){for(w=0,E=d.length;w<E;w++)M=d[w],(M.geometries||M.geometry||M.features||M.coordinates)&&this.addData(M);return this}var V=this.options;if(V.filter&&!V.filter(s))return this;var re=Hs(s,V);return re?(re.feature=rn(s),re.defaultOptions=re.options,this.resetStyle(re),V.onEachFeature&&V.onEachFeature(s,re),this.addLayer(re)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=y({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(d){this._setLayerStyle(d,s)},this)},_setLayerStyle:function(s,d){s.setStyle&&(typeof d=="function"&&(d=d(s.feature)),s.setStyle(d))}});function Hs(s,d){var w=s.type==="Feature"?s.geometry:s,E=w?w.coordinates:null,M=[],V=d&&d.pointToLayer,re=d&&d.coordsToLatLng||La,oe,he,Oe,rt;if(!E&&!w)return null;switch(w.type){case"Point":return oe=re(E),El(V,s,oe,d);case"MultiPoint":for(Oe=0,rt=E.length;Oe<rt;Oe++)oe=re(E[Oe]),M.push(El(V,s,oe,d));return new Ir(M);case"LineString":case"MultiLineString":return he=Jr(E,w.type==="LineString"?0:1,re),new On(he,d);case"Polygon":case"MultiPolygon":return he=Jr(E,w.type==="Polygon"?1:2,re),new kr(he,d);case"GeometryCollection":for(Oe=0,rt=w.geometries.length;Oe<rt;Oe++){var wt=Hs({geometry:w.geometries[Oe],type:"Feature",properties:s.properties},d);wt&&M.push(wt)}return new Ir(M);case"FeatureCollection":for(Oe=0,rt=w.features.length;Oe<rt;Oe++){var bt=Hs(w.features[Oe],d);bt&&M.push(bt)}return new Ir(M);default:throw new Error("Invalid GeoJSON object.")}}function El(s,d,w,E){return s?s(d,w):new Aa(w,E&&E.markersInheritOptions&&E)}function La(s){return new Lt(s[1],s[0],s[2])}function Jr(s,d,w){for(var E=[],M=0,V=s.length,re;M<V;M++)re=d?Jr(s[M],d-1,w):(w||La)(s[M]),E.push(re);return E}function Da(s,d){return s=Dt(s),s.alt!==void 0?[K(s.lng,d),K(s.lat,d),K(s.alt,d)]:[K(s.lng,d),K(s.lat,d)]}function Eo(s,d,w,E){for(var M=[],V=0,re=s.length;V<re;V++)M.push(d?Eo(s[V],Ht(s[V])?0:d-1,w,E):Da(s[V],E));return!d&&w&&M.push(M[0].slice()),M}function Ar(s,d){return s.feature?y({},s.feature,{geometry:d}):rn(d)}function rn(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Xo={toGeoJSON:function(s){return Ar(this,{type:"Point",coordinates:Da(this.getLatLng(),s)})}};Aa.include(Xo),Ws.include(Xo),qs.include(Xo),On.include({toGeoJSON:function(s){var d=!Ht(this._latlngs),w=Eo(this._latlngs,d?1:0,!1,s);return Ar(this,{type:(d?"Multi":"")+"LineString",coordinates:w})}}),kr.include({toGeoJSON:function(s){var d=!Ht(this._latlngs),w=d&&!Ht(this._latlngs[0]),E=Eo(this._latlngs,w?2:d?1:0,!0,s);return d||(E=[E]),Ar(this,{type:(w?"Multi":"")+"Polygon",coordinates:E})}}),Hr.include({toMultiPoint:function(s){var d=[];return this.eachLayer(function(w){d.push(w.toGeoJSON(s).geometry.coordinates)}),Ar(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(s){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(s);var w=d==="GeometryCollection",E=[];return this.eachLayer(function(M){if(M.toGeoJSON){var V=M.toGeoJSON(s);if(w)E.push(V.geometry);else{var re=rn(V);re.type==="FeatureCollection"?E.push.apply(E,re.features):E.push(re)}}}),w?Ar(this,{geometries:E,type:"GeometryCollection"}):{type:"FeatureCollection",features:E}}});function Pn(s,d){return new Fn(s,d)}var oc=Pn,ur=En.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,d,w){this._url=s,this._bounds=ni(d),De(this,w)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Rt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){di(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&yo(this._image),this},bringToBack:function(){return this._map&&vo(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=ni(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",d=this._image=s?this._url:Gt("img");if(Rt(d,"leaflet-image-layer"),this._zoomAnimated&&Rt(d,"leaflet-zoom-animated"),this.options.className&&Rt(d,this.options.className),d.onselectstart=ge,d.onmousemove=ge,d.onload=k(this.fire,this,"load"),d.onerror=k(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(s){var d=this._map.getZoomScale(s.zoom),w=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;xo(this._image,w,d)},_reset:function(){var s=this._image,d=new Tt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),w=d.getSize();yi(s,d.min),s.style.width=w.x+"px",s.style.height=w.y+"px"},_updateOpacity:function(){Tn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),lu=function(s,d,w){return new ur(s,d,w)},zr=ur.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",d=this._image=s?this._url:Gt("video");if(Rt(d,"leaflet-image-layer"),this._zoomAnimated&&Rt(d,"leaflet-zoom-animated"),this.options.className&&Rt(d,this.options.className),d.onselectstart=ge,d.onmousemove=ge,d.onloadeddata=k(this.fire,this,"load"),s){for(var w=d.getElementsByTagName("source"),E=[],M=0;M<w.length;M++)E.push(w[M].src);this._url=w.length>0?E:[d.src];return}me(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var V=0;V<this._url.length;V++){var re=Gt("source");re.src=this._url[V],d.appendChild(re)}}});function Xs(s,d,w){return new zr(s,d,w)}var Ra=ur.extend({_initImage:function(){var s=this._image=this._url;Rt(s,"leaflet-image-layer"),this._zoomAnimated&&Rt(s,"leaflet-zoom-animated"),this.options.className&&Rt(s,this.options.className),s.onselectstart=ge,s.onmousemove=ge}});function sc(s,d,w){return new Ra(s,d,w)}var Mr=En.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,d){s&&(s instanceof Lt||me(s))?(this._latlng=Dt(s),De(this,d)):(De(this,s),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Tn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Tn(this._container,1),this.bringToFront(),this.options.interactive&&(Rt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Tn(this._container,0),this._removeTimeout=setTimeout(k(di,void 0,this._container),200)):di(this._container),this.options.interactive&&(Ei(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=Dt(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&yo(this._container),this},bringToBack:function(){return this._map&&vo(this._container),this},_prepareOpen:function(s){var d=this._source;if(!d._map)return!1;if(d instanceof Ir){d=null;var w=this._source._layers;for(var E in w)if(w[E]._map){d=w[E];break}if(!d)return!1;this._source=d}if(!s)if(d.getCenter)s=d.getCenter();else if(d.getLatLng)s=d.getLatLng();else if(d.getBounds)s=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")s.innerHTML=d;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),d=Ge(this.options.offset),w=this._getAnchor();this._zoomAnimated?yi(this._container,s.add(w)):d=d.add(s).add(w);var E=this._containerBottom=-d.y,M=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=E+"px",this._container.style.left=M+"px"}},_getAnchor:function(){return[0,0]}});jt.include({_initOverlay:function(s,d,w,E){var M=d;return M instanceof s||(M=new s(E).setContent(d)),w&&M.setLatLng(w),M}}),En.include({_initOverlay:function(s,d,w,E){var M=w;return M instanceof s?(De(M,E),M._source=this):(M=d&&!E?d:new s(E,this),M.setContent(w)),M}});var Ko=Mr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Mr.prototype.openOn.call(this,s)},onAdd:function(s){Mr.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Kr||this._source.on("preclick",Ft))},onRemove:function(s){Mr.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Kr||this._source.off("preclick",Ft))},getEvents:function(){var s=Mr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",d=this._container=Gt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),w=this._wrapper=Gt("div",s+"-content-wrapper",d);if(this._contentNode=Gt("div",s+"-content",w),Us(d),Sa(this._contentNode),Mt(d,"contextmenu",Ft),this._tipContainer=Gt("div",s+"-tip-container",d),this._tip=Gt("div",s+"-tip",this._tipContainer),this.options.closeButton){var E=this._closeButton=Gt("a",s+"-close-button",d);E.setAttribute("role","button"),E.setAttribute("aria-label","Close popup"),E.href="#close",E.innerHTML='<span aria-hidden="true">&#215;</span>',Mt(E,"click",function(M){zi(M),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,d=s.style;d.width="",d.whiteSpace="nowrap";var w=s.offsetWidth;w=Math.min(w,this.options.maxWidth),w=Math.max(w,this.options.minWidth),d.width=w+1+"px",d.whiteSpace="",d.height="";var E=s.offsetHeight,M=this.options.maxHeight,V="leaflet-popup-scrolled";M&&E>M?(d.height=M+"px",Rt(s,V)):Ei(s,V),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),w=this._getAnchor();yi(this._container,d.add(w))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,d=parseInt(Ri(this._container,"marginBottom"),10)||0,w=this._container.offsetHeight+d,E=this._containerWidth,M=new Re(this._containerLeft,-w-this._containerBottom);M._add(sr(this._container));var V=s.layerPointToContainerPoint(M),re=Ge(this.options.autoPanPadding),oe=Ge(this.options.autoPanPaddingTopLeft||re),he=Ge(this.options.autoPanPaddingBottomRight||re),Oe=s.getSize(),rt=0,wt=0;V.x+E+he.x>Oe.x&&(rt=V.x+E-Oe.x+he.x),V.x-rt-oe.x<0&&(rt=V.x-oe.x),V.y+w+he.y>Oe.y&&(wt=V.y+w-Oe.y+he.y),V.y-wt-oe.y<0&&(wt=V.y-oe.y),(rt||wt)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([rt,wt]))}},_getAnchor:function(){return Ge(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ks=function(s,d){return new Ko(s,d)};jt.mergeOptions({closePopupOnClick:!0}),jt.include({openPopup:function(s,d,w){return this._initOverlay(Ko,s,d,w).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),En.include({bindPopup:function(s,d){return this._popup=this._initOverlay(Ko,this._popup,s,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof Ir||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){ar(s);var d=s.layer||s.target;if(this._popup._source===d&&!(d instanceof Kr)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=d,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Xn=Mr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Mr.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Mr.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Mr.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",d=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Gt("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+q(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var d,w,E=this._map,M=this._container,V=E.latLngToContainerPoint(E.getCenter()),re=E.layerPointToContainerPoint(s),oe=this.options.direction,he=M.offsetWidth,Oe=M.offsetHeight,rt=Ge(this.options.offset),wt=this._getAnchor();oe==="top"?(d=he/2,w=Oe):oe==="bottom"?(d=he/2,w=0):oe==="center"?(d=he/2,w=Oe/2):oe==="right"?(d=0,w=Oe/2):oe==="left"?(d=he,w=Oe/2):re.x<V.x?(oe="right",d=0,w=Oe/2):(oe="left",d=he+(rt.x+wt.x)*2,w=Oe/2),s=s.subtract(Ge(d,w,!0)).add(rt).add(wt),Ei(M,"leaflet-tooltip-right"),Ei(M,"leaflet-tooltip-left"),Ei(M,"leaflet-tooltip-top"),Ei(M,"leaflet-tooltip-bottom"),Rt(M,"leaflet-tooltip-"+oe),yi(M,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Tn(this._container,s)},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(d)},_getAnchor:function(){return Ge(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),nt=function(s,d){return new Xn(s,d)};jt.include({openTooltip:function(s,d,w){return this._initOverlay(Xn,s,d,w).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),En.include({bindTooltip:function(s,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Xn,this._tooltip,s,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var d=s?"off":"on",w={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?w.add=this._openTooltip:(w.mouseover=this._openTooltip,w.mouseout=this.closeTooltip,w.click=this._openTooltip,this._map?this._addFocusListeners():w.add=this._addFocusListeners),this._tooltip.options.sticky&&(w.mousemove=this._moveTooltip),this[d](w),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof Ir||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var d=s.getElement();d&&(Mt(d,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),Mt(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var d=s.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0))},_moveTooltip:function(s){var d=s.latlng,w,E;this._tooltip.options.sticky&&s.originalEvent&&(w=this._map.mouseEventToContainerPoint(s.originalEvent),E=this._map.containerPointToLayerPoint(w),d=this._map.layerPointToLatLng(E)),this._tooltip.setLatLng(d)}});var Pl=$o.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var d=s&&s.tagName==="DIV"?s:document.createElement("div"),w=this.options;if(w.html instanceof Element?(ti(d),d.appendChild(w.html)):d.innerHTML=w.html!==!1?w.html:"",w.bgPos){var E=Ge(w.bgPos);d.style.backgroundPosition=-E.x+"px "+-E.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function Jo(s){return new Pl(s)}$o.Default=Xr;var Kn=En.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Z.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){De(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),di(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(yo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(vo(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=le(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof Re?s:new Re(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var d=this.getPane().children,w=-s(-1/0,1/0),E=0,M=d.length,V;E<M;E++)V=d[E].style.zIndex,d[E]!==this._container&&V&&(w=s(w,+V));isFinite(w)&&(this.options.zIndex=w+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Z.ielt9){Tn(this._container,this.options.opacity);var s=+new Date,d=!1,w=!1;for(var E in this._tiles){var M=this._tiles[E];if(!(!M.current||!M.loaded)){var V=Math.min(1,(s-M.loaded)/200);Tn(M.el,V),V<1?d=!0:(M.active?w=!0:this._onOpaqueTile(M),M.active=!0)}}w&&!this._noPrune&&this._pruneTiles(),d&&(_i(this._fadeFrame),this._fadeFrame=ei(this._updateOpacity,this))}},_onOpaqueTile:ge,_initContainer:function(){this._container||(this._container=Gt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,d=this.options.maxZoom;if(s!==void 0){for(var w in this._levels)w=Number(w),this._levels[w].el.children.length||w===s?(this._levels[w].el.style.zIndex=d-Math.abs(s-w),this._onUpdateLevel(w)):(di(this._levels[w].el),this._removeTilesAtZoom(w),this._onRemoveLevel(w),delete this._levels[w]);var E=this._levels[s],M=this._map;return E||(E=this._levels[s]={},E.el=Gt("div","leaflet-tile-container leaflet-zoom-animated",this._container),E.el.style.zIndex=d,E.origin=M.project(M.unproject(M.getPixelOrigin()),s).round(),E.zoom=s,this._setZoomTransform(E,M.getCenter(),M.getZoom()),ge(E.el.offsetWidth),this._onCreateLevel(E)),this._level=E,E}},_onUpdateLevel:ge,_onRemoveLevel:ge,_onCreateLevel:ge,_pruneTiles:function(){if(this._map){var s,d,w=this._map.getZoom();if(w>this.options.maxZoom||w<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)d=this._tiles[s],d.retain=d.current;for(s in this._tiles)if(d=this._tiles[s],d.current&&!d.active){var E=d.coords;this._retainParent(E.x,E.y,E.z,E.z-5)||this._retainChildren(E.x,E.y,E.z,E.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var d in this._tiles)this._tiles[d].coords.z===s&&this._removeTile(d)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)di(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,d,w,E){var M=Math.floor(s/2),V=Math.floor(d/2),re=w-1,oe=new Re(+M,+V);oe.z=+re;var he=this._tileCoordsToKey(oe),Oe=this._tiles[he];return Oe&&Oe.active?(Oe.retain=!0,!0):(Oe&&Oe.loaded&&(Oe.retain=!0),re>E?this._retainParent(M,V,re,E):!1)},_retainChildren:function(s,d,w,E){for(var M=2*s;M<2*s+2;M++)for(var V=2*d;V<2*d+2;V++){var re=new Re(M,V);re.z=w+1;var oe=this._tileCoordsToKey(re),he=this._tiles[oe];if(he&&he.active){he.retain=!0;continue}else he&&he.loaded&&(he.retain=!0);w+1<E&&this._retainChildren(M,V,w+1,E)}},_resetView:function(s){var d=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var d=this.options;return d.minNativeZoom!==void 0&&s<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<s?d.maxNativeZoom:s},_setView:function(s,d,w,E){var M=Math.round(d);this.options.maxZoom!==void 0&&M>this.options.maxZoom||this.options.minZoom!==void 0&&M<this.options.minZoom?M=void 0:M=this._clampZoom(M);var V=this.options.updateWhenZooming&&M!==this._tileZoom;(!E||V)&&(this._tileZoom=M,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),M!==void 0&&this._update(s),w||this._pruneTiles(),this._noPrune=!!w),this._setZoomTransforms(s,d)},_setZoomTransforms:function(s,d){for(var w in this._levels)this._setZoomTransform(this._levels[w],s,d)},_setZoomTransform:function(s,d,w){var E=this._map.getZoomScale(w,s.zoom),M=s.origin.multiplyBy(E).subtract(this._map._getNewPixelOrigin(d,w)).round();Z.any3d?xo(s.el,M,E):yi(s.el,M)},_resetGrid:function(){var s=this._map,d=s.options.crs,w=this._tileSize=this.getTileSize(),E=this._tileZoom,M=this._map.getPixelWorldBounds(this._tileZoom);M&&(this._globalTileRange=this._pxBoundsToTileRange(M)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,d.wrapLng[0]],E).x/w.x),Math.ceil(s.project([0,d.wrapLng[1]],E).x/w.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([d.wrapLat[0],0],E).y/w.x),Math.ceil(s.project([d.wrapLat[1],0],E).y/w.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var d=this._map,w=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),E=d.getZoomScale(w,this._tileZoom),M=d.project(s,this._tileZoom).floor(),V=d.getSize().divideBy(E*2);return new Tt(M.subtract(V),M.add(V))},_update:function(s){var d=this._map;if(d){var w=this._clampZoom(d.getZoom());if(s===void 0&&(s=d.getCenter()),this._tileZoom!==void 0){var E=this._getTiledPixelBounds(s),M=this._pxBoundsToTileRange(E),V=M.getCenter(),re=[],oe=this.options.keepBuffer,he=new Tt(M.getBottomLeft().subtract([oe,-oe]),M.getTopRight().add([oe,-oe]));if(!(isFinite(M.min.x)&&isFinite(M.min.y)&&isFinite(M.max.x)&&isFinite(M.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Oe in this._tiles){var rt=this._tiles[Oe].coords;(rt.z!==this._tileZoom||!he.contains(new Re(rt.x,rt.y)))&&(this._tiles[Oe].current=!1)}if(Math.abs(w-this._tileZoom)>1){this._setView(s,w);return}for(var wt=M.min.y;wt<=M.max.y;wt++)for(var bt=M.min.x;bt<=M.max.x;bt++){var Vi=new Re(bt,wt);if(Vi.z=this._tileZoom,!!this._isValidTile(Vi)){var on=this._tiles[this._tileCoordsToKey(Vi)];on?on.current=!0:re.push(Vi)}}if(re.sort(function(yn,Ti){return yn.distanceTo(V)-Ti.distanceTo(V)}),re.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ea=document.createDocumentFragment();for(bt=0;bt<re.length;bt++)this._addTile(re[bt],ea);this._level.el.appendChild(ea)}}}},_isValidTile:function(s){var d=this._map.options.crs;if(!d.infinite){var w=this._globalTileRange;if(!d.wrapLng&&(s.x<w.min.x||s.x>w.max.x)||!d.wrapLat&&(s.y<w.min.y||s.y>w.max.y))return!1}if(!this.options.bounds)return!0;var E=this._tileCoordsToBounds(s);return ni(this.options.bounds).overlaps(E)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var d=this._map,w=this.getTileSize(),E=s.scaleBy(w),M=E.add(w),V=d.unproject(E,s.z),re=d.unproject(M,s.z);return[V,re]},_tileCoordsToBounds:function(s){var d=this._tileCoordsToNwSe(s),w=new bi(d[0],d[1]);return this.options.noWrap||(w=this._map.wrapLatLngBounds(w)),w},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var d=s.split(":"),w=new Re(+d[0],+d[1]);return w.z=+d[2],w},_removeTile:function(s){var d=this._tiles[s];d&&(di(d.el),delete this._tiles[s],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){Rt(s,"leaflet-tile");var d=this.getTileSize();s.style.width=d.x+"px",s.style.height=d.y+"px",s.onselectstart=ge,s.onmousemove=ge,Z.ielt9&&this.options.opacity<1&&Tn(s,this.options.opacity)},_addTile:function(s,d){var w=this._getTilePos(s),E=this._tileCoordsToKey(s),M=this.createTile(this._wrapCoords(s),k(this._tileReady,this,s));this._initTile(M),this.createTile.length<2&&ei(k(this._tileReady,this,s,null,M)),yi(M,w),this._tiles[E]={el:M,coords:s,current:!0},d.appendChild(M),this.fire("tileloadstart",{tile:M,coords:s})},_tileReady:function(s,d,w){d&&this.fire("tileerror",{error:d,tile:w,coords:s});var E=this._tileCoordsToKey(s);w=this._tiles[E],w&&(w.loaded=+new Date,this._map._fadeAnimated?(Tn(w.el,0),_i(this._fadeFrame),this._fadeFrame=ei(this._updateOpacity,this)):(w.active=!0,this._pruneTiles()),d||(Rt(w.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:w.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Z.ielt9||!this._map._fadeAnimated?ei(this._pruneTiles,this):setTimeout(k(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var d=new Re(this._wrapX?Ie(s.x,this._wrapX):s.x,this._wrapY?Ie(s.y,this._wrapY):s.y);return d.z=s.z,d},_pxBoundsToTileRange:function(s){var d=this.getTileSize();return new Tt(s.min.unscaleBy(d).floor(),s.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Cl(s){return new Kn(s)}var He=Kn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,d){this._url=s,d=De(this,d),d.detectRetina&&Z.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,d){return this._url===s&&d===void 0&&(d=!0),this._url=s,d||this.redraw(),this},createTile:function(s,d){var w=document.createElement("img");return Mt(w,"load",k(this._tileOnLoad,this,d,w)),Mt(w,"error",k(this._tileOnError,this,d,w)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(w.referrerPolicy=this.options.referrerPolicy),w.alt="",w.src=this.getTileUrl(s),w},getTileUrl:function(s){var d={r:Z.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var w=this._globalTileRange.max.y-s.y;this.options.tms&&(d.y=w),d["-y"]=w}return ue(this._url,y(d,this.options))},_tileOnLoad:function(s,d){Z.ielt9?setTimeout(k(s,this,null,d),0):s(null,d)},_tileOnError:function(s,d,w){var E=this.options.errorTileUrl;E&&d.getAttribute("src")!==E&&(d.src=E),s(w,d)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,d=this.options.maxZoom,w=this.options.zoomReverse,E=this.options.zoomOffset;return w&&(s=d-s),s+E},_getSubdomain:function(s){var d=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var s,d;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(d=this._tiles[s].el,d.onload=ge,d.onerror=ge,!d.complete)){d.src=$e;var w=this._tiles[s].coords;di(d),delete this._tiles[s],this.fire("tileabort",{tile:d,coords:w})}},_removeTile:function(s){var d=this._tiles[s];if(d)return d.el.setAttribute("src",$e),Kn.prototype._removeTile.call(this,s)},_tileReady:function(s,d,w){if(!(!this._map||w&&w.getAttribute("src")===$e))return Kn.prototype._tileReady.call(this,s,d,w)}});function Js(s,d){return new He(s,d)}var uu=He.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,d){this._url=s;var w=y({},this.defaultWmsParams);for(var E in d)E in this.options||(w[E]=d[E]);d=De(this,d);var M=d.detectRetina&&Z.retina?2:1,V=this.getTileSize();w.width=V.x*M,w.height=V.y*M,this.wmsParams=w},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,He.prototype.onAdd.call(this,s)},getTileUrl:function(s){var d=this._tileCoordsToNwSe(s),w=this._crs,E=Ut(w.project(d[0]),w.project(d[1])),M=E.min,V=E.max,re=(this._wmsVersion>=1.3&&this._crs===ka?[M.y,M.x,V.y,V.x]:[M.x,M.y,V.x,V.y]).join(","),oe=He.prototype.getTileUrl.call(this,s);return oe+Qt(this.wmsParams,oe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+re},setParams:function(s,d){return y(this.wmsParams,s),d||this.redraw(),this}});function Il(s,d){return new uu(s,d)}He.WMS=uu,Js.wms=Il;var cr=En.extend({options:{padding:.1},initialize:function(s){De(this,s),q(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Rt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,d){var w=this._map.getZoomScale(d,this._zoom),E=this._map.getSize().multiplyBy(.5+this.options.padding),M=this._map.project(this._center,d),V=E.multiplyBy(-w).add(M).subtract(this._map._getNewPixelOrigin(s,d));Z.any3d?xo(this._container,V,w):yi(this._container,V)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,d=this._map.getSize(),w=this._map.containerPointToLayerPoint(d.multiplyBy(-s)).round();this._bounds=new Tt(w,w.add(d.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),kl=cr.extend({options:{tolerance:0},getEvents:function(){var s=cr.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){cr.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");Mt(s,"mousemove",this._onMouseMove,this),Mt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Mt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){_i(this._redrawRequest),delete this._ctx,di(this._container),vi(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var d in this._layers)s=this._layers[d],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){cr.prototype._update.call(this);var s=this._bounds,d=this._container,w=s.getSize(),E=Z.retina?2:1;yi(d,s.min),d.width=E*w.x,d.height=E*w.y,d.style.width=w.x+"px",d.style.height=w.y+"px",Z.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){cr.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[q(s)]=s;var d=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var d=s._order,w=d.next,E=d.prev;w?w.prev=E:this._drawLast=E,E?E.next=w:this._drawFirst=w,delete s._order,delete this._layers[q(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var d=s.options.dashArray.split(/[, ]+/),w=[],E,M;for(M=0;M<d.length;M++){if(E=Number(d[M]),isNaN(E))return;w.push(E)}s.options._dashArray=w}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||ei(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var d=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Tt,this._redrawBounds.extend(s._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(s._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var d=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,d=this._redrawBounds;if(this._ctx.save(),d){var w=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,w.x,w.y),this._ctx.clip()}this._drawing=!0;for(var E=this._drawFirst;E;E=E.next)s=E.layer,(!d||s._pxBounds&&s._pxBounds.intersects(d))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,d){if(this._drawing){var w,E,M,V,re=s._parts,oe=re.length,he=this._ctx;if(oe){for(he.beginPath(),w=0;w<oe;w++){for(E=0,M=re[w].length;E<M;E++)V=re[w][E],he[E?"lineTo":"moveTo"](V.x,V.y);d&&he.closePath()}this._fillStroke(he,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var d=s._point,w=this._ctx,E=Math.max(Math.round(s._radius),1),M=(Math.max(Math.round(s._radiusY),1)||E)/E;M!==1&&(w.save(),w.scale(1,M)),w.beginPath(),w.arc(d.x,d.y/M,E,0,Math.PI*2,!1),M!==1&&w.restore(),this._fillStroke(w,s)}},_fillStroke:function(s,d){var w=d.options;w.fill&&(s.globalAlpha=w.fillOpacity,s.fillStyle=w.fillColor||w.color,s.fill(w.fillRule||"evenodd")),w.stroke&&w.weight!==0&&(s.setLineDash&&s.setLineDash(d.options&&d.options._dashArray||[]),s.globalAlpha=w.opacity,s.lineWidth=w.weight,s.strokeStyle=w.color,s.lineCap=w.lineCap,s.lineJoin=w.lineJoin,s.stroke())},_onClick:function(s){for(var d=this._map.mouseEventToLayerPoint(s),w,E,M=this._drawFirst;M;M=M.next)w=M.layer,w.options.interactive&&w._containsPoint(d)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(w))&&(E=w);this._fireEvent(E?[E]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,d)}},_handleMouseOut:function(s){var d=this._hoveredLayer;d&&(Ei(this._container,"leaflet-interactive"),this._fireEvent([d],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,d){if(!this._mouseHoverThrottled){for(var w,E,M=this._drawFirst;M;M=M.next)w=M.layer,w.options.interactive&&w._containsPoint(d)&&(E=w);E!==this._hoveredLayer&&(this._handleMouseOut(s),E&&(Rt(this._container,"leaflet-interactive"),this._fireEvent([E],s,"mouseover"),this._hoveredLayer=E)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(k(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,d,w){this._map._fireDOMEvent(d,w||d.type,s)},_bringToFront:function(s){var d=s._order;if(d){var w=d.next,E=d.prev;if(w)w.prev=E;else return;E?E.next=w:w&&(this._drawFirst=w),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(s)}},_bringToBack:function(s){var d=s._order;if(d){var w=d.next,E=d.prev;if(E)E.next=w;else return;w?w.prev=E:E&&(this._drawLast=E),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(s)}}});function Al(s){return Z.canvas?new kl(s):null}var Ys=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),cu={_initContainer:function(){this._container=Gt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(cr.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var d=s._container=Ys("shape");Rt(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",s._path=Ys("path"),d.appendChild(s._path),this._updateStyle(s),this._layers[q(s)]=s},_addPath:function(s){var d=s._container;this._container.appendChild(d),s.options.interactive&&s.addInteractiveTarget(d)},_removePath:function(s){var d=s._container;di(d),s.removeInteractiveTarget(d),delete this._layers[q(s)]},_updateStyle:function(s){var d=s._stroke,w=s._fill,E=s.options,M=s._container;M.stroked=!!E.stroke,M.filled=!!E.fill,E.stroke?(d||(d=s._stroke=Ys("stroke")),M.appendChild(d),d.weight=E.weight+"px",d.color=E.color,d.opacity=E.opacity,E.dashArray?d.dashStyle=me(E.dashArray)?E.dashArray.join(" "):E.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=E.lineCap.replace("butt","flat"),d.joinstyle=E.lineJoin):d&&(M.removeChild(d),s._stroke=null),E.fill?(w||(w=s._fill=Ys("fill")),M.appendChild(w),w.color=E.fillColor||E.color,w.opacity=E.fillOpacity):w&&(M.removeChild(w),s._fill=null)},_updateCircle:function(s){var d=s._point.round(),w=Math.round(s._radius),E=Math.round(s._radiusY||w);this._setPath(s,s._empty()?"M0 0":"AL "+d.x+","+d.y+" "+w+","+E+" 0,"+65535*360)},_setPath:function(s,d){s._path.v=d},_bringToFront:function(s){yo(s._container)},_bringToBack:function(s){vo(s._container)}},bs=Z.vml?Ys:Vr,Yo=cr.extend({_initContainer:function(){this._container=bs("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=bs("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){di(this._container),vi(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){cr.prototype._update.call(this);var s=this._bounds,d=s.getSize(),w=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,w.setAttribute("width",d.x),w.setAttribute("height",d.y)),yi(w,s.min),w.setAttribute("viewBox",[s.min.x,s.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(s){var d=s._path=bs("path");s.options.className&&Rt(d,s.options.className),s.options.interactive&&Rt(d,"leaflet-interactive"),this._updateStyle(s),this._layers[q(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){di(s._path),s.removeInteractiveTarget(s._path),delete this._layers[q(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var d=s._path,w=s.options;d&&(w.stroke?(d.setAttribute("stroke",w.color),d.setAttribute("stroke-opacity",w.opacity),d.setAttribute("stroke-width",w.weight),d.setAttribute("stroke-linecap",w.lineCap),d.setAttribute("stroke-linejoin",w.lineJoin),w.dashArray?d.setAttribute("stroke-dasharray",w.dashArray):d.removeAttribute("stroke-dasharray"),w.dashOffset?d.setAttribute("stroke-dashoffset",w.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),w.fill?(d.setAttribute("fill",w.fillColor||w.color),d.setAttribute("fill-opacity",w.fillOpacity),d.setAttribute("fill-rule",w.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(s,d){this._setPath(s,Oo(s._parts,d))},_updateCircle:function(s){var d=s._point,w=Math.max(Math.round(s._radius),1),E=Math.max(Math.round(s._radiusY),1)||w,M="a"+w+","+E+" 0 1,0 ",V=s._empty()?"M0 0":"M"+(d.x-w)+","+d.y+M+w*2+",0 "+M+-w*2+",0 ";this._setPath(s,V)},_setPath:function(s,d){s._path.setAttribute("d",d)},_bringToFront:function(s){yo(s._path)},_bringToBack:function(s){vo(s._path)}});Z.vml&&Yo.include(cu);function Ba(s){return Z.svg||Z.vml?new Yo(s):null}jt.include({getRenderer:function(s){var d=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var d=this._paneRenderers[s];return d===void 0&&(d=this._createRenderer({pane:s}),this._paneRenderers[s]=d),d},_createRenderer:function(s){return this.options.preferCanvas&&Al(s)||Ba(s)}});var Oa=kr.extend({initialize:function(s,d){kr.prototype.initialize.call(this,this._boundsToLatLngs(s),d)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=ni(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Cn(s,d){return new Oa(s,d)}Yo.create=bs,Yo.pointsToPath=Oo,Fn.geometryToLayer=Hs,Fn.coordsToLatLng=La,Fn.coordsToLatLngs=Jr,Fn.latLngToCoords=Da,Fn.latLngsToCoords=Eo,Fn.getFeature=Ar,Fn.asFeature=rn,jt.mergeOptions({boxZoom:!0});var Yr=Hn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){Mt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){vi(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){di(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Sr(),Ds(),this._startPoint=this._map.mouseEventToContainerPoint(s),Mt(document,{contextmenu:ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Gt("div","leaflet-zoom-box",this._container),Rt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var d=new Tt(this._point,this._startPoint),w=d.getSize();yi(this._box,d.min),this._box.style.width=w.x+"px",this._box.style.height=w.y+"px"},_finish:function(){this._moved&&(di(this._box),Ei(this._container,"leaflet-crosshair")),wo(),gs(),vi(document,{contextmenu:ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(k(this._resetState,this),0);var d=new bi(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});jt.addInitHook("addHandler","boxZoom",Yr),jt.mergeOptions({doubleClickZoom:!0});var zl=Hn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var d=this._map,w=d.getZoom(),E=d.options.zoomDelta,M=s.originalEvent.shiftKey?w-E:w+E;d.options.doubleClickZoom==="center"?d.setZoom(M):d.setZoomAround(s.containerPoint,M)}});jt.addInitHook("addHandler","doubleClickZoom",zl),jt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Qo=Hn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Cr(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}Rt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Ei(this._map._container,"leaflet-grab"),Ei(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=ni(this._map.options.maxBounds);this._offsetLimit=Ut(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var d=this._lastTime=+new Date,w=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(w),this._times.push(d),this._prunePositions(d)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,d){return s-(s-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;s.x<d.min.x&&(s.x=this._viscousLimit(s.x,d.min.x)),s.y<d.min.y&&(s.y=this._viscousLimit(s.y,d.min.y)),s.x>d.max.x&&(s.x=this._viscousLimit(s.x,d.max.x)),s.y>d.max.y&&(s.y=this._viscousLimit(s.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,d=Math.round(s/2),w=this._initialWorldOffset,E=this._draggable._newPos.x,M=(E-d+w)%s+d-w,V=(E+d+w)%s-d-w,re=Math.abs(M+w)<Math.abs(V+w)?M:V;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=re},_onDragEnd:function(s){var d=this._map,w=d.options,E=!w.inertia||s.noInertia||this._times.length<2;if(d.fire("dragend",s),E)d.fire("moveend");else{this._prunePositions(+new Date);var M=this._lastPos.subtract(this._positions[0]),V=(this._lastTime-this._times[0])/1e3,re=w.easeLinearity,oe=M.multiplyBy(re/V),he=oe.distanceTo([0,0]),Oe=Math.min(w.inertiaMaxSpeed,he),rt=oe.multiplyBy(Oe/he),wt=Oe/(w.inertiaDeceleration*re),bt=rt.multiplyBy(-wt/2).round();!bt.x&&!bt.y?d.fire("moveend"):(bt=d._limitOffset(bt,d.options.maxBounds),ei(function(){d.panBy(bt,{duration:wt,easeLinearity:re,noMoveStart:!0,animate:!0})}))}}});jt.addInitHook("addHandler","dragging",Qo),jt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Fa=Hn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),Mt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),vi(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,d=document.documentElement,w=s.scrollTop||d.scrollTop,E=s.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(E,w)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var d=this._panKeys={},w=this.keyCodes,E,M;for(E=0,M=w.left.length;E<M;E++)d[w.left[E]]=[-1*s,0];for(E=0,M=w.right.length;E<M;E++)d[w.right[E]]=[s,0];for(E=0,M=w.down.length;E<M;E++)d[w.down[E]]=[0,s];for(E=0,M=w.up.length;E<M;E++)d[w.up[E]]=[0,-1*s]},_setZoomDelta:function(s){var d=this._zoomKeys={},w=this.keyCodes,E,M;for(E=0,M=w.zoomIn.length;E<M;E++)d[w.zoomIn[E]]=s;for(E=0,M=w.zoomOut.length;E<M;E++)d[w.zoomOut[E]]=-s},_addHooks:function(){Mt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){vi(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var d=s.keyCode,w=this._map,E;if(d in this._panKeys){if(!w._panAnim||!w._panAnim._inProgress)if(E=this._panKeys[d],s.shiftKey&&(E=Ge(E).multiplyBy(3)),w.options.maxBounds&&(E=w._limitOffset(Ge(E),w.options.maxBounds)),w.options.worldCopyJump){var M=w.wrapLatLng(w.unproject(w.project(w.getCenter()).add(E)));w.panTo(M)}else w.panBy(E)}else if(d in this._zoomKeys)w.setZoom(w.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&w._popup&&w._popup.options.closeOnEscapeKey)w.closePopup();else return;ar(s)}}});jt.addInitHook("addHandler","keyboard",Fa),jt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ts=Hn.extend({addHooks:function(){Mt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){vi(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var d=Vs(s),w=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var E=Math.max(w-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(k(this._performZoom,this),E),ar(s)},_performZoom:function(){var s=this._map,d=s.getZoom(),w=this._map.options.zoomSnap||0;s._stop();var E=this._delta/(this._map.options.wheelPxPerZoomLevel*4),M=4*Math.log(2/(1+Math.exp(-Math.abs(E))))/Math.LN2,V=w?Math.ceil(M/w)*w:M,re=s._limitZoom(d+(this._delta>0?V:-V))-d;this._delta=0,this._startTime=null,re&&(s.options.scrollWheelZoom==="center"?s.setZoom(d+re):s.setZoomAround(this._lastMousePos,d+re))}});jt.addInitHook("addHandler","scrollWheelZoom",Ts);var hu=600;jt.mergeOptions({tapHold:Z.touchNative&&Z.safari&&Z.mobile,tapTolerance:15});var Nn=Hn.extend({addHooks:function(){Mt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){vi(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var d=s.touches[0];this._startPos=this._newPos=new Re(d.clientX,d.clientY),this._holdTimeout=setTimeout(k(function(){this._cancel(),this._isTapValid()&&(Mt(document,"touchend",zi),Mt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),hu),Mt(document,"touchend touchcancel contextmenu",this._cancel,this),Mt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){vi(document,"touchend",zi),vi(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),vi(document,"touchend touchcancel contextmenu",this._cancel,this),vi(document,"touchmove",this._onMove,this)},_onMove:function(s){var d=s.touches[0];this._newPos=new Re(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,d){var w=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});w._simulated=!0,d.target.dispatchEvent(w)}});jt.addInitHook("addHandler","tapHold",Nn),jt.mergeOptions({touchZoom:Z.touch,bounceAtZoomLimits:!0});var xi=Hn.extend({addHooks:function(){Rt(this._map._container,"leaflet-touch-zoom"),Mt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Ei(this._map._container,"leaflet-touch-zoom"),vi(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var d=this._map;if(!(!s.touches||s.touches.length!==2||d._animatingZoom||this._zooming)){var w=d.mouseEventToContainerPoint(s.touches[0]),E=d.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(w.add(E)._divideBy(2))),this._startDist=w.distanceTo(E),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Mt(document,"touchmove",this._onTouchMove,this),Mt(document,"touchend touchcancel",this._onTouchEnd,this),zi(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var d=this._map,w=d.mouseEventToContainerPoint(s.touches[0]),E=d.mouseEventToContainerPoint(s.touches[1]),M=w.distanceTo(E)/this._startDist;if(this._zoom=d.getScaleZoom(M,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&M<1||this._zoom>d.getMaxZoom()&&M>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,M===1)return}else{var V=w._add(E)._divideBy(2)._subtract(this._centerPoint);if(M===1&&V.x===0&&V.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(V),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),_i(this._animRequest);var re=k(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ei(re,this,!0),zi(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,_i(this._animRequest),vi(document,"touchmove",this._onTouchMove,this),vi(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});jt.addInitHook("addHandler","touchZoom",xi),jt.BoxZoom=Yr,jt.DoubleClickZoom=zl,jt.Drag=Qo,jt.Keyboard=Fa,jt.ScrollWheelZoom=Ts,jt.TapHold=Nn,jt.TouchZoom=xi,l.Bounds=Tt,l.Browser=Z,l.CRS=Ai,l.Canvas=kl,l.Circle=Ws,l.CircleMarker=qs,l.Class=Ni,l.Control=Bn,l.DivIcon=Pl,l.DivOverlay=Mr,l.DomEvent=yl,l.DomUtil=ba,l.Draggable=Cr,l.Evented=Ji,l.FeatureGroup=Ir,l.GeoJSON=Fn,l.GridLayer=Kn,l.Handler=Hn,l.Icon=$o,l.ImageOverlay=ur,l.LatLng=Lt,l.LatLngBounds=bi,l.Layer=En,l.LayerGroup=Hr,l.LineUtil=nc,l.Map=jt,l.Marker=Aa,l.Mixin=Pa,l.Path=Kr,l.Point=Re,l.PolyUtil=rc,l.Polygon=kr,l.Polyline=On,l.Popup=Ko,l.PosAnimation=Ea,l.Projection=Gs,l.Rectangle=Oa,l.Renderer=cr,l.SVG=Yo,l.SVGOverlay=Ra,l.TileLayer=He,l.Tooltip=Xn,l.Transformation=Bo,l.Util=$n,l.VideoOverlay=zr,l.bind=k,l.bounds=Ut,l.canvas=Al,l.circle=Ma,l.circleMarker=$s,l.control=To,l.divIcon=Jo,l.extend=y,l.featureGroup=Sl,l.geoJSON=Pn,l.geoJson=oc,l.gridLayer=Cl,l.icon=Wo,l.imageOverlay=lu,l.latLng=Dt,l.latLngBounds=ni,l.layerGroup=lr,l.map=vl,l.marker=za,l.point=Ge,l.polygon=au,l.polyline=ws,l.popup=Ks,l.rectangle=Cn,l.setOptions=De,l.stamp=q,l.svg=Ba,l.svgOverlay=sc,l.tileLayer=Js,l.tooltip=nt,l.transformation=Dn,l.version=p,l.videoOverlay=Xs;var Qs=window.L;l.noConflict=function(){return window.L=Qs,this},window.L=l})})(eT,Te);var up=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,$a=document.documentElement.style.pointerEvents==="",Ja={cors:up,pointerEvents:$a},tT={attributionWidthOffset:55},ov=0;function cp(e){var n="";e.f=e.f||"json";for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var p=e[l],y=Object.prototype.toString.call(p),b;n.length&&(n+="&"),y==="[object Array]"?b=Object.prototype.toString.call(p[0])==="[object Object]"?JSON.stringify(p):p.join(","):y==="[object Object]"?b=JSON.stringify(p):y==="[object Date]"?b=p.valueOf():b=p,n+=encodeURIComponent(l)+"="+encodeURIComponent(b)}return n}function x_(e,n){var l=new window.XMLHttpRequest;return l.onerror=function(p){l.onreadystatechange=Te.Util.falseFn,e.call(n,{error:{code:500,message:"XMLHttpRequest error"}},null)},l.onreadystatechange=function(){var p,y;if(l.readyState===4){try{p=JSON.parse(l.responseText)}catch{p=null,y={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!y&&p.error&&(y=p.error,p=null),l.onerror=Te.Util.falseFn,e.call(n,y,p)}},l.ontimeout=function(){this.onerror()},l}function iT(e,n,l,p){var y=x_(l,p);return y.open("POST",e),typeof p<"u"&&p!==null&&typeof p.options<"u"&&(y.timeout=p.options.timeout),y.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),y.send(cp(n)),y}function y0(e,n,l,p){var y=x_(l,p);return y.open("GET",e+"?"+cp(n),!0),typeof p<"u"&&p!==null&&typeof p.options<"u"&&(y.timeout=p.options.timeout,p.options.withCredentials&&(y.withCredentials=!0)),y.send(null),y}function Yu(e,n,l,p){var y=cp(n),b=x_(l,p),k=(e+"?"+y).length;if(k<=2e3&&Ja.cors?b.open("GET",e+"?"+y):k>2e3&&Ja.cors&&(b.open("POST",e),b.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),typeof p<"u"&&p!==null&&typeof p.options<"u"&&(b.timeout=p.options.timeout,p.options.withCredentials&&(b.withCredentials=!0)),k<=2e3&&Ja.cors)b.send(null);else if(k>2e3&&Ja.cors)b.send(y);else{if(k<=2e3&&!Ja.cors)return w_(e,n,l,p);cl("a request to "+e+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy https://developers.arcgis.com/esri-leaflet/api-reference/request/");return}return b}function w_(e,n,l,p){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var y="c"+ov;n.callback="window._EsriLeafletCallbacks."+y,window._EsriLeafletCallbacks[y]=function(k){if(window._EsriLeafletCallbacks[y]!==!0){var c,q=Object.prototype.toString.call(k);q==="[object Object]"||q==="[object Array]"||(c={error:{code:500,message:"Expected array or object as JSONP response"}},k=null),!c&&k.error&&(c=k,k=null),l.call(p,c,k),window._EsriLeafletCallbacks[y]=!0}};var b=Te.DomUtil.create("script",null,document.body);return b.type="text/javascript",b.src=e+"?"+cp(n),b.id=y,b.onerror=function(k){if(k&&window._EsriLeafletCallbacks[y]!==!0){var c={error:{code:500,message:"An unknown error occurred"}};l.call(p,c),window._EsriLeafletCallbacks[y]=!0}},Te.DomUtil.addClass(b,"esri-leaflet-jsonp"),ov++,{id:y,url:b.src,abort:function(){window._EsriLeafletCallbacks._callback[y]({code:0,message:"Request aborted."})}}}var b_=Ja.cors?y0:w_;b_.CORS=y0;b_.JSONP=w_;function cl(){console&&console.warn&&console.warn.apply(console,arguments)}var jd={request:Yu,get:b_,post:iT};/* @preserve
* @terraformer/arcgis - v2.1.1 - MIT
* Copyright (c) 2012-2022 Environmental Systems Research Institute, Inc.
* Tue Aug 02 2022 14:23:48 GMT-0700 (Pacific Daylight Time)
*/var nT=function(n,l,p,y){var b=(y[0]-p[0])*(n[1]-p[1])-(y[1]-p[1])*(n[0]-p[0]),k=(l[0]-n[0])*(n[1]-p[1])-(l[1]-n[1])*(n[0]-p[0]),c=(y[1]-p[1])*(l[0]-n[0])-(y[0]-p[0])*(l[1]-n[1]);if(c!==0){var q=b/c,le=k/c;if(q>=0&&q<=1&&le>=0&&le<=1)return!0}return!1},rT=function(n,l){for(var p=!1,y=-1,b=n.length,k=b-1;++y<b;k=y)(n[y][1]<=l[1]&&l[1]<n[k][1]||n[k][1]<=l[1]&&l[1]<n[y][1])&&l[0]<(n[k][0]-n[y][0])*(l[1]-n[y][1])/(n[k][1]-n[y][1])+n[y][0]&&(p=!p);return p},oT=function(n,l){for(var p=0;p<n.length;p++)if(n[p]!==l[p])return!1;return!0},v0=function(n,l){for(var p=0;p<n.length-1;p++)for(var y=0;y<l.length-1;y++)if(nT(n[p],n[p+1],l[y],l[y+1]))return!0;return!1},wm=function(n){return oT(n[0],n[n.length-1])||n.push(n[0]),n},bm=function(n){var l=0,p=0,y=n.length,b=n[p],k;for(p;p<y-1;p++)k=n[p+1],l+=(k[0]-b[0])*(k[1]+b[1]),b=k;return l>=0},x0=function(n){var l={};for(var p in n)n.hasOwnProperty(p)&&(l[p]=n[p]);return l},sT=function(n,l){var p=v0(n,l),y=rT(n,l[0]);return!!(!p&&y)},aT=function(n){for(var l=[],p=[],y,b,k,c=0;c<n.length;c++){var q=wm(n[c].slice(0));if(!(q.length<4))if(bm(q)){var le=[q.slice().reverse()];l.push(le)}else p.push(q.slice().reverse())}for(var Ie=[];p.length;){k=p.pop();var ge=!1;for(y=l.length-1;y>=0;y--)if(b=l[y][0],sT(b,k)){l[y].push(k),ge=!0;break}ge||Ie.push(k)}for(;Ie.length;){k=Ie.pop();var K=!1;for(y=l.length-1;y>=0;y--)if(b=l[y][0],v0(b,k)){l[y].push(k),K=!0;break}K||l.push([k.reverse()])}return l.length===1?{type:"Polygon",coordinates:l[0]}:{type:"MultiPolygon",coordinates:l}},lT=function(n,l){for(var p=l?[l,"OBJECTID","FID"]:["OBJECTID","FID"],y=0;y<p.length;y++){var b=p[y];if(b in n&&(typeof n[b]=="string"||typeof n[b]=="number"))return n[b]}throw Error("No valid id attribute found")},uT=function e(n,l){var p={};if(n.features){p.type="FeatureCollection",p.features=[];for(var y=0;y<n.features.length;y++)p.features.push(e(n.features[y],l))}if(typeof n.x=="number"&&typeof n.y=="number"&&(p.type="Point",p.coordinates=[n.x,n.y],typeof n.z=="number"&&p.coordinates.push(n.z)),n.points&&(p.type="MultiPoint",p.coordinates=n.points.slice(0)),n.paths&&(n.paths.length===1?(p.type="LineString",p.coordinates=n.paths[0].slice(0)):(p.type="MultiLineString",p.coordinates=n.paths.slice(0))),n.rings&&(p=aT(n.rings.slice(0))),typeof n.xmin=="number"&&typeof n.ymin=="number"&&typeof n.xmax=="number"&&typeof n.ymax=="number"&&(p.type="Polygon",p.coordinates=[[[n.xmax,n.ymax],[n.xmin,n.ymax],[n.xmin,n.ymin],[n.xmax,n.ymin],[n.xmax,n.ymax]]]),(n.geometry||n.attributes)&&(p.type="Feature",p.geometry=n.geometry?e(n.geometry):null,p.properties=n.attributes?x0(n.attributes):null,n.attributes))try{p.id=lT(n.attributes,l)}catch{}return JSON.stringify(p.geometry)===JSON.stringify({})&&(p.geometry=null),n.spatialReference&&n.spatialReference.wkid&&n.spatialReference.wkid!==4326&&console.warn("Object converted in non-standard crs - "+JSON.stringify(n.spatialReference)),p},w0=function(n){var l=[],p=n.slice(0),y=wm(p.shift().slice(0));if(y.length>=4){bm(y)||y.reverse(),l.push(y);for(var b=0;b<p.length;b++){var k=wm(p[b].slice(0));k.length>=4&&(bm(k)&&k.reverse(),l.push(k))}}return l},cT=function(n){for(var l=[],p=0;p<n.length;p++)for(var y=w0(n[p]),b=y.length-1;b>=0;b--){var k=y[b].slice(0);l.push(k)}return l},hT=function e(n,l){l=l||"OBJECTID";var p={wkid:4326},y={},b;switch(n.type){case"Point":y.x=n.coordinates[0],y.y=n.coordinates[1],n.coordinates[2]!=null&&(y.z=n.coordinates[2]),y.spatialReference=p;break;case"MultiPoint":y.points=n.coordinates.slice(0),n.coordinates[0][2]!=null&&(y.hasZ=!0),y.spatialReference=p;break;case"LineString":y.paths=[n.coordinates.slice(0)],n.coordinates[0][2]!=null&&(y.hasZ=!0),y.spatialReference=p;break;case"MultiLineString":y.paths=n.coordinates.slice(0),n.coordinates[0][0][2]!=null&&(y.hasZ=!0),y.spatialReference=p;break;case"Polygon":y.rings=w0(n.coordinates.slice(0)),n.coordinates[0][0][2]!=null&&(y.hasZ=!0),y.spatialReference=p;break;case"MultiPolygon":y.rings=cT(n.coordinates.slice(0)),n.coordinates[0][0][0][2]!=null&&(y.hasZ=!0),y.spatialReference=p;break;case"Feature":n.geometry&&(y.geometry=e(n.geometry,l)),y.attributes=n.properties?x0(n.properties):{},n.id&&(y.attributes[l]=n.id);break;case"FeatureCollection":for(y=[],b=0;b<n.features.length;b++)y.push(e(n.features[b],l));break;case"GeometryCollection":for(y=[],b=0;b<n.geometries.length;b++)y.push(e(n.geometries[b],l));break}return y},b0='<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>',dT='Powered by <a href="https://www.esri.com">Esri</a>';function dh(e,n){return hT(e,n)}function T0(e,n){return uT(e,n)}function Tm(e){if(e.xmin!=="NaN"&&e.ymin!=="NaN"&&e.xmax!=="NaN"&&e.ymax!=="NaN"){var n=Te.latLng(e.ymin,e.xmin),l=Te.latLng(e.ymax,e.xmax);return Te.latLngBounds(n,l)}else return null}function T_(e){return e=Te.latLngBounds(e),{xmin:e.getSouthWest().lng,ymin:e.getSouthWest().lat,xmax:e.getNorthEast().lng,ymax:e.getNorthEast().lat,spatialReference:{wkid:4326}}}var S0=/^(OBJECTID|FID|OID|ID)$/i;function E0(e){var n;if(e.objectIdFieldName)n=e.objectIdFieldName;else if(e.fields){for(var l=0;l<=e.fields.length-1;l++)if(e.fields[l].type==="esriFieldTypeOID"){n=e.fields[l].name;break}if(!n){for(l=0;l<=e.fields.length-1;l++)if(e.fields[l].name.match(S0)){n=e.fields[l].name;break}}}return n}function P0(e){for(var n in e.attributes)if(n.match(S0))return n}function yh(e,n){var l,p=e.features||e.results,y=p&&p.length;n?l=n:l=E0(e);var b={type:"FeatureCollection",features:[]};if(y)for(var k=p.length-1;k>=0;k--){var c=T0(p[k],l||P0(p[k]));b.features.push(c)}return b}function hp(e){return e=Te.Util.trim(e),e[e.length-1]!=="/"&&(e+="/"),e}function vh(e){if(e.url.indexOf("?")!==-1){e.requestParams=e.requestParams||{};var n=e.url.substring(e.url.indexOf("?")+1);e.url=e.url.split("?")[0],e.requestParams=JSON.parse('{"'+decodeURI(n).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return e.url=hp(e.url.split("?")[0]),e}function C0(e){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(e)}function Sm(e){var n;switch(e){case"Point":n="esriGeometryPoint";break;case"MultiPoint":n="esriGeometryMultipoint";break;case"LineString":n="esriGeometryPolyline";break;case"MultiLineString":n="esriGeometryPolyline";break;case"Polygon":n="esriGeometryPolygon";break;case"MultiPolygon":n="esriGeometryPolygon";break}return n}function qd(e){return e.getSize().x-tT.attributionWidthOffset+"px"}function xh(e){if(e.attributionControl){if(e.attributionControl._esriAttributionLayerCount||(e.attributionControl._esriAttributionLayerCount=0),e.attributionControl._esriAttributionLayerCount===0){if(!e.attributionControl._esriAttributionAddedOnce){var n=document.createElement("style");n.type="text/css",n.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(n);var l=document.createElement("style");l.type="text/css",l.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+qd(e)+";}",document.getElementsByTagName("head")[0].appendChild(l),e.on("resize",function(p){e.attributionControl&&(e.attributionControl._container.style.maxWidth=qd(p.target))}),e.attributionControl._esriAttributionAddedOnce=!0}e.attributionControl.setPrefix(b0+" | "+dT),Te.DomUtil.addClass(e.attributionControl._container,"esri-truncated-attribution:hover"),Te.DomUtil.addClass(e.attributionControl._container,"esri-truncated-attribution")}e.attributionControl._esriAttributionLayerCount=e.attributionControl._esriAttributionLayerCount+1}}function dp(e){e.attributionControl&&(e.attributionControl._esriAttributionLayerCount&&e.attributionControl._esriAttributionLayerCount===1&&(e.attributionControl.setPrefix(b0),Te.DomUtil.removeClass(e.attributionControl._container,"esri-truncated-attribution:hover"),Te.DomUtil.removeClass(e.attributionControl._container,"esri-truncated-attribution")),e.attributionControl._esriAttributionLayerCount=e.attributionControl._esriAttributionLayerCount-1)}function S_(e){var n={geometry:null,geometryType:null};if(e instanceof Te.LatLngBounds)return n.geometry=T_(e),n.geometryType="esriGeometryEnvelope",n;if(e.getLatLng&&(e=e.getLatLng()),e instanceof Te.LatLng&&(e={type:"Point",coordinates:[e.lng,e.lat]}),e instanceof Te.GeoJSON&&(e=e.getLayers()[0].feature.geometry,n.geometry=dh(e),n.geometryType=Sm(e.type)),e.toGeoJSON&&(e=e.toGeoJSON()),e.type==="Feature"&&(e=e.geometry),e.type==="Point"||e.type==="LineString"||e.type==="Polygon"||e.type==="MultiPolygon")return n.geometry=dh(e),n.geometryType=Sm(e.type),n;cl("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")}function I0(e,n){Ja.cors&&Yu(e,{},Te.Util.bind(function(l,p){if(!l){n._esriAttributions=[];for(var y=0;y<p.contributors.length;y++)for(var b=p.contributors[y],k=0;k<b.coverageAreas.length;k++){var c=b.coverageAreas[k],q=Te.latLng(c.bbox[0],c.bbox[1]),le=Te.latLng(c.bbox[2],c.bbox[3]);n._esriAttributions.push({attribution:b.attribution,score:c.score,bounds:Te.latLngBounds(q,le),minZoom:c.zoomMin,maxZoom:c.zoomMax})}n._esriAttributions.sort(function(ge,K){return K.score-ge.score});var Ie={target:n};$d(Ie)}},this))}function $d(e){var n=e.target,l=n._esriAttributions;if(!(!n||!n.attributionControl)){var p=n.attributionControl._container.querySelector(".esri-dynamic-attribution");if(p&&l){for(var y="",b=n.getBounds(),k=Te.latLngBounds(b.getSouthWest().wrap(),b.getNorthEast().wrap()),c=n.getZoom(),q=0;q<l.length;q++){var le=l[q],Ie=le.attribution;!y.match(Ie)&&le.bounds.intersects(k)&&c>=le.minZoom&&c<=le.maxZoom&&(y+=", "+Ie)}y=y.substr(2),p.innerHTML=y,p.style.maxWidth=qd(n),n.fire("attributionupdated",{attribution:y})}}}var Fc={warn:cl,cleanUrl:hp,getUrlParams:vh,isArcgisOnline:C0,geojsonTypeToArcGIS:Sm,responseToFeatureCollection:yh,geojsonToArcGIS:dh,arcgisToGeoJSON:T0,boundsToExtent:T_,extentToBounds:Tm,calcAttributionWidth:qd,setEsriAttribution:xh,_setGeometry:S_,_getAttributionData:I0,_updateMapAttribution:$d,_findIdAttributeFromFeature:P0,_findIdAttributeFromResponse:E0},E_=Te.Class.extend({options:{proxy:!1,useCors:up},generateSetter:function(e,n){return Te.Util.bind(function(l){return this.params[e]=l,this},n)},initialize:function(e){if(e.request&&e.options?(this._service=e,Te.Util.setOptions(this,e.options)):(Te.Util.setOptions(this,e),this.options.url=hp(e.url)),this.params=Te.Util.extend({},this.params||{}),this.setters)for(var n in this.setters){var l=this.setters[n];this[n]=this.generateSetter(l,this)}},token:function(e){return this._service?this._service.authenticate(e):this.params.token=e,this},apikey:function(e){return this.token(e)},format:function(e){return this.params.returnUnformattedValues=!e,this},request:function(e,n){return this.options.requestParams&&Te.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,e,n):this._request("request",this.path,this.params,e,n)},_request:function(e,n,l,p,y){var b=this.options.proxy?this.options.proxy+"?"+this.options.url+n:this.options.url+n;return(e==="get"||e==="request")&&!this.options.useCors?jd.get.JSONP(b,l,p,y):jd[e](b,l,p,y)}}),pT=E_.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(e){return this._setGeometryParams(e),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(e,n){return e=Te.latLng(e),this.params.geometry=[e.lng,e.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=n,this.params.inSR=4326,this},where:function(e){return this.params.where=e,this},between:function(e,n){return this.params.time=[e.valueOf(),n.valueOf()],this},simplify:function(e,n){var l=Math.abs(e.getBounds().getWest()-e.getBounds().getEast());return this.params.maxAllowableOffset=l/e.getSize().y*n,this},orderBy:function(e,n){return n=n||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[e,n].join(" "),this},run:function(e,n){return this._cleanParams(),this.options.isModern||C0(this.options.url)&&this.options.isModern===void 0?(this.params.f="geojson",this.request(function(l,p){this._trapSQLerrors(l),e.call(n,l,p,p)},this)):this.request(function(l,p){this._trapSQLerrors(l),e.call(n,l,p&&yh(p),p)},this)},count:function(e,n){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(l,p){e.call(this,l,p&&p.count,p)},n)},ids:function(e,n){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(l,p){e.call(this,l,p&&p.objectIds,p)},n)},bounds:function(e,n){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(l,p){p&&p.extent&&Tm(p.extent)?e.call(n,l,Tm(p.extent),p):(l={message:"Invalid Bounds"},e.call(n,l,null,p))},n)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(e){var n=Te.point(e);return this.params.pixelSize=[n.x,n.y],this},layer:function(e){return this.path=e+"/query",this},_trapSQLerrors:function(e){e&&e.code==="400"&&cl("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(e){this.params.inSR=4326;var n=S_(e);this.params.geometry=n.geometry,this.params.geometryType=n.geometryType}});function P_(e){return new pT(e)}var fT=E_.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(e,n){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[e,n].join(":"),this},simplify:function(e,n){var l=Math.abs(e.getBounds().getWest()-e.getBounds().getEast());return this.params.maxAllowableOffset=l/e.getSize().y*n,this},run:function(e,n){return this.request(function(l,p){e.call(n,l,p&&yh(p),p)},n)}});function mT(e){return new fT(e)}var k0=E_.extend({path:"identify",between:function(e,n){return this.params.time=[e.valueOf(),n.valueOf()],this}}),_T=k0.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(e){var n=T_(e.getBounds()),l=e.getSize();return this.params.imageDisplay=[l.x,l.y,96],this.params.mapExtent=[n.xmin,n.ymin,n.xmax,n.ymax],this},at:function(e){return e.length===2&&(e=Te.latLng(e)),this._setGeometryParams(e),this},layerDef:function(e,n){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[e,n].join(":"),this},simplify:function(e,n){var l=Math.abs(e.getBounds().getWest()-e.getBounds().getEast());return this.params.maxAllowableOffset=l/e.getSize().y*n,this},run:function(e,n){return this.request(function(l,p){if(l)e.call(n,l,void 0,p);else{var y=yh(p);p.results=p.results.reverse();for(var b=0;b<y.features.length;b++){var k=y.features[b];k.layerId=p.results[b].layerId}e.call(n,void 0,y,p)}})},_setGeometryParams:function(e){var n=S_(e);this.params.geometry=n.geometry,this.params.geometryType=n.geometryType}});function gT(e){return new _T(e)}var yT=k0.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(e){return e=Te.latLng(e),this.params.geometry=JSON.stringify({x:e.lng,y:e.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(e,n){return this.request(function(l,p){e.call(n,l,p&&this._responseToGeoJSON(p),p)},this)},_responseToGeoJSON:function(e){var n=e.location,l=e.catalogItems,p=e.catalogItemVisibilities,y={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[n.x,n.y]},crs:{type:"EPSG",properties:{code:n.spatialReference.wkid}},properties:{OBJECTID:e.objectId,name:e.name,value:e.value},id:e.objectId}};if(e.properties&&e.properties.Values&&(y.pixel.properties.values=e.properties.Values),l&&l.features&&(y.catalogItems=yh(l),p&&p.length===y.catalogItems.features.length))for(var b=p.length-1;b>=0;b--)y.catalogItems.features[b].properties.catalogItemVisibility=p[b];return y}});function vT(e){return new yT(e)}var C_=Te.Evented.extend({options:{proxy:!1,useCors:up,timeout:0},initialize:function(e){e=e||{},this._requestQueue=[],this._authenticating=!1,Te.Util.setOptions(this,e),this.options.url=hp(this.options.url)},get:function(e,n,l,p){return this._request("get",e,n,l,p)},post:function(e,n,l,p){return this._request("post",e,n,l,p)},request:function(e,n,l,p){return this._request("request",e,n,l,p)},metadata:function(e,n){return this._request("get","",{},e,n)},authenticate:function(e){return this._authenticating=!1,this.options.token=e,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(e){this.options.timeout=e},_request:function(e,n,l,p,y){this.fire("requeststart",{url:this.options.url+n,params:l,method:e},!0);var b=this._createServiceCallback(e,n,l,p,y);if(this.options.token&&(l.token=this.options.token),this.options.requestParams&&Te.Util.extend(l,this.options.requestParams),this._authenticating)this._requestQueue.push([e,n,l,p,y]);else{var k=this.options.proxy?this.options.proxy+"?"+this.options.url+n:this.options.url+n;return(e==="get"||e==="request")&&!this.options.useCors?jd.get.JSONP(k,l,b,y):jd[e](k,l,b,y)}},_createServiceCallback:function(e,n,l,p,y){return Te.Util.bind(function(b,k){b&&(b.code===499||b.code===498)&&(this._authenticating=!0,this._requestQueue.push([e,n,l,p,y]),this.fire("authenticationrequired",{authenticate:Te.Util.bind(this.authenticate,this)},!0),b.authenticate=Te.Util.bind(this.authenticate,this)),p.call(y,b,k),b?this.fire("requesterror",{url:this.options.url+n,params:l,message:b.message,code:b.code,method:e},!0):this.fire("requestsuccess",{url:this.options.url+n,params:l,response:k,method:e},!0),this.fire("requestend",{url:this.options.url+n,params:l,method:e},!0)},this)},_runQueue:function(){for(var e=this._requestQueue.length-1;e>=0;e--){var n=this._requestQueue[e],l=n.shift();this[l].apply(this,n)}this._requestQueue=[]}}),xT=C_.extend({identify:function(){return gT(this)},find:function(){return mT(this)},query:function(){return P_(this)}});function A0(e){return new xT(e)}var wT=C_.extend({query:function(){return P_(this)},identify:function(){return vT(this)}});function bT(e){return new wT(e)}var TT=C_.extend({options:{idAttribute:"OBJECTID"},query:function(){return P_(this)},addFeature:function(e,n,l){this.addFeatures(e,n,l)},addFeatures:function(e,n,l){for(var p=e.features?e.features:[e],y=p.length-1;y>=0;y--)delete p[y].id;return e=dh(e),e=p.length>1?e:[e],this.post("addFeatures",{features:e},function(b,k){var c=k&&k.addResults?k.addResults.length>1?k.addResults:k.addResults[0]:void 0;n&&n.call(l,b||k.addResults[0].error,c)},l)},updateFeature:function(e,n,l){this.updateFeatures(e,n,l)},updateFeatures:function(e,n,l){var p=e.features?e.features:[e];return e=dh(e,this.options.idAttribute),e=p.length>1?e:[e],this.post("updateFeatures",{features:e},function(y,b){var k=b&&b.updateResults?b.updateResults.length>1?b.updateResults:b.updateResults[0]:void 0;n&&n.call(l,y||b.updateResults[0].error,k)},l)},deleteFeature:function(e,n,l){this.deleteFeatures(e,n,l)},deleteFeatures:function(e,n,l){return this.post("deleteFeatures",{objectIds:e},function(p,y){var b=y&&y.deleteResults?y.deleteResults.length>1?y.deleteResults:y.deleteResults[0]:void 0;n&&n.call(l,p||y.deleteResults[0].error,b)},l)}});function ST(e){return new TT(e)}var hn=window.location.protocol!=="https:"?"http:":"https:",sv=Te.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:hn+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:hn+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:$a?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:$a?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:$a?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:$a?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:$a?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:$a?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:$a?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:hn+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:hn+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:hn+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:hn+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(e,n){var l;if(typeof e=="object"&&e.urlTemplate&&e.options)l=e;else if(typeof e=="string"&&sv.TILES[e])l=sv.TILES[e];else throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var p=Te.Util.extend(l.options,n);Te.Util.setOptions(this,p),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&l.urlTemplate.indexOf("token=")===-1&&(l.urlTemplate+="?token="+this.options.token),this.options.proxy&&(l.urlTemplate=this.options.proxy+"?"+l.urlTemplate),Te.TileLayer.prototype.initialize.call(this,l.urlTemplate,p)},onAdd:function(e){xh(e),this.options.pane==="esri-labels"&&this._initPane(),this.options.attributionUrl&&I0((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,e),e.on("moveend",$d),Te.TileLayer.prototype.onAdd.call(this,e)},onRemove:function(e){dp(e),e.off("moveend",$d),Te.TileLayer.prototype.onRemove.call(this,e)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var e=this._map.createPane(this.options.pane);e.style.pointerEvents="none",e.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var e='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return e}}),ET=Te.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{0:156543.033928,1:78271.5169639999,2:39135.7584820001,3:19567.8792409999,4:9783.93962049996,5:4891.96981024998,6:2445.98490512499,7:1222.99245256249,8:611.49622628138,9:305.748113140558,10:152.874056570411,11:76.4370282850732,12:38.2185141425366,13:19.1092570712683,14:9.55462853563415,15:4.77731426794937,16:2.38865713397468,17:1.19432856685505,18:.597164283559817,19:.298582141647617,20:.14929107082381,21:.07464553541191,22:.0373227677059525,23:.0186613838529763}},initialize:function(e){e=Te.Util.setOptions(this,e),e=vh(e),this.tileUrl=(e.proxy?e.proxy+"?":"")+e.url+"tile/{z}/{y}/{x}"+(e.requestParams&&Object.keys(e.requestParams).length>0?Te.Util.getParamString(e.requestParams):""),e.url.indexOf("{s}")!==-1&&e.subdomains&&(e.url=e.url.replace("{s}",e.subdomains[0])),this.service=A0(e),this.service.addEventParent(this);var n=new RegExp(/tiles.arcgis(online)?\.com/g);n.test(e.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),e.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),Te.TileLayer.prototype.initialize.call(this,this.tileUrl,e)},getTileUrl:function(e){var n=this._getZoomForUrl();return Te.Util.template(this.tileUrl,Te.Util.extend({s:this._getSubdomain(e),x:e.x,y:e.y,z:this._lodMap&&this._lodMap[n]?this._lodMap[n]:n},this.options))},createTile:function(e,n){var l=document.createElement("img");return Te.DomEvent.on(l,"load",Te.Util.bind(this._tileOnLoad,this,n,l)),Te.DomEvent.on(l,"error",Te.Util.bind(this._tileOnError,this,n,l)),this.options.crossOrigin&&(l.crossOrigin=""),l.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?l.src=this.getTileUrl(e):this.once("lodmap",function(){l.src=this.getTileUrl(e)},this),l},onAdd:function(e){xh(e),this._lodMap||this.metadata(function(n,l){if(!n&&l.spatialReference){var p=l.spatialReference.latestWkid||l.spatialReference.wkid;if(!this.options.attribution&&e.attributionControl&&l.copyrightText&&(this.options.attribution=l.copyrightText,e.attributionControl.addAttribution(this.getAttribution())),e.options.crs===Te.CRS.EPSG3857&&(p===102100||p===3857)){this._lodMap={};for(var y=l.tileInfo.lods,b=ET.MercatorZoomLevels,k=0;k<y.length;k++){var c=y[k];for(var q in b){var le=b[q];if(this._withinPercentage(c.resolution,le,this.options.zoomOffsetAllowance)){this._lodMap[q]=c.level;break}}}this.fire("lodmap")}else e.options.crs&&e.options.crs.code&&e.options.crs.code.indexOf(p)>-1||cl("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet https://developers.arcgis.com/esri-leaflet/samples/non-mercator-projection/")}},this),Te.TileLayer.prototype.onAdd.call(this,e)},onRemove:function(e){dp(e),Te.TileLayer.prototype.onRemove.call(this,e)},metadata:function(e,n){return this.service.metadata(e,n),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(e){var n="?token="+e;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,n):this.tileUrl+n,this.options.token=e,this.service.authenticate(e),this},_withinPercentage:function(e,n,l){var p=Math.abs(e/n-1);return p<l}}),PT=Te.ImageOverlay.extend({onAdd:function(e){this._topLeft=e.getPixelBounds().min,Te.ImageOverlay.prototype.onAdd.call(this,e)},_reset:function(){this._map.options.crs===Te.CRS.EPSG3857?Te.ImageOverlay.prototype._reset.call(this):Te.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),z0=Te.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:up,attribution:null,interactive:!1,alt:""},onAdd:function(e){xh(e),this.options.zIndex&&(this.options.position=null),this._update=Te.Util.throttle(this._update,this.options.updateInterval,this),e.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?e.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(n,l){!n&&!this.options.attribution&&e.attributionControl&&l.copyrightText&&(this.options.attribution=l.copyrightText,e.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(e){dp(e),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(e,n){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=Te.popup(n),this._popupFunction=e,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(e){return this.options.zIndex=e,this._currentImage&&this._currentImage.setZIndex(e),this},_setAutoZIndex:function(e){if(this._currentImage){for(var n=this._currentImage.getPane().children,l=-e(-1/0,1/0),p=0,y=n.length,b;p<y;p++)b=n[p].style.zIndex,n[p]!==this._currentImage._image&&b&&(l=e(l,+b));isFinite(l)&&(this.options.zIndex=l+e(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(e){return this.options.opacity=e,this._currentImage&&this._currentImage.setOpacity(e),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(e,n){return this.options.from=e,this.options.to=n,this._update(),this},metadata:function(e,n){return this.service.metadata(e,n),this},authenticate:function(e){return this.service.authenticate(e),this},redraw:function(){this._update()},_renderImage:function(e,n,l){if(this._map){if(l&&(e="data:"+l+";base64,"+e),!e)return;var p=new PT(e,n,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),y=function(){this._map.removeLayer(p),this.fire("error"),p.off("load",b,this)},b=function(k){if(p.off("error",y,this),this._map){var c=k.target,q=this._currentImage;c._bounds.equals(n)&&c._bounds.equals(this._map.getBounds())?(this._currentImage=c,this.options.position==="front"?this.bringToFront():this.options.position==="back"&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),q&&this._map&&this._map.removeLayer(q),q&&q._map&&q._map.removeLayer(q)):this._map.removeLayer(c)}this.fire("load",{bounds:n})};p.once("error",y,this),p.once("load",b,this)}},_update:function(){if(this._map){var e=this._map.getZoom(),n=this._map.getBounds();if(!this._animatingZoom&&!(this._map._panTransition&&this._map._panTransition._inProgress)){if(e>this.options.maxZoom||e<this.options.minZoom){this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);return}var l=this._buildExportParams();Te.Util.extend(l,this.options.requestParams),l?(this._requestExport(l,n),this.fire("loading",{bounds:n})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(e,n,l,p){if(e=Te.latLng(e),this._shouldRenderPopup&&this._lastClick.equals(e)){var y=this._popupFunction(n,l,p);y&&this._popup.setLatLng(e).setContent(y).openOn(this._map)}},_resetPopupState:function(e){this._shouldRenderPopup=!1,this._lastClick=e.latlng},_calculateBbox:function(){var e=this._map.getPixelBounds(),n=this._map.unproject(e.getBottomLeft()),l=this._map.unproject(e.getTopRight()),p=this._map.options.crs.project(l),y=this._map.options.crs.project(n),b=Te.bounds(p,y);return[b.getBottomLeft().x,b.getBottomLeft().y,b.getTopRight().x,b.getTopRight().y].join(",")},_calculateImageSize:function(){var e=this._map.getPixelBounds(),n=this._map.getSize(),l=this._map.unproject(e.getBottomLeft()),p=this._map.unproject(e.getTopRight()),y=this._map.latLngToLayerPoint(p).y,b=this._map.latLngToLayerPoint(l).y;return(y>0||b<n.y)&&(n.y=b-y),n.x+","+n.y}});z0.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(e){e=vh(e),this.service=bT(e),this.service.addEventParent(this),Te.Util.setOptions(this,e)},setPixelType:function(e){return this.options.pixelType=e,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(e){return Te.Util.isArray(e)?this.options.bandIds=e.join(","):this.options.bandIds=e.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(e,n){return Te.Util.isArray(e)?this.options.noData=e.join(","):this.options.noData=e.toString(),n&&(this.options.noDataInterpretation=n),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(e){this.options.renderingRule=e,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(e){this.options.mosaicRule=e,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(e){var n=Te.Util.bind(function(p,y,b){p||setTimeout(Te.Util.bind(function(){this._renderPopup(e.latlng,p,y,b)},this),300)},this),l=this.identify().at(e.latlng);this.options.mosaicRule&&l.setMosaicRule(this.options.mosaicRule),l.run(n),this._shouldRenderPopup=!0,this._lastClick=e.latlng},_buildExportParams:function(){var e=parseInt(this._map.options.crs.code.split(":")[1],10),n={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:e,imageSR:e};return this.options.from&&this.options.to&&(n.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(n.pixelType=this.options.pixelType),this.options.interpolation&&(n.interpolation=this.options.interpolation),this.options.compressionQuality&&(n.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(n.bandIds=this.options.bandIds),(this.options.noData===0||this.options.noData)&&(n.noData=this.options.noData),this.options.noDataInterpretation&&(n.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(n.token=this.service.options.token),this.options.renderingRule&&(n.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(n.mosaicRule=JSON.stringify(this.options.mosaicRule)),n},_requestExport:function(e,n){if(this.options.f==="json")this.service.request("exportImage",e,function(p,y){p||(this.options.token&&(y.href+="?token="+this.options.token),this.options.proxy&&(y.href=this.options.proxy+"?"+y.href),this._renderImage(y.href,n))},this);else{e.f="image";var l=this.options.url+"exportImage"+Te.Util.getParamString(e);this.options.proxy&&(l=this.options.proxy+"?"+l),this._renderImage(l,n)}}});z0.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(e){e=vh(e),this.service=A0(e),this.service.addEventParent(this),Te.Util.setOptions(this,e)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(e){return this.options.dynamicLayers=e,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(e){return this.options.layers=e,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(e){return this.options.layerDefs=e,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(e){return this.options.timeOptions=e,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(e){var n=Te.Util.bind(function(y,b,k){y||setTimeout(Te.Util.bind(function(){this._renderPopup(e.latlng,y,b,k)},this),300)},this),l;if(this.options.popup?l=this.options.popup.on(this._map).at(e.latlng):l=this.identify().on(this._map).at(e.latlng),l.params.maxAllowableOffset||l.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?l.layers("visible:"+this.options.layers.join(",")):l.layers("visible")),this.options.layerDefs&&typeof this.options.layerDefs!="string"&&!l.params.layerDefs)for(var p in this.options.layerDefs)Object.prototype.hasOwnProperty.call(this.options.layerDefs,p)&&l.layerDef(p,this.options.layerDefs[p]);l.run(n),this._shouldRenderPopup=!0,this._lastClick=e.latlng},_buildExportParams:function(){var e=parseInt(this._map.options.crs.code.split(":")[1],10),n={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:e,imageSR:e};if(this.options.dynamicLayers&&(n.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(this.options.layers.length===0)return;n.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(n.layerDefs=typeof this.options.layerDefs=="string"?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(n.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(n.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(n.token=this.service.options.token),this.options.proxy&&(n.proxy=this.options.proxy),this.options.disableCache&&(n._ts=Date.now()),n},_requestExport:function(e,n){if(this.options.f==="json")this.service.request("export",e,function(p,y){p||(this.options.token&&y.href&&(y.href+="?token="+this.options.token),this.options.proxy&&y.href&&(y.href=this.options.proxy+"?"+y.href),y.href?this._renderImage(y.href,n):this._renderImage(y.imageData,n,y.contentType))},this);else{e.f="image";var l=this.options.url+"export"+Te.Util.getParamString(e);this.options.proxy&&(l=this.options.proxy+"?"+l),this._renderImage(l,n)}}});var ad=Te.Layer.extend({options:{cellSize:512,updateWhenIdle:Te.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(e){Te.Util.setOptions(this,e)},onAdd:function(e){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(e){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Te.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),e},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var e=this.options.cellSize;return e instanceof Te.Point?e:new Te.Point(e,e)},_pruneCells:function(){if(this._map){var e,n;for(e in this._cells)n=this._cells[e],n.retain=n.current;for(e in this._cells)if(n=this._cells[e],n.current&&!n.active){var l=n.coords;this._retainParent(l.x,l.y,l.z,l.z-5)||this._retainChildren(l.x,l.y,l.z,l.z+2)}for(e in this._cells)this._cells[e].retain||this._removeCell(e)}},_removeAllCells:function(){for(var e in this._cells)this._removeCell(e)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(e,n,l,p){var y=Math.floor(e/2),b=Math.floor(n/2),k=l-1,c=new Te.Point(+y,+b);c.z=+k;var q=this._cellCoordsToKey(c),le=this._cells[q];return le&&le.active?(le.retain=!0,!0):(le&&le.loaded&&(le.retain=!0),k>p?this._retainParent(y,b,k,p):!1)},_retainChildren:function(e,n,l,p){for(var y=2*e;y<2*e+2;y++)for(var b=2*n;b<2*n+2;b++){var k=new Te.Point(y,b);k.z=l+1;var c=this._cellCoordsToKey(k),q=this._cells[c];if(q&&q.active){q.retain=!0;continue}else q&&q.loaded&&(q.retain=!0);l+1<p&&this._retainChildren(y,b,l+1,p)}},_resetView:function(e){var n=e&&(e.pinch||e.flyTo);n||this._setView(this._map.getCenter(),this._map.getZoom(),n,n)},_setView:function(e,n,l,p){var y=Math.round(n);p||(this._cellZoom=y,this._abortLoading&&this._abortLoading(),this._resetGrid(),y!==void 0&&this._update(e),l||this._pruneCells(),this._noPrune=!!l)},_resetGrid:function(){var e=this._map,n=e.options.crs,l=this._cellSize=this.getCellSize(),p=this._cellZoom,y=this._map.getPixelWorldBounds(this._cellZoom);y&&(this._globalCellRange=this._pxBoundsToCellRange(y)),this._wrapX=n.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,n.wrapLng[0]],p).x/l.x),Math.ceil(e.project([0,n.wrapLng[1]],p).x/l.y)],this._wrapY=n.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([n.wrapLat[0],0],p).y/l.x),Math.ceil(e.project([n.wrapLat[1],0],p).y/l.y)]},_onMoveEnd:function(e){var n=e&&(e.pinch||e.flyTo);n||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(e){var n=this._map,l=n._animatingZoom?Math.max(n._animateToZoom,n.getZoom()):n.getZoom(),p=n.getZoomScale(l,this._cellZoom),y=n.project(e,this._cellZoom).floor(),b=n.getSize().divideBy(p*2);return new Te.Bounds(y.subtract(b),y.add(b))},_update:function(e){var n=this._map;if(n){var l=Math.round(n.getZoom());e===void 0&&(e=n.getCenter());var p=this._getCelldPixelBounds(e),y=this._pxBoundsToCellRange(p),b=y.getCenter(),k=[],c=this.options.keepBuffer,q=new Te.Bounds(y.getBottomLeft().subtract([c,-c]),y.getTopRight().add([c,-c]));if(!(isFinite(y.min.x)&&isFinite(y.min.y)&&isFinite(y.max.x)&&isFinite(y.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var le in this._cells){var Ie=this._cells[le].coords;(Ie.z!==this._cellZoom||!q.contains(new Te.Point(Ie.x,Ie.y)))&&(this._cells[le].current=!1)}if(Math.abs(l-this._cellZoom)>1){this._setView(e,l);return}for(var ge=y.min.y;ge<=y.max.y;ge++)for(var K=y.min.x;K<=y.max.x;K++){var Ze=new Te.Point(K,ge);if(Ze.z=this._cellZoom,!!this._isValidCell(Ze)){var Ve=this._cells[this._cellCoordsToKey(Ze)];Ve?Ve.current=!0:k.push(Ze)}}if(k.sort(function(ye,ue){return ye.distanceTo(b)-ue.distanceTo(b)}),k.length!==0)for(this._loading||(this._loading=!0),K=0;K<k.length;K++){var De=this._cellCoordsToKey(k[K]),Qt=this._keyToCellCoords(De);this._activeCells[Qt]?this._reuseCell(k[K]):this._createCell(k[K])}}},_isValidCell:function(e){var n=this._map.options.crs;if(!n.infinite){var l=this._globalCellRange;if(!n.wrapLng&&(e.x<l.min.x||e.x>l.max.x)||!n.wrapLat&&(e.y<l.min.y||e.y>l.max.y))return!1}if(!this.options.bounds)return!0;var p=this._cellCoordsToBounds(e);return Te.toLatLngBounds(this.options.bounds).overlaps(p)},_keyToBounds:function(e){return this._cellCoordsToBounds(this._keyToCellCoords(e))},_cellCoordsToNwSe:function(e){var n=this._map,l=this.getCellSize(),p=e.scaleBy(l),y=p.add(l),b=n.unproject(p,e.z),k=n.unproject(y,e.z);return[b,k]},_cellCoordsToBounds:function(e){var n=this._cellCoordsToNwSe(e),l=new Te.LatLngBounds(n[0],n[1]);return this.options.noWrap||(l=this._map.wrapLatLngBounds(l)),l},_cellCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToCellCoords:function(e){var n=e.split(":"),l=new Te.Point(+n[0],+n[1]);return l.z=+n[2],l},_removeCell:function(e){var n=this._cells[e];if(n){var l=this._keyToCellCoords(e),p=this._wrapCoords(l),y=this._cellCoordsToBounds(this._wrapCoords(l));n.current=!1,delete this._cells[e],this._activeCells[e]=n,this.cellLeave(y,p,e),this.fire("cellleave",{key:e,coords:p,bounds:y})}},_reuseCell:function(e){var n=this._cellCoordsToKey(e);this._cells[n]=this._activeCells[n],this._cells[n].current=!0;var l=this._wrapCoords(e),p=this._cellCoordsToBounds(this._wrapCoords(e));this.cellEnter(p,l,n),this.fire("cellenter",{key:n,coords:l,bounds:p})},_createCell:function(e){var n=this._cellCoordsToKey(e),l=this._wrapCoords(e),p=this._cellCoordsToBounds(this._wrapCoords(e));this.createCell(p,l,n),this.fire("cellcreate",{key:n,coords:l,bounds:p}),this._cells[n]={coords:e,current:!0},Te.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(e,n,l){var p=this._cellCoordsToKey(e);l=this._cells[p],l&&(l.loaded=+new Date,l.active=!0)},_getCellPos:function(e){return e.scaleBy(this.getCellSize())},_wrapCoords:function(e){var n=new Te.Point(this._wrapX?Te.Util.wrapNum(e.x,this._wrapX):e.x,this._wrapY?Te.Util.wrapNum(e.y,this._wrapY):e.y);return n.z=e.z,n},_pxBoundsToCellRange:function(e){var n=this.getCellSize();return new Te.Bounds(e.min.unscaleBy(n).floor(),e.max.unscaleBy(n).ceil().subtract([1,1]))}});function ma(e){this.values=[].concat(e||[])}ma.prototype.query=function(e){var n=this.getIndex(e);return this.values[n]};ma.prototype.getIndex=function(n){this.dirty&&this.sort();for(var l=0,p=this.values.length-1,y,b;l<=p;)if(y=(l+p)/2|0,b=this.values[Math.round(y)],+b.value<+n)l=y+1;else if(+b.value>+n)p=y-1;else return y;return Math.abs(~p)};ma.prototype.between=function(n,l){var p=this.getIndex(n),y=this.getIndex(l);if(p===0&&y===0)return[];for(;this.values[p-1]&&this.values[p-1].value===n;)p--;for(;this.values[y+1]&&this.values[y+1].value===l;)y++;return this.values[y]&&this.values[y].value===l&&this.values[y+1]&&y++,this.values.slice(p,y)};ma.prototype.insert=function(n){return this.values.splice(this.getIndex(n.value),0,n),this};ma.prototype.bulkAdd=function(n,l){return this.values=this.values.concat([].concat(n||[])),l?this.sort():this.dirty=!0,this};ma.prototype.sort=function(){return this.values.sort(function(n,l){return+l.value-+n.value}).reverse(),this.dirty=!1,this};var Sf=ad.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(e){if(ad.prototype.initialize.call(this,e),e=vh(e),e=Te.Util.setOptions(this,e),this.service=ST(e),this.service.addEventParent(this),this.options.fields[0]!=="*"){for(var n=!1,l=0;l<this.options.fields.length;l++)this.options.fields[l].match(/^(OBJECTID|FID|OID|ID)$/i)&&(n=!0);n===!1&&cl("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new ma,this._endTimeIndex=new ma):this.options.timeField&&(this._timeIndex=new ma),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(e){return xh(e),this.service.metadata(function(n,l){if(!n){var p=l.supportedQueryFormats,y=!1;(this.service.options.isModern===!1||this.options.fetchAllFeatures)&&(y=!0),!y&&p&&p.indexOf("geoJSON")!==-1&&(this.service.options.isModern=!0),l.objectIdField&&(this.service.options.idAttribute=l.objectIdField),!this.options.attribution&&e.attributionControl&&l.copyrightText&&(this.options.attribution=l.copyrightText,e.attributionControl.addAttribution(this.getAttribution()))}},this),e.on("zoomend",this._handleZoomChange,this),ad.prototype.onAdd.call(this,e)},onRemove:function(e){return dp(e),e.off("zoomend",this._handleZoomChange,this),ad.prototype.onRemove.call(this,e)},getAttribution:function(){return this.options.attribution},createCell:function(e,n){this._visibleZoom()&&this._requestFeatures(e,n)},_requestFeatures:function(e,n,l,p){this._activeRequests++,p=p||0;var y=this.options.where;return this._activeRequests===1&&this.fire("loading",{bounds:e},!0),this._buildQuery(e,p).run(function(b,k,c){c&&c.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===y&&(!b&&k&&k.features.length&&Te.Util.requestAnimFrame(Te.Util.bind(function(){this._addFeatures(k.features,n),this._postProcessFeatures(e)},this)),!b&&k&&!k.features.length&&this._postProcessFeatures(e),b&&this._postProcessFeatures(e),l&&l.call(this,b,k),c&&(c.exceededTransferLimit||c.properties&&c.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(e,n,l,p+k.features.length))},this)},_postProcessFeatures:function(e){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:e})},_cacheKey:function(e){return e.z+":"+e.x+":"+e.y},_addFeatures:function(e,n){if(n){var l=this._cacheKey(n);this._cache[l]=this._cache[l]||[]}for(var p=e.length-1;p>=0;p--){var y=e[p].id;this._currentSnapshot.indexOf(y)===-1&&this._currentSnapshot.push(y),typeof l<"u"&&this._cache[l].indexOf(y)===-1&&this._cache[l].push(y)}this.options.timeField&&this._buildTimeIndexes(e),this.createLayers(e)},_buildQuery:function(e,n){var l=this.service.query().intersects(e).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(n))&&(l=l.offset(n)),l.params.resultType="tile",this.options.requestParams&&Te.Util.extend(l.params,this.options.requestParams),this.options.simplifyFactor&&l.simplify(this._map,this.options.simplifyFactor),this.options.timeFilterMode==="server"&&this.options.from&&this.options.to&&l.between(this.options.from,this.options.to),l},setWhere:function(e,n,l){this.options.where=e&&e.length?e:"1=1";for(var p=[],y=[],b=0,k=null,c=Te.Util.bind(function(K,Ze){if(K&&(k=K),Ze)for(var Ve=Ze.features.length-1;Ve>=0;Ve--)y.push(Ze.features[Ve].id);b--,b<=0&&this._visibleZoom()&&e===this.options.where&&(this._currentSnapshot=y,Te.Util.requestAnimFrame(Te.Util.bind(function(){this.removeLayers(p),this.addLayers(y),n&&n.call(l,k)},this)))},this),q=this._currentSnapshot.length-1;q>=0;q--)p.push(this._currentSnapshot[q]);this._cache={};for(var le in this._cells){b++;var Ie=this._keyToCellCoords(le),ge=this._cellCoordsToBounds(Ie);this._requestFeatures(ge,Ie,c)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(e,n,l,p){var y=this.options.from,b=this.options.to,k=0,c=null,q=Te.Util.bind(function(K){K&&(c=K),this._filterExistingFeatures(y,b,e,n),k--,l&&k<=0&&l.call(p,c)},this);if(this.options.from=e,this.options.to=n,this._filterExistingFeatures(y,b,e,n),this.options.timeFilterMode==="server")for(var le in this._cells){k++;var Ie=this._keyToCellCoords(le),ge=this._cellCoordsToBounds(Ie);this._requestFeatures(ge,Ie,q)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(e,n,l,p){var y=e&&n?this._getFeaturesInTimeRange(e,n):this._currentSnapshot,b=this._getFeaturesInTimeRange(l,p);if(b.indexOf)for(var k=0;k<b.length;k++){var c=y.indexOf(b[k]);c>=0&&y.splice(c,1)}Te.Util.requestAnimFrame(Te.Util.bind(function(){this.removeLayers(y),this.addLayers(b)},this))},_getFeaturesInTimeRange:function(e,n){var l=[],p;if(this.options.timeField.start&&this.options.timeField.end){var y=this._startTimeIndex.between(e,n),b=this._endTimeIndex.between(e,n);p=y.concat(b)}else if(this._timeIndex)p=this._timeIndex.between(e,n);else return cl("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];for(var k=p.length-1;k>=0;k--)l.push(p[k].id);return l},_buildTimeIndexes:function(e){var n,l;if(this.options.timeField.start&&this.options.timeField.end){var p=[],y=[];for(n=e.length-1;n>=0;n--)l=e[n],p.push({id:l.id,value:new Date(l.properties[this.options.timeField.start])}),y.push({id:l.id,value:new Date(l.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(p),this._endTimeIndex.bulkAdd(y)}else{var b=[];for(n=e.length-1;n>=0;n--)l=e[n],b.push({id:l.id,value:new Date(l.properties[this.options.timeField])});this._timeIndex.bulkAdd(b)}},_featureWithinTimeRange:function(e){if(!this.options.from||!this.options.to)return!0;var n=+this.options.from.valueOf(),l=+this.options.to.valueOf();if(typeof this.options.timeField=="string"){var p=+e.properties[this.options.timeField];return p>=n&&p<=l}if(this.options.timeField.start&&this.options.timeField.end){var y=+e.properties[this.options.timeField.start],b=+e.properties[this.options.timeField.end];return y>=n&&y<=l||b>=n&&b<=l||y<=n&&b>=l}},_visibleZoom:function(){if(!this._map)return!1;var e=this._map.getZoom();return!(e>this.options.maxZoom||e<this.options.minZoom)},_handleZoomChange:function(){if(!this._visibleZoom())this.removeLayers(this._currentSnapshot),this._currentSnapshot=[];else for(var e in this._cells){var n=this._cells[e].coords,l=this._cacheKey(n);this._cache[l]&&this.addLayers(this._cache[l])}},authenticate:function(e){return this.service.authenticate(e),this},metadata:function(e,n){return this.service.metadata(e,n),this},query:function(){return this.service.query()},_getMetadata:function(e){if(this._metadata){var n;e(n,this._metadata)}else this.metadata(Te.Util.bind(function(l,p){this._metadata=p,e(l,this._metadata)},this))},addFeature:function(e,n,l){this.addFeatures(e,n,l)},addFeatures:function(e,n,l){this._getMetadata(Te.Util.bind(function(p,y){if(p){n&&n.call(this,p,null);return}var b=e.features?e.features:[e];this.service.addFeatures(e,Te.Util.bind(function(k,c){if(!k){for(var q=b.length-1;q>=0;q--)b[q].properties[y.objectIdField]=b.length>1?c[q].objectId:c.objectId,b[q].id=b.length>1?c[q].objectId:c.objectId;this._addFeatures(b)}n&&n.call(l,k,c)},this))},this))},updateFeature:function(e,n,l){this.updateFeatures(e,n,l)},updateFeatures:function(e,n,l){var p=e.features?e.features:[e];this.service.updateFeatures(e,function(y,b){if(!y){for(var k=p.length-1;k>=0;k--)this.removeLayers([p[k].id],!0);this._addFeatures(p)}n&&n.call(l,y,b)},this)},deleteFeature:function(e,n,l){this.deleteFeatures(e,n,l)},deleteFeatures:function(e,n,l){return this.service.deleteFeatures(e,function(p,y){var b=y.length?y:[y];if(!p&&b.length>0)for(var k=b.length-1;k>=0;k--)this.removeLayers([b[k].objectId],!0);n&&n.call(l,p,y)},this)}}),CT=Sf.extend({options:{cacheLayers:!0},initialize:function(e){e.apikey&&(e.token=e.apikey),Sf.prototype.initialize.call(this,e),this._originalStyle=this.options.style,this._layers={}},onRemove:function(e){for(var n in this._layers)e.removeLayer(this._layers[n]),this.fire("removefeature",{feature:this._layers[n].feature,permanent:!1},!0);return Sf.prototype.onRemove.call(this,e)},createNewLayer:function(e){var n=Te.GeoJSON.geometryToLayer(e,this.options);return n&&(n.defaultOptions=n.options),n},_updateLayer:function(e,n){var l=[],p=this.options.coordsToLatLng||Te.GeoJSON.coordsToLatLng;switch(n.properties&&(e.feature.properties=n.properties),n.geometry.type){case"Point":l=Te.GeoJSON.coordsToLatLng(n.geometry.coordinates),e.setLatLng(l);break;case"LineString":l=Te.GeoJSON.coordsToLatLngs(n.geometry.coordinates,0,p),e.setLatLngs(l);break;case"MultiLineString":l=Te.GeoJSON.coordsToLatLngs(n.geometry.coordinates,1,p),e.setLatLngs(l);break;case"Polygon":l=Te.GeoJSON.coordsToLatLngs(n.geometry.coordinates,1,p),e.setLatLngs(l);break;case"MultiPolygon":l=Te.GeoJSON.coordsToLatLngs(n.geometry.coordinates,2,p),e.setLatLngs(l);break}this.redraw(e.feature.id)},createLayers:function(e){for(var n=e.length-1;n>=0;n--){var l=e[n],p=this._layers[l.id],y;this._visibleZoom()&&p&&!this._map.hasLayer(p)&&(!this.options.timeField||this._featureWithinTimeRange(l))&&(this._map.addLayer(p),this.fire("addfeature",{feature:p.feature},!0)),p&&(p.setLatLngs||p.setLatLng)&&this._updateLayer(p,l),p||(y=this.createNewLayer(l),y?(y.feature=l,y.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(y.feature,y),this._layers[y.feature.id]=y,this.setFeatureStyle(y.feature.id,this.options.style),this.fire("createfeature",{feature:y.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(l))&&this._map.addLayer(y)):cl("invalid GeoJSON encountered"))}},addLayers:function(e){for(var n=e.length-1;n>=0;n--){var l=this._layers[e[n]];l&&(!this.options.timeField||this._featureWithinTimeRange(l.feature))&&(this._map.addLayer(l),this.fire("addfeature",{feature:l.feature},!0))}},removeLayers:function(e,n){for(var l=e.length-1;l>=0;l--){var p=e[l],y=this._layers[p];y&&(this.fire("removefeature",{feature:y.feature,permanent:n},!0),this._map.removeLayer(y)),y&&n&&delete this._layers[p]}},cellEnter:function(e,n){this._visibleZoom()&&!this._zooming&&this._map&&Te.Util.requestAnimFrame(Te.Util.bind(function(){var l=this._cacheKey(n),p=this._cellCoordsToKey(n),y=this._cache[l];this._activeCells[p]&&y&&this.addLayers(y)},this))},cellLeave:function(e,n){this._zooming||Te.Util.requestAnimFrame(Te.Util.bind(function(){if(this._map){var l=this._cacheKey(n),p=this._cellCoordsToKey(n),y=this._cache[l],b=this._map.getBounds();if(!this._activeCells[p]&&y){for(var k=!0,c=0;c<y.length;c++){var q=this._layers[y[c]];q&&q.getBounds&&b.intersects(q.getBounds())&&(k=!1)}k&&this.removeLayers(y,!this.options.cacheLayers),!this.options.cacheLayers&&k&&(delete this._cache[l],delete this._cells[p],delete this._activeCells[p])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(e){this.resetFeatureStyle(e.feature.id)},this),this},setStyle:function(e){return this.options.style=e,this.eachFeature(function(n){this.setFeatureStyle(n.feature.id,e)},this),this},resetFeatureStyle:function(e){var n=this._layers[e],l=this._originalStyle||Te.Path.prototype.options;return n&&(Te.Util.extend(n.options,n.defaultOptions),this.setFeatureStyle(e,l)),this},setFeatureStyle:function(e,n){var l=this._layers[e];return typeof n=="function"&&(n=n(l.feature)),l.setStyle&&l.setStyle(n),this},eachActiveFeature:function(e,n){if(this._map){var l=this._map.getBounds();for(var p in this._layers)this._currentSnapshot.indexOf(this._layers[p].feature.id)!==-1&&(typeof this._layers[p].getLatLng=="function"&&l.contains(this._layers[p].getLatLng())?e.call(n,this._layers[p]):typeof this._layers[p].getBounds=="function"&&l.intersects(this._layers[p].getBounds())&&e.call(n,this._layers[p]))}return this},eachFeature:function(e,n){for(var l in this._layers)e.call(n,this._layers[l]);return this},getFeature:function(e){return this._layers[e]},bringToBack:function(){this.eachFeature(function(e){e.bringToBack&&e.bringToBack()})},bringToFront:function(){this.eachFeature(function(e){e.bringToFront&&e.bringToFront()})},redraw:function(e){return e&&this._redraw(e),this},_redraw:function(e){var n=this._layers[e],l=n.feature;if(n&&n.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var p=this.options.pointToLayer(l,Te.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0])),y=p.options.icon;n.setIcon(y)}if(n&&n.setStyle&&this.options.pointToLayer){var b=this.options.pointToLayer(l,Te.latLng(l.geometry.coordinates[1],l.geometry.coordinates[0])),k=b.options;this.setFeatureStyle(l.id,k)}n&&n.setStyle&&this.options.style&&this.resetFeatureStyle(l.id)},openPopup(e){return this._popup&&this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map),this},openTooltip(e){return this._tooltip&&this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this)),this}});function IT(e,n){let l="https://basemaps-api.arcgis.com/arcgis/rest/services/styles/"+e+"?type=style";return n&&(l=l+"&apiKey="+n),l}function kT(e,n,l){const p=/^https?:\/\//,y=/\/VectorTileServer\/?$/;p.test(e)&&y.test(e)?L0(e,n,l):AT(e,n,l)}function M0(e,n,l){const p=n.token?{token:n.token}:{};Yu(e,p,l)}function av(e,n,l){const p=n.token?{token:n.token}:{},y=n.portalUrl+"/sharing/rest/content/items/"+e;Yu(y,p,l)}function AT(e,n,l){const p=n.portalUrl+"/sharing/rest/content/items/"+e+"/resources/styles/root.json";D0(p,n,function(y,b){y?av(e,n,function(k,c){k&&console.error(k),L0(c.url,n,l)}):av(e,n,function(k,c){k&&console.error(k),M0(c.url,n,function(q,le){l(q,b,p,le,c.url)})})})}function L0(e,n,l){M0(e,n,function(p,y){p&&console.error(p);let b=e;e.charAt(e.length-1)==="/"&&(b=e.slice(0,e.length-1));let k;y.defaultStyles.charAt(0)==="/"?k=b+y.defaultStyles+"/root.json":k=b+"/"+y.defaultStyles+"/root.json",D0(k,n,function(c,q){c&&console.error(c),l(null,q,k,y,e)})})}function D0(e,n,l){const p=n.token?{token:n.token}:{};Yu(e,p,l)}function zT(e,n,l,p){const y=Object.keys(e.sources);for(let k=0;k<y.length;k++){const c=e.sources[y[k]];c.url.indexOf("http")===-1&&(c.url=n.replace("/resources/styles/root.json","")),c.url.charAt(c.url.length-1)==="/"&&(c.url=c.url.slice(0,c.url.length-1)),c.tiles||(l.tiles&&l.tiles[0].charAt(0)!=="/"&&(l.tiles[0]="/"+l.tiles[0]),c.tiles=[c.url+l.tiles[0]]),c.url+="?f=json",c.url+=p?"&token="+p:"",c.tiles[0]+=p?"?token="+p:"",c.minzoom=l.tileInfo.lods[0].level,c.maxzoom=l.tileInfo.lods[l.tileInfo.lods.length-1].level}const b=e.sources[y[y.length-1]];b.attribution=l.copyrightText||"",b.copyrightText=l.copyrightText||"";for(let k=0;k<e.layers.length;k++){const c=e.layers[k];c.layout&&c.layout["text-font"]&&c.layout["text-font"].length>1&&(c.layout["text-font"]=[c.layout["text-font"][0]])}return e.sprite&&e.sprite.indexOf("http")===-1&&(e.sprite=n.replace("styles/root.json",e.sprite.replace("../","")),e.sprite+=p?"?token="+p:""),e.glyphs&&e.glyphs.indexOf("http")===-1&&(e.glyphs=n.replace("styles/root.json",e.glyphs.replace("../","")),e.glyphs+=p?"?token="+p:""),e}function MT(e,n){Ja.cors&&Yu(e,{},function(l,p){if(l)return;n._esriAttributions=n._esriAttributions||[];for(let b=0;b<p.contributors.length;b++){const k=p.contributors[b];for(let c=0;c<k.coverageAreas.length;c++){const q=k.coverageAreas[c],le=Te.latLng(q.bbox[0],q.bbox[1]),Ie=Te.latLng(q.bbox[2],q.bbox[3]);n._esriAttributions.push({attribution:k.attribution,score:q.score,bounds:Te.latLngBounds(le,Ie),minZoom:q.zoomMin,maxZoom:q.zoomMax})}}n._esriAttributions.sort(function(b,k){return k.score-b.score});const y={target:n};Fc._updateMapAttribution(y)})}const LT=[3857,102100,102113];function DT(e){return LT.indexOf(e)>=0}var Em={},RT={get exports(){return Em},set exports(e){Em=e}};(function(e,n){(function(l,p){e.exports=p()})(uv,function(){var l,p,y;function b(c,q){if(!l)l=q;else if(!p)p=q;else{var le="var sharedChunk = {}; ("+l+")(sharedChunk); ("+p+")(sharedChunk);",Ie={};l(Ie),y=q(Ie),typeof window<"u"&&(y.workerUrl=window.URL.createObjectURL(new Blob([le],{type:"text/javascript"})))}}b(["exports"],function(c){var q=le;function le(r,t,o,u){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(u-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=u}function Ie(r,t,o,u){const m=new q(r,t,o,u);return function(g){return m.solve(g)}}le.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,u=0;u<8;u++){var m=this.sampleCurveX(o)-r;if(Math.abs(m)<t)return o;var g=this.sampleCurveDerivativeX(o);if(Math.abs(g)<1e-6)break;o-=m/g}var x=0,S=1;for(o=r,u=0;u<20&&(m=this.sampleCurveX(o),!(Math.abs(m-r)<t));u++)r>m?x=o:S=o,o=.5*(S-x)+x;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};const ge=Ie(.25,.1,.25,1);function K(r,t,o){return Math.min(o,Math.max(t,r))}function Ze(r,t,o){const u=o-t,m=((r-t)%u+u)%u+t;return m===t?o:m}function Ve(r,...t){for(const o of t)for(const u in o)r[u]=o[u];return r}let De=1;function Qt(r,t){r.forEach(o=>{t[o]&&(t[o]=t[o].bind(t))})}function ye(r,t,o){const u={};for(const m in r)u[m]=t.call(o||this,r[m],m,r);return u}function ue(r,t,o){const u={};for(const m in r)t.call(o||this,r[m],m,r)&&(u[m]=r[m]);return u}function me(r){return Array.isArray(r)?r.map(me):typeof r=="object"&&r?ye(r,me):r}const Ue={};function $e(r){Ue[r]||(typeof console<"u"&&console.warn(r),Ue[r]=!0)}function lt(r,t,o){return(o.y-r.y)*(t.x-r.x)>(t.y-r.y)*(o.x-r.x)}function dt(r){let t=0;for(let o,u,m=0,g=r.length,x=g-1;m<g;x=m++)o=r[m],u=r[x],t+=(u.x-o.x)*(o.y+u.y);return t}function pt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function ci(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,m,g)=>{const x=m||g;return t[u]=!x||x.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let Ct,ei,_i=null;function $n(r){if(_i==null){const t=r.navigator?r.navigator.userAgent:null;_i=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return _i}function Ni(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}const xr={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(r){const t=requestAnimationFrame(r);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(r,t=0){const o=window.document.createElement("canvas"),u=o.getContext("2d");if(!u)throw new Error("failed to create canvas 2d context");return o.width=r.width,o.height=r.height,u.drawImage(r,0,0,r.width,r.height),u.getImageData(-t,-t,r.width+2*t,r.height+2*t)},resolveURL:r=>(Ct||(Ct=document.createElement("a")),Ct.href=r,Ct.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ei==null&&(ei=matchMedia("(prefers-reduced-motion: reduce)")),ei.matches)}};var ut=Ji;function Ji(r,t){this.x=r,this.y=t}Ji.prototype={clone:function(){return new Ji(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,o=r.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),o=Math.sin(r),u=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=u,this},_rotateAround:function(r,t){var o=Math.cos(r),u=Math.sin(r),m=t.y+u*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-u*(this.y-t.y),this.y=m,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ji.convert=function(r){return r instanceof Ji?r:Array.isArray(r)?new Ji(r[0],r[1]):r};const Re={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},vt="mapbox-tiles";let Ge,Tt,Ut=500,bi=50;function ni(){typeof caches>"u"||Ge||(Ge=caches.open(vt))}let Lt=1/0;const Dt={supported:!1,testSupport:function(r){!fn&&pn&&(co?Bo(r):Ai=r)}};let Ai,pn,fn=!1,co=!1;function Bo(r){const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,pn),r.isContextLost())return;Dt.supported=!0}catch{}r.deleteTexture(t),fn=!0}typeof document<"u"&&(pn=document.createElement("img"),pn.onload=function(){Ai&&Bo(Ai),Ai=null,co=!0},pn.onerror=function(){fn=!0,Ai=null},pn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Dn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Dn);class mn extends Error{constructor(t,o,u,m){super(`AJAXError: ${o} (${t}): ${u}`),this.status=t,this.statusText=o,this.url=u,this.body=m}}const Ms=pt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function Vr(r,t){const o=new AbortController,u=new Request(r.url,{method:r.method||"GET",body:r.body,credentials:r.credentials,headers:r.headers,referrer:Ms(),signal:o.signal});let m=!1,g=!1;return r.type==="json"&&u.headers.set("Accept","application/json"),((x,S,P)=>{if(g)return;const A=Date.now();fetch(u).then(R=>R.ok?((O,U,j)=>{(r.type==="arrayBuffer"?O.arrayBuffer():r.type==="json"?O.json():O.text()).then($=>{g||(U&&j&&function(te,ee,_e){if(ni(),!Ge)return;const Se={status:ee.status,statusText:ee.statusText,headers:new Headers};ee.headers.forEach((we,Le)=>Se.headers.set(Le,we));const fe=ci(ee.headers.get("Cache-Control")||"");fe["no-store"]||(fe["max-age"]&&Se.headers.set("Expires",new Date(_e+1e3*fe["max-age"]).toUTCString()),new Date(Se.headers.get("Expires")).getTime()-_e<42e4||function(we,Le){if(Tt===void 0)try{new Response(new ReadableStream),Tt=!0}catch{Tt=!1}Tt?Le(we.body):we.blob().then(Le)}(ee,we=>{const Le=new Response(we,Se);ni(),Ge&&Ge.then(Me=>Me.put(function(st){const ht=st.indexOf("?");return ht<0?st:st.slice(0,ht)}(te.url),Le)).catch(Me=>$e(Me.message))}))}(u,U,j),m=!0,t(null,$,O.headers.get("Cache-Control"),O.headers.get("Expires")))}).catch($=>{g||t(new Error($.message))})})(R,null,A):R.blob().then(O=>t(new mn(R.status,R.statusText,r.url,O)))).catch(R=>{R.code!==20&&t(new Error(R.message))})})(),{cancel:()=>{g=!0,m||o.abort()}}}const Oo=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){if(pt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,t);if(!pt()){const u=r.url.substring(0,r.url.indexOf("://"));return(Re.REGISTERED_PROTOCOLS[u]||Vr)(r,t)}}if(!(/^file:/.test(o=r.url)||/^file:/.test(Ms())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Vr(r,t);if(pt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,t,void 0,!0)}var o;return function(u,m){const g=new XMLHttpRequest;g.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const x in u.headers)g.setRequestHeader(x,u.headers[x]);return u.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=u.credentials==="include",g.onerror=()=>{m(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let x=g.response;if(u.type==="json")try{x=JSON.parse(g.response)}catch(S){return m(S)}m(null,x,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else{const x=new Blob([g.response],{type:g.getResponseHeader("Content-Type")});m(new mn(g.status,g.statusText,u.url,x))}},g.send(u.body),{cancel:()=>g.abort()}}(r,t)},ho=function(r,t){return Oo(Ve(r,{type:"arrayBuffer"}),t)};function po(r){const t=window.document.createElement("a");return t.href=r,t.protocol===window.document.location.protocol&&t.host===window.document.location.host}const qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let or,wr;or=[],wr=0;const Zr=function(r,t){if(Dt.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),wr>=Re.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:r,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return or.push(g),g}wr++;let o=!1;const u=()=>{if(!o)for(o=!0,wr--;or.length&&wr<Re.MAX_PARALLEL_IMAGE_REQUESTS;){const g=or.shift(),{requestParameters:x,callback:S,cancelled:P}=g;P||(g.cancel=Zr(x,S).cancel)}},m=ho(r,(g,x,S,P)=>{u(),g?t(g):x&&function(A,R){typeof createImageBitmap=="function"?function(O,U){const j=new Blob([new Uint8Array(O)],{type:"image/png"});createImageBitmap(j).then($=>{U(null,$)}).catch($=>{U(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(A,R):function(O,U){const j=new Image;j.onload=()=>{U(null,j),URL.revokeObjectURL(j.src),j.onload=null,window.requestAnimationFrame(()=>{j.src=qt})},j.onerror=()=>U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const $=new Blob([new Uint8Array(O)],{type:"image/png"});j.src=O.byteLength?URL.createObjectURL($):qt}(A,R)}(x,(A,R)=>{A!=null?t(A):R!=null&&t(null,R,{cacheControl:S,expires:P})})});return{cancel:()=>{m.cancel(),u()}}};function ps(r,t,o){o[r]&&o[r].indexOf(t)!==-1||(o[r]=o[r]||[],o[r].push(t))}function Gr(r,t,o){if(o&&o[r]){const u=o[r].indexOf(t);u!==-1&&o[r].splice(u,1)}}class jr{constructor(t,o={}){Ve(this,o),this.type=t}}class fo extends jr{constructor(t,o={}){super("error",Ve({error:t},o))}}class br{on(t,o){return this._listeners=this._listeners||{},ps(t,o,this._listeners),this}off(t,o){return Gr(t,o,this._listeners),Gr(t,o,this._oneTimeListeners),this}once(t,o){return this._oneTimeListeners=this._oneTimeListeners||{},ps(t,o,this._oneTimeListeners),this}fire(t,o){typeof t=="string"&&(t=new jr(t,o||{}));const u=t.type;if(this.listens(u)){t.target=this;const m=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const S of m)S.call(this,t);const g=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const S of g)Gr(u,S,this._oneTimeListeners),S.call(this,t);const x=this._eventedParent;x&&(Ve(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),x.fire(t))}else t instanceof fo&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var ke={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Xe{constructor(t,o,u,m){this.message=(t?`${t}: `:"")+u,m&&(this.identifier=m),o!=null&&o.__line__&&(this.line=o.__line__)}}function mo(r){const t=r.value;return t?[new Xe(r.key,t,"constants have been deprecated as of v8")]:[]}function Wn(r,...t){for(const o of t)for(const u in o)r[u]=o[u];return r}function $t(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Rn(r){if(Array.isArray(r))return r.map(Rn);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const o in r)t[o]=Rn(r[o]);return t}return $t(r)}class _n extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class bn{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[u,m]of o)this.bindings[u]=m}concat(t){return new bn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const _o={kind:"null"},je={kind:"number"},At={kind:"string"},Pt={kind:"boolean"},$i={kind:"color"},qr={kind:"object"},St={kind:"value"},$r={kind:"collator"},Wi={kind:"formatted"},fs={kind:"padding"},Di={kind:"resolvedImage"};function gn(r,t){return{kind:"array",itemType:r,N:t}}function oi(r){if(r.kind==="array"){const t=oi(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const go=[_o,je,At,Pt,$i,Wi,qr,gn(St),fs,Di];function Tr(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Tr(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const o of go)if(!Tr(o,t))return null}}return`Expected ${oi(r)} but found ${oi(t)} instead.`}function Fo(r,t){return t.some(o=>o.kind===r.kind)}function No(r,t){return t.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}var ms,nn={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Z(r){return(r=Math.round(r))<0?0:r>255?255:r}function D(r){return Z(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function F(r){return(t=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:t>1?1:t;var t}function W(r,t,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?r+(t-r)*o*6:2*o<1?t:3*o<2?r+(t-r)*(2/3-o)*6:r}try{ms={}.parseCSSColor=function(r){var t,o=r.replace(/ /g,"").toLowerCase();if(o in nn)return nn[o].slice();if(o[0]==="#")return o.length===4?(t=parseInt(o.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:o.length===7&&(t=parseInt(o.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var u=o.indexOf("("),m=o.indexOf(")");if(u!==-1&&m+1===o.length){var g=o.substr(0,u),x=o.substr(u+1,m-(u+1)).split(","),S=1;switch(g){case"rgba":if(x.length!==4)return null;S=F(x.pop());case"rgb":return x.length!==3?null:[D(x[0]),D(x[1]),D(x[2]),S];case"hsla":if(x.length!==4)return null;S=F(x.pop());case"hsl":if(x.length!==3)return null;var P=(parseFloat(x[0])%360+360)%360/360,A=F(x[1]),R=F(x[2]),O=R<=.5?R*(A+1):R+A-R*A,U=2*R-O;return[Z(255*W(U,O,P+1/3)),Z(255*W(U,O,P)),Z(255*W(U,O,P-1/3)),S];default:return null}}return null}}catch{}class H{constructor(t,o,u,m=1){this.r=t,this.g=o,this.b=u,this.a=m}static parse(t){if(!t)return;if(t instanceof H)return t;if(typeof t!="string")return;const o=ms(t);return o?new H(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[t,o,u,m]=this.toArray();return`rgba(${Math.round(t)},${Math.round(o)},${Math.round(u)},${m})`}toArray(){const{r:t,g:o,b:u,a:m}=this;return m===0?[0,0,0,0]:[255*t/m,255*o/m,255*u/m,m]}}H.black=new H(0,0,0,1),H.white=new H(1,1,1,1),H.transparent=new H(0,0,0,0),H.red=new H(1,0,0,1);class ie{constructor(t,o,u){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ce{constructor(t,o,u,m,g){this.text=t,this.image=o,this.scale=u,this.fontStack=m,this.textColor=g}}class se{constructor(t){this.sections=t}static fromString(t){return new se([new ce(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof se?t:se.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class ne{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ne)return t;if(typeof t=="number")return new ne([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const o of t)if(typeof o!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new ne(t)}}toString(){return JSON.stringify(this.values)}}class de{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new de({name:t,available:!1}):null}}function Pe(r,t,o,u){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[r,t,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[r,t,o,u]:[r,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Be(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof H||r instanceof ie||r instanceof se||r instanceof ne||r instanceof de)return!0;if(Array.isArray(r)){for(const t of r)if(!Be(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!Be(r[t]))return!1;return!0}return!1}function Ee(r){if(r===null)return _o;if(typeof r=="string")return At;if(typeof r=="boolean")return Pt;if(typeof r=="number")return je;if(r instanceof H)return $i;if(r instanceof ie)return $r;if(r instanceof se)return Wi;if(r instanceof ne)return fs;if(r instanceof de)return Di;if(Array.isArray(r)){const t=r.length;let o;for(const u of r){const m=Ee(u);if(o){if(o===m)continue;o=St;break}o=m}return gn(o||St,t)}return qr}function at(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof H||r instanceof se||r instanceof ne||r instanceof de?r.toString():JSON.stringify(r)}class ct{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Be(t[1]))return o.error("invalid value");const u=t[1];let m=Ee(u);const g=o.expectedType;return m.kind!=="array"||m.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(m=g),new ct(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Ye{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const yt={string:At,number:je,boolean:Pt,object:qr};class xt{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let u,m=1;const g=t[0];if(g==="array"){let S,P;if(t.length>2){const A=t[1];if(typeof A!="string"||!(A in yt)||A==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);S=yt[A],m++}else S=St;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);P=t[2],m++}u=gn(S,P)}else{if(!yt[g])throw new Error(`Types doesn't contain name = ${g}`);u=yt[g]}const x=[];for(;m<t.length;m++){const S=o.parse(t[m],m,St);if(!S)return null;x.push(S)}return new xt(u,x)}evaluate(t){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(t);if(!Tr(this.type,Ee(u)))return u;if(o===this.args.length-1)throw new Ye(`Expected value to be of type ${oi(this.type)}, but found ${oi(Ee(u))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Wt={"to-boolean":Pt,"to-color":$i,"to-number":je,"to-string":At};class Et{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const u=t[0];if(!Wt[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&t.length!==2)return o.error("Expected one argument.");const m=Wt[u],g=[];for(let x=1;x<t.length;x++){const S=o.parse(t[x],x,St);if(!S)return null;g.push(S)}return new Et(m,g)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let o,u;for(const m of this.args){if(o=m.evaluate(t),u=null,o instanceof H)return o;if(typeof o=="string"){const g=t.parseColor(o);if(g)return g}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Pe(o[0],o[1],o[2],o[3]),!u))return new H(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Ye(u||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="padding"){let o;for(const u of this.args){o=u.evaluate(t);const m=ne.parse(o);if(m)return m}throw new Ye(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(t),o===null)return 0;const m=Number(o);if(!isNaN(m))return m}throw new Ye(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?se.fromString(at(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?de.fromString(at(this.args[0].evaluate(t))):at(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const zt=["Unknown","Point","LineString","Polygon"];class Vt{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?zt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=H.parse(t)),o}}class Jt{constructor(t,o,u,m){this.name=t,this.type=o,this._evaluate=u,this.args=m}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,o){const u=t[0],m=Jt.definitions[u];if(!m)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(m)?m[0]:m.type,x=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,S=x.filter(([A])=>!Array.isArray(A)||A.length===t.length-1);let P=null;for(const[A,R]of S){P=new Er(o.registry,o.path,null,o.scope);const O=[];let U=!1;for(let j=1;j<t.length;j++){const $=t[j],te=Array.isArray(A)?A[j-1]:A.type,ee=P.parse($,1+O.length,te);if(!ee){U=!0;break}O.push(ee)}if(!U)if(Array.isArray(A)&&A.length!==O.length)P.error(`Expected ${A.length} arguments, but found ${O.length} instead.`);else{for(let j=0;j<O.length;j++){const $=Array.isArray(A)?A[j]:A.type,te=O[j];P.concat(j+1).checkSubtype($,te.type)}if(P.errors.length===0)return new Jt(u,g,R,O)}}if(S.length===1)o.errors.push(...P.errors);else{const A=(S.length?S:x).map(([O])=>{return U=O,Array.isArray(U)?`(${U.map(oi).join(", ")})`:`(${oi(U.type)}...)`;var U}).join(" | "),R=[];for(let O=1;O<t.length;O++){const U=o.parse(t[O],1+R.length);if(!U)return null;R.push(oi(U.type))}o.error(`Expected arguments of type ${A}, but found (${R.join(", ")}) instead.`)}return null}static register(t,o){Jt.definitions=o;for(const u in o)t[u]=Jt}}class Ui{constructor(t,o,u){this.type=$r,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const u=t[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const m=o.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Pt);if(!m)return null;const g=o.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Pt);if(!g)return null;let x=null;return u.locale&&(x=o.parse(u.locale,1,At),!x)?null:new Ui(m,g,x)}evaluate(t){return new ie(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const gi=8192;function Ri(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function Gt(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function di(r,t){const o=(180+r[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,m=Math.pow(2,t.z);return[Math.round(o*m*gi),Math.round(u*m*gi)]}function ti(r,t,o){const u=r[0]-t[0],m=r[1]-t[1],g=r[0]-o[0],x=r[1]-o[1];return u*x-g*m==0&&u*g<=0&&m*x<=0}function yo(r,t){let o=!1;for(let x=0,S=t.length;x<S;x++){const P=t[x];for(let A=0,R=P.length;A<R-1;A++){if(ti(r,P[A],P[A+1]))return!1;(m=P[A])[1]>(u=r)[1]!=(g=P[A+1])[1]>u[1]&&u[0]<(g[0]-m[0])*(u[1]-m[1])/(g[1]-m[1])+m[0]&&(o=!o)}}var u,m,g;return o}function vo(r,t){for(let o=0;o<t.length;o++)if(yo(r,t[o]))return!0;return!1}function wa(r,t,o,u){const m=u[0]-o[0],g=u[1]-o[1],x=(r[0]-o[0])*g-m*(r[1]-o[1]),S=(t[0]-o[0])*g-m*(t[1]-o[1]);return x>0&&S<0||x<0&&S>0}function Rt(r,t,o){for(const A of o)for(let R=0;R<A.length-1;++R)if((S=[(x=A[R+1])[0]-(g=A[R])[0],x[1]-g[1]])[0]*(P=[(m=t)[0]-(u=r)[0],m[1]-u[1]])[1]-S[1]*P[0]!=0&&wa(u,m,g,x)&&wa(g,x,u,m))return!0;var u,m,g,x,S,P;return!1}function Ei(r,t){for(let o=0;o<r.length;++o)if(!yo(r[o],t))return!1;for(let o=0;o<r.length-1;++o)if(Rt(r[o],r[o+1],t))return!1;return!0}function fl(r,t){for(let o=0;o<t.length;o++)if(Ei(r,t[o]))return!0;return!1}function Uo(r,t,o){const u=[];for(let m=0;m<r.length;m++){const g=[];for(let x=0;x<r[m].length;x++){const S=di(r[m][x],o);Ri(t,S),g.push(S)}u.push(g)}return u}function Tn(r,t,o){const u=[];for(let m=0;m<r.length;m++){const g=Uo(r[m],t,o);u.push(g)}return u}function eu(r,t,o,u){if(r[0]<o[0]||r[0]>o[2]){const m=.5*u;let g=r[0]-o[0]>m?-u:o[0]-r[0]>m?u:0;g===0&&(g=r[0]-o[2]>m?-u:o[2]-r[0]>m?u:0),r[0]+=g}Ri(t,r)}function Ls(r,t,o,u){const m=Math.pow(2,u.z)*gi,g=[u.x*gi,u.y*gi],x=[];for(const S of r)for(const P of S){const A=[P.x+g[0],P.y+g[1]];eu(A,t,o,m),x.push(A)}return x}function xo(r,t,o,u){const m=Math.pow(2,u.z)*gi,g=[u.x*gi,u.y*gi],x=[];for(const P of r){const A=[];for(const R of P){const O=[R.x+g[0],R.y+g[1]];Ri(t,O),A.push(O)}x.push(A)}if(t[2]-t[0]<=m/2){(S=t)[0]=S[1]=1/0,S[2]=S[3]=-1/0;for(const P of x)for(const A of P)eu(A,t,o,m)}var S;return x}class yi{constructor(t,o){this.type=Pt,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Be(t[1])){const u=t[1];if(u.type==="FeatureCollection")for(let m=0;m<u.features.length;++m){const g=u.features[m].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new yi(u,u.features[m].geometry)}else if(u.type==="Feature"){const m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new yi(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new yi(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){const S=Uo(u.coordinates,g,x),P=Ls(o.geometry(),m,g,x);if(!Gt(m,g))return!1;for(const A of P)if(!yo(A,S))return!1}if(u.type==="MultiPolygon"){const S=Tn(u.coordinates,g,x),P=Ls(o.geometry(),m,g,x);if(!Gt(m,g))return!1;for(const A of P)if(!vo(A,S))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],x=o.canonicalID();if(u.type==="Polygon"){const S=Uo(u.coordinates,g,x),P=xo(o.geometry(),m,g,x);if(!Gt(m,g))return!1;for(const A of P)if(!Ei(A,S))return!1}if(u.type==="MultiPolygon"){const S=Tn(u.coordinates,g,x),P=xo(o.geometry(),m,g,x);if(!Gt(m,g))return!1;for(const A of P)if(!fl(A,S))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function sr(r){if(r instanceof Jt&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof yi)return!1;let t=!0;return r.eachChild(o=>{t&&!sr(o)&&(t=!1)}),t}function Sr(r){if(r instanceof Jt&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(o=>{t&&!Sr(o)&&(t=!1)}),t}function wo(r,t){if(r instanceof Jt&&t.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(u=>{o&&!wo(u,t)&&(o=!1)}),o}class _s{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=t[1];return o.scope.has(u)?new _s(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Er{constructor(t,o=[],u,m=new bn,g=[]){this.registry=t,this.path=o,this.key=o.map(x=>`[${x}]`).join(""),this.scope=m,this.errors=g,this.expectedType=u}parse(t,o,u,m,g={}){return o?this.concat(o,u,m)._parse(t,g):this._parse(t,g)}_parse(t,o){function u(m,g,x){return x==="assert"?new xt(g,[m]):x==="coerce"?new Et(g,[m]):m}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=t[0];if(typeof m!="string")return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[m];if(g){let x=g.parse(t,this);if(!x)return null;if(this.expectedType){const S=this.expectedType,P=x.type;if(S.kind!=="string"&&S.kind!=="number"&&S.kind!=="boolean"&&S.kind!=="object"&&S.kind!=="array"||P.kind!=="value")if(S.kind!=="color"&&S.kind!=="formatted"&&S.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string")if(S.kind!=="padding"||P.kind!=="value"&&P.kind!=="number"&&P.kind!=="array"){if(this.checkSubtype(S,P))return null}else x=u(x,S,o.typeAnnotation||"coerce");else x=u(x,S,o.typeAnnotation||"coerce");else x=u(x,S,o.typeAnnotation||"assert")}if(!(x instanceof ct)&&x.type.kind!=="resolvedImage"&&Ds(x)){const S=new Vt;try{x=new ct(x.type,x.evaluate(S))}catch(P){return this.error(P.message),null}}return x}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,u){const m=typeof t=="number"?this.path.concat(t):this.path,g=u?this.scope.concat(u):this.scope;return new Er(this.registry,m,o||null,g,this.errors)}error(t,...o){const u=`${this.key}${o.map(m=>`[${m}]`).join("")}`;this.errors.push(new _n(u,t))}checkSubtype(t,o){const u=Tr(t,o);return u&&this.error(u),u}}function Ds(r){if(r instanceof _s)return Ds(r.boundExpression);if(r instanceof Jt&&r.name==="error"||r instanceof Ui||r instanceof yi)return!1;const t=r instanceof Et||r instanceof xt;let o=!0;return r.eachChild(u=>{o=t?o&&Ds(u):o&&u instanceof ct}),!!o&&sr(r)&&wo(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function gs(r,t){const o=r.length-1;let u,m,g=0,x=o,S=0;for(;g<=x;)if(S=Math.floor((g+x)/2),u=r[S],m=r[S+1],u<=t){if(S===o||t<m)return S;g=S+1}else{if(!(u>t))throw new Ye("Input is not a number.");x=S-1}return 0}class bo{constructor(t,o,u){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[m,g]of u)this.labels.push(m),this.outputs.push(g)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(t[1],1,je);if(!u)return null;const m=[];let g=null;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);for(let x=1;x<t.length;x+=2){const S=x===1?-1/0:t[x],P=t[x+1],A=x,R=x+1;if(typeof S!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(m.length&&m[m.length-1][0]>=S)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const O=o.parse(P,R,g);if(!O)return null;g=g||O.type,m.push([S,O])}return new bo(g,u,m)}evaluate(t){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);const m=this.input.evaluate(t);if(m<=o[0])return u[0].evaluate(t);const g=o.length;return m>=o[g-1]?u[g-1].evaluate(t):u[gs(o,m)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function pi(r,t,o){return r*(1-o)+t*o}var Vo=Object.freeze({__proto__:null,number:pi,color:function(r,t,o){return new H(pi(r.r,t.r,o),pi(r.g,t.g,o),pi(r.b,t.b,o),pi(r.a,t.a,o))},array:function(r,t,o){return r.map((u,m)=>pi(u,t[m],o))},padding:function(r,t,o){const u=r.values,m=t.values;return new ne([pi(u[0],m[0],o),pi(u[1],m[1],o),pi(u[2],m[2],o),pi(u[3],m[3],o)])}});const Rs=.95047,ml=1.08883,Bs=4/29,ba=6/29,Mt=3*ba*ba,Pr=Math.PI/180,vi=180/Math.PI;function Ta(r){return r>.008856451679035631?Math.pow(r,1/3):r/Mt+Bs}function Os(r){return r>ba?r*r*r:Mt*(r-Bs)}function Fs(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Ns(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function Ft(r){const t=Ns(r.r),o=Ns(r.g),u=Ns(r.b),m=Ta((.4124564*t+.3575761*o+.1804375*u)/Rs),g=Ta((.2126729*t+.7151522*o+.072175*u)/1);return{l:116*g-16,a:500*(m-g),b:200*(g-Ta((.0193339*t+.119192*o+.9503041*u)/ml)),alpha:r.a}}function Sa(r){let t=(r.l+16)/116,o=isNaN(r.a)?t:t+r.a/500,u=isNaN(r.b)?t:t-r.b/200;return t=1*Os(t),o=Rs*Os(o),u=ml*Os(u),new H(Fs(3.2404542*o-1.5371385*t-.4985314*u),Fs(-.969266*o+1.8760108*t+.041556*u),Fs(.0556434*o-.2040259*t+1.0572252*u),r.alpha)}function Us(r,t,o){const u=t-r;return r+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const zi={forward:Ft,reverse:Sa,interpolate:function(r,t,o){return{l:pi(r.l,t.l,o),a:pi(r.a,t.a,o),b:pi(r.b,t.b,o),alpha:pi(r.alpha,t.alpha,o)}}},ar={forward:function(r){const{l:t,a:o,b:u}=Ft(r),m=Math.atan2(u,o)*vi;return{h:m<0?m+360:m,c:Math.sqrt(o*o+u*u),l:t,alpha:r.a}},reverse:function(r){const t=r.h*Pr,o=r.c;return Sa({l:r.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:r.alpha})},interpolate:function(r,t,o){return{h:Us(r.h,t.h,o),c:pi(r.c,t.c,o),l:pi(r.l,t.l,o),alpha:pi(r.alpha,t.alpha,o)}}};var _l=Object.freeze({__proto__:null,lab:zi,hcl:ar});class Sn{constructor(t,o,u,m,g){this.type=t,this.operator=o,this.interpolation=u,this.input=m,this.labels=[],this.outputs=[];for(const[x,S]of g)this.labels.push(x),this.outputs.push(S)}static interpolationFactor(t,o,u,m){let g=0;if(t.name==="exponential")g=gl(o,t.base,u,m);else if(t.name==="linear")g=gl(o,1,u,m);else if(t.name==="cubic-bezier"){const x=t.controlPoints;g=new q(x[0],x[1],x[2],x[3]).solve(gl(o,1,u,m))}return g}static parse(t,o){let[u,m,g,...x]=t;if(!Array.isArray(m)||m.length===0)return o.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const A=m[1];if(typeof A!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:A}}else{if(m[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const A=m.slice(1);if(A.length!==4||A.some(R=>typeof R!="number"||R<0||R>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:A}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(g=o.parse(g,2,je),!g)return null;const S=[];let P=null;u==="interpolate-hcl"||u==="interpolate-lab"?P=$i:o.expectedType&&o.expectedType.kind!=="value"&&(P=o.expectedType);for(let A=0;A<x.length;A+=2){const R=x[A],O=x[A+1],U=A+3,j=A+4;if(typeof R!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(S.length&&S[S.length-1][0]>=R)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const $=o.parse(O,j,P);if(!$)return null;P=P||$.type,S.push([R,$])}return P.kind==="number"||P.kind==="color"||P.kind==="padding"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Sn(P,u,m,g,S):o.error(`Type ${oi(P)} is not interpolatable.`)}evaluate(t){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);const m=this.input.evaluate(t);if(m<=o[0])return u[0].evaluate(t);const g=o.length;if(m>=o[g-1])return u[g-1].evaluate(t);const x=gs(o,m),S=Sn.interpolationFactor(this.interpolation,m,o[x],o[x+1]),P=u[x].evaluate(t),A=u[x+1].evaluate(t);return this.operator==="interpolate"?Vo[this.type.kind.toLowerCase()](P,A,S):this.operator==="interpolate-hcl"?ar.reverse(ar.interpolate(ar.forward(P),ar.forward(A),S)):zi.reverse(zi.interpolate(zi.forward(P),zi.forward(A),S))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function gl(r,t,o,u){const m=u-o,g=r-o;return m===0?0:t===1?g/m:(Math.pow(t,g)-1)/(Math.pow(t,m)-1)}class Vs{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let u=null;const m=o.expectedType;m&&m.kind!=="value"&&(u=m);const g=[];for(const S of t.slice(1)){const P=o.parse(S,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,g.push(P)}if(!u)throw new Error("No output type");const x=m&&g.some(S=>Tr(m,S.type));return new Vs(x?St:u,g)}evaluate(t){let o,u=null,m=0;for(const g of this.args)if(m++,u=g.evaluate(t),u&&u instanceof de&&!u.available&&(o||(o=u.name),u=null,m===this.args.length&&(u=o)),u!==null)break;return u}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}class ys{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const u=[];for(let g=1;g<t.length-1;g+=2){const x=t[g];if(typeof x!="string")return o.error(`Expected string, but found ${typeof x} instead.`,g);if(/[^a-zA-Z0-9_]/.test(x))return o.error("Variable names must contain only alphanumeric characters or '_'.",g);const S=o.parse(t[g+1],g+1);if(!S)return null;u.push([x,S])}const m=o.parse(t[t.length-1],t.length-1,o.expectedType,u);return m?new ys(u,m):null}outputDefined(){return this.result.outputDefined()}}class yl{constructor(t,o,u){this.type=t,this.index=o,this.input=u}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,je),m=o.parse(t[2],2,gn(o.expectedType||St));return u&&m?new yl(m.type.itemType,u,m):null}evaluate(t){const o=this.index.evaluate(t),u=this.input.evaluate(t);if(o<0)throw new Ye(`Array index out of bounds: ${o} < 0.`);if(o>=u.length)throw new Ye(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o!==Math.floor(o))throw new Ye(`Array index must be an integer, but found ${o} instead.`);return u[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Ea{constructor(t,o){this.type=Pt,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,St),m=o.parse(t[2],2,St);return u&&m?Fo(u.type,[Pt,At,je,_o,St])?new Ea(u,m):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${oi(u.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!No(o,["boolean","string","number","null"]))throw new Ye(`Expected first argument to be of type boolean, string, number or null, but found ${oi(Ee(o))} instead.`);if(!No(u,["string","array"]))throw new Ye(`Expected second argument to be of type array or string, but found ${oi(Ee(u))} instead.`);return u.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class jt{constructor(t,o,u){this.type=je,this.needle=t,this.haystack=o,this.fromIndex=u}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,St),m=o.parse(t[2],2,St);if(!u||!m)return null;if(!Fo(u.type,[Pt,At,je,_o,St]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${oi(u.type)} instead`);if(t.length===4){const g=o.parse(t[3],3,je);return g?new jt(u,m,g):null}return new jt(u,m)}evaluate(t){const o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!No(o,["boolean","string","number","null"]))throw new Ye(`Expected first argument to be of type boolean, string, number or null, but found ${oi(Ee(o))} instead.`);if(!No(u,["string","array"]))throw new Ye(`Expected second argument to be of type array or string, but found ${oi(Ee(u))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(t);return u.indexOf(o,m)}return u.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class vl{constructor(t,o,u,m,g,x){this.inputType=t,this.type=o,this.input=u,this.cases=m,this.outputs=g,this.otherwise=x}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let u,m;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);const g={},x=[];for(let A=2;A<t.length-1;A+=2){let R=t[A];const O=t[A+1];Array.isArray(R)||(R=[R]);const U=o.concat(A);if(R.length===0)return U.error("Expected at least one branch label.");for(const $ of R){if(typeof $!="number"&&typeof $!="string")return U.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return U.error("Numeric branch labels must be integer values.");if(u){if(U.checkSubtype(u,Ee($)))return null}else u=Ee($);if(g[String($)]!==void 0)return U.error("Branch labels must be unique.");g[String($)]=x.length}const j=o.parse(O,A,m);if(!j)return null;m=m||j.type,x.push(j)}const S=o.parse(t[1],1,St);if(!S)return null;const P=o.parse(t[t.length-1],t.length-1,m);return P?S.type.kind!=="value"&&o.concat(1).checkSubtype(u,S.type)?null:new vl(u,m,S,g,x,P):null}evaluate(t){const o=this.input.evaluate(t);return(Ee(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Bn{constructor(t,o,u){this.type=t,this.branches=o,this.otherwise=u}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const m=[];for(let x=1;x<t.length-1;x+=2){const S=o.parse(t[x],x,Pt);if(!S)return null;const P=o.parse(t[x+1],x+1,u);if(!P)return null;m.push([S,P]),u=u||P.type}const g=o.parse(t[t.length-1],t.length-1,u);if(!g)return null;if(!u)throw new Error("Can't infer output type");return new Bn(u,m,g)}evaluate(t){for(const[o,u]of this.branches)if(o.evaluate(t))return u.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,u]of this.branches)t(o),t(u);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class To{constructor(t,o,u,m){this.type=t,this.input=o,this.beginIndex=u,this.endIndex=m}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,St),m=o.parse(t[2],2,je);if(!u||!m)return null;if(!Fo(u.type,[gn(St),At,St]))return o.error(`Expected first argument to be of type array or string, but found ${oi(u.type)} instead`);if(t.length===4){const g=o.parse(t[3],3,je);return g?new To(u.type,u,m,g):null}return new To(u.type,u,m)}evaluate(t){const o=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!No(o,["string","array"]))throw new Ye(`Expected first argument to be of type array or string, but found ${oi(Ee(o))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(t);return o.slice(u,m)}return o.slice(u)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function xl(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function tu(r,t,o,u){return u.compare(t,o)===0}function So(r,t,o){const u=r!=="=="&&r!=="!=";return class R0{constructor(g,x,S){this.type=Pt,this.lhs=g,this.rhs=x,this.collator=S,this.hasUntypedArgument=g.type.kind==="value"||x.type.kind==="value"}static parse(g,x){if(g.length!==3&&g.length!==4)return x.error("Expected two or three arguments.");const S=g[0];let P=x.parse(g[1],1,St);if(!P)return null;if(!xl(S,P.type))return x.concat(1).error(`"${S}" comparisons are not supported for type '${oi(P.type)}'.`);let A=x.parse(g[2],2,St);if(!A)return null;if(!xl(S,A.type))return x.concat(2).error(`"${S}" comparisons are not supported for type '${oi(A.type)}'.`);if(P.type.kind!==A.type.kind&&P.type.kind!=="value"&&A.type.kind!=="value")return x.error(`Cannot compare types '${oi(P.type)}' and '${oi(A.type)}'.`);u&&(P.type.kind==="value"&&A.type.kind!=="value"?P=new xt(A.type,[P]):P.type.kind!=="value"&&A.type.kind==="value"&&(A=new xt(P.type,[A])));let R=null;if(g.length===4){if(P.type.kind!=="string"&&A.type.kind!=="string"&&P.type.kind!=="value"&&A.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(R=x.parse(g[3],3,$r),!R)return null}return new R0(P,A,R)}evaluate(g){const x=this.lhs.evaluate(g),S=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const P=Ee(x),A=Ee(S);if(P.kind!==A.kind||P.kind!=="string"&&P.kind!=="number")throw new Ye(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${P.kind}, ${A.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=Ee(x),A=Ee(S);if(P.kind!=="string"||A.kind!=="string")return t(g,x,S)}return this.collator?o(g,x,S,this.collator.evaluate(g)):t(g,x,S)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}}}const Qu=So("==",function(r,t,o){return t===o},tu),iu=So("!=",function(r,t,o){return t!==o},function(r,t,o,u){return!tu(0,t,o,u)}),ec=So("<",function(r,t,o){return t<o},function(r,t,o,u){return u.compare(t,o)<0}),tc=So(">",function(r,t,o){return t>o},function(r,t,o,u){return u.compare(t,o)>0}),wl=So("<=",function(r,t,o){return t<=o},function(r,t,o,u){return u.compare(t,o)<=0}),ic=So(">=",function(r,t,o){return t>=o},function(r,t,o,u){return u.compare(t,o)>=0});class Hn{constructor(t,o,u,m,g){this.type=At,this.number=t,this.locale=o,this.currency=u,this.minFractionDigits=m,this.maxFractionDigits=g}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const u=o.parse(t[1],1,je);if(!u)return null;const m=t[2];if(typeof m!="object"||Array.isArray(m))return o.error("NumberFormat options argument must be an object.");let g=null;if(m.locale&&(g=o.parse(m.locale,1,At),!g))return null;let x=null;if(m.currency&&(x=o.parse(m.currency,1,At),!x))return null;let S=null;if(m["min-fraction-digits"]&&(S=o.parse(m["min-fraction-digits"],1,je),!S))return null;let P=null;return m["max-fraction-digits"]&&(P=o.parse(m["max-fraction-digits"],1,je),!P)?null:new Hn(u,g,x,S,P)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Pa{constructor(t){this.type=Wi,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const u=t[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const m=[];let g=!1;for(let x=1;x<=t.length-1;++x){const S=t[x];if(g&&typeof S=="object"&&!Array.isArray(S)){g=!1;let P=null;if(S["font-scale"]&&(P=o.parse(S["font-scale"],1,je),!P))return null;let A=null;if(S["text-font"]&&(A=o.parse(S["text-font"],1,gn(At)),!A))return null;let R=null;if(S["text-color"]&&(R=o.parse(S["text-color"],1,$i),!R))return null;const O=m[m.length-1];O.scale=P,O.font=A,O.textColor=R}else{const P=o.parse(t[x],1,St);if(!P)return null;const A=P.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,m.push({content:P,scale:null,font:null,textColor:null})}}return new Pa(m)}evaluate(t){return new se(this.sections.map(o=>{const u=o.content.evaluate(t);return Ee(u)===Di?new ce("",u,null,null,null):new ce(at(u),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}}class Ca{constructor(t){this.type=Di,this.input=t}static parse(t,o){if(t.length!==2)return o.error("Expected two arguments.");const u=o.parse(t[1],1,At);return u?new Ca(u):o.error("No image name provided.")}evaluate(t){const o=this.input.evaluate(t),u=de.fromString(o);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(o)>-1),u}eachChild(t){t(this.input)}outputDefined(){return!1}}class Cr{constructor(t){this.type=je,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const u=o.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${oi(u.type)} instead.`):new Cr(u):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Ye(`Expected value to be of type string or array, but found ${oi(Ee(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Zo={"==":Qu,"!=":iu,">":tc,"<":ec,">=":ic,"<=":wl,array:xt,at:yl,boolean:xt,case:Bn,coalesce:Vs,collator:Ui,format:Pa,image:Ca,in:Ea,"index-of":jt,interpolate:Sn,"interpolate-hcl":Sn,"interpolate-lab":Sn,length:Cr,let:ys,literal:ct,match:vl,number:xt,"number-format":Hn,object:xt,slice:To,step:bo,string:xt,"to-boolean":Et,"to-color":Et,"to-number":Et,"to-string":Et,var:_s,within:yi};function bl(r,[t,o,u,m]){t=t.evaluate(r),o=o.evaluate(r),u=u.evaluate(r);const g=m?m.evaluate(r):1,x=Pe(t,o,u,g);if(x)throw new Ye(x);return new H(t/255*g,o/255*g,u/255*g,g)}function nu(r,t){return r in t}function Ia(r,t){const o=t[r];return o===void 0?null:o}function Wr(r){return{type:r}}function ru(r){return{result:"success",value:r}}function Go(r){return{result:"error",value:r}}function fi(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function Zs(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function It(r){return!!r.expression&&r.expression.interpolated}function Yt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function ri(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Ht(r){return r}function vs(r,t){const o=t.type==="color",u=r.stops&&typeof r.stops[0][0]=="object",m=u||!(u||r.property!==void 0),g=r.type||(It(t)?"exponential":"interval");if(o||t.type==="padding"){const A=o?H.parse:ne.parse;(r=Wn({},r)).stops&&(r.stops=r.stops.map(R=>[R[0],A(R[1])])),r.default=A(r.default?r.default:t.default)}if(r.colorSpace&&r.colorSpace!=="rgb"&&!_l[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let x,S,P;if(g==="exponential")x=Tl;else if(g==="interval")x=ou;else if(g==="categorical"){x=nc,S=Object.create(null);for(const A of r.stops)S[A[0]]=A[1];P=typeof r.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);x=rc}if(u){const A={},R=[];for(let j=0;j<r.stops.length;j++){const $=r.stops[j],te=$[0].zoom;A[te]===void 0&&(A[te]={zoom:te,type:r.type,property:r.property,default:r.default,stops:[]},R.push(te)),A[te].stops.push([$[0].value,$[1]])}const O=[];for(const j of R)O.push([A[j].zoom,vs(A[j],t)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Sn.interpolationFactor.bind(void 0,U),zoomStops:O.map(j=>j[0]),evaluate:({zoom:j},$)=>Tl({stops:O,base:r.base},t,j).evaluate(j,$)}}if(m){const A=g==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Sn.interpolationFactor.bind(void 0,A),zoomStops:r.stops.map(R=>R[0]),evaluate:({zoom:R})=>x(r,t,R,S,P)}}return{kind:"source",evaluate(A,R){const O=R&&R.properties?R.properties[r.property]:void 0;return O===void 0?jo(r.default,t.default):x(r,t,O,S,P)}}}function jo(r,t,o){return r!==void 0?r:t!==void 0?t:o!==void 0?o:void 0}function nc(r,t,o,u,m){return jo(typeof o===m?u[o]:void 0,r.default,t.default)}function ou(r,t,o){if(Yt(o)!=="number")return jo(r.default,t.default);const u=r.stops.length;if(u===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[u-1][0])return r.stops[u-1][1];const m=gs(r.stops.map(g=>g[0]),o);return r.stops[m][1]}function Tl(r,t,o){const u=r.base!==void 0?r.base:1;if(Yt(o)!=="number")return jo(r.default,t.default);const m=r.stops.length;if(m===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[m-1][0])return r.stops[m-1][1];const g=gs(r.stops.map(R=>R[0]),o),x=function(R,O,U,j){const $=j-U,te=R-U;return $===0?0:O===1?te/$:(Math.pow(O,te)-1)/(Math.pow(O,$)-1)}(o,u,r.stops[g][0],r.stops[g+1][0]),S=r.stops[g][1],P=r.stops[g+1][1];let A=Vo[t.type]||Ht;if(r.colorSpace&&r.colorSpace!=="rgb"){const R=_l[r.colorSpace];A=(O,U)=>R.reverse(R.interpolate(R.forward(O),R.forward(U),x))}return typeof S.evaluate=="function"?{evaluate(...R){const O=S.evaluate.apply(void 0,R),U=P.evaluate.apply(void 0,R);if(O!==void 0&&U!==void 0)return A(O,U,x)}}:A(S,P,x)}function rc(r,t,o){switch(t.type){case"color":o=H.parse(o);break;case"formatted":o=se.fromString(o.toString());break;case"resolvedImage":o=de.fromString(o.toString());break;case"padding":o=ne.parse(o);break;default:Yt(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0)}return jo(o,r.default,t.default)}Jt.register(Zo,{error:[{kind:"error"},[At],(r,[t])=>{throw new Ye(t.evaluate(r))}],typeof:[At,[St],(r,[t])=>oi(Ee(t.evaluate(r)))],"to-rgba":[gn(je,4),[$i],(r,[t])=>t.evaluate(r).toArray()],rgb:[$i,[je,je,je],bl],rgba:[$i,[je,je,je,je],bl],has:{type:Pt,overloads:[[[At],(r,[t])=>nu(t.evaluate(r),r.properties())],[[At,qr],(r,[t,o])=>nu(t.evaluate(r),o.evaluate(r))]]},get:{type:St,overloads:[[[At],(r,[t])=>Ia(t.evaluate(r),r.properties())],[[At,qr],(r,[t,o])=>Ia(t.evaluate(r),o.evaluate(r))]]},"feature-state":[St,[At],(r,[t])=>Ia(t.evaluate(r),r.featureState||{})],properties:[qr,[],r=>r.properties()],"geometry-type":[At,[],r=>r.geometryType()],id:[St,[],r=>r.id()],zoom:[je,[],r=>r.globals.zoom],"heatmap-density":[je,[],r=>r.globals.heatmapDensity||0],"line-progress":[je,[],r=>r.globals.lineProgress||0],accumulated:[St,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[je,Wr(je),(r,t)=>{let o=0;for(const u of t)o+=u.evaluate(r);return o}],"*":[je,Wr(je),(r,t)=>{let o=1;for(const u of t)o*=u.evaluate(r);return o}],"-":{type:je,overloads:[[[je,je],(r,[t,o])=>t.evaluate(r)-o.evaluate(r)],[[je],(r,[t])=>-t.evaluate(r)]]},"/":[je,[je,je],(r,[t,o])=>t.evaluate(r)/o.evaluate(r)],"%":[je,[je,je],(r,[t,o])=>t.evaluate(r)%o.evaluate(r)],ln2:[je,[],()=>Math.LN2],pi:[je,[],()=>Math.PI],e:[je,[],()=>Math.E],"^":[je,[je,je],(r,[t,o])=>Math.pow(t.evaluate(r),o.evaluate(r))],sqrt:[je,[je],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[je,[je],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[je,[je],(r,[t])=>Math.log(t.evaluate(r))],log2:[je,[je],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[je,[je],(r,[t])=>Math.sin(t.evaluate(r))],cos:[je,[je],(r,[t])=>Math.cos(t.evaluate(r))],tan:[je,[je],(r,[t])=>Math.tan(t.evaluate(r))],asin:[je,[je],(r,[t])=>Math.asin(t.evaluate(r))],acos:[je,[je],(r,[t])=>Math.acos(t.evaluate(r))],atan:[je,[je],(r,[t])=>Math.atan(t.evaluate(r))],min:[je,Wr(je),(r,t)=>Math.min(...t.map(o=>o.evaluate(r)))],max:[je,Wr(je),(r,t)=>Math.max(...t.map(o=>o.evaluate(r)))],abs:[je,[je],(r,[t])=>Math.abs(t.evaluate(r))],round:[je,[je],(r,[t])=>{const o=t.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[je,[je],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[je,[je],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Pt,[At,St],(r,[t,o])=>r.properties()[t.value]===o.value],"filter-id-==":[Pt,[St],(r,[t])=>r.id()===t.value],"filter-type-==":[Pt,[At],(r,[t])=>r.geometryType()===t.value],"filter-<":[Pt,[At,St],(r,[t,o])=>{const u=r.properties()[t.value],m=o.value;return typeof u==typeof m&&u<m}],"filter-id-<":[Pt,[St],(r,[t])=>{const o=r.id(),u=t.value;return typeof o==typeof u&&o<u}],"filter->":[Pt,[At,St],(r,[t,o])=>{const u=r.properties()[t.value],m=o.value;return typeof u==typeof m&&u>m}],"filter-id->":[Pt,[St],(r,[t])=>{const o=r.id(),u=t.value;return typeof o==typeof u&&o>u}],"filter-<=":[Pt,[At,St],(r,[t,o])=>{const u=r.properties()[t.value],m=o.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[Pt,[St],(r,[t])=>{const o=r.id(),u=t.value;return typeof o==typeof u&&o<=u}],"filter->=":[Pt,[At,St],(r,[t,o])=>{const u=r.properties()[t.value],m=o.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[Pt,[St],(r,[t])=>{const o=r.id(),u=t.value;return typeof o==typeof u&&o>=u}],"filter-has":[Pt,[St],(r,[t])=>t.value in r.properties()],"filter-has-id":[Pt,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Pt,[gn(At)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Pt,[gn(St)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Pt,[At,gn(St)],(r,[t,o])=>o.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Pt,[At,gn(St)],(r,[t,o])=>function(u,m,g,x){for(;g<=x;){const S=g+x>>1;if(m[S]===u)return!0;m[S]>u?x=S-1:g=S+1}return!1}(r.properties()[t.value],o.value,0,o.value.length-1)],all:{type:Pt,overloads:[[[Pt,Pt],(r,[t,o])=>t.evaluate(r)&&o.evaluate(r)],[Wr(Pt),(r,t)=>{for(const o of t)if(!o.evaluate(r))return!1;return!0}]]},any:{type:Pt,overloads:[[[Pt,Pt],(r,[t,o])=>t.evaluate(r)||o.evaluate(r)],[Wr(Pt),(r,t)=>{for(const o of t)if(o.evaluate(r))return!0;return!1}]]},"!":[Pt,[Pt],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Pt,[At],(r,[t])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(t.evaluate(r))}],upcase:[At,[At],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[At,[At],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[At,Wr(St),(r,t)=>t.map(o=>at(o.evaluate(r))).join("")],"resolved-locale":[At,[$r],(r,[t])=>t.evaluate(r).resolvedLocale()]});class xs{constructor(t,o){this.expression=t,this._warningHistory={},this._evaluator=new Vt,this._defaultValue=o?function(u){return u.type==="color"&&ri(u.default)?new H(0,0,0,0):u.type==="color"?H.parse(u.default)||null:u.type==="padding"?ne.parse(u.default)||null:u.default===void 0?null:u.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,u,m,g,x){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=m,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)}evaluate(t,o,u,m,g,x){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=x||null;try{const S=this.expression.evaluate(this._evaluator);if(S==null||typeof S=="number"&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new Ye(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(S)} instead.`);return S}catch(S){return this._warningHistory[S.message]||(this._warningHistory[S.message]=!0,typeof console<"u"&&console.warn(S.message)),this._defaultValue}}}function qo(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in Zo}function Gs(r,t){const o=new Er(Zo,[],t?function(m){const g={color:$i,string:At,number:je,enum:At,boolean:Pt,formatted:Wi,padding:fs,resolvedImage:Di};return m.type==="array"?gn(g[m.value]||St,m.length):g[m.type]}(t):void 0),u=o.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?ru(new xs(u,t)):Go(o.errors)}class js{constructor(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!Sr(o.expression)}evaluateWithoutErrorHandling(t,o,u,m,g,x){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,m,g,x)}evaluate(t,o,u,m,g,x){return this._styleExpression.evaluate(t,o,u,m,g,x)}}class ka{constructor(t,o,u,m){this.kind=t,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!Sr(o.expression),this.interpolationType=m}evaluateWithoutErrorHandling(t,o,u,m,g,x){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,m,g,x)}evaluate(t,o,u,m,g,x){return this._styleExpression.evaluate(t,o,u,m,g,x)}interpolationFactor(t,o,u){return this.interpolationType?Sn.interpolationFactor(this.interpolationType,t,o,u):0}}function su(r,t){const o=Gs(r,t);if(o.result==="error")return o;const u=o.value.expression,m=sr(u);if(!m&&!fi(t))return Go([new _n("","data expressions not supported")]);const g=wo(u,["zoom"]);if(!g&&!Zs(t))return Go([new _n("","zoom expressions not supported")]);const x=Hr(u);return x||g?x instanceof _n?Go([x]):x instanceof Sn&&!It(t)?Go([new _n("",'"interpolate" expressions cannot be used with this property')]):ru(x?new ka(m?"camera":"composite",o.value,x.labels,x instanceof Sn?x.interpolation:void 0):new js(m?"constant":"source",o.value)):Go([new _n("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class En{constructor(t,o){this._parameters=t,this._specification=o,Wn(this,vs(this._parameters,this._specification))}static deserialize(t){return new En(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Hr(r){let t=null;if(r instanceof ys)t=Hr(r.result);else if(r instanceof Vs){for(const o of r.args)if(t=Hr(o),t)break}else(r instanceof bo||r instanceof Sn)&&r.input instanceof Jt&&r.input.name==="zoom"&&(t=r);return t instanceof _n||r.eachChild(o=>{const u=Hr(o);u instanceof _n?t=u:!t&&u?t=new _n("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&u&&t!==u&&(t=new _n("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function lr(r){const t=r.key,o=r.value,u=r.valueSpec||{},m=r.objectElementValidators||{},g=r.style,x=r.styleSpec;let S=[];const P=Yt(o);if(P!=="object")return[new Xe(t,o,`object expected, ${P} found`)];for(const A in o){const R=A.split(".")[0],O=u[R]||u["*"];let U;if(m[R])U=m[R];else if(u[R])U=Pn;else if(m["*"])U=m["*"];else{if(!u["*"]){S.push(new Xe(t,o[A],`unknown property "${A}"`));continue}U=Pn}S=S.concat(U({key:(t&&`${t}.`)+A,value:o[A],valueSpec:O,style:g,styleSpec:x,object:o,objectKey:A},o))}for(const A in u)m[A]||u[A].required&&u[A].default===void 0&&o[A]===void 0&&S.push(new Xe(t,o,`missing required property "${A}"`));return S}function Ir(r){const t=r.value,o=r.valueSpec,u=r.style,m=r.styleSpec,g=r.key,x=r.arrayElementValidator||Pn;if(Yt(t)!=="array")return[new Xe(g,t,`array expected, ${Yt(t)} found`)];if(o.length&&t.length!==o.length)return[new Xe(g,t,`array length ${o.length} expected, length ${t.length} found`)];if(o["min-length"]&&t.length<o["min-length"])return[new Xe(g,t,`array length at least ${o["min-length"]} expected, length ${t.length} found`)];let S={type:o.value,values:o.values};m.$version<7&&(S.function=o.function),Yt(o.value)==="object"&&(S=o.value);let P=[];for(let A=0;A<t.length;A++)P=P.concat(x({array:t,arrayIndex:A,value:t[A],valueSpec:S,style:u,styleSpec:m,key:`${g}[${A}]`}));return P}function Sl(r){const t=r.key,o=r.value,u=r.valueSpec;let m=Yt(o);return m==="number"&&o!=o&&(m="NaN"),m!=="number"?[new Xe(t,o,`number expected, ${m} found`)]:"minimum"in u&&o<u.minimum?[new Xe(t,o,`${o} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&o>u.maximum?[new Xe(t,o,`${o} is greater than the maximum value ${u.maximum}`)]:[]}function $o(r){const t=r.valueSpec,o=$t(r.value.type);let u,m,g,x={};const S=o!=="categorical"&&r.value.property===void 0,P=!S,A=Yt(r.value.stops)==="array"&&Yt(r.value.stops[0])==="array"&&Yt(r.value.stops[0][0])==="object",R=lr({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(j){if(o==="identity")return[new Xe(j.key,j.value,'identity function may not have a "stops" property')];let $=[];const te=j.value;return $=$.concat(Ir({key:j.key,value:te,valueSpec:j.valueSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:O})),Yt(te)==="array"&&te.length===0&&$.push(new Xe(j.key,te,"array must have at least one stop")),$},default:function(j){return Pn({key:j.key,value:j.value,valueSpec:t,style:j.style,styleSpec:j.styleSpec})}}});return o==="identity"&&S&&R.push(new Xe(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||R.push(new Xe(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!It(r.valueSpec)&&R.push(new Xe(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(P&&!fi(r.valueSpec)?R.push(new Xe(r.key,r.value,"property functions not supported")):S&&!Zs(r.valueSpec)&&R.push(new Xe(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!A||r.value.property!==void 0||R.push(new Xe(r.key,r.value,'"property" property is required')),R;function O(j){let $=[];const te=j.value,ee=j.key;if(Yt(te)!=="array")return[new Xe(ee,te,`array expected, ${Yt(te)} found`)];if(te.length!==2)return[new Xe(ee,te,`array length 2 expected, length ${te.length} found`)];if(A){if(Yt(te[0])!=="object")return[new Xe(ee,te,`object expected, ${Yt(te[0])} found`)];if(te[0].zoom===void 0)return[new Xe(ee,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Xe(ee,te,"object stop key must have value")];if(g&&g>$t(te[0].zoom))return[new Xe(ee,te[0].zoom,"stop zoom values must appear in ascending order")];$t(te[0].zoom)!==g&&(g=$t(te[0].zoom),m=void 0,x={}),$=$.concat(lr({key:`${ee}[0]`,value:te[0],valueSpec:{zoom:{}},style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:Sl,value:U}}))}else $=$.concat(U({key:`${ee}[0]`,value:te[0],valueSpec:{},style:j.style,styleSpec:j.styleSpec},te));return qo(Rn(te[1]))?$.concat([new Xe(`${ee}[1]`,te[1],"expressions are not allowed in function stops.")]):$.concat(Pn({key:`${ee}[1]`,value:te[1],valueSpec:t,style:j.style,styleSpec:j.styleSpec}))}function U(j,$){const te=Yt(j.value),ee=$t(j.value),_e=j.value!==null?j.value:$;if(u){if(te!==u)return[new Xe(j.key,_e,`${te} stop domain type must match previous stop domain type ${u}`)]}else u=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new Xe(j.key,_e,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&o!=="categorical"){let Se=`number expected, ${te} found`;return fi(t)&&o===void 0&&(Se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Xe(j.key,_e,Se)]}return o!=="categorical"||te!=="number"||isFinite(ee)&&Math.floor(ee)===ee?o!=="categorical"&&te==="number"&&m!==void 0&&ee<m?[new Xe(j.key,_e,"stop domain values must appear in ascending order")]:(m=ee,o==="categorical"&&ee in x?[new Xe(j.key,_e,"stop domain values must be unique")]:(x[ee]=!0,[])):[new Xe(j.key,_e,`integer expected, found ${ee}`)]}}function Wo(r){const t=(r.expressionContext==="property"?su:Gs)(Rn(r.value),r.valueSpec);if(t.result==="error")return t.value.map(u=>new Xe(`${r.key}${u.key}`,r.value,u.message));const o=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new Xe(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Sr(o))return[new Xe(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!Sr(o))return[new Xe(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!wo(o,["zoom","feature-state"]))return[new Xe(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!sr(o))return[new Xe(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xr(r){const t=r.key,o=r.value,u=r.valueSpec,m=[];return Array.isArray(u.values)?u.values.indexOf($t(o))===-1&&m.push(new Xe(t,o,`expected one of [${u.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(u.values).indexOf($t(o))===-1&&m.push(new Xe(t,o,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(o)} found`)),m}function Ho(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Ho(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Aa={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function za(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Ho(r)||(r=$s(r));const t=Gs(r,Aa);if(t.result==="error")throw new Error(t.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,u,m)=>t.value.evaluate(o,u,{},m),needGeometry:qs(r)}}function Kr(r,t){return r<t?-1:r>t?1:0}function qs(r){if(!Array.isArray(r))return!1;if(r[0]==="within")return!0;for(let t=1;t<r.length;t++)if(qs(r[t]))return!0;return!1}function $s(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?Ws(r[1],r[2],"=="):t==="!="?ws(Ws(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Ws(r[1],r[2],t):t==="any"?(o=r.slice(1),["any"].concat(o.map($s))):t==="all"?["all"].concat(r.slice(1).map($s)):t==="none"?["all"].concat(r.slice(1).map($s).map(ws)):t==="in"?Ma(r[1],r.slice(2)):t==="!in"?ws(Ma(r[1],r.slice(2))):t==="has"?On(r[1]):t==="!has"?ws(On(r[1])):t!=="within"||r;var o}function Ws(r,t,o){switch(r){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,r,t]}}function Ma(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",r,["literal",t.sort(Kr)]]:["filter-in-small",r,["literal",t]]}}function On(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ws(r){return["!",r]}function kr(r){return Ho(Rn(r.value))?Wo(Wn({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):au(r)}function au(r){const t=r.value,o=r.key;if(Yt(t)!=="array")return[new Xe(o,t,`array expected, ${Yt(t)} found`)];const u=r.styleSpec;let m,g=[];if(t.length<1)return[new Xe(o,t,"filter array must have at least 1 element")];switch(g=g.concat(Xr({key:`${o}[0]`,value:t[0],valueSpec:u.filter_operator,style:r.style,styleSpec:r.styleSpec})),$t(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&$t(t[1])==="$type"&&g.push(new Xe(o,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&g.push(new Xe(o,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(m=Yt(t[1]),m!=="string"&&g.push(new Xe(`${o}[1]`,t[1],`string expected, ${m} found`)));for(let x=2;x<t.length;x++)m=Yt(t[x]),$t(t[1])==="$type"?g=g.concat(Xr({key:`${o}[${x}]`,value:t[x],valueSpec:u.geometry_type,style:r.style,styleSpec:r.styleSpec})):m!=="string"&&m!=="number"&&m!=="boolean"&&g.push(new Xe(`${o}[${x}]`,t[x],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let x=1;x<t.length;x++)g=g.concat(au({key:`${o}[${x}]`,value:t[x],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":m=Yt(t[1]),t.length!==2?g.push(new Xe(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):m!=="string"&&g.push(new Xe(`${o}[1]`,t[1],`string expected, ${m} found`));break;case"within":m=Yt(t[1]),t.length!==2?g.push(new Xe(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):m!=="object"&&g.push(new Xe(`${o}[1]`,t[1],`object expected, ${m} found`))}return g}function Fn(r,t){const o=r.key,u=r.style,m=r.styleSpec,g=r.value,x=r.objectKey,S=m[`${t}_${r.layerType}`];if(!S)return[];const P=x.match(/^(.*)-transition$/);if(t==="paint"&&P&&S[P[1]]&&S[P[1]].transition)return Pn({key:o,value:g,valueSpec:m.transition,style:u,styleSpec:m});const A=r.valueSpec||S[x];if(!A)return[new Xe(o,g,`unknown property "${x}"`)];let R;if(Yt(g)==="string"&&fi(A)&&!A.tokens&&(R=/^{([^}]+)}$/.exec(g)))return[new Xe(o,g,`"${x}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(R[1])} }\`.`)];const O=[];return r.layerType==="symbol"&&(x==="text-field"&&u&&!u.glyphs&&O.push(new Xe(o,g,'use of "text-field" requires a style "glyphs" property')),x==="text-font"&&ri(Rn(g))&&$t(g.type)==="identity"&&O.push(new Xe(o,g,'"text-font" does not support identity functions'))),O.concat(Pn({key:r.key,value:g,valueSpec:A,style:u,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:x}))}function Hs(r){return Fn(r,"paint")}function El(r){return Fn(r,"layout")}function La(r){let t=[];const o=r.value,u=r.key,m=r.style,g=r.styleSpec;o.type||o.ref||t.push(new Xe(u,o,'either "type" or "ref" is required'));let x=$t(o.type);const S=$t(o.ref);if(o.id){const P=$t(o.id);for(let A=0;A<r.arrayIndex;A++){const R=m.layers[A];$t(R.id)===P&&t.push(new Xe(u,o.id,`duplicate layer id "${o.id}", previously used at line ${R.id.__line__}`))}}if("ref"in o){let P;["type","source","source-layer","filter","layout"].forEach(A=>{A in o&&t.push(new Xe(u,o[A],`"${A}" is prohibited for ref layers`))}),m.layers.forEach(A=>{$t(A.id)===S&&(P=A)}),P?P.ref?t.push(new Xe(u,o.ref,"ref cannot reference another ref layer")):x=$t(P.type):t.push(new Xe(u,o.ref,`ref layer "${S}" not found`))}else if(x!=="background")if(o.source){const P=m.sources&&m.sources[o.source],A=P&&$t(P.type);P?A==="vector"&&x==="raster"?t.push(new Xe(u,o.source,`layer "${o.id}" requires a raster source`)):A==="raster"&&x!=="raster"?t.push(new Xe(u,o.source,`layer "${o.id}" requires a vector source`)):A!=="vector"||o["source-layer"]?A==="raster-dem"&&x!=="hillshade"?t.push(new Xe(u,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):x!=="line"||!o.paint||!o.paint["line-gradient"]||A==="geojson"&&P.lineMetrics||t.push(new Xe(u,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Xe(u,o,`layer "${o.id}" must specify a "source-layer"`)):t.push(new Xe(u,o.source,`source "${o.source}" not found`))}else t.push(new Xe(u,o,'missing required property "source"'));return t=t.concat(lr({key:u,value:o,valueSpec:g.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Pn({key:`${u}.type`,value:o.type,valueSpec:g.layer.type,style:r.style,styleSpec:r.styleSpec,object:o,objectKey:"type"}),filter:kr,layout:P=>lr({layer:o,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":A=>El(Wn({layerType:x},A))}}),paint:P=>lr({layer:o,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,objectElementValidators:{"*":A=>Hs(Wn({layerType:x},A))}})}})),t}function Jr(r){const t=r.value,o=r.key,u=Yt(t);return u!=="string"?[new Xe(o,t,`string expected, ${u} found`)]:[]}const Da={promoteId:function({key:r,value:t}){if(Yt(t)==="string")return Jr({key:r,value:t});{const o=[];for(const u in t)o.push(...Jr({key:`${r}.${u}`,value:t[u]}));return o}}};function Eo(r){const t=r.value,o=r.key,u=r.styleSpec,m=r.style;if(!t.type)return[new Xe(o,t,'"type" is required')];const g=$t(t.type);let x;switch(g){case"vector":case"raster":case"raster-dem":return x=lr({key:o,value:t,valueSpec:u[`source_${g.replace("-","_")}`],style:r.style,styleSpec:u,objectElementValidators:Da}),x;case"geojson":if(x=lr({key:o,value:t,valueSpec:u.source_geojson,style:m,styleSpec:u,objectElementValidators:Da}),t.cluster)for(const S in t.clusterProperties){const[P,A]=t.clusterProperties[S],R=typeof P=="string"?[P,["accumulated"],["get",S]]:P;x.push(...Wo({key:`${o}.${S}.map`,value:A,expressionContext:"cluster-map"})),x.push(...Wo({key:`${o}.${S}.reduce`,value:R,expressionContext:"cluster-reduce"}))}return x;case"video":return lr({key:o,value:t,valueSpec:u.source_video,style:m,styleSpec:u});case"image":return lr({key:o,value:t,valueSpec:u.source_image,style:m,styleSpec:u});case"canvas":return[new Xe(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xr({key:`${o}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:m,styleSpec:u})}}function Ar(r){const t=r.value,o=r.styleSpec,u=o.light,m=r.style;let g=[];const x=Yt(t);if(t===void 0)return g;if(x!=="object")return g=g.concat([new Xe("light",t,`object expected, ${x} found`)]),g;for(const S in t){const P=S.match(/^(.*)-transition$/);g=g.concat(P&&u[P[1]]&&u[P[1]].transition?Pn({key:S,value:t[S],valueSpec:o.transition,style:m,styleSpec:o}):u[S]?Pn({key:S,value:t[S],valueSpec:u[S],style:m,styleSpec:o}):[new Xe(S,t[S],`unknown property "${S}"`)])}return g}function rn(r){const t=r.value,o=r.styleSpec,u=o.terrain,m=r.style;let g=[];const x=Yt(t);if(t===void 0)return g;if(x!=="object")return g=g.concat([new Xe("terrain",t,`object expected, ${x} found`)]),g;for(const S in t)g=g.concat(u[S]?Pn({key:S,value:t[S],valueSpec:u[S],style:m,styleSpec:o}):[new Xe(S,t[S],`unknown property "${S}"`)]);return g}const Xo={"*":()=>[],array:Ir,boolean:function(r){const t=r.value,o=r.key,u=Yt(t);return u!=="boolean"?[new Xe(o,t,`boolean expected, ${u} found`)]:[]},number:Sl,color:function(r){const t=r.key,o=r.value,u=Yt(o);return u!=="string"?[new Xe(t,o,`color expected, ${u} found`)]:ms(o)===null?[new Xe(t,o,`color expected, "${o}" found`)]:[]},constants:mo,enum:Xr,filter:kr,function:$o,layer:La,object:lr,source:Eo,light:Ar,terrain:rn,string:Jr,formatted:function(r){return Jr(r).length===0?[]:Wo(r)},resolvedImage:function(r){return Jr(r).length===0?[]:Wo(r)},padding:function(r){const t=r.key,o=r.value;if(Yt(o)==="array"){if(o.length<1||o.length>4)return[new Xe(t,o,`padding requires 1 to 4 values; ${o.length} values found`)];const u={type:"number"};let m=[];for(let g=0;g<o.length;g++)m=m.concat(Pn({key:`${t}[${g}]`,value:o[g],valueSpec:u}));return m}return Sl({key:t,value:o,valueSpec:{}})}};function Pn(r){const t=r.value,o=r.valueSpec,u=r.styleSpec;return o.expression&&ri($t(t))?$o(r):o.expression&&qo(Rn(t))?Wo(r):o.type&&Xo[o.type]?Xo[o.type](r):lr(Wn({},r,{valueSpec:o.type?u[o.type]:o}))}function oc(r){const t=r.value,o=r.key,u=Jr(r);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new Xe(o,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new Xe(o,t,'"glyphs" url must include a "{range}" token'))),u}function ur(r,t=ke){let o=[];return o=o.concat(Pn({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,objectElementValidators:{glyphs:oc,"*":()=>[]}})),r.constants&&(o=o.concat(mo({key:"constants",value:r.constants,style:r,styleSpec:t}))),lu(o)}function lu(r){return[].concat(r).sort((t,o)=>t.line-o.line)}function zr(r){return function(...t){return lu(r.apply(this,t))}}ur.source=zr(Eo),ur.light=zr(Ar),ur.terrain=zr(rn),ur.layer=zr(La),ur.filter=zr(kr),ur.paintProperty=zr(Hs),ur.layoutProperty=zr(El);const Xs=ur,Ra=Xs.light,sc=Xs.paintProperty,Mr=Xs.layoutProperty;function Ko(r,t){let o=!1;if(t&&t.length)for(const u of t)r.fire(new fo(new Error(u.message))),o=!0;return o}class Ks{constructor(t,o,u){const m=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const x=new Int32Array(this.arrayBuffer);t=x[0],this.d=(o=x[1])+2*(u=x[2]);for(let P=0;P<this.d*this.d;P++){const A=x[3+P],R=x[3+P+1];m.push(A===R?null:x.subarray(A,R))}const S=x[3+m.length+1];this.keys=x.subarray(x[3+m.length],S),this.bboxes=x.subarray(S),this.insert=this._insertReadonly}else{this.d=o+2*u;for(let x=0;x<this.d*this.d;x++)m.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=u,this.scale=o/t,this.uid=0;const g=u/o*t;this.min=-g,this.max=t+g}insert(t,o,u,m,g){this._forEachCell(o,u,m,g,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(g)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,o,u,m,g,x){this.cells[g].push(x)}query(t,o,u,m,g){const x=this.min,S=this.max;if(t<=x&&o<=x&&S<=u&&S<=m&&!g)return Array.prototype.slice.call(this.keys);{const P=[];return this._forEachCell(t,o,u,m,this._queryCell,P,{},g),P}}_queryCell(t,o,u,m,g,x,S,P){const A=this.cells[g];if(A!==null){const R=this.keys,O=this.bboxes;for(let U=0;U<A.length;U++){const j=A[U];if(S[j]===void 0){const $=4*j;(P?P(O[$+0],O[$+1],O[$+2],O[$+3]):t<=O[$+2]&&o<=O[$+3]&&u>=O[$+0]&&m>=O[$+1])?(S[j]=!0,x.push(R[j])):S[j]=!1}}}}_forEachCell(t,o,u,m,g,x,S,P){const A=this._convertToCellCoord(t),R=this._convertToCellCoord(o),O=this._convertToCellCoord(u),U=this._convertToCellCoord(m);for(let j=A;j<=O;j++)for(let $=R;$<=U;$++){const te=this.d*$+j;if((!P||P(this._convertFromCellCoord(j),this._convertFromCellCoord($),this._convertFromCellCoord(j+1),this._convertFromCellCoord($+1)))&&g.call(this,t,o,u,m,te,x,S,P))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,o=3+this.cells.length+1+1;let u=0;for(let x=0;x<this.cells.length;x++)u+=this.cells[x].length;const m=new Int32Array(o+u+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let g=o;for(let x=0;x<t.length;x++){const S=t[x];m[3+x]=g,m.set(S,g),g+=S.length}return m[3+t.length]=g,m.set(this.keys,g),g+=this.keys.length,m[3+t.length+1]=g,m.set(this.bboxes,g),g+=this.bboxes.length,m.buffer}static serialize(t,o){const u=t.toArrayBuffer();return o&&o.push(u),{buffer:u}}static deserialize(t){return new Ks(t.buffer)}}const Xn={};function nt(r,t,o={}){if(Xn[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),Xn[r]={klass:t,omit:o.omit||[],shallow:o.shallow||[]}}nt("Object",Object),nt("TransferableGridIndex",Ks),nt("Color",H),nt("Error",Error),nt("AJAXError",mn),nt("ResolvedImage",de),nt("StylePropertyFunction",En),nt("StyleExpression",xs,{omit:["_evaluator"]}),nt("ZoomDependentExpression",ka),nt("ZoomConstantExpression",js),nt("CompoundExpression",Jt,{omit:["_evaluate"]});for(const r in Zo)Zo[r]._classRegistryKey||nt(`Expression_${r}`,Zo[r]);function Pl(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Jo(r,t){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob)return r;if(Pl(r)||Ni(r))return t&&t.push(r),r;if(ArrayBuffer.isView(r)){const o=r;return t&&t.push(o.buffer),o}if(r instanceof ImageData)return t&&t.push(r.data.buffer),r;if(Array.isArray(r)){const o=[];for(const u of r)o.push(Jo(u,t));return o}if(typeof r=="object"){const o=r.constructor,u=o._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");if(!Xn[u])throw new Error(`${u} is not registered.`);const m=o.serialize?o.serialize(r,t):{};if(o.serialize){if(t&&m===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const g in r){if(!r.hasOwnProperty(g)||Xn[u].omit.indexOf(g)>=0)continue;const x=r[g];m[g]=Xn[u].shallow.indexOf(g)>=0?x:Jo(x,t)}r instanceof Error&&(m.message=r.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(m.$name=u),m}throw new Error("can't serialize object of type "+typeof r)}function Kn(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||Pl(r)||Ni(r)||ArrayBuffer.isView(r)||r instanceof ImageData)return r;if(Array.isArray(r))return r.map(Kn);if(typeof r=="object"){const t=r.$name||"Object";if(!Xn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:o}=Xn[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(r);const u=Object.create(o.prototype);for(const m of Object.keys(r)){if(m==="$name")continue;const g=r[m];u[m]=Xn[t].shallow.indexOf(m)>=0?g:Kn(g)}return u}throw new Error("can't deserialize object of type "+typeof r)}class Cl{constructor(){this.first=!0}update(t,o){const u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))}}const He={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Js(r){for(const t of r)if(cr(t.charCodeAt(0)))return!0;return!1}function uu(r){for(const t of r)if(!Il(t.charCodeAt(0)))return!1;return!0}function Il(r){return!(He.Arabic(r)||He["Arabic Supplement"](r)||He["Arabic Extended-A"](r)||He["Arabic Presentation Forms-A"](r)||He["Arabic Presentation Forms-B"](r))}function cr(r){return!(r!==746&&r!==747&&(r<4352||!(He["Bopomofo Extended"](r)||He.Bopomofo(r)||He["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||He["CJK Compatibility Ideographs"](r)||He["CJK Compatibility"](r)||He["CJK Radicals Supplement"](r)||He["CJK Strokes"](r)||!(!He["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||He["CJK Unified Ideographs Extension A"](r)||He["CJK Unified Ideographs"](r)||He["Enclosed CJK Letters and Months"](r)||He["Hangul Compatibility Jamo"](r)||He["Hangul Jamo Extended-A"](r)||He["Hangul Jamo Extended-B"](r)||He["Hangul Jamo"](r)||He["Hangul Syllables"](r)||He.Hiragana(r)||He["Ideographic Description Characters"](r)||He.Kanbun(r)||He["Kangxi Radicals"](r)||He["Katakana Phonetic Extensions"](r)||He.Katakana(r)&&r!==12540||!(!He["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!He["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||He["Unified Canadian Aboriginal Syllabics"](r)||He["Unified Canadian Aboriginal Syllabics Extended"](r)||He["Vertical Forms"](r)||He["Yijing Hexagram Symbols"](r)||He["Yi Syllables"](r)||He["Yi Radicals"](r))))}function kl(r){return!(cr(r)||function(t){return!!(He["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||He["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||He["Letterlike Symbols"](t)||He["Number Forms"](t)||He["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||He["Control Pictures"](t)&&t!==9251||He["Optical Character Recognition"](t)||He["Enclosed Alphanumerics"](t)||He["Geometric Shapes"](t)||He["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||He["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||He["CJK Symbols and Punctuation"](t)||He.Katakana(t)||He["Private Use Area"](t)||He["CJK Compatibility Forms"](t)||He["Small Form Variants"](t)||He["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}function Al(r){return r>=1424&&r<=2303||He["Arabic Presentation Forms-A"](r)||He["Arabic Presentation Forms-B"](r)}function Ys(r,t){return!(!t&&Al(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||He.Khmer(r))}function cu(r){for(const t of r)if(Al(t.charCodeAt(0)))return!0;return!1}const bs="deferred",Yo="loading",Ba="loaded";let Oa=null,Cn="unavailable",Yr=null;const zl=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(Cn="error"),Oa&&Oa(r)};function Qo(){Fa.fire(new jr("pluginStateChange",{pluginStatus:Cn,pluginURL:Yr}))}const Fa=new br,Ts=function(){return Cn},hu=function(){if(Cn!==bs||!Yr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Cn=Yo,Qo(),Yr&&ho({url:Yr},r=>{r?zl(r):(Cn=Ba,Qo())})},Nn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Cn===Ba||Nn.applyArabicShaping!=null,isLoading:()=>Cn===Yo,setState(r){if(!pt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Cn=r.pluginStatus,Yr=r.pluginURL},isParsed(){if(!pt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Nn.applyArabicShaping!=null&&Nn.processBidirectionalText!=null&&Nn.processStyledBidirectionalText!=null},getPluginURL(){if(!pt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Yr}};class xi{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Cl,this.transition={})}isSupportedScript(t){return function(o,u){for(const m of o)if(!Ys(m.charCodeAt(0),u))return!1;return!0}(t,Nn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,o=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*o}}}class Qs{constructor(t,o){this.property=t,this.value=o,this.expression=function(u,m){if(ri(u))return new En(u,m);if(qo(u)){const g=su(u,m);if(g.result==="error")throw new Error(g.value.map(x=>`${x.key}: ${x.message}`).join(", "));return g.value}{let g=u;return m.type==="color"&&typeof u=="string"?g=H.parse(u):m.type!=="padding"||typeof u!="number"&&!Array.isArray(u)||(g=ne.parse(u)),{kind:"constant",evaluate:()=>g}}}(o===void 0?t.specification.default:o,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,u){return this.property.possiblyEvaluate(this,t,o,u)}}class s{constructor(t){this.property=t,this.value=new Qs(t,void 0)}transitioned(t,o){return new w(this.property,this.value,o,Ve({},t.transition,this.transition),t.now)}untransitioned(){return new w(this.property,this.value,null,{},0)}}class d{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return me(this._values[t].value.value)}setValue(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new s(this._values[t].property)),this._values[t].value=new Qs(this._values[t].property,o===null?void 0:me(o))}getTransition(t){return me(this._values[t].transition)}setTransition(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new s(this._values[t].property)),this._values[t].transition=me(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(t[o]=u);const m=this.getTransition(o);m!==void 0&&(t[`${o}-transition`]=m)}return t}transitioned(t,o){const u=new E(this._properties);for(const m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(t,o._values[m]);return u}untransitioned(){const t=new E(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class w{constructor(t,o,u,m,g){this.property=t,this.value=o,this.begin=g+m.delay||0,this.end=this.begin+m.duration||0,t.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(t,o,u){const m=t.now||0,g=this.value.possiblyEvaluate(t,o,u),x=this.prior;if(x){if(m>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(m<this.begin)return x.possiblyEvaluate(t,o,u);{const S=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(t,o,u),g,function(P){if(P<=0)return 0;if(P>=1)return 1;const A=P*P,R=A*P;return 4*(P<.5?R:3*(P-A)+R-.75)}(S))}}return g}}class E{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,u){const m=new re(this._properties);for(const g of Object.keys(this._values))m._values[g]=this._values[g].possiblyEvaluate(t,o,u);return m}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class M{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return me(this._values[t].value)}setValue(t,o){this._values[t]=new Qs(this._values[t].property,o===null?void 0:me(o))}serialize(){const t={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(t[o]=u)}return t}possiblyEvaluate(t,o,u){const m=new re(this._properties);for(const g of Object.keys(this._values))m._values[g]=this._values[g].possiblyEvaluate(t,o,u);return m}}class V{constructor(t,o,u){this.property=t,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,u,m){return this.property.evaluate(this.value,this.parameters,t,o,u,m)}}class re{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class oe{constructor(t){this.specification=t}possiblyEvaluate(t,o){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(o)}interpolate(t,o,u){const m=Vo[this.specification.type];return m?m(t,o,u):t}}class he{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,u,m){return new V(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},u,m)}:t.expression,o)}interpolate(t,o,u){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new V(this,{kind:"constant",value:void 0},t.parameters);const m=Vo[this.specification.type];return m?new V(this,{kind:"constant",value:m(t.value.value,o.value.value,u)},t.parameters):t}evaluate(t,o,u,m,g,x){return t.kind==="constant"?t.value:t.evaluate(o,u,m,g,x)}}class Oe extends he{possiblyEvaluate(t,o,u,m){if(t.value===void 0)return new V(this,{kind:"constant",value:void 0},o);if(t.expression.kind==="constant"){const g=t.expression.evaluate(o,null,{},u,m),x=t.property.specification.type==="resolvedImage"&&typeof g!="string"?g.name:g,S=this._calculate(x,x,x,o);return new V(this,{kind:"constant",value:S},o)}if(t.expression.kind==="camera"){const g=this._calculate(t.expression.evaluate({zoom:o.zoom-1}),t.expression.evaluate({zoom:o.zoom}),t.expression.evaluate({zoom:o.zoom+1}),o);return new V(this,{kind:"constant",value:g},o)}return new V(this,t.expression,o)}evaluate(t,o,u,m,g,x){if(t.kind==="source"){const S=t.evaluate(o,u,m,g,x);return this._calculate(S,S,S,o)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(o.zoom)-1},u,m),t.evaluate({zoom:Math.floor(o.zoom)},u,m),t.evaluate({zoom:Math.floor(o.zoom)+1},u,m),o):t.value}_calculate(t,o,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:u,to:o}}interpolate(t){return t}}class rt{constructor(t){this.specification=t}possiblyEvaluate(t,o,u,m){if(t.value!==void 0){if(t.expression.kind==="constant"){const g=t.expression.evaluate(o,null,{},u,m);return this._calculate(g,g,g,o)}return this._calculate(t.expression.evaluate(new xi(Math.floor(o.zoom-1),o)),t.expression.evaluate(new xi(Math.floor(o.zoom),o)),t.expression.evaluate(new xi(Math.floor(o.zoom+1),o)),o)}}_calculate(t,o,u,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:u,to:o}}interpolate(t){return t}}class wt{constructor(t){this.specification=t}possiblyEvaluate(t,o,u,m){return!!t.expression.evaluate(o,null,{},u,m)}interpolate(){return!1}}class bt{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in t){const u=t[o];u.specification.overridable&&this.overridableProperties.push(o);const m=this.defaultPropertyValues[o]=new Qs(u,void 0),g=this.defaultTransitionablePropertyValues[o]=new s(u);this.defaultTransitioningPropertyValues[o]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=m.possiblyEvaluate({})}}}nt("DataDrivenProperty",he),nt("DataConstantProperty",oe),nt("CrossFadedDataDrivenProperty",Oe),nt("CrossFadedProperty",rt),nt("ColorRampProperty",wt);const Vi="-transition";class on extends br{constructor(t,o){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new M(o.layout)),o.paint)){this._transitionablePaint=new d(o.paint);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new re(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o,u={}){o!=null&&this._validate(Mr,`layers.${this.id}.layout.${t}`,t,o,u)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,o):this.visibility=o)}getPaintProperty(t){return t.endsWith(Vi)?this._transitionablePaint.getTransition(t.slice(0,-Vi.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o,u={}){if(o!=null&&this._validate(sc,`layers.${this.id}.paint.${t}`,t,o,u))return!1;if(t.endsWith(Vi))return this._transitionablePaint.setTransition(t.slice(0,-Vi.length),o||void 0),!1;{const m=this._transitionablePaint._values[t],g=m.property.specification["property-type"]==="cross-faded-data-driven",x=m.value.isDataDriven(),S=m.value;this._transitionablePaint.setValue(t,o),this._handleSpecialPaintPropertyUpdate(t);const P=this._transitionablePaint._values[t].value;return P.isDataDriven()||x||g||this._handleOverridablePaintPropertyUpdate(t,S,P)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,o,u){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),ue(t,(o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length))}_validate(t,o,u,m,g={}){return(!g||g.validate!==!1)&&Ko(this,t.call(Xs,{key:o,layerType:this.type,objectKey:u,value:m,styleSpec:ke,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof V&&fi(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const ea={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class yn{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ti{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Bi(r,t=1){let o=0,u=0;return{members:r.map(m=>{const g=ea[m.type].BYTES_PER_ELEMENT,x=o=Ml(o,Math.max(t,g)),S=m.components||1;return u=Math.max(u,g),o+=g*S,{name:m.name,type:m.type,components:S,offset:x}}),size:Ml(o,Math.max(u,t)),alignment:t}}function Ml(r,t){return Math.ceil(r/t)*t}class es extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const m=2*t;return this.int16[m+0]=o,this.int16[m+1]=u,t}}es.prototype.bytesPerElement=4,nt("StructArrayLayout2i4",es);class f extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,u,m)}emplace(t,o,u,m,g){const x=4*t;return this.int16[x+0]=o,this.int16[x+1]=u,this.int16[x+2]=m,this.int16[x+3]=g,t}}f.prototype.bytesPerElement=8,nt("StructArrayLayout4i8",f);class i extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,o,u,m,g,x)}emplace(t,o,u,m,g,x,S){const P=6*t;return this.int16[P+0]=o,this.int16[P+1]=u,this.int16[P+2]=m,this.int16[P+3]=g,this.int16[P+4]=x,this.int16[P+5]=S,t}}i.prototype.bytesPerElement=12,nt("StructArrayLayout2i4i12",i);class a extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,o,u,m,g,x)}emplace(t,o,u,m,g,x,S){const P=4*t,A=8*t;return this.int16[P+0]=o,this.int16[P+1]=u,this.uint8[A+4]=m,this.uint8[A+5]=g,this.uint8[A+6]=x,this.uint8[A+7]=S,t}}a.prototype.bytesPerElement=8,nt("StructArrayLayout2i4ub8",a);class h extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const m=2*t;return this.float32[m+0]=o,this.float32[m+1]=u,t}}h.prototype.bytesPerElement=8,nt("StructArrayLayout2f8",h);class _ extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x,S,P,A,R){const O=this.length;return this.resize(O+1),this.emplace(O,t,o,u,m,g,x,S,P,A,R)}emplace(t,o,u,m,g,x,S,P,A,R,O){const U=10*t;return this.uint16[U+0]=o,this.uint16[U+1]=u,this.uint16[U+2]=m,this.uint16[U+3]=g,this.uint16[U+4]=x,this.uint16[U+5]=S,this.uint16[U+6]=P,this.uint16[U+7]=A,this.uint16[U+8]=R,this.uint16[U+9]=O,t}}_.prototype.bytesPerElement=20,nt("StructArrayLayout10ui20",_);class v extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x,S,P,A,R,O,U){const j=this.length;return this.resize(j+1),this.emplace(j,t,o,u,m,g,x,S,P,A,R,O,U)}emplace(t,o,u,m,g,x,S,P,A,R,O,U,j){const $=12*t;return this.int16[$+0]=o,this.int16[$+1]=u,this.int16[$+2]=m,this.int16[$+3]=g,this.uint16[$+4]=x,this.uint16[$+5]=S,this.uint16[$+6]=P,this.uint16[$+7]=A,this.int16[$+8]=R,this.int16[$+9]=O,this.int16[$+10]=U,this.int16[$+11]=j,t}}v.prototype.bytesPerElement=24,nt("StructArrayLayout4i4ui4i24",v);class T extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,u)}emplace(t,o,u,m){const g=3*t;return this.float32[g+0]=o,this.float32[g+1]=u,this.float32[g+2]=m,t}}T.prototype.bytesPerElement=12,nt("StructArrayLayout3f12",T);class C extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}C.prototype.bytesPerElement=4,nt("StructArrayLayout1ul4",C);class I extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x,S,P,A){const R=this.length;return this.resize(R+1),this.emplace(R,t,o,u,m,g,x,S,P,A)}emplace(t,o,u,m,g,x,S,P,A,R){const O=10*t,U=5*t;return this.int16[O+0]=o,this.int16[O+1]=u,this.int16[O+2]=m,this.int16[O+3]=g,this.int16[O+4]=x,this.int16[O+5]=S,this.uint32[U+3]=P,this.uint16[O+8]=A,this.uint16[O+9]=R,t}}I.prototype.bytesPerElement=20,nt("StructArrayLayout6i1ul2ui20",I);class z extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x){const S=this.length;return this.resize(S+1),this.emplace(S,t,o,u,m,g,x)}emplace(t,o,u,m,g,x,S){const P=6*t;return this.int16[P+0]=o,this.int16[P+1]=u,this.int16[P+2]=m,this.int16[P+3]=g,this.int16[P+4]=x,this.int16[P+5]=S,t}}z.prototype.bytesPerElement=12,nt("StructArrayLayout2i2i2i12",z);class B extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g){const x=this.length;return this.resize(x+1),this.emplace(x,t,o,u,m,g)}emplace(t,o,u,m,g,x){const S=4*t,P=8*t;return this.float32[S+0]=o,this.float32[S+1]=u,this.float32[S+2]=m,this.int16[P+6]=g,this.int16[P+7]=x,t}}B.prototype.bytesPerElement=16,nt("StructArrayLayout2f1f2i16",B);class N extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,u,m)}emplace(t,o,u,m,g){const x=12*t,S=3*t;return this.uint8[x+0]=o,this.uint8[x+1]=u,this.float32[S+1]=m,this.float32[S+2]=g,t}}N.prototype.bytesPerElement=12,nt("StructArrayLayout2ub2f12",N);class G extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,u)}emplace(t,o,u,m){const g=3*t;return this.uint16[g+0]=o,this.uint16[g+1]=u,this.uint16[g+2]=m,t}}G.prototype.bytesPerElement=6,nt("StructArrayLayout3ui6",G);class Y extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x,S,P,A,R,O,U,j,$,te,ee,_e){const Se=this.length;return this.resize(Se+1),this.emplace(Se,t,o,u,m,g,x,S,P,A,R,O,U,j,$,te,ee,_e)}emplace(t,o,u,m,g,x,S,P,A,R,O,U,j,$,te,ee,_e,Se){const fe=24*t,we=12*t,Le=48*t;return this.int16[fe+0]=o,this.int16[fe+1]=u,this.uint16[fe+2]=m,this.uint16[fe+3]=g,this.uint32[we+2]=x,this.uint32[we+3]=S,this.uint32[we+4]=P,this.uint16[fe+10]=A,this.uint16[fe+11]=R,this.uint16[fe+12]=O,this.float32[we+7]=U,this.float32[we+8]=j,this.uint8[Le+36]=$,this.uint8[Le+37]=te,this.uint8[Le+38]=ee,this.uint32[we+10]=_e,this.int16[fe+22]=Se,t}}Y.prototype.bytesPerElement=48,nt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Y);class X extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,g,x,S,P,A,R,O,U,j,$,te,ee,_e,Se,fe,we,Le,Me,st,ht,et,Je,We,tt){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,t,o,u,m,g,x,S,P,A,R,O,U,j,$,te,ee,_e,Se,fe,we,Le,Me,st,ht,et,Je,We,tt)}emplace(t,o,u,m,g,x,S,P,A,R,O,U,j,$,te,ee,_e,Se,fe,we,Le,Me,st,ht,et,Je,We,tt,Qe){const Ne=34*t,gt=17*t;return this.int16[Ne+0]=o,this.int16[Ne+1]=u,this.int16[Ne+2]=m,this.int16[Ne+3]=g,this.int16[Ne+4]=x,this.int16[Ne+5]=S,this.int16[Ne+6]=P,this.int16[Ne+7]=A,this.uint16[Ne+8]=R,this.uint16[Ne+9]=O,this.uint16[Ne+10]=U,this.uint16[Ne+11]=j,this.uint16[Ne+12]=$,this.uint16[Ne+13]=te,this.uint16[Ne+14]=ee,this.uint16[Ne+15]=_e,this.uint16[Ne+16]=Se,this.uint16[Ne+17]=fe,this.uint16[Ne+18]=we,this.uint16[Ne+19]=Le,this.uint16[Ne+20]=Me,this.uint16[Ne+21]=st,this.uint16[Ne+22]=ht,this.uint32[gt+12]=et,this.float32[gt+13]=Je,this.float32[gt+14]=We,this.float32[gt+15]=tt,this.float32[gt+16]=Qe,t}}X.prototype.bytesPerElement=68,nt("StructArrayLayout8i15ui1ul4f68",X);class J extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}J.prototype.bytesPerElement=4,nt("StructArrayLayout1f4",J);class ae extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,u)}emplace(t,o,u,m){const g=3*t;return this.int16[g+0]=o,this.int16[g+1]=u,this.int16[g+2]=m,t}}ae.prototype.bytesPerElement=6,nt("StructArrayLayout3i6",ae);class pe extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,u)}emplace(t,o,u,m){const g=4*t;return this.uint32[2*t+0]=o,this.uint16[g+2]=u,this.uint16[g+3]=m,t}}pe.prototype.bytesPerElement=8,nt("StructArrayLayout1ul2ui8",pe);class ve extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const m=2*t;return this.uint16[m+0]=o,this.uint16[m+1]=u,t}}ve.prototype.bytesPerElement=4,nt("StructArrayLayout2ui4",ve);class Q extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}Q.prototype.bytesPerElement=2,nt("StructArrayLayout1ui2",Q);class be extends Ti{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,u,m)}emplace(t,o,u,m,g){const x=4*t;return this.float32[x+0]=o,this.float32[x+1]=u,this.float32[x+2]=m,this.float32[x+3]=g,t}}be.prototype.bytesPerElement=16,nt("StructArrayLayout4f16",be);class xe extends yn{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ut(this.anchorPointX,this.anchorPointY)}}xe.prototype.size=20;class Ae extends I{get(t){return new xe(this,t)}}nt("CollisionBoxArray",Ae);class ze extends yn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ze.prototype.size=48;class Fe extends Y{get(t){return new ze(this,t)}}nt("PlacedSymbolArray",Fe);class Ce extends yn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Ce.prototype.size=68;class it extends X{get(t){return new Ce(this,t)}}nt("SymbolInstanceArray",it);class Ke extends J{getoffsetX(t){return this.float32[1*t+0]}}nt("GlyphOffsetArray",Ke);class ot extends ae{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}nt("SymbolLineVertexArray",ot);class kt extends yn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}kt.prototype.size=8;class Bt extends pe{get(t){return new kt(this,t)}}nt("FeatureIndexArray",Bt);class _t extends es{}class ai extends es{}class li extends es{}class Xt extends i{}class Kt extends a{}class hi extends h{}class sn extends _{}class Po extends v{}class Qr extends T{}class Co extends C{}class Ss extends z{}class Lr extends N{}class Jn extends G{}class ts extends ve{}const du=Bi([{name:"a_pos",components:2,type:"Int16"}],4),{members:Yi}=du;class Nt{constructor(t=[]){this.segments=t}prepareSegment(t,o,u,m){let g=this.segments[this.segments.length-1];return t>Nt.MAX_VERTEX_ARRAY_LENGTH&&$e(`Max vertices per segment is ${Nt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!g||g.vertexLength+t>Nt.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==m)&&(g={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},m!==void 0&&(g.sortKey=m),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,u,m){return new Nt([{vertexOffset:t,primitiveOffset:o,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function si(r,t){return 256*(r=K(Math.floor(r),0,255))+K(Math.floor(t),0,255)}Nt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,nt("SegmentVector",Nt);const an=Bi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ln={exports:{}},Pi={exports:{}};Pi.exports=function(r,t){var o,u,m,g,x,S,P,A;for(u=r.length-(o=3&r.length),m=t,x=3432918353,S=461845907,A=0;A<u;)P=255&r.charCodeAt(A)|(255&r.charCodeAt(++A))<<8|(255&r.charCodeAt(++A))<<16|(255&r.charCodeAt(++A))<<24,++A,m=27492+(65535&(g=5*(65535&(m=(m^=P=(65535&(P=(P=(65535&P)*x+(((P>>>16)*x&65535)<<16)&4294967295)<<15|P>>>17))*S+(((P>>>16)*S&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(P=0,o){case 3:P^=(255&r.charCodeAt(A+2))<<16;case 2:P^=(255&r.charCodeAt(A+1))<<8;case 1:m^=P=(65535&(P=(P=(65535&(P^=255&r.charCodeAt(A)))*x+(((P>>>16)*x&65535)<<16)&4294967295)<<15|P>>>17))*S+(((P>>>16)*S&65535)<<16)&4294967295}return m^=r.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0};var Dr={exports:{}};Dr.exports=function(r,t){for(var o,u=r.length,m=t^u,g=0;u>=4;)o=1540483477*(65535&(o=255&r.charCodeAt(g)|(255&r.charCodeAt(++g))<<8|(255&r.charCodeAt(++g))<<16|(255&r.charCodeAt(++g))<<24))+((1540483477*(o>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),u-=4,++g;switch(u){case 3:m^=(255&r.charCodeAt(g+2))<<16;case 2:m^=(255&r.charCodeAt(g+1))<<8;case 1:m=1540483477*(65535&(m^=255&r.charCodeAt(g)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0};var ta=Pi.exports,ac=Dr.exports;ln.exports=ta,ln.exports.murmur3=ta,ln.exports.murmur2=ac;class Na{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,o,u,m){this.ids.push(wh(t)),this.positions.push(o,u,m)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=wh(t);let u=0,m=this.ids.length-1;for(;u<m;){const x=u+m>>1;this.ids[x]>=o?m=x:u=x+1}const g=[];for(;this.ids[u]===o;)g.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return g}static serialize(t,o){const u=new Float64Array(t.ids),m=new Uint32Array(t.positions);return lc(u,m,0,u.length-1),o&&o.push(u.buffer,m.buffer),{ids:u,positions:m}}static deserialize(t){const o=new Na;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o}}function wh(r){const t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:ln.exports(String(r))}function lc(r,t,o,u){for(;o<u;){const m=r[o+u>>1];let g=o-1,x=u+1;for(;;){do g++;while(r[g]<m);do x--;while(r[x]>m);if(g>=x)break;Es(r,g,x),Es(t,3*g,3*x),Es(t,3*g+1,3*x+1),Es(t,3*g+2,3*x+2)}x-o<u-x?(lc(r,t,o,x),o=x+1):(lc(r,t,x+1,u),u=x)}}function Es(r,t,o){const u=r[t];r[t]=r[o],r[o]=u}nt("FeaturePositionMap",Na);class ia{constructor(t,o){this.gl=t.gl,this.location=o}}class na extends ia{constructor(t,o){super(t,o),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class pu extends ia{constructor(t,o){super(t,o),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class I_ extends ia{constructor(t,o){super(t,o),this.current=H.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const O0=new Float32Array(16);function pp(r){return[si(255*r.r,255*r.g),si(255*r.b,255*r.a)]}class uc{constructor(t,o,u){this.value=t,this.uniformNames=o.map(m=>`u_${m}`),this.type=u}setUniform(t,o,u){t.set(u.constantOr(this.value))}getBinding(t,o,u){return this.type==="color"?new I_(t,o):new na(t,o)}}class fu{constructor(t,o){this.uniformNames=o.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr}setUniform(t,o,u,m){const g=m==="u_pattern_to"?this.patternTo:m==="u_pattern_from"?this.patternFrom:m==="u_pixel_ratio_to"?this.pixelRatioTo:m==="u_pixel_ratio_from"?this.pixelRatioFrom:null;g&&t.set(g)}getBinding(t,o,u){return u.substr(0,9)==="u_pattern"?new pu(t,o):new na(t,o)}}class ra{constructor(t,o,u,m){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(g=>({name:`a_${g}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,o,u,m,g){const x=this.paintVertexArray.length,S=this.expression.evaluate(new xi(0),o,{},m,[],g);this.paintVertexArray.resize(t),this._setPaintValue(x,t,S)}updatePaintArray(t,o,u,m){const g=this.expression.evaluate({zoom:0},u,m);this._setPaintValue(t,o,g)}_setPaintValue(t,o,u){if(this.type==="color"){const m=pp(u);for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,m[0],m[1])}else{for(let m=t;m<o;m++)this.paintVertexArray.emplace(m,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class is{constructor(t,o,u,m,g,x){this.expression=t,this.uniformNames=o.map(S=>`u_${S}_t`),this.type=u,this.useIntegerZoom=m,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=o.map(S=>({name:`a_${S}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(t,o,u,m,g){const x=this.expression.evaluate(new xi(this.zoom),o,{},m,[],g),S=this.expression.evaluate(new xi(this.zoom+1),o,{},m,[],g),P=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(P,t,x,S)}updatePaintArray(t,o,u,m){const g=this.expression.evaluate({zoom:this.zoom},u,m),x=this.expression.evaluate({zoom:this.zoom+1},u,m);this._setPaintValue(t,o,g,x)}_setPaintValue(t,o,u,m){if(this.type==="color"){const g=pp(u),x=pp(m);for(let S=t;S<o;S++)this.paintVertexArray.emplace(S,g[0],g[1],x[0],x[1])}else{for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o){const u=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,m=K(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(m)}getBinding(t,o,u){return new na(t,o)}}class Ua{constructor(t,o,u,m,g,x){this.expression=t,this.type=o,this.useIntegerZoom=u,this.zoom=m,this.layerId=x,this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,o,u){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(m,t,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(t,o,u,m,g){this._setPaintValues(t,o,u.patterns&&u.patterns[this.layerId],g)}_setPaintValues(t,o,u,m){if(!m||!u)return;const{min:g,mid:x,max:S}=u,P=m[g],A=m[x],R=m[S];if(P&&A&&R)for(let O=t;O<o;O++)this.zoomInPaintVertexArray.emplace(O,A.tl[0],A.tl[1],A.br[0],A.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],A.pixelRatio,P.pixelRatio),this.zoomOutPaintVertexArray.emplace(O,A.tl[0],A.tl[1],A.br[0],A.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],A.pixelRatio,R.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,an.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,an.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class k_{constructor(t,o,u){this.binders={},this._buffers=[];const m=[];for(const g in t.paint._values){if(!u(g))continue;const x=t.paint.get(g);if(!(x instanceof V&&fi(x.property.specification)))continue;const S=F0(g,t.type),P=x.value,A=x.property.specification.type,R=x.property.useIntegerZoom,O=x.property.specification["property-type"],U=O==="cross-faded"||O==="cross-faded-data-driven";if(P.kind==="constant")this.binders[g]=U?new fu(P.value,S):new uc(P.value,S,A),m.push(`/u_${g}`);else if(P.kind==="source"||U){const j=A_(g,A,"source");this.binders[g]=U?new Ua(P,A,R,o,j,t.id):new ra(P,S,A,j),m.push(`/a_${g}`)}else{const j=A_(g,A,"composite");this.binders[g]=new is(P,S,A,R,o,j),m.push(`/z_${g}`)}}this.cacheKey=m.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof ra||o instanceof is?o.maxValue:0}populatePaintArrays(t,o,u,m,g){for(const x in this.binders){const S=this.binders[x];(S instanceof ra||S instanceof is||S instanceof Ua)&&S.populatePaintArray(t,o,u,m,g)}}setConstantPatternPositions(t,o){for(const u in this.binders){const m=this.binders[u];m instanceof fu&&m.setConstantPatternPositions(t,o)}}updatePaintArrays(t,o,u,m,g){let x=!1;for(const S in t){const P=o.getPositions(S);for(const A of P){const R=u.feature(A.index);for(const O in this.binders){const U=this.binders[O];if((U instanceof ra||U instanceof is||U instanceof Ua)&&U.expression.isStateDependent===!0){const j=m.paint.get(O);U.expression=j.value,U.updatePaintArray(A.start,A.end,R,t[S],g),x=!0}}}}return x}defines(){const t=[];for(const o in this.binders){const u=this.binders[o];(u instanceof uc||u instanceof fu)&&t.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof ra||u instanceof is)for(let m=0;m<u.paintVertexAttributes.length;m++)t.push(u.paintVertexAttributes[m].name);else if(u instanceof Ua)for(let m=0;m<an.members.length;m++)t.push(an.members[m].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof uc||u instanceof fu||u instanceof is)for(const m of u.uniformNames)t.push(m)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,o){const u=[];for(const m in this.binders){const g=this.binders[m];if(g instanceof uc||g instanceof fu||g instanceof is){for(const x of g.uniformNames)if(o[x]){const S=g.getBinding(t,o[x],x);u.push({name:x,property:m,binding:S})}}}return u}setUniforms(t,o,u,m){for(const{name:g,property:x,binding:S}of o)this.binders[x].setUniform(S,m,u.get(x),g)}updatePaintBuffers(t){this._buffers=[];for(const o in this.binders){const u=this.binders[o];if(t&&u instanceof Ua){const m=t.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(u instanceof ra||u instanceof is)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(t){for(const o in this.binders){const u=this.binders[o];(u instanceof ra||u instanceof is||u instanceof Ua)&&u.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof ra||o instanceof is||o instanceof Ua)&&o.destroy()}}}class Ll{constructor(t,o,u=()=>!0){this.programConfigurations={};for(const m of t)this.programConfigurations[m.id]=new k_(m,o,u);this.needsUpload=!1,this._featureMap=new Na,this._bufferOffset=0}populatePaintArrays(t,o,u,m,g,x){for(const S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(t,o,m,g,x);o.id!==void 0&&this._featureMap.add(o.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,u,m){for(const g of u)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,o,g,m)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function F0(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function A_(r,t,o){const u={color:{source:h,composite:be},number:{source:J,composite:h}},m=function(g){return{"line-pattern":{source:sn,composite:sn},"fill-pattern":{source:sn,composite:sn},"fill-extrusion-pattern":{source:sn,composite:sn}}[g]}(r);return m&&m[o]||u[t][o]}nt("ConstantBinder",uc),nt("CrossFadedConstantBinder",fu),nt("SourceExpressionBinder",ra),nt("CrossFadedCompositeBinder",Ua),nt("CompositeExpressionBinder",is),nt("ProgramConfiguration",k_,{omit:["_buffers"]}),nt("ProgramConfigurationSet",Ll);var Qi=8192;const fp=Math.pow(2,14)-1,z_=-fp-1;function Dl(r){const t=Qi/r.extent,o=r.loadGeometry();for(let u=0;u<o.length;u++){const m=o[u];for(let g=0;g<m.length;g++){const x=m[g],S=Math.round(x.x*t),P=Math.round(x.y*t);x.x=K(S,z_,fp),x.y=K(P,z_,fp),(S<x.x||S>x.x+1||P<x.y||P>x.y+1)&&$e("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Rl(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Dl(r):[]}}function bh(r,t,o,u,m){r.emplaceBack(2*t+(u+1)/2,2*o+(m+1)/2)}class mp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ai,this.indexArray=new Jn,this.segments=new Nt,this.programConfigurations=new Ll(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,u){const m=this.layers[0],g=[];let x=null,S=!1;m.type==="circle"&&(x=m.layout.get("circle-sort-key"),S=!x.isConstant());for(const{feature:P,id:A,index:R,sourceLayerIndex:O}of t){const U=this.layers[0]._featureFilter.needGeometry,j=Rl(P,U);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),j,u))continue;const $=S?x.evaluate(j,{},u):void 0,te={id:A,properties:P.properties,type:P.type,sourceLayerIndex:O,index:R,geometry:U?j.geometry:Dl(P),patterns:{},sortKey:$};g.push(te)}S&&g.sort((P,A)=>P.sortKey-A.sortKey);for(const P of g){const{geometry:A,index:R,sourceLayerIndex:O}=P,U=t[R].feature;this.addFeature(P,A,R,u),o.featureIndex.insert(U,A,R,O,this.index)}}update(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,u,m){for(const g of o)for(const x of g){const S=x.x,P=x.y;if(S<0||S>=Qi||P<0||P>=Qi)continue;const A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),R=A.vertexLength;bh(this.layoutVertexArray,S,P,-1,-1),bh(this.layoutVertexArray,S,P,1,-1),bh(this.layoutVertexArray,S,P,1,1),bh(this.layoutVertexArray,S,P,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+3,R+2),A.vertexLength+=4,A.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},m)}}function M_(r,t){for(let o=0;o<r.length;o++)if(mu(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(mu(r,t[o]))return!0;return!!_p(r,t)}function N0(r,t,o){return!!mu(r,t)||!!gp(t,r,o)}function L_(r,t){if(r.length===1)return R_(t,r[0]);for(let o=0;o<t.length;o++){const u=t[o];for(let m=0;m<u.length;m++)if(mu(r,u[m]))return!0}for(let o=0;o<r.length;o++)if(R_(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(_p(r,t[o]))return!0;return!1}function U0(r,t,o){if(r.length>1){if(_p(r,t))return!0;for(let u=0;u<t.length;u++)if(gp(t[u],r,o))return!0}for(let u=0;u<r.length;u++)if(gp(r[u],t,o))return!0;return!1}function _p(r,t){if(r.length===0||t.length===0)return!1;for(let o=0;o<r.length-1;o++){const u=r[o],m=r[o+1];for(let g=0;g<t.length-1;g++)if(V0(u,m,t[g],t[g+1]))return!0}return!1}function V0(r,t,o,u){return lt(r,o,u)!==lt(t,o,u)&&lt(r,t,o)!==lt(r,t,u)}function gp(r,t,o){const u=o*o;if(t.length===1)return r.distSqr(t[0])<u;for(let m=1;m<t.length;m++)if(D_(r,t[m-1],t[m])<u)return!0;return!1}function D_(r,t,o){const u=t.distSqr(o);if(u===0)return r.distSqr(t);const m=((r.x-t.x)*(o.x-t.x)+(r.y-t.y)*(o.y-t.y))/u;return r.distSqr(m<0?t:m>1?o:o.sub(t)._mult(m)._add(t))}function R_(r,t){let o,u,m,g=!1;for(let x=0;x<r.length;x++){o=r[x];for(let S=0,P=o.length-1;S<o.length;P=S++)u=o[S],m=o[P],u.y>t.y!=m.y>t.y&&t.x<(m.x-u.x)*(t.y-u.y)/(m.y-u.y)+u.x&&(g=!g)}return g}function mu(r,t){let o=!1;for(let u=0,m=r.length-1;u<r.length;m=u++){const g=r[u],x=r[m];g.y>t.y!=x.y>t.y&&t.x<(x.x-g.x)*(t.y-g.y)/(x.y-g.y)+g.x&&(o=!o)}return o}function Z0(r,t,o){const u=o[0],m=o[2];if(r.x<u.x&&t.x<u.x||r.x>m.x&&t.x>m.x||r.y<u.y&&t.y<u.y||r.y>m.y&&t.y>m.y)return!1;const g=lt(r,t,o[0]);return g!==lt(r,t,o[1])||g!==lt(r,t,o[2])||g!==lt(r,t,o[3])}function cc(r,t,o){const u=t.paint.get(r).value;return u.kind==="constant"?u.value:o.programConfigurations.get(t.id).getMaxValue(r)}function Th(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Sh(r,t,o,u,m){if(!t[0]&&!t[1])return r;const g=ut.convert(t)._mult(m);o==="viewport"&&g._rotate(-u);const x=[];for(let S=0;S<r.length;S++)x.push(r[S].sub(g));return x}nt("CircleBucket",mp,{omit:["layers"]});const G0=new bt({"circle-sort-key":new he(ke.layout_circle["circle-sort-key"])});var j0={paint:new bt({"circle-radius":new he(ke.paint_circle["circle-radius"]),"circle-color":new he(ke.paint_circle["circle-color"]),"circle-blur":new he(ke.paint_circle["circle-blur"]),"circle-opacity":new he(ke.paint_circle["circle-opacity"]),"circle-translate":new oe(ke.paint_circle["circle-translate"]),"circle-translate-anchor":new oe(ke.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new oe(ke.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new oe(ke.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new he(ke.paint_circle["circle-stroke-width"]),"circle-stroke-color":new he(ke.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new he(ke.paint_circle["circle-stroke-opacity"])}),layout:G0},Yn=1e-6,Qn=typeof Float32Array<"u"?Float32Array:Array;function B_(){var r=new Qn(9);return Qn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function yp(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function O_(r,t,o){var u=t[0],m=t[1],g=t[2],x=t[3],S=t[4],P=t[5],A=t[6],R=t[7],O=t[8],U=t[9],j=t[10],$=t[11],te=t[12],ee=t[13],_e=t[14],Se=t[15],fe=o[0],we=o[1],Le=o[2],Me=o[3];return r[0]=fe*u+we*S+Le*O+Me*te,r[1]=fe*m+we*P+Le*U+Me*ee,r[2]=fe*g+we*A+Le*j+Me*_e,r[3]=fe*x+we*R+Le*$+Me*Se,r[4]=(fe=o[4])*u+(we=o[5])*S+(Le=o[6])*O+(Me=o[7])*te,r[5]=fe*m+we*P+Le*U+Me*ee,r[6]=fe*g+we*A+Le*j+Me*_e,r[7]=fe*x+we*R+Le*$+Me*Se,r[8]=(fe=o[8])*u+(we=o[9])*S+(Le=o[10])*O+(Me=o[11])*te,r[9]=fe*m+we*P+Le*U+Me*ee,r[10]=fe*g+we*A+Le*j+Me*_e,r[11]=fe*x+we*R+Le*$+Me*Se,r[12]=(fe=o[12])*u+(we=o[13])*S+(Le=o[14])*O+(Me=o[15])*te,r[13]=fe*m+we*P+Le*U+Me*ee,r[14]=fe*g+we*A+Le*j+Me*_e,r[15]=fe*x+we*R+Le*$+Me*Se,r}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var hc,q0=O_;function F_(){var r=new Qn(3);return Qn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function N_(r,t,o){var u=new Qn(3);return u[0]=r,u[1]=t,u[2]=o,u}function Eh(r,t,o){var u=t[0],m=t[1],g=t[2],x=t[3];return r[0]=o[0]*u+o[4]*m+o[8]*g+o[12]*x,r[1]=o[1]*u+o[5]*m+o[9]*g+o[13]*x,r[2]=o[2]*u+o[6]*m+o[10]*g+o[14]*x,r[3]=o[3]*u+o[7]*m+o[11]*g+o[15]*x,r}function U_(){var r=new Qn(4);return Qn!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function V_(r,t){const o=Eh([],[r.x,r.y,0,1],t);return new ut(o[0]/o[3],o[1]/o[3])}F_(),hc=new Qn(4),Qn!=Float32Array&&(hc[0]=0,hc[1]=0,hc[2]=0,hc[3]=0),F_(),N_(1,0,0),N_(0,1,0),U_(),U_(),B_(),function(){var r;r=new Qn(2),Qn!=Float32Array&&(r[0]=0,r[1]=0)}();class Z_ extends mp{}nt("HeatmapBucket",Z_,{omit:["layers"]});var $0={paint:new bt({"heatmap-radius":new he(ke.paint_heatmap["heatmap-radius"]),"heatmap-weight":new he(ke.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new oe(ke.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wt(ke.paint_heatmap["heatmap-color"]),"heatmap-opacity":new oe(ke.paint_heatmap["heatmap-opacity"])})};function vp(r,{width:t,height:o},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==t*o*u)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${t*o*u}`)}else m=new Uint8Array(t*o*u);return r.width=t,r.height=o,r.data=m,r}function G_(r,{width:t,height:o},u){if(t===r.width&&o===r.height)return;const m=vp({},{width:t,height:o},u);xp(r,m,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,o)},u),r.width=t,r.height=o,r.data=m.data}function xp(r,t,o,u,m,g){if(m.width===0||m.height===0)return t;if(m.width>r.width||m.height>r.height||o.x>r.width-m.width||o.y>r.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>t.width||m.height>t.height||u.x>t.width-m.width||u.y>t.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const x=r.data,S=t.data;if(x===S)throw new Error("srcData equals dstData, so image is already copied");for(let P=0;P<m.height;P++){const A=((o.y+P)*r.width+o.x)*g,R=((u.y+P)*t.width+u.x)*g;for(let O=0;O<m.width*g;O++)S[R+O]=x[A+O]}return t}class dc{constructor(t,o){vp(this,t,1,o)}resize(t){G_(this,t,1)}clone(){return new dc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,u,m,g){xp(t,o,u,m,g,1)}}class eo{constructor(t,o){vp(this,t,4,o)}resize(t){G_(this,t,4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new eo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,u,m,g){xp(t,o,u,m,g,4)}}function j_(r){const t={},o=r.resolution||256,u=r.clips?r.clips.length:1,m=r.image||new eo({width:o,height:u});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const g=(x,S,P)=>{t[r.evaluationKey]=P;const A=r.expression.evaluate(t);m.data[x+S+0]=Math.floor(255*A.r/A.a),m.data[x+S+1]=Math.floor(255*A.g/A.a),m.data[x+S+2]=Math.floor(255*A.b/A.a),m.data[x+S+3]=Math.floor(255*A.a)};if(r.clips)for(let x=0,S=0;x<u;++x,S+=4*o)for(let P=0,A=0;P<o;P++,A+=4){const R=P/(o-1),{start:O,end:U}=r.clips[x];g(S,A,O*(1-R)+U*R)}else for(let x=0,S=0;x<o;x++,S+=4)g(0,S,x/(o-1));return m}nt("AlphaImage",dc),nt("RGBAImage",eo);var W0={paint:new bt({"hillshade-illumination-direction":new oe(ke.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new oe(ke.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new oe(ke.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new oe(ke.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new oe(ke.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new oe(ke.paint_hillshade["hillshade-accent-color"])})};const H0=Bi([{name:"a_pos",components:2,type:"Int16"}],4),{members:X0}=H0;var Ph={exports:{}};function Ch(r,t,o){o=o||2;var u,m,g,x,S,P,A,R=t&&t.length,O=R?t[0]*o:r.length,U=q_(r,0,O,o,!0),j=[];if(!U||U.next===U.prev)return j;if(R&&(U=function(te,ee,_e,Se){var fe,we,Le,Me=[];for(fe=0,we=ee.length;fe<we;fe++)(Le=q_(te,ee[fe]*Se,fe<we-1?ee[fe+1]*Se:te.length,Se,!1))===Le.next&&(Le.steiner=!0),Me.push(n1(Le));for(Me.sort(e1),fe=0;fe<Me.length;fe++)_e=t1(Me[fe],_e);return _e}(r,t,U,o)),r.length>80*o){u=g=r[0],m=x=r[1];for(var $=o;$<O;$+=o)(S=r[$])<u&&(u=S),(P=r[$+1])<m&&(m=P),S>g&&(g=S),P>x&&(x=P);A=(A=Math.max(g-u,x-m))!==0?32767/A:0}return pc(U,j,o,u,m,A,0),j}function q_(r,t,o,u,m){var g,x;if(m===Tp(r,t,o,u)>0)for(g=t;g<o;g+=u)x=H_(g,r[g],r[g+1],x);else for(g=o-u;g>=t;g-=u)x=H_(g,r[g],r[g+1],x);return x&&Ih(x,x.next)&&(mc(x),x=x.next),x}function Bl(r,t){if(!r)return r;t||(t=r);var o,u=r;do if(o=!1,u.steiner||!Ih(u,u.next)&&Zi(u.prev,u,u.next)!==0)u=u.next;else{if(mc(u),(u=t=u.prev)===u.next)break;o=!0}while(o||u!==t);return t}function pc(r,t,o,u,m,g,x){if(r){!x&&g&&function(R,O,U,j){var $=R;do $.z===0&&($.z=wp($.x,$.y,O,U,j)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==R);$.prevZ.nextZ=null,$.prevZ=null,function(te){var ee,_e,Se,fe,we,Le,Me,st,ht=1;do{for(_e=te,te=null,we=null,Le=0;_e;){for(Le++,Se=_e,Me=0,ee=0;ee<ht&&(Me++,Se=Se.nextZ);ee++);for(st=ht;Me>0||st>0&&Se;)Me!==0&&(st===0||!Se||_e.z<=Se.z)?(fe=_e,_e=_e.nextZ,Me--):(fe=Se,Se=Se.nextZ,st--),we?we.nextZ=fe:te=fe,fe.prevZ=we,we=fe;_e=Se}we.nextZ=null,ht*=2}while(Le>1)}($)}(r,u,m,g);for(var S,P,A=r;r.prev!==r.next;)if(S=r.prev,P=r.next,g?J0(r,u,m,g):K0(r))t.push(S.i/o|0),t.push(r.i/o|0),t.push(P.i/o|0),mc(r),r=P.next,A=P.next;else if((r=P)===A){x?x===1?pc(r=Y0(Bl(r),t,o),t,o,u,m,g,2):x===2&&Q0(r,t,o,u,m,g):pc(Bl(r),t,o,u,m,g,1);break}}}function K0(r){var t=r.prev,o=r,u=r.next;if(Zi(t,o,u)>=0)return!1;for(var m=t.x,g=o.x,x=u.x,S=t.y,P=o.y,A=u.y,R=m<g?m<x?m:x:g<x?g:x,O=S<P?S<A?S:A:P<A?P:A,U=m>g?m>x?m:x:g>x?g:x,j=S>P?S>A?S:A:P>A?P:A,$=u.next;$!==t;){if($.x>=R&&$.x<=U&&$.y>=O&&$.y<=j&&_u(m,S,g,P,x,A,$.x,$.y)&&Zi($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function J0(r,t,o,u){var m=r.prev,g=r,x=r.next;if(Zi(m,g,x)>=0)return!1;for(var S=m.x,P=g.x,A=x.x,R=m.y,O=g.y,U=x.y,j=S<P?S<A?S:A:P<A?P:A,$=R<O?R<U?R:U:O<U?O:U,te=S>P?S>A?S:A:P>A?P:A,ee=R>O?R>U?R:U:O>U?O:U,_e=wp(j,$,t,o,u),Se=wp(te,ee,t,o,u),fe=r.prevZ,we=r.nextZ;fe&&fe.z>=_e&&we&&we.z<=Se;){if(fe.x>=j&&fe.x<=te&&fe.y>=$&&fe.y<=ee&&fe!==m&&fe!==x&&_u(S,R,P,O,A,U,fe.x,fe.y)&&Zi(fe.prev,fe,fe.next)>=0||(fe=fe.prevZ,we.x>=j&&we.x<=te&&we.y>=$&&we.y<=ee&&we!==m&&we!==x&&_u(S,R,P,O,A,U,we.x,we.y)&&Zi(we.prev,we,we.next)>=0))return!1;we=we.nextZ}for(;fe&&fe.z>=_e;){if(fe.x>=j&&fe.x<=te&&fe.y>=$&&fe.y<=ee&&fe!==m&&fe!==x&&_u(S,R,P,O,A,U,fe.x,fe.y)&&Zi(fe.prev,fe,fe.next)>=0)return!1;fe=fe.prevZ}for(;we&&we.z<=Se;){if(we.x>=j&&we.x<=te&&we.y>=$&&we.y<=ee&&we!==m&&we!==x&&_u(S,R,P,O,A,U,we.x,we.y)&&Zi(we.prev,we,we.next)>=0)return!1;we=we.nextZ}return!0}function Y0(r,t,o){var u=r;do{var m=u.prev,g=u.next.next;!Ih(m,g)&&$_(m,u,u.next,g)&&fc(m,g)&&fc(g,m)&&(t.push(m.i/o|0),t.push(u.i/o|0),t.push(g.i/o|0),mc(u),mc(u.next),u=r=g),u=u.next}while(u!==r);return Bl(u)}function Q0(r,t,o,u,m,g){var x=r;do{for(var S=x.next.next;S!==x.prev;){if(x.i!==S.i&&r1(x,S)){var P=W_(x,S);return x=Bl(x,x.next),P=Bl(P,P.next),pc(x,t,o,u,m,g,0),void pc(P,t,o,u,m,g,0)}S=S.next}x=x.next}while(x!==r)}function e1(r,t){return r.x-t.x}function t1(r,t){var o=function(m,g){var x,S=g,P=m.x,A=m.y,R=-1/0;do{if(A<=S.y&&A>=S.next.y&&S.next.y!==S.y){var O=S.x+(A-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(O<=P&&O>R&&(R=O,x=S.x<S.next.x?S:S.next,O===P))return x}S=S.next}while(S!==g);if(!x)return null;var U,j=x,$=x.x,te=x.y,ee=1/0;S=x;do P>=S.x&&S.x>=$&&P!==S.x&&_u(A<te?P:R,A,$,te,A<te?R:P,A,S.x,S.y)&&(U=Math.abs(A-S.y)/(P-S.x),fc(S,m)&&(U<ee||U===ee&&(S.x>x.x||S.x===x.x&&i1(x,S)))&&(x=S,ee=U)),S=S.next;while(S!==j);return x}(r,t);if(!o)return t;var u=W_(o,r);return Bl(u,u.next),Bl(o,o.next)}function i1(r,t){return Zi(r.prev,r,t.prev)<0&&Zi(t.next,r,r.next)<0}function wp(r,t,o,u,m){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*m|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-u)*m|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function n1(r){var t=r,o=r;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==r);return o}function _u(r,t,o,u,m,g,x,S){return(m-x)*(t-S)>=(r-x)*(g-S)&&(r-x)*(u-S)>=(o-x)*(t-S)&&(o-x)*(g-S)>=(m-x)*(u-S)}function r1(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(o,u){var m=o;do{if(m.i!==o.i&&m.next.i!==o.i&&m.i!==u.i&&m.next.i!==u.i&&$_(m,m.next,o,u))return!0;m=m.next}while(m!==o);return!1}(r,t)&&(fc(r,t)&&fc(t,r)&&function(o,u){var m=o,g=!1,x=(o.x+u.x)/2,S=(o.y+u.y)/2;do m.y>S!=m.next.y>S&&m.next.y!==m.y&&x<(m.next.x-m.x)*(S-m.y)/(m.next.y-m.y)+m.x&&(g=!g),m=m.next;while(m!==o);return g}(r,t)&&(Zi(r.prev,r,t.prev)||Zi(r,t.prev,t))||Ih(r,t)&&Zi(r.prev,r,r.next)>0&&Zi(t.prev,t,t.next)>0)}function Zi(r,t,o){return(t.y-r.y)*(o.x-t.x)-(t.x-r.x)*(o.y-t.y)}function Ih(r,t){return r.x===t.x&&r.y===t.y}function $_(r,t,o,u){var m=Ah(Zi(r,t,o)),g=Ah(Zi(r,t,u)),x=Ah(Zi(o,u,r)),S=Ah(Zi(o,u,t));return m!==g&&x!==S||!(m!==0||!kh(r,o,t))||!(g!==0||!kh(r,u,t))||!(x!==0||!kh(o,r,u))||!(S!==0||!kh(o,t,u))}function kh(r,t,o){return t.x<=Math.max(r.x,o.x)&&t.x>=Math.min(r.x,o.x)&&t.y<=Math.max(r.y,o.y)&&t.y>=Math.min(r.y,o.y)}function Ah(r){return r>0?1:r<0?-1:0}function fc(r,t){return Zi(r.prev,r,r.next)<0?Zi(r,t,r.next)>=0&&Zi(r,r.prev,t)>=0:Zi(r,t,r.prev)<0||Zi(r,r.next,t)<0}function W_(r,t){var o=new bp(r.i,r.x,r.y),u=new bp(t.i,t.x,t.y),m=r.next,g=t.prev;return r.next=t,t.prev=r,o.next=m,m.prev=o,u.next=o,o.prev=u,g.next=u,u.prev=g,u}function H_(r,t,o,u){var m=new bp(r,t,o);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function mc(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function bp(r,t,o){this.i=r,this.x=t,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Tp(r,t,o,u){for(var m=0,g=t,x=o-u;g<o;g+=u)m+=(r[x]-r[g])*(r[g+1]+r[x+1]),x=g;return m}function o1(r,t,o,u,m){X_(r,t,o||0,u||r.length-1,m||s1)}function X_(r,t,o,u,m){for(;u>o;){if(u-o>600){var g=u-o+1,x=t-o+1,S=Math.log(g),P=.5*Math.exp(2*S/3),A=.5*Math.sqrt(S*P*(g-P)/g)*(x-g/2<0?-1:1);X_(r,t,Math.max(o,Math.floor(t-x*P/g+A)),Math.min(u,Math.floor(t+(g-x)*P/g+A)),m)}var R=r[t],O=o,U=u;for(_c(r,o,t),m(r[u],R)>0&&_c(r,o,u);O<U;){for(_c(r,O,U),O++,U--;m(r[O],R)<0;)O++;for(;m(r[U],R)>0;)U--}m(r[o],R)===0?_c(r,o,U):_c(r,++U,u),U<=t&&(o=U+1),t<=U&&(u=U-1)}}function _c(r,t,o){var u=r[t];r[t]=r[o],r[o]=u}function s1(r,t){return r<t?-1:r>t?1:0}function Sp(r,t){const o=r.length;if(o<=1)return[r];const u=[];let m,g;for(let x=0;x<o;x++){const S=dt(r[x]);S!==0&&(r[x].area=Math.abs(S),g===void 0&&(g=S<0),g===S<0?(m&&u.push(m),m=[r[x]]):m.push(r[x]))}if(m&&u.push(m),t>1)for(let x=0;x<u.length;x++)u[x].length<=t||(o1(u[x],t,1,u[x].length-1,a1),u[x]=u[x].slice(0,t));return u}function a1(r,t){return t.area-r.area}function Ep(r,t,o){const u=o.patternDependencies;let m=!1;for(const g of t){const x=g.paint.get(`${r}-pattern`);x.isConstant()||(m=!0);const S=x.constantOr(null);S&&(m=!0,u[S.to]=!0,u[S.from]=!0)}return m}function Pp(r,t,o,u,m){const g=m.patternDependencies;for(const x of t){const S=x.paint.get(`${r}-pattern`).value;if(S.kind!=="constant"){let P=S.evaluate({zoom:u-1},o,{},m.availableImages),A=S.evaluate({zoom:u},o,{},m.availableImages),R=S.evaluate({zoom:u+1},o,{},m.availableImages);P=P&&P.name?P.name:P,A=A&&A.name?A.name:A,R=R&&R.name?R.name:R,g[P]=!0,g[A]=!0,g[R]=!0,o.patterns[x.id]={min:P,mid:A,max:R}}}return o}Ph.exports=Ch,Ph.exports.default=Ch,Ch.deviation=function(r,t,o,u){var m=t&&t.length,g=Math.abs(Tp(r,0,m?t[0]*o:r.length,o));if(m)for(var x=0,S=t.length;x<S;x++)g-=Math.abs(Tp(r,t[x]*o,x<S-1?t[x+1]*o:r.length,o));var P=0;for(x=0;x<u.length;x+=3){var A=u[x]*o,R=u[x+1]*o,O=u[x+2]*o;P+=Math.abs((r[A]-r[O])*(r[R+1]-r[A+1])-(r[A]-r[R])*(r[O+1]-r[A+1]))}return g===0&&P===0?0:Math.abs((P-g)/g)},Ch.flatten=function(r){for(var t=r[0][0].length,o={vertices:[],holes:[],dimensions:t},u=0,m=0;m<r.length;m++){for(var g=0;g<r[m].length;g++)for(var x=0;x<t;x++)o.vertices.push(r[m][g][x]);m>0&&o.holes.push(u+=r[m-1].length)}return o};class Cp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new li,this.indexArray=new Jn,this.indexArray2=new ts,this.programConfigurations=new Ll(t.layers,t.zoom),this.segments=new Nt,this.segments2=new Nt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,u){this.hasPattern=Ep("fill",this.layers,o);const m=this.layers[0].layout.get("fill-sort-key"),g=!m.isConstant(),x=[];for(const{feature:S,id:P,index:A,sourceLayerIndex:R}of t){const O=this.layers[0]._featureFilter.needGeometry,U=Rl(S,O);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),U,u))continue;const j=g?m.evaluate(U,{},u,o.availableImages):void 0,$={id:P,properties:S.properties,type:S.type,sourceLayerIndex:R,index:A,geometry:O?U.geometry:Dl(S),patterns:{},sortKey:j};x.push($)}g&&x.sort((S,P)=>S.sortKey-P.sortKey);for(const S of x){const{geometry:P,index:A,sourceLayerIndex:R}=S;if(this.hasPattern){const O=Pp("fill",this.layers,S,this.zoom,o);this.patternFeatures.push(O)}else this.addFeature(S,P,A,u,{});o.featureIndex.insert(t[A].feature,P,A,R,this.index)}}update(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)}addFeatures(t,o,u){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,X0),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,u,m,g){for(const x of Sp(o,500)){let S=0;for(const j of x)S+=j.length;const P=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray),A=P.vertexLength,R=[],O=[];for(const j of x){if(j.length===0)continue;j!==x[0]&&O.push(R.length/2);const $=this.segments2.prepareSegment(j.length,this.layoutVertexArray,this.indexArray2),te=$.vertexLength;this.layoutVertexArray.emplaceBack(j[0].x,j[0].y),this.indexArray2.emplaceBack(te+j.length-1,te),R.push(j[0].x),R.push(j[0].y);for(let ee=1;ee<j.length;ee++)this.layoutVertexArray.emplaceBack(j[ee].x,j[ee].y),this.indexArray2.emplaceBack(te+ee-1,te+ee),R.push(j[ee].x),R.push(j[ee].y);$.vertexLength+=j.length,$.primitiveLength+=j.length}const U=Ph.exports(R,O);for(let j=0;j<U.length;j+=3)this.indexArray.emplaceBack(A+U[j],A+U[j+1],A+U[j+2]);P.vertexLength+=S,P.primitiveLength+=U.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,g,m)}}nt("FillBucket",Cp,{omit:["layers","patternFeatures"]});const l1=new bt({"fill-sort-key":new he(ke.layout_fill["fill-sort-key"])});var u1={paint:new bt({"fill-antialias":new oe(ke.paint_fill["fill-antialias"]),"fill-opacity":new he(ke.paint_fill["fill-opacity"]),"fill-color":new he(ke.paint_fill["fill-color"]),"fill-outline-color":new he(ke.paint_fill["fill-outline-color"]),"fill-translate":new oe(ke.paint_fill["fill-translate"]),"fill-translate-anchor":new oe(ke.paint_fill["fill-translate-anchor"]),"fill-pattern":new Oe(ke.paint_fill["fill-pattern"])}),layout:l1};const c1=Bi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),h1=Bi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:d1}=c1;var Va={},p1=ut,K_=gu;function gu(r,t,o,u,m){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=u,this._values=m,r.readFields(f1,this,t)}function f1(r,t,o){r==1?t.id=o.readVarint():r==2?function(u,m){for(var g=u.readVarint()+u.pos;u.pos<g;){var x=m._keys[u.readVarint()],S=m._values[u.readVarint()];m.properties[x]=S}}(o,t):r==3?t.type=o.readVarint():r==4&&(t._geometry=o.pos)}function m1(r){for(var t,o,u=0,m=0,g=r.length,x=g-1;m<g;x=m++)u+=((o=r[x]).x-(t=r[m]).x)*(t.y+o.y);return u}gu.types=["Unknown","Point","LineString","Polygon"],gu.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,o=r.readVarint()+r.pos,u=1,m=0,g=0,x=0,S=[];r.pos<o;){if(m<=0){var P=r.readVarint();u=7&P,m=P>>3}if(m--,u===1||u===2)g+=r.readSVarint(),x+=r.readSVarint(),u===1&&(t&&S.push(t),t=[]),t.push(new p1(g,x));else{if(u!==7)throw new Error("unknown command "+u);t&&t.push(t[0].clone())}}return t&&S.push(t),S},gu.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,o=1,u=0,m=0,g=0,x=1/0,S=-1/0,P=1/0,A=-1/0;r.pos<t;){if(u<=0){var R=r.readVarint();o=7&R,u=R>>3}if(u--,o===1||o===2)(m+=r.readSVarint())<x&&(x=m),m>S&&(S=m),(g+=r.readSVarint())<P&&(P=g),g>A&&(A=g);else if(o!==7)throw new Error("unknown command "+o)}return[x,P,S,A]},gu.prototype.toGeoJSON=function(r,t,o){var u,m,g=this.extent*Math.pow(2,o),x=this.extent*r,S=this.extent*t,P=this.loadGeometry(),A=gu.types[this.type];function R(j){for(var $=0;$<j.length;$++){var te=j[$];j[$]=[360*(te.x+x)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+S)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(u=0;u<P.length;u++)O[u]=P[u][0];R(P=O);break;case 2:for(u=0;u<P.length;u++)R(P[u]);break;case 3:for(P=function(j){var $=j.length;if($<=1)return[j];for(var te,ee,_e=[],Se=0;Se<$;Se++){var fe=m1(j[Se]);fe!==0&&(ee===void 0&&(ee=fe<0),ee===fe<0?(te&&_e.push(te),te=[j[Se]]):te.push(j[Se]))}return te&&_e.push(te),_e}(P),u=0;u<P.length;u++)for(m=0;m<P[u].length;m++)R(P[u][m])}P.length===1?P=P[0]:A="Multi"+A;var U={type:"Feature",geometry:{type:A,coordinates:P},properties:this.properties};return"id"in this&&(U.id=this.id),U};var _1=K_,J_=Y_;function Y_(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(g1,this,t),this.length=this._features.length}function g1(r,t,o){r===15?t.version=o.readVarint():r===1?t.name=o.readString():r===5?t.extent=o.readVarint():r===2?t._features.push(o.pos):r===3?t._keys.push(o.readString()):r===4&&t._values.push(function(u){for(var m=null,g=u.readVarint()+u.pos;u.pos<g;){var x=u.readVarint()>>3;m=x===1?u.readString():x===2?u.readFloat():x===3?u.readDouble():x===4?u.readVarint64():x===5?u.readVarint():x===6?u.readSVarint():x===7?u.readBoolean():null}return m}(o))}Y_.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new _1(this._pbf,t,this.extent,this._keys,this._values)};var y1=J_;function v1(r,t,o){if(r===3){var u=new y1(o,o.readVarint()+o.pos);u.length&&(t[u.name]=u)}}Va.VectorTile=function(r,t){this.layers=r.readFields(v1,{},t)},Va.VectorTileFeature=K_,Va.VectorTileLayer=J_;const x1=Va.VectorTileFeature.types,Ip=Math.pow(2,13);function gc(r,t,o,u,m,g,x,S){r.emplaceBack(t,o,2*Math.floor(u*Ip)+x,m*Ip*2,g*Ip*2,Math.round(S))}class kp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Xt,this.centroidVertexArray=new _t,this.indexArray=new Jn,this.programConfigurations=new Ll(t.layers,t.zoom),this.segments=new Nt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,u){this.features=[],this.hasPattern=Ep("fill-extrusion",this.layers,o);for(const{feature:m,id:g,index:x,sourceLayerIndex:S}of t){const P=this.layers[0]._featureFilter.needGeometry,A=Rl(m,P);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),A,u))continue;const R={id:g,sourceLayerIndex:S,index:x,geometry:P?A.geometry:Dl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(Pp("fill-extrusion",this.layers,R,this.zoom,o)):this.addFeature(R,R.geometry,x,u,{}),o.featureIndex.insert(m,R.geometry,x,S,this.index,!0)}}addFeatures(t,o,u){for(const m of this.features){const{geometry:g}=m;this.addFeature(m,g,m.index,o,u)}}update(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,d1),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,h1.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,o,u,m,g){const x={x:0,y:0,vertexCount:0};for(const S of Sp(o,500)){let P=0;for(const $ of S)P+=$.length;let A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of S){if($.length===0||b1($))continue;let te=0;for(let ee=0;ee<$.length;ee++){const _e=$[ee];if(ee>=1){const Se=$[ee-1];if(!w1(_e,Se)){A.vertexLength+4>Nt.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const fe=_e.sub(Se)._perp()._unit(),we=Se.dist(_e);te+we>32768&&(te=0),gc(this.layoutVertexArray,_e.x,_e.y,fe.x,fe.y,0,0,te),gc(this.layoutVertexArray,_e.x,_e.y,fe.x,fe.y,0,1,te),x.x+=2*_e.x,x.y+=2*_e.y,x.vertexCount+=2,te+=we,gc(this.layoutVertexArray,Se.x,Se.y,fe.x,fe.y,0,0,te),gc(this.layoutVertexArray,Se.x,Se.y,fe.x,fe.y,0,1,te),x.x+=2*Se.x,x.y+=2*Se.y,x.vertexCount+=2;const Le=A.vertexLength;this.indexArray.emplaceBack(Le,Le+2,Le+1),this.indexArray.emplaceBack(Le+1,Le+2,Le+3),A.vertexLength+=4,A.primitiveLength+=2}}}}if(A.vertexLength+P>Nt.MAX_VERTEX_ARRAY_LENGTH&&(A=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray)),x1[t.type]!=="Polygon")continue;const R=[],O=[],U=A.vertexLength;for(const $ of S)if($.length!==0){$!==S[0]&&O.push(R.length/2);for(let te=0;te<$.length;te++){const ee=$[te];gc(this.layoutVertexArray,ee.x,ee.y,0,0,1,1,0),x.x+=ee.x,x.y+=ee.y,x.vertexCount+=1,R.push(ee.x),R.push(ee.y)}}const j=Ph.exports(R,O);for(let $=0;$<j.length;$+=3)this.indexArray.emplaceBack(U+j[$],U+j[$+2],U+j[$+1]);A.primitiveLength+=j.length/3,A.vertexLength+=P}for(let S=0;S<x.vertexCount;S++)this.centroidVertexArray.emplaceBack(Math.floor(x.x/x.vertexCount),Math.floor(x.y/x.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,g,m)}}function w1(r,t){return r.x===t.x&&(r.x<0||r.x>Qi)||r.y===t.y&&(r.y<0||r.y>Qi)}function b1(r){return r.every(t=>t.x<0)||r.every(t=>t.x>Qi)||r.every(t=>t.y<0)||r.every(t=>t.y>Qi)}nt("FillExtrusionBucket",kp,{omit:["layers","features"]});var T1={paint:new bt({"fill-extrusion-opacity":new oe(ke["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new he(ke["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new oe(ke["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new oe(ke["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Oe(ke["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new he(ke["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new he(ke["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new oe(ke["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function yc(r,t){return r.x*t.x+r.y*t.y}function Q_(r,t){if(r.length===1){let o=0;const u=t[o++];let m;for(;!m||u.equals(m);)if(m=t[o++],!m)return 1/0;for(;o<t.length;o++){const g=t[o],x=r[0],S=m.sub(u),P=g.sub(u),A=x.sub(u),R=yc(S,S),O=yc(S,P),U=yc(P,P),j=yc(A,S),$=yc(A,P),te=R*U-O*O,ee=(U*j-O*$)/te,_e=(R*$-O*j)/te,Se=u.z*(1-ee-_e)+m.z*ee+g.z*_e;if(isFinite(Se))return Se}return 1/0}{let o=1/0;for(const u of t)o=Math.min(o,u.z);return o}}const S1=Bi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:E1}=S1,P1=Bi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:C1}=P1,I1=Va.VectorTileFeature.types,k1=Math.cos(Math.PI/180*37.5),eg=Math.pow(2,14)/.5;class Ap{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Kt,this.layoutVertexArray2=new hi,this.indexArray=new Jn,this.programConfigurations=new Ll(t.layers,t.zoom),this.segments=new Nt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,u){this.hasPattern=Ep("line",this.layers,o);const m=this.layers[0].layout.get("line-sort-key"),g=!m.isConstant(),x=[];for(const{feature:S,id:P,index:A,sourceLayerIndex:R}of t){const O=this.layers[0]._featureFilter.needGeometry,U=Rl(S,O);if(!this.layers[0]._featureFilter.filter(new xi(this.zoom),U,u))continue;const j=g?m.evaluate(U,{},u):void 0,$={id:P,properties:S.properties,type:S.type,sourceLayerIndex:R,index:A,geometry:O?U.geometry:Dl(S),patterns:{},sortKey:j};x.push($)}g&&x.sort((S,P)=>S.sortKey-P.sortKey);for(const S of x){const{geometry:P,index:A,sourceLayerIndex:R}=S;if(this.hasPattern){const O=Pp("line",this.layers,S,this.zoom,o);this.patternFeatures.push(O)}else this.addFeature(S,P,A,u,{});o.featureIndex.insert(t[A].feature,P,A,R,this.index)}}update(t,o,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,u)}addFeatures(t,o,u){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,o,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,C1)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,E1),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,u,m,g){const x=this.layers[0].layout,S=x.get("line-join").evaluate(t,{}),P=x.get("line-cap"),A=x.get("line-miter-limit"),R=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const O of o)this.addLine(O,t,S,P,A,R);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,g,m)}addLine(t,o,u,m,g,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<t.length-1;_e++)this.totalDistance+=t[_e].dist(t[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const S=I1[o.type]==="Polygon";let P=t.length;for(;P>=2&&t[P-1].equals(t[P-2]);)P--;let A=0;for(;A<P-1&&t[A].equals(t[A+1]);)A++;if(P<(S?3:2))return;u==="bevel"&&(g=1.05);const R=this.overscaling<=16?122880/(512*this.overscaling):0,O=this.segments.prepareSegment(10*P,this.layoutVertexArray,this.indexArray);let U,j,$,te,ee;this.e1=this.e2=-1,S&&(U=t[P-2],ee=t[A].sub(U)._unit()._perp());for(let _e=A;_e<P;_e++){if($=_e===P-1?S?t[A+1]:void 0:t[_e+1],$&&t[_e].equals($))continue;ee&&(te=ee),U&&(j=U),U=t[_e],ee=$?$.sub(U)._unit()._perp():te,te=te||ee;let Se=te.add(ee);Se.x===0&&Se.y===0||Se._unit();const fe=te.x*ee.x+te.y*ee.y,we=Se.x*ee.x+Se.y*ee.y,Le=we!==0?1/we:1/0,Me=2*Math.sqrt(2-2*we),st=we<k1&&j&&$,ht=te.x*ee.y-te.y*ee.x>0;if(st&&_e>A){const We=U.dist(j);if(We>2*R){const tt=U.sub(U.sub(j)._mult(R/We)._round());this.updateDistance(j,tt),this.addCurrentVertex(tt,te,0,0,O),j=tt}}const et=j&&$;let Je=et?u:S?"butt":m;if(et&&Je==="round"&&(Le<x?Je="miter":Le<=2&&(Je="fakeround")),Je==="miter"&&Le>g&&(Je="bevel"),Je==="bevel"&&(Le>2&&(Je="flipbevel"),Le<g&&(Je="miter")),j&&this.updateDistance(j,U),Je==="miter")Se._mult(Le),this.addCurrentVertex(U,Se,0,0,O);else if(Je==="flipbevel"){if(Le>100)Se=ee.mult(-1);else{const We=Le*te.add(ee).mag()/te.sub(ee).mag();Se._perp()._mult(We*(ht?-1:1))}this.addCurrentVertex(U,Se,0,0,O),this.addCurrentVertex(U,Se.mult(-1),0,0,O)}else if(Je==="bevel"||Je==="fakeround"){const We=-Math.sqrt(Le*Le-1),tt=ht?We:0,Qe=ht?0:We;if(j&&this.addCurrentVertex(U,te,tt,Qe,O),Je==="fakeround"){const Ne=Math.round(180*Me/Math.PI/20);for(let gt=1;gt<Ne;gt++){let ft=gt/Ne;if(ft!==.5){const Si=ft-.5;ft+=ft*Si*(ft-1)*((1.0904+fe*(fe*(3.55645-1.43519*fe)-3.2452))*Si*Si+(.848013+fe*(.215638*fe-1.06021)))}const Ot=ee.sub(te)._mult(ft)._add(te)._unit()._mult(ht?-1:1);this.addHalfVertex(U,Ot.x,Ot.y,!1,ht,0,O)}}$&&this.addCurrentVertex(U,ee,-tt,-Qe,O)}else if(Je==="butt")this.addCurrentVertex(U,Se,0,0,O);else if(Je==="square"){const We=j?1:-1;this.addCurrentVertex(U,Se,We,We,O)}else Je==="round"&&(j&&(this.addCurrentVertex(U,te,0,0,O),this.addCurrentVertex(U,te,1,1,O,!0)),$&&(this.addCurrentVertex(U,ee,-1,-1,O,!0),this.addCurrentVertex(U,ee,0,0,O)));if(st&&_e<P-1){const We=U.dist($);if(We>2*R){const tt=U.add($.sub(U)._mult(R/We)._round());this.updateDistance(U,tt),this.addCurrentVertex(tt,ee,0,0,O),U=tt}}}}addCurrentVertex(t,o,u,m,g,x=!1){const S=o.y*m-o.x,P=-o.y-o.x*m;this.addHalfVertex(t,o.x+o.y*u,o.y-o.x*u,x,!1,u,g),this.addHalfVertex(t,S,P,x,!0,-m,g),this.distance>eg/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,o,u,m,g,x))}addHalfVertex({x:t,y:o},u,m,g,x,S,P){const A=.5*(this.lineClips?this.scaledDistance*(eg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(g?1:0),(o<<1)+(x?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(S===0?0:S<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const R=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),P.primitiveLength++),x?this.e2=R:this.e1=R}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}nt("LineBucket",Ap,{omit:["layers","patternFeatures"]});const A1=new bt({"line-cap":new oe(ke.layout_line["line-cap"]),"line-join":new he(ke.layout_line["line-join"]),"line-miter-limit":new oe(ke.layout_line["line-miter-limit"]),"line-round-limit":new oe(ke.layout_line["line-round-limit"]),"line-sort-key":new he(ke.layout_line["line-sort-key"])});var tg={paint:new bt({"line-opacity":new he(ke.paint_line["line-opacity"]),"line-color":new he(ke.paint_line["line-color"]),"line-translate":new oe(ke.paint_line["line-translate"]),"line-translate-anchor":new oe(ke.paint_line["line-translate-anchor"]),"line-width":new he(ke.paint_line["line-width"]),"line-gap-width":new he(ke.paint_line["line-gap-width"]),"line-offset":new he(ke.paint_line["line-offset"]),"line-blur":new he(ke.paint_line["line-blur"]),"line-dasharray":new rt(ke.paint_line["line-dasharray"]),"line-pattern":new Oe(ke.paint_line["line-pattern"]),"line-gradient":new wt(ke.paint_line["line-gradient"])}),layout:A1};const ig=new class extends he{possiblyEvaluate(r,t){return t=new xi(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(r,t)}evaluate(r,t,o,u){return t=Ve({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(r,t,o,u)}}(tg.paint.properties["line-width"].specification);function ng(r,t){return t>0?t+2*r:r}ig.useIntegerZoom=!0;const z1=Bi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),M1=Bi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Bi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const L1=Bi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Bi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const rg=Bi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),D1=Bi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function R1(r,t,o){return r.sections.forEach(u=>{u.text=function(m,g,x){const S=g.layout.get("text-transform").evaluate(x,{});return S==="uppercase"?m=m.toLocaleUpperCase():S==="lowercase"&&(m=m.toLocaleLowerCase()),Nn.applyArabicShaping&&(m=Nn.applyArabicShaping(m)),m}(u.text,t,o)}),r}Bi([{name:"triangle",components:3,type:"Uint16"}]),Bi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Bi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Bi([{type:"Float32",name:"offsetX"}]),Bi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const vc={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var vn=24,zp=mi,og=function(r,t,o,u,m){var g,x,S=8*m-u-1,P=(1<<S)-1,A=P>>1,R=-7,O=o?m-1:0,U=o?-1:1,j=r[t+O];for(O+=U,g=j&(1<<-R)-1,j>>=-R,R+=S;R>0;g=256*g+r[t+O],O+=U,R-=8);for(x=g&(1<<-R)-1,g>>=-R,R+=u;R>0;x=256*x+r[t+O],O+=U,R-=8);if(g===0)g=1-A;else{if(g===P)return x?NaN:1/0*(j?-1:1);x+=Math.pow(2,u),g-=A}return(j?-1:1)*x*Math.pow(2,g-u)},sg=function(r,t,o,u,m,g){var x,S,P,A=8*g-m-1,R=(1<<A)-1,O=R>>1,U=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=u?0:g-1,$=u?1:-1,te=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(S=isNaN(t)?1:0,x=R):(x=Math.floor(Math.log(t)/Math.LN2),t*(P=Math.pow(2,-x))<1&&(x--,P*=2),(t+=x+O>=1?U/P:U*Math.pow(2,1-O))*P>=2&&(x++,P/=2),x+O>=R?(S=0,x=R):x+O>=1?(S=(t*P-1)*Math.pow(2,m),x+=O):(S=t*Math.pow(2,O-1)*Math.pow(2,m),x=0));m>=8;r[o+j]=255&S,j+=$,S/=256,m-=8);for(x=x<<m|S,A+=m;A>0;r[o+j]=255&x,j+=$,x/=256,A-=8);r[o+j-$]|=128*te};function mi(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}mi.Varint=0,mi.Fixed64=1,mi.Bytes=2,mi.Fixed32=5;var Za,Mp=4294967296,ag=1/Mp,lg=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function oa(r){return r.type===mi.Bytes?r.readVarint()+r.pos:r.pos+1}function yu(r,t,o){return o?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function ug(r,t,o){var u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(u);for(var m=o.pos-1;m>=r;m--)o.buf[m+u]=o.buf[m]}function B1(r,t){for(var o=0;o<r.length;o++)t.writeVarint(r[o])}function O1(r,t){for(var o=0;o<r.length;o++)t.writeSVarint(r[o])}function F1(r,t){for(var o=0;o<r.length;o++)t.writeFloat(r[o])}function N1(r,t){for(var o=0;o<r.length;o++)t.writeDouble(r[o])}function U1(r,t){for(var o=0;o<r.length;o++)t.writeBoolean(r[o])}function V1(r,t){for(var o=0;o<r.length;o++)t.writeFixed32(r[o])}function Z1(r,t){for(var o=0;o<r.length;o++)t.writeSFixed32(r[o])}function G1(r,t){for(var o=0;o<r.length;o++)t.writeFixed64(r[o])}function j1(r,t){for(var o=0;o<r.length;o++)t.writeSFixed64(r[o])}function zh(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function vu(r,t,o){r[o]=t,r[o+1]=t>>>8,r[o+2]=t>>>16,r[o+3]=t>>>24}function cg(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}function q1(r,t,o){r===1&&o.readMessage($1,t)}function $1(r,t,o){if(r===3){const{id:u,bitmap:m,width:g,height:x,left:S,top:P,advance:A}=o.readMessage(W1,{});t.push({id:u,bitmap:new dc({width:g+6,height:x+6},m),metrics:{width:g,height:x,left:S,top:P,advance:A}})}}function W1(r,t,o){r===1?t.id=o.readVarint():r===2?t.bitmap=o.readBytes():r===3?t.width=o.readVarint():r===4?t.height=o.readVarint():r===5?t.left=o.readSVarint():r===6?t.top=o.readSVarint():r===7&&(t.advance=o.readVarint())}function hg(r){let t=0,o=0;for(const x of r)t+=x.w*x.h,o=Math.max(o,x.w);r.sort((x,S)=>S.h-x.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let m=0,g=0;for(const x of r)for(let S=u.length-1;S>=0;S--){const P=u[S];if(!(x.w>P.w||x.h>P.h)){if(x.x=P.x,x.y=P.y,g=Math.max(g,x.y+x.h),m=Math.max(m,x.x+x.w),x.w===P.w&&x.h===P.h){const A=u.pop();S<u.length&&(u[S]=A)}else x.h===P.h?(P.x+=x.w,P.w-=x.w):x.w===P.w?(P.y+=x.h,P.h-=x.h):(u.push({x:P.x+x.w,y:P.y,w:P.w-x.w,h:x.h}),P.y+=x.h,P.h-=x.h);break}}return{w:m,h:g,fill:t/(m*g)||0}}mi.prototype={destroy:function(){this.buf=null},readFields:function(r,t,o){for(o=o||this.length;this.pos<o;){var u=this.readVarint(),m=u>>3,g=this.pos;this.type=7&u,r(m,t,this),this.pos===g&&this.skip(u)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=zh(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=cg(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=zh(this.buf,this.pos)+zh(this.buf,this.pos+4)*Mp;return this.pos+=8,r},readSFixed64:function(){var r=zh(this.buf,this.pos)+cg(this.buf,this.pos+4)*Mp;return this.pos+=8,r},readFloat:function(){var r=og(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=og(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,o,u=this.buf;return t=127&(o=u[this.pos++]),o<128?t:(t|=(127&(o=u[this.pos++]))<<7,o<128?t:(t|=(127&(o=u[this.pos++]))<<14,o<128?t:(t|=(127&(o=u[this.pos++]))<<21,o<128?t:function(m,g,x){var S,P,A=x.buf;if(S=(112&(P=A[x.pos++]))>>4,P<128||(S|=(127&(P=A[x.pos++]))<<3,P<128)||(S|=(127&(P=A[x.pos++]))<<10,P<128)||(S|=(127&(P=A[x.pos++]))<<17,P<128)||(S|=(127&(P=A[x.pos++]))<<24,P<128)||(S|=(1&(P=A[x.pos++]))<<31,P<128))return yu(m,S,g);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(o=u[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&lg?function(o,u,m){return lg.decode(o.subarray(u,m))}(this.buf,t,r):function(o,u,m){for(var g="",x=u;x<m;){var S,P,A,R=o[x],O=null,U=R>239?4:R>223?3:R>191?2:1;if(x+U>m)break;U===1?R<128&&(O=R):U===2?(192&(S=o[x+1]))==128&&(O=(31&R)<<6|63&S)<=127&&(O=null):U===3?(P=o[x+2],(192&(S=o[x+1]))==128&&(192&P)==128&&((O=(15&R)<<12|(63&S)<<6|63&P)<=2047||O>=55296&&O<=57343)&&(O=null)):U===4&&(P=o[x+2],A=o[x+3],(192&(S=o[x+1]))==128&&(192&P)==128&&(192&A)==128&&((O=(15&R)<<18|(63&S)<<12|(63&P)<<6|63&A)<=65535||O>=1114112)&&(O=null)),O===null?(O=65533,U=1):O>65535&&(O-=65536,g+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),g+=String.fromCharCode(O),x+=U}return g}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==mi.Bytes)return r.push(this.readVarint(t));var o=oa(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==mi.Bytes)return r.push(this.readSVarint());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==mi.Bytes)return r.push(this.readBoolean());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==mi.Bytes)return r.push(this.readFloat());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==mi.Bytes)return r.push(this.readDouble());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==mi.Bytes)return r.push(this.readFixed32());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==mi.Bytes)return r.push(this.readSFixed32());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==mi.Bytes)return r.push(this.readFixed64());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==mi.Bytes)return r.push(this.readSFixed64());var t=oa(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===mi.Varint)for(;this.buf[this.pos++]>127;);else if(t===mi.Bytes)this.pos=this.readVarint()+this.pos;else if(t===mi.Fixed32)this.pos+=4;else{if(t!==mi.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),vu(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),vu(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),vu(this.buf,-1&r,this.pos),vu(this.buf,Math.floor(r*ag),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),vu(this.buf,-1&r,this.pos),vu(this.buf,Math.floor(r*ag),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,o){var u,m;if(t>=0?(u=t%4294967296|0,m=t/4294967296|0):(m=~(-t/4294967296),4294967295^(u=~(-t%4294967296))?u=u+1|0:(u=0,m=m+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(g,x,S){S.buf[S.pos++]=127&g|128,g>>>=7,S.buf[S.pos++]=127&g|128,g>>>=7,S.buf[S.pos++]=127&g|128,g>>>=7,S.buf[S.pos++]=127&g|128,S.buf[S.pos]=127&(g>>>=7)}(u,0,o),function(g,x){var S=(7&g)<<4;x.buf[x.pos++]|=S|((g>>>=3)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g)))))}(m,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(Boolean(r))},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(u,m,g){for(var x,S,P=0;P<m.length;P++){if((x=m.charCodeAt(P))>55295&&x<57344){if(!S){x>56319||P+1===m.length?(u[g++]=239,u[g++]=191,u[g++]=189):S=x;continue}if(x<56320){u[g++]=239,u[g++]=191,u[g++]=189,S=x;continue}x=S-55296<<10|x-56320|65536,S=null}else S&&(u[g++]=239,u[g++]=191,u[g++]=189,S=null);x<128?u[g++]=x:(x<2048?u[g++]=x>>6|192:(x<65536?u[g++]=x>>12|224:(u[g++]=x>>18|240,u[g++]=x>>12&63|128),u[g++]=x>>6&63|128),u[g++]=63&x|128)}return g}(this.buf,r,this.pos);var o=this.pos-t;o>=128&&ug(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),sg(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),sg(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var o=0;o<t;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,t){this.pos++;var o=this.pos;r(t,this);var u=this.pos-o;u>=128&&ug(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u},writeMessage:function(r,t,o){this.writeTag(r,mi.Bytes),this.writeRawMessage(t,o)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,B1,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,O1,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,U1,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,F1,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,N1,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,V1,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,Z1,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,G1,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,j1,t)},writeBytesField:function(r,t){this.writeTag(r,mi.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,mi.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,mi.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,mi.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,mi.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,mi.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,mi.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,mi.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,mi.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,mi.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,Boolean(t))}};class Lp{constructor(t,{pixelRatio:o,version:u,stretchX:m,stretchY:g,content:x}){this.paddedRect=t,this.pixelRatio=o,this.stretchX=m,this.stretchY=g,this.content=x,this.version=u}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class dg{constructor(t,o){const u={},m={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,u,g),this.addImages(o,m,g);const{w:x,h:S}=hg(g),P=new eo({width:x||1,height:S||1});for(const A in t){const R=t[A],O=u[A].paddedRect;eo.copy(R.data,P,{x:0,y:0},{x:O.x+1,y:O.y+1},R.data)}for(const A in o){const R=o[A],O=m[A].paddedRect,U=O.x+1,j=O.y+1,$=R.data.width,te=R.data.height;eo.copy(R.data,P,{x:0,y:0},{x:U,y:j},R.data),eo.copy(R.data,P,{x:0,y:te-1},{x:U,y:j-1},{width:$,height:1}),eo.copy(R.data,P,{x:0,y:0},{x:U,y:j+te},{width:$,height:1}),eo.copy(R.data,P,{x:$-1,y:0},{x:U-1,y:j},{width:1,height:te}),eo.copy(R.data,P,{x:0,y:0},{x:U+$,y:j},{width:1,height:te})}this.image=P,this.iconPositions=u,this.patternPositions=m}addImages(t,o,u){for(const m in t){const g=t[m],x={x:0,y:0,w:g.data.width+2,h:g.data.height+2};u.push(x),o[m]=new Lp(x,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(t,o){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),o),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),o)}patchUpdatedImage(t,o,u){if(!t||!o||t.version===o.version)return;t.version=o.version;const[m,g]=t.tl;u.update(o.data,void 0,{x:m,y:g})}}nt("ImagePosition",Lp),nt("ImageAtlas",dg),c.WritingMode=void 0,(Za=c.WritingMode||(c.WritingMode={}))[Za.none=0]="none",Za[Za.horizontal=1]="horizontal",Za[Za.vertical=2]="vertical",Za[Za.horizontalOnly=3]="horizontalOnly";const Mh=-17;class xc{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){const u=new xc;return u.scale=t||1,u.fontStack=o,u}static forImage(t){const o=new xc;return o.imageName=t,o}}class xu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const u=new xu;for(let m=0;m<t.sections.length;m++){const g=t.sections[m];g.image?u.addImageSection(g):u.addTextSection(g,o)}return u}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let o="";for(let u=0;u<t.length;u++){const m=t.charCodeAt(u+1)||null,g=t.charCodeAt(u-1)||null;o+=m&&kl(m)&&!vc[t[u+1]]||g&&kl(g)&&!vc[t[u-1]]||!vc[t[u]]?t[u]:vc[t[u]]}return o}(this.text)}trim(){let t=0;for(let u=0;u<this.text.length&&Dh[this.text.charCodeAt(u)];u++)t++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=t&&Dh[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const u=new xu;return u.text=this.text.substring(t,o),u.sectionIndex=this.sectionIndex.slice(t,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(xc.forText(t.scale,t.fontStack||o));const u=this.sections.length-1;for(let m=0;m<t.text.length;++m)this.sectionIndex.push(u)}addImageSection(t){const o=t.image?t.image.name:"";if(o.length===0)return void $e("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(xc.forImage(o)),this.sectionIndex.push(this.sections.length-1)):$e("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Lh(r,t,o,u,m,g,x,S,P,A,R,O,U,j,$,te){const ee=xu.fromFeature(r,m);let _e;O===c.WritingMode.vertical&&ee.verticalizePunctuation();const{processBidirectionalText:Se,processStyledBidirectionalText:fe}=Nn;if(Se&&ee.sections.length===1){_e=[];const Me=Se(ee.toString(),Dp(ee,A,g,t,u,j,$));for(const st of Me){const ht=new xu;ht.text=st,ht.sections=ee.sections;for(let et=0;et<st.length;et++)ht.sectionIndex.push(0);_e.push(ht)}}else if(fe){_e=[];const Me=fe(ee.text,ee.sectionIndex,Dp(ee,A,g,t,u,j,$));for(const st of Me){const ht=new xu;ht.text=st[0],ht.sectionIndex=st[1],ht.sections=ee.sections,_e.push(ht)}}else _e=function(Me,st){const ht=[],et=Me.text;let Je=0;for(const We of st)ht.push(Me.substring(Je,We)),Je=We;return Je<et.length&&ht.push(Me.substring(Je,et.length)),ht}(ee,Dp(ee,A,g,t,u,j,$));const we=[],Le={positionedLines:we,text:ee.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:O,iconsInText:!1,verticalizable:!1};return function(Me,st,ht,et,Je,We,tt,Qe,Ne,gt,ft,Ot){let Si=0,Ci=Mh,en=0,io=0;const In=Qe==="right"?1:Qe==="left"?0:.5;let Hi=0;for(const Xi of Je){Xi.trim();const An=Xi.getMaxScale(),Vn=(An-1)*vn,er={positionedGlyphs:[],lineOffset:0};Me.positionedLines[Hi]=er;const dr=er.positionedGlyphs;let pr=0;if(!Xi.length()){Ci+=We,++Hi;continue}for(let cn=0;cn<Xi.length();cn++){const Zt=Xi.getSection(cn),Rr=Xi.getSectionIndex(cn),zn=Xi.getCharCode(cn);let Zn=0,Io=null,ns=null,rs=null,aa=vn;const ko=!(Ne===c.WritingMode.horizontal||!ft&&!cr(zn)||ft&&(Dh[zn]||(un=zn,He.Arabic(un)||He["Arabic Supplement"](un)||He["Arabic Extended-A"](un)||He["Arabic Presentation Forms-A"](un)||He["Arabic Presentation Forms-B"](un))));if(Zt.imageName){const no=et[Zt.imageName];if(!no)continue;rs=Zt.imageName,Me.iconsInText=Me.iconsInText||!0,ns=no.paddedRect;const fr=no.displaySize;Zt.scale=Zt.scale*vn/Ot,Io={width:fr[0],height:fr[1],left:1,top:-3,advance:ko?fr[1]:fr[0]},Zn=Vn+(vn-fr[1]*Zt.scale),aa=Io.advance;const la=ko?fr[0]*Zt.scale-vn*An:fr[1]*Zt.scale-vn*An;la>0&&la>pr&&(pr=la)}else{const no=ht[Zt.fontStack],fr=no&&no[zn];if(fr&&fr.rect)ns=fr.rect,Io=fr.metrics;else{const la=st[Zt.fontStack],Tc=la&&la[zn];if(!Tc)continue;Io=Tc.metrics}Zn=(An-Zt.scale)*vn}ko?(Me.verticalizable=!0,dr.push({glyph:zn,imageName:rs,x:Si,y:Ci+Zn,vertical:ko,scale:Zt.scale,fontStack:Zt.fontStack,sectionIndex:Rr,metrics:Io,rect:ns}),Si+=aa*Zt.scale+gt):(dr.push({glyph:zn,imageName:rs,x:Si,y:Ci+Zn,vertical:ko,scale:Zt.scale,fontStack:Zt.fontStack,sectionIndex:Rr,metrics:Io,rect:ns}),Si+=Io.advance*Zt.scale+gt)}dr.length!==0&&(en=Math.max(Si-gt,en),K1(dr,0,dr.length-1,In,pr)),Si=0;const Ii=We*An+pr;er.lineOffset=Math.max(pr,Vn),Ci+=Ii,io=Math.max(Ii,io),++Hi}var un;const kn=Ci-Mh,{horizontalAlign:Un,verticalAlign:hr}=Rp(tt);(function(Xi,An,Vn,er,dr,pr,Ii,cn,Zt){const Rr=(An-Vn)*dr;let zn=0;zn=pr!==Ii?-cn*er-Mh:(-er*Zt+.5)*Ii;for(const Zn of Xi)for(const Io of Zn.positionedGlyphs)Io.x+=Rr,Io.y+=zn})(Me.positionedLines,In,Un,hr,en,io,We,kn,Je.length),Me.top+=-hr*kn,Me.bottom=Me.top+kn,Me.left+=-Un*en,Me.right=Me.left+en}(Le,t,o,u,_e,x,S,P,O,A,U,te),!function(Me){for(const st of Me)if(st.positionedGlyphs.length!==0)return!1;return!0}(we)&&Le}const Dh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},H1={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function pg(r,t,o,u,m,g){if(t.imageName){const x=u[t.imageName];return x?x.displaySize[0]*t.scale*vn/g+m:0}{const x=o[t.fontStack],S=x&&x[r];return S?S.metrics.advance*t.scale+m:0}}function fg(r,t,o,u){const m=Math.pow(r-t,2);return u?r<t?m/2:2*m:m+Math.abs(o)*o}function X1(r,t,o){let u=0;return r===10&&(u-=1e4),o&&(u+=150),r!==40&&r!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function mg(r,t,o,u,m,g){let x=null,S=fg(t,o,m,g);for(const P of u){const A=fg(t-P.x,o,m,g)+P.badness;A<=S&&(x=P,S=A)}return{index:r,x:t,priorBreak:x,badness:S}}function _g(r){return r?_g(r.priorBreak).concat(r.index):[]}function Dp(r,t,o,u,m,g,x){if(g!=="point")return[];if(!r)return[];const S=[],P=function(U,j,$,te,ee,_e){let Se=0;for(let fe=0;fe<U.length();fe++){const we=U.getSection(fe);Se+=pg(U.getCharCode(fe),we,te,ee,j,_e)}return Se/Math.max(1,Math.ceil(Se/$))}(r,t,o,u,m,x),A=r.text.indexOf("")>=0;let R=0;for(let U=0;U<r.length();U++){const j=r.getSection(U),$=r.getCharCode(U);if(Dh[$]||(R+=pg($,j,u,m,t,x)),U<r.length()-1){const te=!((O=$)<11904||!(He["Bopomofo Extended"](O)||He.Bopomofo(O)||He["CJK Compatibility Forms"](O)||He["CJK Compatibility Ideographs"](O)||He["CJK Compatibility"](O)||He["CJK Radicals Supplement"](O)||He["CJK Strokes"](O)||He["CJK Symbols and Punctuation"](O)||He["CJK Unified Ideographs Extension A"](O)||He["CJK Unified Ideographs"](O)||He["Enclosed CJK Letters and Months"](O)||He["Halfwidth and Fullwidth Forms"](O)||He.Hiragana(O)||He["Ideographic Description Characters"](O)||He["Kangxi Radicals"](O)||He["Katakana Phonetic Extensions"](O)||He.Katakana(O)||He["Vertical Forms"](O)||He["Yi Radicals"](O)||He["Yi Syllables"](O)));(H1[$]||te||j.imageName)&&S.push(mg(U+1,R,P,S,X1($,r.getCharCode(U+1),te&&A),!1))}}var O;return _g(mg(r.length(),R,P,S,0,!0))}function Rp(r){let t=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function K1(r,t,o,u,m){if(!u&&!m)return;const g=r[o],x=(r[o].x+g.metrics.advance*g.scale)*u;for(let S=t;S<=o;S++)r[S].x-=x,r[S].y+=m}function J1(r,t,o){const{horizontalAlign:u,verticalAlign:m}=Rp(o),g=t[0]-r.displaySize[0]*u,x=t[1]-r.displaySize[1]*m;return{image:r,top:x,bottom:x+r.displaySize[1],left:g,right:g+r.displaySize[0]}}function gg(r,t,o,u,m,g){const x=r.image;let S;if(x.content){const ee=x.content,_e=x.pixelRatio||1;S=[ee[0]/_e,ee[1]/_e,x.displaySize[0]-ee[2]/_e,x.displaySize[1]-ee[3]/_e]}const P=t.left*g,A=t.right*g;let R,O,U,j;o==="width"||o==="both"?(j=m[0]+P-u[3],O=m[0]+A+u[1]):(j=m[0]+(P+A-x.displaySize[0])/2,O=j+x.displaySize[0]);const $=t.top*g,te=t.bottom*g;return o==="height"||o==="both"?(R=m[1]+$-u[0],U=m[1]+te+u[2]):(R=m[1]+($+te-x.displaySize[1])/2,U=R+x.displaySize[1]),{image:x,top:R,right:O,bottom:U,left:j,collisionPadding:S}}const sa=128;function yg(r,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new xi(r+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:m}=o;let g=0;for(;g<u.length&&u[g]<=r;)g++;g=Math.max(0,g-1);let x=g;for(;x<u.length&&u[x]<r+1;)x++;x=Math.min(u.length-1,x);const S=u[g],P=u[x];return o.kind==="composite"?{kind:"composite",minZoom:S,maxZoom:P,interpolationType:m}:{kind:"camera",minZoom:S,maxZoom:P,minSize:o.evaluate(new xi(S)),maxSize:o.evaluate(new xi(P)),interpolationType:m}}}class Ga extends ut{constructor(t,o,u,m){super(t,o),this.angle=u,m!==void 0&&(this.segment=m)}clone(){return new Ga(this.x,this.y,this.angle,this.segment)}}function vg(r,t,o,u,m){if(t.segment===void 0)return!0;let g=t,x=t.segment+1,S=0;for(;S>-o/2;){if(x--,x<0)return!1;S-=r[x].dist(g),g=r[x]}S+=r[x].dist(r[x+1]),x++;const P=[];let A=0;for(;S<o/2;){const R=r[x],O=r[x+1];if(!O)return!1;let U=r[x-1].angleTo(R)-R.angleTo(O);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:S,angleDelta:U}),A+=U;S-P[0].distance>u;)A-=P.shift().angleDelta;if(A>m)return!1;x++,S+=R.dist(O)}return!0}function xg(r){let t=0;for(let o=0;o<r.length-1;o++)t+=r[o].dist(r[o+1]);return t}function wg(r,t,o){return r?.6*t*o:0}function bg(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function Y1(r,t,o,u,m,g){const x=wg(o,m,g),S=bg(o,u)*g;let P=0;const A=xg(r)/2;for(let R=0;R<r.length-1;R++){const O=r[R],U=r[R+1],j=O.dist(U);if(P+j>A){const $=(A-P)/j,te=pi(O.x,U.x,$),ee=pi(O.y,U.y,$),_e=new Ga(te,ee,U.angleTo(O),R);return _e._round(),!x||vg(r,_e,S,x,t)?_e:void 0}P+=j}}function Q1(r,t,o,u,m,g,x,S,P){const A=wg(u,g,x),R=bg(u,m),O=R*x,U=r[0].x===0||r[0].x===P||r[0].y===0||r[0].y===P;return t-O<t/4&&(t=O+t/4),Tg(r,U?t/2*S%t:(R/2+2*g)*x*S%t,t,A,o,O,U,!1,P)}function Tg(r,t,o,u,m,g,x,S,P){const A=g/2,R=xg(r);let O=0,U=t-o,j=[];for(let $=0;$<r.length-1;$++){const te=r[$],ee=r[$+1],_e=te.dist(ee),Se=ee.angleTo(te);for(;U+o<O+_e;){U+=o;const fe=(U-O)/_e,we=pi(te.x,ee.x,fe),Le=pi(te.y,ee.y,fe);if(we>=0&&we<P&&Le>=0&&Le<P&&U-A>=0&&U+A<=R){const Me=new Ga(we,Le,Se,$);Me._round(),u&&!vg(r,Me,g,u,m)||j.push(Me)}}O+=_e}return S||j.length||x||(j=Tg(r,O/2,o,u,m,g,x,!0,P)),j}function Sg(r,t,o,u,m){const g=[];for(let x=0;x<r.length;x++){const S=r[x];let P;for(let A=0;A<S.length-1;A++){let R=S[A],O=S[A+1];R.x<t&&O.x<t||(R.x<t?R=new ut(t,R.y+(t-R.x)/(O.x-R.x)*(O.y-R.y))._round():O.x<t&&(O=new ut(t,R.y+(t-R.x)/(O.x-R.x)*(O.y-R.y))._round()),R.y<o&&O.y<o||(R.y<o?R=new ut(R.x+(o-R.y)/(O.y-R.y)*(O.x-R.x),o)._round():O.y<o&&(O=new ut(R.x+(o-R.y)/(O.y-R.y)*(O.x-R.x),o)._round()),R.x>=u&&O.x>=u||(R.x>=u?R=new ut(u,R.y+(u-R.x)/(O.x-R.x)*(O.y-R.y))._round():O.x>=u&&(O=new ut(u,R.y+(u-R.x)/(O.x-R.x)*(O.y-R.y))._round()),R.y>=m&&O.y>=m||(R.y>=m?R=new ut(R.x+(m-R.y)/(O.y-R.y)*(O.x-R.x),m)._round():O.y>=m&&(O=new ut(R.x+(m-R.y)/(O.y-R.y)*(O.x-R.x),m)._round()),P&&R.equals(P[P.length-1])||(P=[R],g.push(P)),P.push(O)))))}}return g}function Eg(r,t,o,u){const m=[],g=r.image,x=g.pixelRatio,S=g.paddedRect.w-2,P=g.paddedRect.h-2,A=r.right-r.left,R=r.bottom-r.top,O=g.stretchX||[[0,S]],U=g.stretchY||[[0,P]],j=(We,tt)=>We+tt[1]-tt[0],$=O.reduce(j,0),te=U.reduce(j,0),ee=S-$,_e=P-te;let Se=0,fe=$,we=0,Le=te,Me=0,st=ee,ht=0,et=_e;if(g.content&&u){const We=g.content;Se=Rh(O,0,We[0]),we=Rh(U,0,We[1]),fe=Rh(O,We[0],We[2]),Le=Rh(U,We[1],We[3]),Me=We[0]-Se,ht=We[1]-we,st=We[2]-We[0]-fe,et=We[3]-We[1]-Le}const Je=(We,tt,Qe,Ne)=>{const gt=Bh(We.stretch-Se,fe,A,r.left),ft=Oh(We.fixed-Me,st,We.stretch,$),Ot=Bh(tt.stretch-we,Le,R,r.top),Si=Oh(tt.fixed-ht,et,tt.stretch,te),Ci=Bh(Qe.stretch-Se,fe,A,r.left),en=Oh(Qe.fixed-Me,st,Qe.stretch,$),io=Bh(Ne.stretch-we,Le,R,r.top),In=Oh(Ne.fixed-ht,et,Ne.stretch,te),Hi=new ut(gt,Ot),un=new ut(Ci,Ot),kn=new ut(Ci,io),Un=new ut(gt,io),hr=new ut(ft/x,Si/x),Xi=new ut(en/x,In/x),An=t*Math.PI/180;if(An){const dr=Math.sin(An),pr=Math.cos(An),Ii=[pr,-dr,dr,pr];Hi._matMult(Ii),un._matMult(Ii),Un._matMult(Ii),kn._matMult(Ii)}const Vn=We.stretch+We.fixed,er=tt.stretch+tt.fixed;return{tl:Hi,tr:un,bl:Un,br:kn,tex:{x:g.paddedRect.x+1+Vn,y:g.paddedRect.y+1+er,w:Qe.stretch+Qe.fixed-Vn,h:Ne.stretch+Ne.fixed-er},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hr,pixelOffsetBR:Xi,minFontScaleX:st/x/A,minFontScaleY:et/x/R,isSDF:o}};if(u&&(g.stretchX||g.stretchY)){const We=Pg(O,ee,$),tt=Pg(U,_e,te);for(let Qe=0;Qe<We.length-1;Qe++){const Ne=We[Qe],gt=We[Qe+1];for(let ft=0;ft<tt.length-1;ft++)m.push(Je(Ne,tt[ft],gt,tt[ft+1]))}}else m.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:S+1},{fixed:0,stretch:P+1}));return m}function Rh(r,t,o){let u=0;for(const m of r)u+=Math.max(t,Math.min(o,m[1]))-Math.max(t,Math.min(o,m[0]));return u}function Pg(r,t,o){const u=[{fixed:-1,stretch:0}];for(const[m,g]of r){const x=u[u.length-1];u.push({fixed:m-x.stretch,stretch:x.stretch}),u.push({fixed:m-x.stretch,stretch:x.stretch+(g-m)})}return u.push({fixed:t+1,stretch:o}),u}function Bh(r,t,o,u){return r/t*o+u}function Oh(r,t,o,u){return r-t*o/u}nt("Anchor",Ga);class Fh{constructor(t,o,u,m,g,x,S,P,A,R){if(this.boxStartIndex=t.length,A){let O=x.top,U=x.bottom;const j=x.collisionPadding;j&&(O-=j[1],U+=j[3]);let $=U-O;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{let O=x.top*S-P[0],U=x.bottom*S+P[2],j=x.left*S-P[3],$=x.right*S+P[1];const te=x.collisionPadding;if(te&&(j-=te[0]*S,O-=te[1]*S,$+=te[2]*S,U+=te[3]*S),R){const ee=new ut(j,O),_e=new ut($,O),Se=new ut(j,U),fe=new ut($,U),we=R*Math.PI/180;ee._rotate(we),_e._rotate(we),Se._rotate(we),fe._rotate(we),j=Math.min(ee.x,_e.x,Se.x,fe.x),$=Math.max(ee.x,_e.x,Se.x,fe.x),O=Math.min(ee.y,_e.y,Se.y,fe.y),U=Math.max(ee.y,_e.y,Se.y,fe.y)}t.emplaceBack(o.x,o.y,j,O,$,U,u,m,g)}this.boxEndIndex=t.length}}class ew{constructor(t=[],o=tw){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:u}=this,m=o[t];for(;t>0;){const g=t-1>>1,x=o[g];if(u(m,x)>=0)break;o[t]=x,t=g}o[t]=m}_down(t){const{data:o,compare:u}=this,m=this.length>>1,g=o[t];for(;t<m;){let x=1+(t<<1),S=o[x];const P=x+1;if(P<this.length&&u(o[P],S)<0&&(x=P,S=o[P]),u(S,g)>=0)break;o[t]=S,t=x}o[t]=g}}function tw(r,t){return r<t?-1:r>t?1:0}function iw(r,t=1,o=!1){let u=1/0,m=1/0,g=-1/0,x=-1/0;const S=r[0];for(let j=0;j<S.length;j++){const $=S[j];(!j||$.x<u)&&(u=$.x),(!j||$.y<m)&&(m=$.y),(!j||$.x>g)&&(g=$.x),(!j||$.y>x)&&(x=$.y)}const P=Math.min(g-u,x-m);let A=P/2;const R=new ew([],nw);if(P===0)return new ut(u,m);for(let j=u;j<g;j+=P)for(let $=m;$<x;$+=P)R.push(new wu(j+A,$+A,A,r));let O=function(j){let $=0,te=0,ee=0;const _e=j[0];for(let Se=0,fe=_e.length,we=fe-1;Se<fe;we=Se++){const Le=_e[Se],Me=_e[we],st=Le.x*Me.y-Me.x*Le.y;te+=(Le.x+Me.x)*st,ee+=(Le.y+Me.y)*st,$+=3*st}return new wu(te/$,ee/$,0,j)}(r),U=R.length;for(;R.length;){const j=R.pop();(j.d>O.d||!O.d)&&(O=j,o&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,U)),j.max-O.d<=t||(A=j.h/2,R.push(new wu(j.p.x-A,j.p.y-A,A,r)),R.push(new wu(j.p.x+A,j.p.y-A,A,r)),R.push(new wu(j.p.x-A,j.p.y+A,A,r)),R.push(new wu(j.p.x+A,j.p.y+A,A,r)),U+=4)}return o&&(console.log(`num probes: ${U}`),console.log(`best distance: ${O.d}`)),O.p}function nw(r,t){return t.max-r.max}function wu(r,t,o,u){this.p=new ut(r,t),this.h=o,this.d=function(m,g){let x=!1,S=1/0;for(let P=0;P<g.length;P++){const A=g[P];for(let R=0,O=A.length,U=O-1;R<O;U=R++){const j=A[R],$=A[U];j.y>m.y!=$.y>m.y&&m.x<($.x-j.x)*(m.y-j.y)/($.y-j.y)+j.x&&(x=!x),S=Math.min(S,D_(m,j,$))}}return(x?1:-1)*Math.sqrt(S)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}const Bp=Number.POSITIVE_INFINITY;function Cg(r,t){return t[1]!==Bp?function(o,u,m){let g=0,x=0;switch(u=Math.abs(u),m=Math.abs(m),o){case"top-right":case"top-left":case"top":x=m-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-m}switch(o){case"top-right":case"bottom-right":case"right":g=-u;break;case"top-left":case"bottom-left":case"left":g=u}return[g,x]}(r,t[0],t[1]):function(o,u){let m=0,g=0;u<0&&(u=0);const x=u/Math.sqrt(2);switch(o){case"top-right":case"top-left":g=x-7;break;case"bottom-right":case"bottom-left":g=7-x;break;case"bottom":g=7-u;break;case"top":g=u-7}switch(o){case"top-right":case"bottom-right":m=-x;break;case"top-left":case"bottom-left":m=x;break;case"left":m=u;break;case"right":m=-u}return[m,g]}(r,t[0])}function Op(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function rw(r,t,o,u,m,g,x,S,P,A,R){let O=g.textMaxSize.evaluate(t,{});O===void 0&&(O=x);const U=r.layers[0].layout,j=U.get("icon-offset").evaluate(t,{},R),$=kg(o.horizontal),te=x/24,ee=r.tilePixelRatio*te,_e=r.tilePixelRatio*O/24,Se=r.tilePixelRatio*S,fe=r.tilePixelRatio*U.get("symbol-spacing"),we=U.get("text-padding")*r.tilePixelRatio,Le=function(Ne,gt,ft,Ot=1){const Si=Ne.get("icon-padding").evaluate(gt,{},ft),Ci=Si&&Si.values;return[Ci[0]*Ot,Ci[1]*Ot,Ci[2]*Ot,Ci[3]*Ot]}(U,t,R,r.tilePixelRatio),Me=U.get("text-max-angle")/180*Math.PI,st=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point",ht=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",et=U.get("symbol-placement"),Je=fe/2,We=U.get("icon-text-fit");let tt;u&&We!=="none"&&(r.allowVerticalPlacement&&o.vertical&&(tt=gg(u,o.vertical,We,U.get("icon-text-fit-padding"),j,te)),$&&(u=gg(u,$,We,U.get("icon-text-fit-padding"),j,te)));const Qe=(Ne,gt)=>{gt.x<0||gt.x>=Qi||gt.y<0||gt.y>=Qi||function(ft,Ot,Si,Ci,en,io,In,Hi,un,kn,Un,hr,Xi,An,Vn,er,dr,pr,Ii,cn,Zt,Rr,zn,Zn,Io){const ns=ft.addToLineVertexArray(Ot,Si);let rs,aa,ko,no,fr=0,la=0,Tc=0,qg=0,Wp=-1,Hp=-1;const ua={};let $g=ln.exports(""),Xp=0,Kp=0;if(Hi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Xp,Kp]=Hi.layout.get("text-offset").evaluate(Zt,{},Zn).map(mr=>mr*vn):(Xp=Hi.layout.get("text-radial-offset").evaluate(Zt,{},Zn)*vn,Kp=Bp),ft.allowVerticalPlacement&&Ci.vertical){const mr=Hi.layout.get("text-rotate").evaluate(Zt,{},Zn)+90;ko=new Fh(un,Ot,kn,Un,hr,Ci.vertical,Xi,An,Vn,mr),In&&(no=new Fh(un,Ot,kn,Un,hr,In,dr,pr,Vn,mr))}if(en){const mr=Hi.layout.get("icon-rotate").evaluate(Zt,{}),Ps=Hi.layout.get("icon-text-fit")!=="none",Sc=Eg(en,mr,zn,Ps),Ec=In?Eg(In,mr,zn,Ps):void 0;aa=new Fh(un,Ot,kn,Un,hr,en,dr,pr,!1,mr),fr=4*Sc.length;const Xg=ft.iconSizeData;let Fl=null;Xg.kind==="source"?(Fl=[sa*Hi.layout.get("icon-size").evaluate(Zt,{})],Fl[0]>ja&&$e(`${ft.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Xg.kind==="composite"&&(Fl=[sa*Rr.compositeIconSizes[0].evaluate(Zt,{},Zn),sa*Rr.compositeIconSizes[1].evaluate(Zt,{},Zn)],(Fl[0]>ja||Fl[1]>ja)&&$e(`${ft.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ft.addSymbols(ft.icon,Sc,Fl,cn,Ii,Zt,c.WritingMode.none,Ot,ns.lineStartIndex,ns.lineLength,-1,Zn),Wp=ft.icon.placedSymbolArray.length-1,Ec&&(la=4*Ec.length,ft.addSymbols(ft.icon,Ec,Fl,cn,Ii,Zt,c.WritingMode.vertical,Ot,ns.lineStartIndex,ns.lineLength,-1,Zn),Hp=ft.icon.placedSymbolArray.length-1)}const Wg=Object.keys(Ci.horizontal);for(const mr of Wg){const Ps=Ci.horizontal[mr];if(!rs){$g=ln.exports(Ps.text);const Ec=Hi.layout.get("text-rotate").evaluate(Zt,{},Zn);rs=new Fh(un,Ot,kn,Un,hr,Ps,Xi,An,Vn,Ec)}const Sc=Ps.positionedLines.length===1;if(Tc+=Ig(ft,Ot,Ps,io,Hi,Vn,Zt,er,ns,Ci.vertical?c.WritingMode.horizontal:c.WritingMode.horizontalOnly,Sc?Wg:[mr],ua,Wp,Rr,Zn),Sc)break}Ci.vertical&&(qg+=Ig(ft,Ot,Ci.vertical,io,Hi,Vn,Zt,er,ns,c.WritingMode.vertical,["vertical"],ua,Hp,Rr,Zn));const gw=rs?rs.boxStartIndex:ft.collisionBoxArray.length,yw=rs?rs.boxEndIndex:ft.collisionBoxArray.length,vw=ko?ko.boxStartIndex:ft.collisionBoxArray.length,xw=ko?ko.boxEndIndex:ft.collisionBoxArray.length,ww=aa?aa.boxStartIndex:ft.collisionBoxArray.length,bw=aa?aa.boxEndIndex:ft.collisionBoxArray.length,Tw=no?no.boxStartIndex:ft.collisionBoxArray.length,Sw=no?no.boxEndIndex:ft.collisionBoxArray.length;let os=-1;const Gh=(mr,Ps)=>mr&&mr.circleDiameter?Math.max(mr.circleDiameter,Ps):Ps;os=Gh(rs,os),os=Gh(ko,os),os=Gh(aa,os),os=Gh(no,os);const Hg=os>-1?1:0;Hg&&(os*=Io/vn),ft.glyphOffsetArray.length>=bu.MAX_GLYPHS&&$e("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Zt.sortKey!==void 0&&ft.addToSortKeyRanges(ft.symbolInstances.length,Zt.sortKey),ft.symbolInstances.emplaceBack(Ot.x,Ot.y,ua.right>=0?ua.right:-1,ua.center>=0?ua.center:-1,ua.left>=0?ua.left:-1,ua.vertical||-1,Wp,Hp,$g,gw,yw,vw,xw,ww,bw,Tw,Sw,kn,Tc,qg,fr,la,Hg,0,Xi,Xp,Kp,os)}(r,gt,Ne,o,u,m,tt,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,ee,[we,we,we,we],st,P,Se,Le,ht,j,t,g,A,R,x)};if(et==="line")for(const Ne of Sg(t.geometry,0,0,Qi,Qi)){const gt=Q1(Ne,fe,Me,o.vertical||$,u,24,_e,r.overscaling,Qi);for(const ft of gt){const Ot=$;Ot&&ow(r,Ot.text,Je,ft)||Qe(Ne,ft)}}else if(et==="line-center"){for(const Ne of t.geometry)if(Ne.length>1){const gt=Y1(Ne,Me,o.vertical||$,u,24,_e);gt&&Qe(Ne,gt)}}else if(t.type==="Polygon")for(const Ne of Sp(t.geometry,0)){const gt=iw(Ne,16);Qe(Ne[0],new Ga(gt.x,gt.y,0))}else if(t.type==="LineString")for(const Ne of t.geometry)Qe(Ne,new Ga(Ne[0].x,Ne[0].y,0));else if(t.type==="Point")for(const Ne of t.geometry)for(const gt of Ne)Qe([gt],new Ga(gt.x,gt.y,0))}const ja=32640;function Ig(r,t,o,u,m,g,x,S,P,A,R,O,U,j,$){const te=function(Se,fe,we,Le,Me,st,ht,et){const Je=Le.layout.get("text-rotate").evaluate(st,{})*Math.PI/180,We=[];for(const tt of fe.positionedLines)for(const Qe of tt.positionedGlyphs){if(!Qe.rect)continue;const Ne=Qe.rect||{};let gt=4,ft=!0,Ot=1,Si=0;const Ci=(Me||et)&&Qe.vertical,en=Qe.metrics.advance*Qe.scale/2;if(et&&fe.verticalizable){const Ii=(Qe.scale-1)*vn,cn=(vn-Qe.metrics.width*Qe.scale)/2;Si=tt.lineOffset/2-(Qe.imageName?-cn:Ii)}if(Qe.imageName){const Ii=ht[Qe.imageName];ft=Ii.sdf,Ot=Ii.pixelRatio,gt=1/Ot}const io=Me?[Qe.x+en,Qe.y]:[0,0];let In=Me?[0,0]:[Qe.x+en+we[0],Qe.y+we[1]-Si],Hi=[0,0];Ci&&(Hi=In,In=[0,0]);const un=(Qe.metrics.left-gt)*Qe.scale-en+In[0],kn=(-Qe.metrics.top-gt)*Qe.scale+In[1],Un=un+Ne.w*Qe.scale/Ot,hr=kn+Ne.h*Qe.scale/Ot,Xi=new ut(un,kn),An=new ut(Un,kn),Vn=new ut(un,hr),er=new ut(Un,hr);if(Ci){const Ii=new ut(-en,en-Mh),cn=-Math.PI/2,Zt=12-en,Rr=new ut(22-Zt,-(Qe.imageName?Zt:0)),zn=new ut(...Hi);Xi._rotateAround(cn,Ii)._add(Rr)._add(zn),An._rotateAround(cn,Ii)._add(Rr)._add(zn),Vn._rotateAround(cn,Ii)._add(Rr)._add(zn),er._rotateAround(cn,Ii)._add(Rr)._add(zn)}if(Je){const Ii=Math.sin(Je),cn=Math.cos(Je),Zt=[cn,-Ii,Ii,cn];Xi._matMult(Zt),An._matMult(Zt),Vn._matMult(Zt),er._matMult(Zt)}const dr=new ut(0,0),pr=new ut(0,0);We.push({tl:Xi,tr:An,bl:Vn,br:er,tex:Ne,writingMode:fe.writingMode,glyphOffset:io,sectionIndex:Qe.sectionIndex,isSDF:ft,pixelOffsetTL:dr,pixelOffsetBR:pr,minFontScaleX:0,minFontScaleY:0})}return We}(0,o,S,m,g,x,u,r.allowVerticalPlacement),ee=r.textSizeData;let _e=null;ee.kind==="source"?(_e=[sa*m.layout.get("text-size").evaluate(x,{})],_e[0]>ja&&$e(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):ee.kind==="composite"&&(_e=[sa*j.compositeTextSizes[0].evaluate(x,{},$),sa*j.compositeTextSizes[1].evaluate(x,{},$)],(_e[0]>ja||_e[1]>ja)&&$e(`${r.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),r.addSymbols(r.text,te,_e,S,g,x,A,t,P.lineStartIndex,P.lineLength,U,$);for(const Se of R)O[Se]=r.text.placedSymbolArray.length-1;return 4*te.length}function kg(r){for(const t in r)return r[t];return null}function ow(r,t,o,u){const m=r.compareText;if(t in m){const g=m[t];for(let x=g.length-1;x>=0;x--)if(u.dist(g[x])<o)return!0}else m[t]=[];return m[t].push(u),!1}const sw=Va.VectorTileFeature.types,aw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Nh(r,t,o,u,m,g,x,S,P,A,R,O,U){const j=S?Math.min(ja,Math.round(S[0])):0,$=S?Math.min(ja,Math.round(S[1])):0;r.emplaceBack(t,o,Math.round(32*u),Math.round(32*m),g,x,(j<<1)+(P?1:0),$,16*A,16*R,256*O,256*U)}function Fp(r,t,o){r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o)}function lw(r){for(const t of r.sections)if(cu(t.text))return!0;return!1}class Np{constructor(t){this.layoutVertexArray=new Po,this.indexArray=new Jn,this.programConfigurations=t,this.segments=new Nt,this.dynamicLayoutVertexArray=new Qr,this.opacityVertexArray=new Co,this.placedSymbolArray=new Fe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,o,u,m){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,z1.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,M1.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,aw,!0),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}nt("SymbolBuffers",Np);class Up{constructor(t,o,u){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new u,this.segments=new Nt,this.collisionVertexArray=new Lr}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,L1.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}nt("CollisionBuffers",Up);class bu{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(x=>x.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=yp([]),this.placementViewportMatrix=yp([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yg(this.zoom,o["text-size"]),this.iconSizeData=yg(this.zoom,o["icon-size"]);const u=this.layers[0].layout,m=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=Zp(u,"text-overlap","text-allow-overlap")!=="never"||Zp(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&!m.isConstant(),this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(x=>c.WritingMode[x])),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=t.sourceID}createArrays(){this.text=new Np(new Ll(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Np(new Ll(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Ke,this.lineVertexArray=new ot,this.symbolInstances=new it}calculateGlyphDependencies(t,o,u,m,g){for(let x=0;x<t.length;x++)if(o[t.charCodeAt(x)]=!0,(u||m)&&g){const S=vc[t.charAt(x)];S&&(o[S.charCodeAt(0)]=!0)}}populate(t,o,u){const m=this.layers[0],g=m.layout,x=g.get("text-font"),S=g.get("text-field"),P=g.get("icon-image"),A=(S.value.kind!=="constant"||S.value.value instanceof se&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&(x.value.kind!=="constant"||x.value.value.length>0),R=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,O=g.get("symbol-sort-key");if(this.features=[],!A&&!R)return;const U=o.iconDependencies,j=o.glyphDependencies,$=o.availableImages,te=new xi(this.zoom);for(const{feature:ee,id:_e,index:Se,sourceLayerIndex:fe}of t){const we=m._featureFilter.needGeometry,Le=Rl(ee,we);if(!m._featureFilter.filter(te,Le,u))continue;let Me,st;if(we||(Le.geometry=Dl(ee)),A){const et=m.getValueAndResolveTokens("text-field",Le,u,$),Je=se.factory(et);lw(Je)&&(this.hasRTLText=!0),(!this.hasRTLText||Ts()==="unavailable"||this.hasRTLText&&Nn.isParsed())&&(Me=R1(Je,m,Le))}if(R){const et=m.getValueAndResolveTokens("icon-image",Le,u,$);st=et instanceof de?et:de.fromString(et)}if(!Me&&!st)continue;const ht=this.sortFeaturesByKey?O.evaluate(Le,{},u):void 0;if(this.features.push({id:_e,text:Me,icon:st,index:Se,sourceLayerIndex:fe,geometry:Le.geometry,properties:ee.properties,type:sw[ee.type],sortKey:ht}),st&&(U[st.name]=!0),Me){const et=x.evaluate(Le,{},u).join(","),Je=g.get("text-rotation-alignment")!=="viewport"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(c.WritingMode.vertical)>=0;for(const We of Me.sections)if(We.image)U[We.image.name]=!0;else{const tt=Js(Me.toString()),Qe=We.fontStack||et,Ne=j[Qe]=j[Qe]||{};this.calculateGlyphDependencies(We.text,Ne,Je,this.allowVerticalPlacement,tt)}}}g.get("symbol-placement")==="line"&&(this.features=function(ee){const _e={},Se={},fe=[];let we=0;function Le(et){fe.push(ee[et]),we++}function Me(et,Je,We){const tt=Se[et];return delete Se[et],Se[Je]=tt,fe[tt].geometry[0].pop(),fe[tt].geometry[0]=fe[tt].geometry[0].concat(We[0]),tt}function st(et,Je,We){const tt=_e[Je];return delete _e[Je],_e[et]=tt,fe[tt].geometry[0].shift(),fe[tt].geometry[0]=We[0].concat(fe[tt].geometry[0]),tt}function ht(et,Je,We){const tt=We?Je[0][Je[0].length-1]:Je[0][0];return`${et}:${tt.x}:${tt.y}`}for(let et=0;et<ee.length;et++){const Je=ee[et],We=Je.geometry,tt=Je.text?Je.text.toString():null;if(!tt){Le(et);continue}const Qe=ht(tt,We),Ne=ht(tt,We,!0);if(Qe in Se&&Ne in _e&&Se[Qe]!==_e[Ne]){const gt=st(Qe,Ne,We),ft=Me(Qe,Ne,fe[gt].geometry);delete _e[Qe],delete Se[Ne],Se[ht(tt,fe[ft].geometry,!0)]=ft,fe[gt].geometry=null}else Qe in Se?Me(Qe,Ne,We):Ne in _e?st(Qe,Ne,We):(Le(et),_e[Qe]=we-1,Se[Ne]=we-1)}return fe.filter(et=>et.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ee,_e)=>ee.sortKey-_e.sortKey)}update(t,o,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const u=this.lineVertexArray.length;if(t.segment!==void 0){let m=t.dist(o[t.segment+1]),g=t.dist(o[t.segment]);const x={};for(let S=t.segment+1;S<o.length;S++)x[S]={x:o[S].x,y:o[S].y,tileUnitDistanceFromAnchor:m},S<o.length-1&&(m+=o[S+1].dist(o[S]));for(let S=t.segment||0;S>=0;S--)x[S]={x:o[S].x,y:o[S].y,tileUnitDistanceFromAnchor:g},S>0&&(g+=o[S-1].dist(o[S]));for(let S=0;S<o.length;S++){const P=x[S];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(t,o,u,m,g,x,S,P,A,R,O,U){const j=t.indexArray,$=t.layoutVertexArray,te=t.segments.prepareSegment(4*o.length,$,j,this.canOverlap?x.sortKey:void 0),ee=this.glyphOffsetArray.length,_e=te.vertexLength,Se=this.allowVerticalPlacement&&S===c.WritingMode.vertical?Math.PI/2:0,fe=x.text&&x.text.sections;for(let we=0;we<o.length;we++){const{tl:Le,tr:Me,bl:st,br:ht,tex:et,pixelOffsetTL:Je,pixelOffsetBR:We,minFontScaleX:tt,minFontScaleY:Qe,glyphOffset:Ne,isSDF:gt,sectionIndex:ft}=o[we],Ot=te.vertexLength,Si=Ne[1];Nh($,P.x,P.y,Le.x,Si+Le.y,et.x,et.y,u,gt,Je.x,Je.y,tt,Qe),Nh($,P.x,P.y,Me.x,Si+Me.y,et.x+et.w,et.y,u,gt,We.x,Je.y,tt,Qe),Nh($,P.x,P.y,st.x,Si+st.y,et.x,et.y+et.h,u,gt,Je.x,We.y,tt,Qe),Nh($,P.x,P.y,ht.x,Si+ht.y,et.x+et.w,et.y+et.h,u,gt,We.x,We.y,tt,Qe),Fp(t.dynamicLayoutVertexArray,P,Se),j.emplaceBack(Ot,Ot+1,Ot+2),j.emplaceBack(Ot+1,Ot+2,Ot+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ne[0]),we!==o.length-1&&ft===o[we+1].sectionIndex||t.programConfigurations.populatePaintArrays($.length,x,x.index,{},U,fe&&fe[ft])}t.placedSymbolArray.emplaceBack(P.x,P.y,ee,this.glyphOffsetArray.length-ee,_e,A,R,P.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],S,0,!1,0,O)}_addCollisionDebugVertex(t,o,u,m,g,x){return o.emplaceBack(0,0),t.emplaceBack(u.x,u.y,m,g,Math.round(x.x),Math.round(x.y))}addCollisionDebugVertices(t,o,u,m,g,x,S){const P=g.segments.prepareSegment(4,g.layoutVertexArray,g.indexArray),A=P.vertexLength,R=g.layoutVertexArray,O=g.collisionVertexArray,U=S.anchorX,j=S.anchorY;this._addCollisionDebugVertex(R,O,x,U,j,new ut(t,o)),this._addCollisionDebugVertex(R,O,x,U,j,new ut(u,o)),this._addCollisionDebugVertex(R,O,x,U,j,new ut(u,m)),this._addCollisionDebugVertex(R,O,x,U,j,new ut(t,m)),P.vertexLength+=4;const $=g.indexArray;$.emplaceBack(A,A+1),$.emplaceBack(A+1,A+2),$.emplaceBack(A+2,A+3),$.emplaceBack(A+3,A),P.primitiveLength+=4}addDebugCollisionBoxes(t,o,u,m){for(let g=t;g<o;g++){const x=this.collisionBoxArray.get(g);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,m?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Up(Ss,rg.members,ts),this.iconCollisionBox=new Up(Ss,rg.members,ts);for(let t=0;t<this.symbolInstances.length;t++){const o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(t,o,u,m,g,x,S,P,A){const R={};for(let O=o;O<u;O++){const U=t.get(O);R.textBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},R.textFeatureIndex=U.featureIndex;break}for(let O=m;O<g;O++){const U=t.get(O);R.verticalTextBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},R.verticalTextFeatureIndex=U.featureIndex;break}for(let O=x;O<S;O++){const U=t.get(O);R.iconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},R.iconFeatureIndex=U.featureIndex;break}for(let O=P;O<A;O++){const U=t.get(O);R.verticalIconBox={x1:U.x1,y1:U.y1,x2:U.x2,y2:U.y2,anchorPointX:U.anchorPointX,anchorPointY:U.anchorPointY},R.verticalIconFeatureIndex=U.featureIndex;break}return R}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,o){const u=t.placedSymbolArray.get(o),m=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<m;g+=4)t.indexArray.emplaceBack(g,g+1,g+2),t.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),u=Math.cos(t),m=[],g=[],x=[];for(let S=0;S<this.symbolInstances.length;++S){x.push(S);const P=this.symbolInstances.get(S);m.push(0|Math.round(o*P.anchorX+u*P.anchorY)),g.push(P.featureIndex)}return x.sort((S,P)=>m[S]-m[P]||g[P]-g[S]),x}addToSortKeyRanges(t,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((m,g,x)=>{m>=0&&x.indexOf(m)===g&&this.addIndicesForPlacedSymbol(this.text,m)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}nt("SymbolBucket",bu,{omit:["layers","collisionBoxArray","features","compareText"]}),bu.MAX_GLYPHS=65535,bu.addDynamicAttributes=Fp;const uw=new bt({"symbol-placement":new oe(ke.layout_symbol["symbol-placement"]),"symbol-spacing":new oe(ke.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new oe(ke.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new he(ke.layout_symbol["symbol-sort-key"]),"symbol-z-order":new oe(ke.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new oe(ke.layout_symbol["icon-allow-overlap"]),"icon-overlap":new oe(ke.layout_symbol["icon-overlap"]),"icon-ignore-placement":new oe(ke.layout_symbol["icon-ignore-placement"]),"icon-optional":new oe(ke.layout_symbol["icon-optional"]),"icon-rotation-alignment":new oe(ke.layout_symbol["icon-rotation-alignment"]),"icon-size":new he(ke.layout_symbol["icon-size"]),"icon-text-fit":new oe(ke.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new oe(ke.layout_symbol["icon-text-fit-padding"]),"icon-image":new he(ke.layout_symbol["icon-image"]),"icon-rotate":new he(ke.layout_symbol["icon-rotate"]),"icon-padding":new he(ke.layout_symbol["icon-padding"]),"icon-keep-upright":new oe(ke.layout_symbol["icon-keep-upright"]),"icon-offset":new he(ke.layout_symbol["icon-offset"]),"icon-anchor":new he(ke.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new oe(ke.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new oe(ke.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new oe(ke.layout_symbol["text-rotation-alignment"]),"text-field":new he(ke.layout_symbol["text-field"]),"text-font":new he(ke.layout_symbol["text-font"]),"text-size":new he(ke.layout_symbol["text-size"]),"text-max-width":new he(ke.layout_symbol["text-max-width"]),"text-line-height":new oe(ke.layout_symbol["text-line-height"]),"text-letter-spacing":new he(ke.layout_symbol["text-letter-spacing"]),"text-justify":new he(ke.layout_symbol["text-justify"]),"text-radial-offset":new he(ke.layout_symbol["text-radial-offset"]),"text-variable-anchor":new oe(ke.layout_symbol["text-variable-anchor"]),"text-anchor":new he(ke.layout_symbol["text-anchor"]),"text-max-angle":new oe(ke.layout_symbol["text-max-angle"]),"text-writing-mode":new oe(ke.layout_symbol["text-writing-mode"]),"text-rotate":new he(ke.layout_symbol["text-rotate"]),"text-padding":new oe(ke.layout_symbol["text-padding"]),"text-keep-upright":new oe(ke.layout_symbol["text-keep-upright"]),"text-transform":new he(ke.layout_symbol["text-transform"]),"text-offset":new he(ke.layout_symbol["text-offset"]),"text-allow-overlap":new oe(ke.layout_symbol["text-allow-overlap"]),"text-overlap":new oe(ke.layout_symbol["text-overlap"]),"text-ignore-placement":new oe(ke.layout_symbol["text-ignore-placement"]),"text-optional":new oe(ke.layout_symbol["text-optional"])});var Vp={paint:new bt({"icon-opacity":new he(ke.paint_symbol["icon-opacity"]),"icon-color":new he(ke.paint_symbol["icon-color"]),"icon-halo-color":new he(ke.paint_symbol["icon-halo-color"]),"icon-halo-width":new he(ke.paint_symbol["icon-halo-width"]),"icon-halo-blur":new he(ke.paint_symbol["icon-halo-blur"]),"icon-translate":new oe(ke.paint_symbol["icon-translate"]),"icon-translate-anchor":new oe(ke.paint_symbol["icon-translate-anchor"]),"text-opacity":new he(ke.paint_symbol["text-opacity"]),"text-color":new he(ke.paint_symbol["text-color"],{runtimeType:$i,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new he(ke.paint_symbol["text-halo-color"]),"text-halo-width":new he(ke.paint_symbol["text-halo-width"]),"text-halo-blur":new he(ke.paint_symbol["text-halo-blur"]),"text-translate":new oe(ke.paint_symbol["text-translate"]),"text-translate-anchor":new oe(ke.paint_symbol["text-translate-anchor"])}),layout:uw};class Ag{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:_o,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}nt("FormatSectionOverride",Ag,{omit:["defaultValue"]});class Uh extends on{constructor(t){super(t,Vp)}recalculate(t,o){if(super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const m=[];for(const g of u)m.indexOf(g)<0&&m.push(g);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,o,u,m){const g=this.layout.get(t).evaluate(o,{},u,m),x=this._unevaluatedLayout._values[t];return x.isDataDriven()||qo(x.value)||!g?g:function(S,P){return P.replace(/{([^{}]+)}/g,(A,R)=>R in S?String(S[R]):"")}(o.properties,g)}createBucket(t){return new bu(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Vp.paint.overridableProperties){if(!Uh.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),u=new Ag(o),m=new xs(u,o.property.specification);let g=null;g=o.value.kind==="constant"||o.value.kind==="source"?new js("source",m):new ka("composite",m,o.value.zoomStops),this.paint._values[t]=new V(o.property,g,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&Uh.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const u=t.get("text-field"),m=Vp.paint.properties[o];let g=!1;const x=S=>{for(const P of S)if(m.overrides&&m.overrides.hasOverride(P))return void(g=!0)};if(u.value.kind==="constant"&&u.value.value instanceof se)x(u.value.value.sections);else if(u.value.kind==="source"){const S=A=>{g||(A instanceof ct&&Ee(A.value)===Wi?x(A.value.sections):A instanceof Pa?x(A.sections):A.eachChild(S))},P=u.value;P._styleExpression&&S(P._styleExpression.expression)}return g}}function Zp(r,t,o){let u="never";const m=r.get(t);return m?u=m:r.get(o)&&(u="always"),u}var cw={paint:new bt({"background-color":new oe(ke.paint_background["background-color"]),"background-pattern":new rt(ke.paint_background["background-pattern"]),"background-opacity":new oe(ke.paint_background["background-opacity"])})},hw={paint:new bt({"raster-opacity":new oe(ke.paint_raster["raster-opacity"]),"raster-hue-rotate":new oe(ke.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new oe(ke.paint_raster["raster-brightness-min"]),"raster-brightness-max":new oe(ke.paint_raster["raster-brightness-max"]),"raster-saturation":new oe(ke.paint_raster["raster-saturation"]),"raster-contrast":new oe(ke.paint_raster["raster-contrast"]),"raster-resampling":new oe(ke.paint_raster["raster-resampling"]),"raster-fade-duration":new oe(ke.paint_raster["raster-fade-duration"])})};class dw extends on{constructor(t){super(t,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const pw={circle:class extends on{constructor(r){super(r,j0)}createBucket(r){return new mp(r)}queryRadius(r){const t=r;return cc("circle-radius",this,t)+cc("circle-stroke-width",this,t)+Th(this.paint.get("circle-translate"))}queryIntersectsFeature(r,t,o,u,m,g,x,S){const P=Sh(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,x),A=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o),R=this.paint.get("circle-pitch-alignment")==="map",O=R?P:function(j,$){return j.map(te=>V_(te,$))}(P,S),U=R?A*x:A;for(const j of u)for(const $ of j){const te=R?$:V_($,S);let ee=U;const _e=Eh([],[$.x,$.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ee*=_e[3]/g.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ee*=g.cameraToCenterDistance/_e[3]),N0(O,te,ee))return!0}return!1}},heatmap:class extends on{constructor(r){super(r,$0),this._updateColorRamp()}createBucket(r){return new Z_(r)}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=j_({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends on{constructor(r){super(r,W0)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends on{constructor(r){super(r,u1)}recalculate(r,t){super.recalculate(r,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Cp(r)}queryRadius(){return Th(this.paint.get("fill-translate"))}queryIntersectsFeature(r,t,o,u,m,g,x){return L_(Sh(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,x),u)}isTileClipped(){return!0}},"fill-extrusion":class extends on{constructor(r){super(r,T1)}createBucket(r){return new kp(r)}queryRadius(){return Th(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,t,o,u,m,g,x,S){const P=Sh(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,x),A=this.paint.get("fill-extrusion-height").evaluate(t,o),R=this.paint.get("fill-extrusion-base").evaluate(t,o),O=function(j,$,te,ee){const _e=[];for(const Se of j){const fe=[Se.x,Se.y,0,1];Eh(fe,fe,$),_e.push(new ut(fe[0]/fe[3],fe[1]/fe[3]))}return _e}(P,S),U=function(j,$,te,ee){const _e=[],Se=[],fe=ee[8]*$,we=ee[9]*$,Le=ee[10]*$,Me=ee[11]*$,st=ee[8]*te,ht=ee[9]*te,et=ee[10]*te,Je=ee[11]*te;for(const We of j){const tt=[],Qe=[];for(const Ne of We){const gt=Ne.x,ft=Ne.y,Ot=ee[0]*gt+ee[4]*ft+ee[12],Si=ee[1]*gt+ee[5]*ft+ee[13],Ci=ee[2]*gt+ee[6]*ft+ee[14],en=ee[3]*gt+ee[7]*ft+ee[15],io=Ci+Le,In=en+Me,Hi=Ot+st,un=Si+ht,kn=Ci+et,Un=en+Je,hr=new ut((Ot+fe)/In,(Si+we)/In);hr.z=io/In,tt.push(hr);const Xi=new ut(Hi/Un,un/Un);Xi.z=kn/Un,Qe.push(Xi)}_e.push(tt),Se.push(Qe)}return[_e,Se]}(u,R,A,S);return function(j,$,te){let ee=1/0;L_(te,$)&&(ee=Q_(te,$[0]));for(let _e=0;_e<$.length;_e++){const Se=$[_e],fe=j[_e];for(let we=0;we<Se.length-1;we++){const Le=Se[we],Me=[Le,Se[we+1],fe[we+1],fe[we],Le];M_(te,Me)&&(ee=Math.min(ee,Q_(te,Me)))}}return ee!==1/0&&ee}(U[0],U[1],O)}},line:class extends on{constructor(r){super(r,tg),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof bo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,t){super.recalculate(r,t),this.paint._values["line-floorwidth"]=ig.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Ap(r)}queryRadius(r){const t=r,o=ng(cc("line-width",this,t),cc("line-gap-width",this,t)),u=cc("line-offset",this,t);return o/2+Math.abs(u)+Th(this.paint.get("line-translate"))}queryIntersectsFeature(r,t,o,u,m,g,x){const S=Sh(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,x),P=x/2*ng(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),A=this.paint.get("line-offset").evaluate(t,o);return A&&(u=function(R,O){const U=[];for(let j=0;j<R.length;j++){const $=R[j],te=[];for(let ee=0;ee<$.length;ee++){const _e=$[ee-1],Se=$[ee],fe=$[ee+1],we=ee===0?new ut(0,0):Se.sub(_e)._unit()._perp(),Le=ee===$.length-1?new ut(0,0):fe.sub(Se)._unit()._perp(),Me=we._add(Le)._unit(),st=Me.x*Le.x+Me.y*Le.y;st!==0&&Me._mult(1/st),te.push(Me._mult(O)._add(Se))}U.push(te)}return U}(u,A*x)),function(R,O,U){for(let j=0;j<O.length;j++){const $=O[j];if(R.length>=3){for(let te=0;te<$.length;te++)if(mu(R,$[te]))return!0}if(U0(R,$,U))return!0}return!1}(S,u,P)}isTileClipped(){return!0}},symbol:Uh,background:class extends on{constructor(r){super(r,cw)}},raster:class extends on{constructor(r){super(r,hw)}}};class fw{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const zg=63710088e-1;class Oi{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Oi(Ze(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,u=this.lat*o,m=t.lat*o,g=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((t.lng-this.lng)*o);return zg*Math.acos(Math.min(g,1))}toBounds(t=0){const o=360*t/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new Ol(new Oi(this.lng-u,this.lat-o),new Oi(this.lng+u,this.lat+o))}static convert(t){if(t instanceof Oi)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Oi(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Oi(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Ol{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Oi?new Oi(t.lng,t.lat):Oi.convert(t),this}setSouthWest(t){return this._sw=t instanceof Oi?new Oi(t.lng,t.lat):Oi.convert(t),this}extend(t){const o=this._sw,u=this._ne;let m,g;if(t instanceof Oi)m=t,g=t;else{if(!(t instanceof Ol))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ol.convert(t)):this.extend(Oi.convert(t)):this;if(m=t._sw,g=t._ne,!m||!g)return this}return o||u?(o.lng=Math.min(m.lng,o.lng),o.lat=Math.min(m.lat,o.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new Oi(m.lng,m.lat),this._ne=new Oi(g.lng,g.lat)),this}getCenter(){return new Oi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Oi(this.getWest(),this.getNorth())}getSouthEast(){return new Oi(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:u}=Oi.convert(t);let m=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&m}static convert(t){return t instanceof Ol?t:t&&new Ol(t)}}const Mg=2*Math.PI*zg;function Lg(r){return Mg*Math.cos(r*Math.PI/180)}function Dg(r){return(180+r)/360}function Rg(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Bg(r,t){return r/Lg(t)}function Gp(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Vh{constructor(t,o,u=0){this.x=+t,this.y=+o,this.z=+u}static fromLngLat(t,o=0){const u=Oi.convert(t);return new Vh(Dg(u.lng),Rg(u.lat),Bg(o,u.lat))}toLngLat(){return new Oi(360*this.x-180,Gp(this.y))}toAltitude(){return this.z*Lg(Gp(this.y))}meterInMercatorCoordinateUnits(){return 1/Mg*(t=Gp(this.y),1/Math.cos(t*Math.PI/180));var t}}function Og(r,t,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[r*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}class jp{constructor(t,o,u){if(t<0||t>25||u<0||u>=Math.pow(2,t)||o<0||o>=Math.pow(2,t))throw new Error(`x=${o}, y=${u}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=o,this.y=u,this.key=wc(0,t,t,o,u)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o,u){const m=(x=this.y,S=this.z,P=Og(256*(g=this.x),256*(x=Math.pow(2,S)-x-1),S),A=Og(256*(g+1),256*(x+1),S),P[0]+","+P[1]+","+A[0]+","+A[1]);var g,x,S,P,A;const R=function(O,U,j){let $,te="";for(let ee=O;ee>0;ee--)$=1<<ee-1,te+=(U&$?1:0)+(j&$?2:0);return te}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,R).replace(/{bbox-epsg-3857}/g,m)}isChildOf(t){const o=this.z-t.z;return o>0&&t.x===this.x>>o&&t.y===this.y>>o}getTilePoint(t){const o=Math.pow(2,this.z);return new ut((t.x*o-this.x)*Qi,(t.y*o-this.y)*Qi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Fg{constructor(t,o){this.wrap=t,this.canonical=o,this.key=wc(t,o.z,o.z,o.x,o.y)}}class to{constructor(t,o,u,m,g){if(t<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${u}`);this.overscaledZ=t,this.wrap=o,this.canonical=new jp(u,+m,+g),this.key=wc(o,t,u,m,g)}clone(){return new to(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?new to(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new to(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-t;return t>this.canonical.z?wc(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):wc(this.wrap*+o,t,t,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new to(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new to(o,this.wrap,o,u,m),new to(o,this.wrap,o,u+1,m),new to(o,this.wrap,o,u,m+1),new to(o,this.wrap,o,u+1,m+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new to(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new to(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Fg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Vh(t.x-this.wrap,t.y))}}function wc(r,t,o,u,m){(r*=2)<0&&(r=-1*r-1);const g=1<<o;return(g*g*r+g*m+u).toString(36)+o.toString(36)+t.toString(36)}nt("CanonicalTileID",jp),nt("OverscaledTileID",to,{omit:["posMatrix"]});class Ng{constructor(t,o,u){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void $e(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const m=this.dim=o.height-2;this.data=new Uint32Array(o.data.buffer),this.encoding=u||"mapbox";for(let g=0;g<m;g++)this.data[this._idx(-1,g)]=this.data[this._idx(0,g)],this.data[this._idx(m,g)]=this.data[this._idx(m-1,g)],this.data[this._idx(g,-1)]=this.data[this._idx(g,0)],this.data[this._idx(g,m)]=this.data[this._idx(g,m-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(m,-1)]=this.data[this._idx(m-1,0)],this.data[this._idx(-1,m)]=this.data[this._idx(0,m-1)],this.data[this._idx(m,m)]=this.data[this._idx(m-1,m-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let g=0;g<m;g++)for(let x=0;x<m;x++){const S=this.get(g,x);S>this.max&&(this.max=S),S<this.min&&(this.min=S)}}get(t,o){const u=new Uint8Array(this.data.buffer),m=4*this._idx(t,o);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(u[m],u[m+1],u[m+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}_unpackMapbox(t,o,u){return(256*t*256+256*o+u)/10-1e4}_unpackTerrarium(t,o,u){return 256*t+o+u/256-32768}getPixels(){return new eo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,o,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let m=o*this.dim,g=o*this.dim+this.dim,x=u*this.dim,S=u*this.dim+this.dim;switch(o){case-1:m=g-1;break;case 1:g=m+1}switch(u){case-1:x=S-1;break;case 1:S=x+1}const P=-o*this.dim,A=-u*this.dim;for(let R=x;R<S;R++)for(let O=m;O<g;O++)this.data[this._idx(O,R)]=t.data[this._idx(O+P,R+A)]}}nt("DEMData",Ng);class Ug{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const u=t[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Vg{constructor(t,o,u,m,g){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=u,t._y=m,this.properties=t.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t}}class Zg{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ks(Qi,16,0),this.grid3D=new Ks(Qi,16,0),this.featureIndexArray=new Bt,this.promoteId=o}insert(t,o,u,m,g,x){const S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,g);const P=x?this.grid3D:this.grid;for(let A=0;A<o.length;A++){const R=o[A],O=[1/0,1/0,-1/0,-1/0];for(let U=0;U<R.length;U++){const j=R[U];O[0]=Math.min(O[0],j.x),O[1]=Math.min(O[1],j.y),O[2]=Math.max(O[2],j.x),O[3]=Math.max(O[3],j.y)}O[0]<Qi&&O[1]<Qi&&O[2]>=0&&O[3]>=0&&P.insert(S,O[0],O[1],O[2],O[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Va.VectorTile(new zp(this.rawTileData)).layers,this.sourceLayerCoder=new Ug(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,o,u,m){this.loadVTLayers();const g=t.params||{},x=Qi/t.tileSize/t.scale,S=za(g.filter),P=t.queryGeometry,A=t.queryPadding*x,R=jg(P),O=this.grid.query(R.minX-A,R.minY-A,R.maxX+A,R.maxY+A),U=jg(t.cameraQueryGeometry),j=this.grid3D.query(U.minX-A,U.minY-A,U.maxX+A,U.maxY+A,(ee,_e,Se,fe)=>function(we,Le,Me,st,ht){for(const Je of we)if(Le<=Je.x&&Me<=Je.y&&st>=Je.x&&ht>=Je.y)return!0;const et=[new ut(Le,Me),new ut(Le,ht),new ut(st,ht),new ut(st,Me)];if(we.length>2){for(const Je of et)if(mu(we,Je))return!0}for(let Je=0;Je<we.length-1;Je++)if(Z0(we[Je],we[Je+1],et))return!0;return!1}(t.cameraQueryGeometry,ee-A,_e-A,Se+A,fe+A));for(const ee of j)O.push(ee);O.sort(mw);const $={};let te;for(let ee=0;ee<O.length;ee++){const _e=O[ee];if(_e===te)continue;te=_e;const Se=this.featureIndexArray.get(_e);let fe=null;this.loadMatchingFeature($,Se.bucketIndex,Se.sourceLayerIndex,Se.featureIndex,S,g.layers,g.availableImages,o,u,m,(we,Le,Me)=>(fe||(fe=Dl(we)),Le.queryIntersectsFeature(P,we,Me,fe,this.z,t.transform,x,t.pixelPosMatrix)))}return $}loadMatchingFeature(t,o,u,m,g,x,S,P,A,R,O){const U=this.bucketLayerIDs[o];if(x&&!function(ee,_e){for(let Se=0;Se<ee.length;Se++)if(_e.indexOf(ee[Se])>=0)return!0;return!1}(x,U))return;const j=this.sourceLayerCoder.decode(u),$=this.vtLayers[j].feature(m);if(g.needGeometry){const ee=Rl($,!0);if(!g.filter(new xi(this.tileID.overscaledZ),ee,this.tileID.canonical))return}else if(!g.filter(new xi(this.tileID.overscaledZ),$))return;const te=this.getId($,j);for(let ee=0;ee<U.length;ee++){const _e=U[ee];if(x&&x.indexOf(_e)<0)continue;const Se=P[_e];if(!Se)continue;let fe={};te&&R&&(fe=R.getState(Se.sourceLayer||"_geojsonTileLayer",te));const we=Ve({},A[_e]);we.paint=Gg(we.paint,Se.paint,$,fe,S),we.layout=Gg(we.layout,Se.layout,$,fe,S);const Le=!O||O($,Se,fe);if(!Le)continue;const Me=new Vg($,this.z,this.x,this.y,te);Me.layer=we;let st=t[_e];st===void 0&&(st=t[_e]=[]),st.push({featureIndex:m,feature:Me,intersectionZ:Le})}}lookupSymbolFeatures(t,o,u,m,g,x,S,P){const A={};this.loadVTLayers();const R=za(g);for(const O of t)this.loadMatchingFeature(A,u,m,O,R,x,S,P,o);return A}hasLayer(t){for(const o of this.bucketLayerIDs)for(const u of o)if(t===u)return!0;return!1}getId(t,o){let u=t.id;return this.promoteId&&(u=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof u=="boolean"&&(u=Number(u))),u}}function Gg(r,t,o,u,m){return ye(r,(g,x)=>{const S=t instanceof re?t.get(x):null;return S&&S.evaluate?S.evaluate(o,u,m):S})}function jg(r){let t=1/0,o=1/0,u=-1/0,m=-1/0;for(const g of r)t=Math.min(t,g.x),o=Math.min(o,g.y),u=Math.max(u,g.x),m=Math.max(m,g.y);return{minX:t,minY:o,maxX:u,maxY:m}}function mw(r,t){return t-r}var qp;nt("FeatureIndex",Zg,{omit:["rawTileData","sourceLayerCoder"]}),c.PerformanceMarkers=void 0,(qp=c.PerformanceMarkers||(c.PerformanceMarkers={})).create="create",qp.load="load",qp.fullLoad="fullLoad";let Zh=null,bc=[];const $p=1e3/30,_w={mark(r){performance.mark(r)},frame(r){const t=r;Zh!=null&&bc.push(t-Zh),Zh=t},clearMetrics(){Zh=null,bc=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const r in c.PerformanceMarkers)performance.clearMarks(c.PerformanceMarkers[r])},getPerformanceMetrics(){performance.measure("loadTime",c.PerformanceMarkers.create,c.PerformanceMarkers.load),performance.measure("fullLoadTime",c.PerformanceMarkers.create,c.PerformanceMarkers.fullLoad);const r=performance.getEntriesByName("loadTime")[0].duration,t=performance.getEntriesByName("fullLoadTime")[0].duration,o=bc.length,u=1/(bc.reduce((g,x)=>g+x,0)/o/1e3),m=bc.filter(g=>g>$p).reduce((g,x)=>g+(x-$p)/$p,0);return{loadTime:r,fullLoadTime:t,fps:u,percentDroppedFrames:m/(o+m)*100}}};c.AJAXError=mn,c.ARRAY_TYPE=Qn,c.Actor=class{constructor(r,t,o){this.target=r,this.parent=t,this.mapId=o,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Qt(["receive","process"],this),this.invoker=new fw(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=pt()?r:window}send(r,t,o,u,m=!1){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(this.callbacks[g]=o);const x=$n(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:r,hasCallback:!!o,targetMapId:u,mustQueue:m,sourceMapId:this.mapId,data:Jo(t,x)},x),{cancel:()=>{o&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(r){const t=r.data,o=t.id;if(o&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[o];const u=this.cancelCallbacks[o];delete this.cancelCallbacks[o],u&&u()}else pt()||t.mustQueue?(this.tasks[o]=t,this.taskQueue.push(o),this.invoker.trigger()):this.processTask(o,t)}process(){if(!this.taskQueue.length)return;const r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){if(t.type==="<response>"){const o=this.callbacks[r];delete this.callbacks[r],o&&(t.error?o(Kn(t.error)):o(null,Kn(t.data)))}else{let o=!1;const u=$n(this.globalScope)?void 0:[],m=t.hasCallback?(S,P)=>{o=!0,delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:S?Jo(S):null,data:Jo(P,u)},u)}:S=>{o=!0};let g=null;const x=Kn(t.data);if(this.parent[t.type])g=this.parent[t.type](t.sourceMapId,x,m);else if(this.parent.getWorkerSource){const S=t.type.split(".");g=this.parent.getWorkerSource(t.sourceMapId,S[0],x.source)[S[1]](x,m)}else m(new Error(`Could not find function ${t.type}`));!o&&g&&g.cancel&&(this.cancelCallbacks[r]=g.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},c.AlphaImage=dc,c.CanonicalTileID=jp,c.CollisionBoxArray=Ae,c.CollisionCircleLayoutArray=class extends B{},c.Color=H,c.DEMData=Ng,c.DataConstantProperty=oe,c.DictionaryCoder=Ug,c.EXTENT=Qi,c.ErrorEvent=fo,c.EvaluationParameters=xi,c.Event=jr,c.Evented=br,c.FeatureIndex=Zg,c.FillBucket=Cp,c.FillExtrusionBucket=kp,c.GeoJSONFeature=Vg,c.ImageAtlas=dg,c.ImagePosition=Lp,c.LineBucket=Ap,c.LineStripIndexArray=class extends Q{},c.LngLat=Oi,c.LngLatBounds=Ol,c.MercatorCoordinate=Vh,c.ONE_EM=vn,c.OverscaledTileID=to,c.PerformanceUtils=_w,c.PosArray=_t,c.Properties=bt,c.QuadTriangleArray=class extends G{},c.RGBAImage=eo,c.RasterBoundsArray=class extends f{},c.RequestPerformance=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},c.ResourceType=Dn,c.SegmentVector=Nt,c.SymbolBucket=bu,c.Transitionable=d,c.TriangleIndexArray=Jn,c.Uniform1f=na,c.Uniform1i=class extends ia{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},c.Uniform2f=class extends ia{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},c.Uniform3f=class extends ia{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},c.Uniform4f=pu,c.UniformColor=I_,c.UniformMatrix4f=class extends ia{constructor(r,t){super(r,t),this.current=O0}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},c.UnwrappedTileID=Fg,c.ValidationError=Xe,c.ZoomHistory=Cl,c.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r},c.addDynamicAttributes=Fp,c.asyncAll=function(r,t,o){if(!r.length)return o(null,[]);let u=r.length;const m=new Array(r.length);let g=null;r.forEach((x,S)=>{t(x,(P,A)=>{P&&(g=P),m[S]=A,--u==0&&o(g,m)})})},c.bezier=Ie,c.bindAll=Qt,c.cacheEntryPossiblyAdded=function(r){Lt++,Lt>bi&&(r.getActor().send("enforceCacheSizeLimit",Ut),Lt=0)},c.clamp=K,c.clearTileCache=function(r){const t=caches.delete(vt);r&&t.catch(r).then(()=>r())},c.clipLine=Sg,c.clone=function(r){var t=new Qn(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},c.clone$1=me,c.clone$2=function(r){var t=new Qn(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},c.collisionCircleLayout=D1,c.config=Re,c.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},c.create=function(){var r=new Qn(16);return Qn!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},c.create$1=B_,c.createExpression=Gs,c.createFilter=za,c.createLayout=Bi,c.createStyleLayer=function(r){return r.type==="custom"?new dw(r):new pw[r.type](r)},c.cross=function(r,t,o){var u=t[0],m=t[1],g=t[2],x=o[0],S=o[1],P=o[2];return r[0]=m*P-g*S,r[1]=g*x-u*P,r[2]=u*S-m*x,r},c.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]},c.dot$1=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},c.ease=ge,c.emitValidationErrors=Ko,c.enforceCacheSizeLimit=function(r){ni(),Ge&&Ge.then(t=>{t.keys().then(o=>{for(let u=0;u<o.length-r;u++)t.delete(o[u])})})},c.equals=function(r,t){var o=r[0],u=r[1],m=r[2],g=r[3],x=r[4],S=r[5],P=r[6],A=r[7],R=r[8],O=r[9],U=r[10],j=r[11],$=r[12],te=r[13],ee=r[14],_e=r[15],Se=t[0],fe=t[1],we=t[2],Le=t[3],Me=t[4],st=t[5],ht=t[6],et=t[7],Je=t[8],We=t[9],tt=t[10],Qe=t[11],Ne=t[12],gt=t[13],ft=t[14],Ot=t[15];return Math.abs(o-Se)<=Yn*Math.max(1,Math.abs(o),Math.abs(Se))&&Math.abs(u-fe)<=Yn*Math.max(1,Math.abs(u),Math.abs(fe))&&Math.abs(m-we)<=Yn*Math.max(1,Math.abs(m),Math.abs(we))&&Math.abs(g-Le)<=Yn*Math.max(1,Math.abs(g),Math.abs(Le))&&Math.abs(x-Me)<=Yn*Math.max(1,Math.abs(x),Math.abs(Me))&&Math.abs(S-st)<=Yn*Math.max(1,Math.abs(S),Math.abs(st))&&Math.abs(P-ht)<=Yn*Math.max(1,Math.abs(P),Math.abs(ht))&&Math.abs(A-et)<=Yn*Math.max(1,Math.abs(A),Math.abs(et))&&Math.abs(R-Je)<=Yn*Math.max(1,Math.abs(R),Math.abs(Je))&&Math.abs(O-We)<=Yn*Math.max(1,Math.abs(O),Math.abs(We))&&Math.abs(U-tt)<=Yn*Math.max(1,Math.abs(U),Math.abs(tt))&&Math.abs(j-Qe)<=Yn*Math.max(1,Math.abs(j),Math.abs(Qe))&&Math.abs($-Ne)<=Yn*Math.max(1,Math.abs($),Math.abs(Ne))&&Math.abs(te-gt)<=Yn*Math.max(1,Math.abs(te),Math.abs(gt))&&Math.abs(ee-ft)<=Yn*Math.max(1,Math.abs(ee),Math.abs(ft))&&Math.abs(_e-Ot)<=Yn*Math.max(1,Math.abs(_e),Math.abs(Ot))},c.evaluateSizeForFeature=function(r,{uSize:t,uSizeT:o},{lowerSize:u,upperSize:m}){return r.kind==="source"?u/sa:r.kind==="composite"?pi(u/sa,m/sa,o):t},c.evaluateSizeForZoom=function(r,t){let o=0,u=0;if(r.kind==="constant")u=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:m,minZoom:g,maxZoom:x}=r,S=m?K(Sn.interpolationFactor(m,t,g,x),0,1):0;r.kind==="camera"?u=pi(r.minSize,r.maxSize,S):o=S}return{uSizeT:o,uSize:u}},c.evaluateVariableOffset=Cg,c.evented=Fa,c.exported=xr,c.exported$1=Dt,c.extend=Ve,c.filterObject=ue,c.fromRotation=function(r,t){var o=Math.sin(t),u=Math.cos(t);return r[0]=u,r[1]=o,r[2]=0,r[3]=-o,r[4]=u,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},c.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},c.getAnchorAlignment=Rp,c.getAnchorJustification=Op,c.getArrayBuffer=ho,c.getImage=Zr,c.getJSON=function(r,t){return Oo(Ve(r,{type:"json"}),t)},c.getOverlapMode=Zp,c.getRTLTextPluginStatus=Ts,c.getReferrer=Ms,c.getVideo=function(r,t){const o=window.document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(let u=0;u<r.length;u++){const m=window.document.createElement("source");po(r[u])||(o.crossOrigin="Anonymous"),m.src=r[u],o.appendChild(m)}return{cancel:()=>{}}},c.identity=yp,c.invert=function(r,t){var o=t[0],u=t[1],m=t[2],g=t[3],x=t[4],S=t[5],P=t[6],A=t[7],R=t[8],O=t[9],U=t[10],j=t[11],$=t[12],te=t[13],ee=t[14],_e=t[15],Se=o*S-u*x,fe=o*P-m*x,we=o*A-g*x,Le=u*P-m*S,Me=u*A-g*S,st=m*A-g*P,ht=R*te-O*$,et=R*ee-U*$,Je=R*_e-j*$,We=O*ee-U*te,tt=O*_e-j*te,Qe=U*_e-j*ee,Ne=Se*Qe-fe*tt+we*We+Le*Je-Me*et+st*ht;return Ne?(r[0]=(S*Qe-P*tt+A*We)*(Ne=1/Ne),r[1]=(m*tt-u*Qe-g*We)*Ne,r[2]=(te*st-ee*Me+_e*Le)*Ne,r[3]=(U*Me-O*st-j*Le)*Ne,r[4]=(P*Je-x*Qe-A*et)*Ne,r[5]=(o*Qe-m*Je+g*et)*Ne,r[6]=(ee*we-$*st-_e*fe)*Ne,r[7]=(R*st-U*we+j*fe)*Ne,r[8]=(x*tt-S*Je+A*ht)*Ne,r[9]=(u*Je-o*tt-g*ht)*Ne,r[10]=($*Me-te*we+_e*Se)*Ne,r[11]=(O*we-R*Me-j*Se)*Ne,r[12]=(S*et-x*We-P*ht)*Ne,r[13]=(o*We-u*et+m*ht)*Ne,r[14]=(te*fe-$*Le-ee*Se)*Ne,r[15]=(R*Le-O*fe+U*Se)*Ne,r):null},c.isImageBitmap=Ni,c.isSafari=$n,c.isWorker=pt,c.keysDifference=function(r,t){const o=[];for(const u in r)u in t||o.push(u);return o},c.lazyLoadRTLTextPlugin=function(){Nn.isLoading()||Nn.isLoaded()||Ts()!=="deferred"||hu()},c.makeRequest=Oo,c.mapObject=ye,c.mercatorXfromLng=Dg,c.mercatorYfromLat=Rg,c.mercatorZfromAltitude=Bg,c.mul=q0,c.mul$1=function(r,t,o){return r[0]=t[0]*o[0],r[1]=t[1]*o[1],r[2]=t[2]*o[2],r[3]=t[3]*o[3],r},c.multiply=O_,c.nextPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},c.normalize=function(r,t){var o=t[0],u=t[1],m=t[2],g=o*o+u*u+m*m;return g>0&&(g=1/Math.sqrt(g)),r[0]=t[0]*g,r[1]=t[1]*g,r[2]=t[2]*g,r},c.number=pi,c.ortho=function(r,t,o,u,m,g,x){var S=1/(t-o),P=1/(u-m),A=1/(g-x);return r[0]=-2*S,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*P,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*A,r[11]=0,r[12]=(t+o)*S,r[13]=(m+u)*P,r[14]=(x+g)*A,r[15]=1,r},c.parseCacheControl=ci,c.parseGlyphPbf=function(r){return new zp(r).readFields(q1,[])},c.pbf=zp,c.performSymbolLayout=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=Qi/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;const t=r.bucket.layers[0].layout,o=r.bucket.layers[0]._unevaluatedLayout._values,u={layoutIconSize:o["icon-size"].possiblyEvaluate(new xi(r.bucket.zoom+1),r.canonical),layoutTextSize:o["text-size"].possiblyEvaluate(new xi(r.bucket.zoom+1),r.canonical),textMaxSize:o["text-size"].possiblyEvaluate(new xi(18))};if(r.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:A}=r.bucket.textSizeData;u.compositeTextSizes=[o["text-size"].possiblyEvaluate(new xi(P),r.canonical),o["text-size"].possiblyEvaluate(new xi(A),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:A}=r.bucket.iconSizeData;u.compositeIconSizes=[o["icon-size"].possiblyEvaluate(new xi(P),r.canonical),o["icon-size"].possiblyEvaluate(new xi(A),r.canonical)]}const m=t.get("text-line-height")*vn,g=t.get("text-rotation-alignment")!=="viewport"&&t.get("symbol-placement")!=="point",x=t.get("text-keep-upright"),S=t.get("text-size");for(const P of r.bucket.features){const A=t.get("text-font").evaluate(P,{},r.canonical).join(","),R=S.evaluate(P,{},r.canonical),O=u.layoutTextSize.evaluate(P,{},r.canonical),U=u.layoutIconSize.evaluate(P,{},r.canonical),j={horizontal:{},vertical:void 0},$=P.text;let te,ee=[0,0];if($){const fe=$.toString(),we=t.get("text-letter-spacing").evaluate(P,{},r.canonical)*vn,Le=uu(fe)?we:0,Me=t.get("text-anchor").evaluate(P,{},r.canonical),st=t.get("text-variable-anchor");if(!st){const tt=t.get("text-radial-offset").evaluate(P,{},r.canonical);ee=tt?Cg(Me,[tt*vn,Bp]):t.get("text-offset").evaluate(P,{},r.canonical).map(Qe=>Qe*vn)}let ht=g?"center":t.get("text-justify").evaluate(P,{},r.canonical);const et=t.get("symbol-placement"),Je=et==="point"?t.get("text-max-width").evaluate(P,{},r.canonical)*vn:0,We=()=>{r.bucket.allowVerticalPlacement&&Js(fe)&&(j.vertical=Lh($,r.glyphMap,r.glyphPositions,r.imagePositions,A,Je,m,Me,"left",Le,ee,c.WritingMode.vertical,!0,et,O,R))};if(!g&&st){const tt=ht==="auto"?st.map(Ne=>Op(Ne)):[ht];let Qe=!1;for(let Ne=0;Ne<tt.length;Ne++){const gt=tt[Ne];if(!j.horizontal[gt])if(Qe)j.horizontal[gt]=j.horizontal[0];else{const ft=Lh($,r.glyphMap,r.glyphPositions,r.imagePositions,A,Je,m,"center",gt,Le,ee,c.WritingMode.horizontal,!1,et,O,R);ft&&(j.horizontal[gt]=ft,Qe=ft.positionedLines.length===1)}}We()}else{ht==="auto"&&(ht=Op(Me));const tt=Lh($,r.glyphMap,r.glyphPositions,r.imagePositions,A,Je,m,Me,ht,Le,ee,c.WritingMode.horizontal,!1,et,O,R);tt&&(j.horizontal[ht]=tt),We(),Js(fe)&&g&&x&&(j.vertical=Lh($,r.glyphMap,r.glyphPositions,r.imagePositions,A,Je,m,Me,ht,Le,ee,c.WritingMode.vertical,!1,et,O,R))}}let _e=!1;if(P.icon&&P.icon.name){const fe=r.imageMap[P.icon.name];fe&&(te=J1(r.imagePositions[P.icon.name],t.get("icon-offset").evaluate(P,{},r.canonical),t.get("icon-anchor").evaluate(P,{},r.canonical)),_e=!!fe.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=_e:r.bucket.sdfIcons!==_e&&$e("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==r.bucket.pixelRatio||t.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}const Se=kg(j.horizontal)||j.vertical;r.bucket.iconsInText=!!Se&&Se.iconsInText,(Se||te)&&rw(r.bucket,P,j,te,r.imageMap,u,O,U,ee,_e,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},c.perspective=function(r,t,o,u,m){var g,x=1/Math.tan(t/2);return r[0]=x/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=x,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,m!=null&&m!==1/0?(r[10]=(m+u)*(g=1/(u-m)),r[14]=2*m*u*g):(r[10]=-1,r[14]=-2*u),r},c.pick=function(r,t){const o={};for(let u=0;u<t.length;u++){const m=t[u];m in r&&(o[m]=r[m])}return o},c.plugin=Nn,c.pointGeometry=ut,c.polygonIntersectsPolygon=M_,c.potpack=hg,c.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],c.register=nt,c.registerForPluginStateChange=function(r){return r({pluginStatus:Cn,pluginURL:Yr}),Fa.on("pluginStateChange",r),r},c.renderColorRamp=j_,c.rotateX=function(r,t,o){var u=Math.sin(o),m=Math.cos(o),g=t[4],x=t[5],S=t[6],P=t[7],A=t[8],R=t[9],O=t[10],U=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=g*m+A*u,r[5]=x*m+R*u,r[6]=S*m+O*u,r[7]=P*m+U*u,r[8]=A*m-g*u,r[9]=R*m-x*u,r[10]=O*m-S*u,r[11]=U*m-P*u,r},c.rotateZ=function(r,t,o){var u=Math.sin(o),m=Math.cos(o),g=t[0],x=t[1],S=t[2],P=t[3],A=t[4],R=t[5],O=t[6],U=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=g*m+A*u,r[1]=x*m+R*u,r[2]=S*m+O*u,r[3]=P*m+U*u,r[4]=A*m-g*u,r[5]=R*m-x*u,r[6]=O*m-S*u,r[7]=U*m-P*u,r},c.scale=function(r,t,o){var u=o[0],m=o[1],g=o[2];return r[0]=t[0]*u,r[1]=t[1]*u,r[2]=t[2]*u,r[3]=t[3]*u,r[4]=t[4]*m,r[5]=t[5]*m,r[6]=t[6]*m,r[7]=t[7]*m,r[8]=t[8]*g,r[9]=t[9]*g,r[10]=t[10]*g,r[11]=t[11]*g,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},c.scale$1=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r},c.setCacheLimits=function(r,t){Ut=r,bi=t},c.setRTLTextPlugin=function(r,t,o=!1){if(Cn===bs||Cn===Yo||Cn===Ba)throw new Error("setRTLTextPlugin cannot be called multiple times.");Yr=xr.resolveURL(r),Cn=bs,Oa=t,Qo(),o||hu()},c.spec=ke,c.sphericalToCartesian=function([r,t,o]){return t+=90,t*=Math.PI/180,o*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(o),y:r*Math.sin(t)*Math.sin(o),z:r*Math.cos(o)}},c.sqrLen=function(r){var t=r[0],o=r[1];return t*t+o*o},c.sub=function(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r[2]=t[2]-o[2],r},c.toEvaluationFeature=Rl,c.transformMat3=function(r,t,o){var u=t[0],m=t[1],g=t[2];return r[0]=u*o[0]+m*o[3]+g*o[6],r[1]=u*o[1]+m*o[4]+g*o[7],r[2]=u*o[2]+m*o[5]+g*o[8],r},c.transformMat4=Eh,c.transformMat4$1=function(r,t,o){var u=t[0],m=t[1];return r[0]=o[0]*u+o[4]*m+o[12],r[1]=o[1]*u+o[5]*m+o[13],r},c.translate=function(r,t,o){var u,m,g,x,S,P,A,R,O,U,j,$,te=o[0],ee=o[1],_e=o[2];return t===r?(r[12]=t[0]*te+t[4]*ee+t[8]*_e+t[12],r[13]=t[1]*te+t[5]*ee+t[9]*_e+t[13],r[14]=t[2]*te+t[6]*ee+t[10]*_e+t[14],r[15]=t[3]*te+t[7]*ee+t[11]*_e+t[15]):(m=t[1],g=t[2],x=t[3],S=t[4],P=t[5],A=t[6],R=t[7],O=t[8],U=t[9],j=t[10],$=t[11],r[0]=u=t[0],r[1]=m,r[2]=g,r[3]=x,r[4]=S,r[5]=P,r[6]=A,r[7]=R,r[8]=O,r[9]=U,r[10]=j,r[11]=$,r[12]=u*te+S*ee+O*_e+t[12],r[13]=m*te+P*ee+U*_e+t[13],r[14]=g*te+A*ee+j*_e+t[14],r[15]=x*te+R*ee+$*_e+t[15]),r},c.triggerPluginCompletionEvent=zl,c.unicodeBlockLookup=He,c.uniqueId=function(){return De++},c.validateCustomStyleLayer=function(r){const t=[],o=r.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},c.validateLight=Ra,c.validateStyle=Xs,c.vectorTile=Va,c.warnOnce=$e,c.wrap=Ze}),b(["./shared"],function(c){function q(Z){const D=typeof Z;if(D==="number"||D==="boolean"||D==="string"||Z==null)return JSON.stringify(Z);if(Array.isArray(Z)){let H="[";for(const ie of Z)H+=`${q(ie)},`;return`${H}]`}const F=Object.keys(Z).sort();let W="{";for(let H=0;H<F.length;H++)W+=`${JSON.stringify(F[H])}:${q(Z[F[H]])},`;return`${W}}`}function le(Z){let D="";for(const F of c.refProperties)D+=`/${q(Z[F])}`;return D}class Ie{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,F){for(const H of D){this._layerConfigs[H.id]=H;const ie=this._layers[H.id]=c.createStyleLayer(H);ie._featureFilter=c.createFilter(ie.filter),this.keyCache[H.id]&&delete this.keyCache[H.id]}for(const H of F)delete this.keyCache[H],delete this._layerConfigs[H],delete this._layers[H];this.familiesBySource={};const W=function(H,ie){const ce={};for(let ne=0;ne<H.length;ne++){const de=ie&&ie[H[ne].id]||le(H[ne]);ie&&(ie[H[ne].id]=de);let Pe=ce[de];Pe||(Pe=ce[de]=[]),Pe.push(H[ne])}const se=[];for(const ne in ce)se.push(ce[ne]);return se}(Object.values(this._layerConfigs),this.keyCache);for(const H of W){const ie=H.map(Be=>this._layers[Be.id]),ce=ie[0];if(ce.visibility==="none")continue;const se=ce.source||"";let ne=this.familiesBySource[se];ne||(ne=this.familiesBySource[se]={});const de=ce.sourceLayer||"_geojsonTileLayer";let Pe=ne[de];Pe||(Pe=ne[de]=[]),Pe.push(ie)}}}class ge{constructor(D){const F={},W=[];for(const se in D){const ne=D[se],de=F[se]={};for(const Pe in ne){const Be=ne[+Pe];if(!Be||Be.bitmap.width===0||Be.bitmap.height===0)continue;const Ee={x:0,y:0,w:Be.bitmap.width+2,h:Be.bitmap.height+2};W.push(Ee),de[Pe]={rect:Ee,metrics:Be.metrics}}}const{w:H,h:ie}=c.potpack(W),ce=new c.AlphaImage({width:H||1,height:ie||1});for(const se in D){const ne=D[se];for(const de in ne){const Pe=ne[+de];if(!Pe||Pe.bitmap.width===0||Pe.bitmap.height===0)continue;const Be=F[se][de].rect;c.AlphaImage.copy(Pe.bitmap,ce,{x:0,y:0},{x:Be.x+1,y:Be.y+1},Pe.bitmap)}}this.image=ce,this.positions=F}}c.register("GlyphAtlas",ge);class K{constructor(D){this.tileID=new c.OverscaledTileID(D.tileID.overscaledZ,D.tileID.wrap,D.tileID.canonical.z,D.tileID.canonical.x,D.tileID.canonical.y),this.uid=D.uid,this.zoom=D.zoom,this.pixelRatio=D.pixelRatio,this.tileSize=D.tileSize,this.source=D.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=D.showCollisionBoxes,this.collectResourceTiming=!!D.collectResourceTiming,this.returnDependencies=!!D.returnDependencies,this.promoteId=D.promoteId}parse(D,F,W,H,ie){this.status="parsing",this.data=D,this.collisionBoxArray=new c.CollisionBoxArray;const ce=new c.DictionaryCoder(Object.keys(D.layers).sort()),se=new c.FeatureIndex(this.tileID,this.promoteId);se.bucketLayerIDs=[];const ne={},de={featureIndex:se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:W},Pe=F.familiesBySource[this.source];for(const Et in Pe){const zt=D.layers[Et];if(!zt)continue;zt.version===1&&c.warnOnce(`Vector tile source "${this.source}" layer "${Et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Vt=ce.encode(Et),Jt=[];for(let Ui=0;Ui<zt.length;Ui++){const gi=zt.feature(Ui),Ri=se.getId(gi,Et);Jt.push({feature:gi,id:Ri,index:Ui,sourceLayerIndex:Vt})}for(const Ui of Pe[Et]){const gi=Ui[0];gi.source!==this.source&&c.warnOnce(`layer.source = ${gi.source} does not equal this.source = ${this.source}`),gi.minzoom&&this.zoom<Math.floor(gi.minzoom)||gi.maxzoom&&this.zoom>=gi.maxzoom||gi.visibility!=="none"&&(Ze(Ui,this.zoom,W),(ne[gi.id]=gi.createBucket({index:se.bucketLayerIDs.length,layers:Ui,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Vt,sourceID:this.source})).populate(Jt,de,this.tileID.canonical),se.bucketLayerIDs.push(Ui.map(Ri=>Ri.id)))}}let Be,Ee,at,ct;const Ye=c.mapObject(de.glyphDependencies,Et=>Object.keys(Et).map(Number));Object.keys(Ye).length?H.send("getGlyphs",{uid:this.uid,stacks:Ye},(Et,zt)=>{Be||(Be=Et,Ee=zt,Wt.call(this))}):Ee={};const yt=Object.keys(de.iconDependencies);yt.length?H.send("getImages",{icons:yt,source:this.source,tileID:this.tileID,type:"icons"},(Et,zt)=>{Be||(Be=Et,at=zt,Wt.call(this))}):at={};const xt=Object.keys(de.patternDependencies);function Wt(){if(Be)return ie(Be);if(Ee&&at&&ct){const Et=new ge(Ee),zt=new c.ImageAtlas(at,ct);for(const Vt in ne){const Jt=ne[Vt];Jt instanceof c.SymbolBucket?(Ze(Jt.layers,this.zoom,W),c.performSymbolLayout({bucket:Jt,glyphMap:Ee,glyphPositions:Et.positions,imageMap:at,imagePositions:zt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Jt.hasPattern&&(Jt instanceof c.LineBucket||Jt instanceof c.FillBucket||Jt instanceof c.FillExtrusionBucket)&&(Ze(Jt.layers,this.zoom,W),Jt.addFeatures(de,this.tileID.canonical,zt.patternPositions))}this.status="done",ie(null,{buckets:Object.values(ne).filter(Vt=>!Vt.isEmpty()),featureIndex:se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Et.image,imageAtlas:zt,glyphMap:this.returnDependencies?Ee:null,iconMap:this.returnDependencies?at:null,glyphPositions:this.returnDependencies?Et.positions:null})}}xt.length?H.send("getImages",{icons:xt,source:this.source,tileID:this.tileID,type:"patterns"},(Et,zt)=>{Be||(Be=Et,ct=zt,Wt.call(this))}):ct={},Wt.call(this)}}function Ze(Z,D,F){const W=new c.EvaluationParameters(D);for(const H of Z)H.recalculate(W,F)}function Ve(Z,D){const F=c.getArrayBuffer(Z.request,(W,H,ie,ce)=>{W?D(W):H&&D(null,{vectorTile:new c.vectorTile.VectorTile(new c.pbf(H)),rawData:H,cacheControl:ie,expires:ce})});return()=>{F.cancel(),D()}}class De{constructor(D,F,W,H){this.actor=D,this.layerIndex=F,this.availableImages=W,this.loadVectorData=H||Ve,this.loading={},this.loaded={}}loadTile(D,F){const W=D.uid;this.loading||(this.loading={});const H=!!(D&&D.request&&D.request.collectResourceTiming)&&new c.RequestPerformance(D.request),ie=this.loading[W]=new K(D);ie.abort=this.loadVectorData(D,(ce,se)=>{if(delete this.loading[W],ce||!se)return ie.status="done",this.loaded[W]=ie,F(ce);const ne=se.rawData,de={};se.expires&&(de.expires=se.expires),se.cacheControl&&(de.cacheControl=se.cacheControl);const Pe={};if(H){const Be=H.finish();Be&&(Pe.resourceTiming=JSON.parse(JSON.stringify(Be)))}ie.vectorTile=se.vectorTile,ie.parse(se.vectorTile,this.layerIndex,this.availableImages,this.actor,(Be,Ee)=>{if(Be||!Ee)return F(Be);F(null,c.extend({rawTileData:ne.slice(0)},Ee,de,Pe))}),this.loaded=this.loaded||{},this.loaded[W]=ie})}reloadTile(D,F){const W=this.loaded,H=D.uid,ie=this;if(W&&W[H]){const ce=W[H];ce.showCollisionBoxes=D.showCollisionBoxes;const se=(ne,de)=>{const Pe=ce.reloadCallback;Pe&&(delete ce.reloadCallback,ce.parse(ce.vectorTile,ie.layerIndex,this.availableImages,ie.actor,Pe)),F(ne,de)};ce.status==="parsing"?ce.reloadCallback=se:ce.status==="done"&&(ce.vectorTile?ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor,se):se())}}abortTile(D,F){const W=this.loading,H=D.uid;W&&W[H]&&W[H].abort&&(W[H].abort(),delete W[H]),F()}removeTile(D,F){const W=this.loaded,H=D.uid;W&&W[H]&&delete W[H],F()}}class Qt{constructor(){this.loaded={}}loadTile(D,F){const{uid:W,encoding:H,rawImageData:ie}=D,ce=c.isImageBitmap(ie)?this.getImageData(ie):ie,se=new c.DEMData(W,ce,H);this.loaded=this.loaded||{},this.loaded[W]=se,F(null,se)}getImageData(D){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(D.width,D.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=D.width,this.offscreenCanvas.height=D.height,this.offscreenCanvasContext.drawImage(D,0,0,D.width,D.height);const F=this.offscreenCanvasContext.getImageData(-1,-1,D.width+2,D.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new c.RGBAImage({width:F.width,height:F.height},F.data)}removeTile(D){const F=this.loaded,W=D.uid;F&&F[W]&&delete F[W]}}var ye=function Z(D,F){var W,H=D&&D.type;if(H==="FeatureCollection")for(W=0;W<D.features.length;W++)Z(D.features[W],F);else if(H==="GeometryCollection")for(W=0;W<D.geometries.length;W++)Z(D.geometries[W],F);else if(H==="Feature")Z(D.geometry,F);else if(H==="Polygon")ue(D.coordinates,F);else if(H==="MultiPolygon")for(W=0;W<D.coordinates.length;W++)ue(D.coordinates[W],F);return D};function ue(Z,D){if(Z.length!==0){me(Z[0],D);for(var F=1;F<Z.length;F++)me(Z[F],!D)}}function me(Z,D){for(var F=0,W=0,H=0,ie=Z.length,ce=ie-1;H<ie;ce=H++){var se=(Z[H][0]-Z[ce][0])*(Z[ce][1]+Z[H][1]),ne=F+se;W+=Math.abs(F)>=Math.abs(se)?F-ne+se:se-ne+F,F=ne}F+W>=0!=!!D&&Z.reverse()}const Ue=c.vectorTile.VectorTileFeature.prototype.toGeoJSON;class $e{constructor(D){this._feature=D,this.extent=c.EXTENT,this.type=D.type,this.properties=D.tags,"id"in D&&!isNaN(D.id)&&(this.id=parseInt(D.id,10))}loadGeometry(){if(this._feature.type===1){const D=[];for(const F of this._feature.geometry)D.push([new c.pointGeometry(F[0],F[1])]);return D}{const D=[];for(const F of this._feature.geometry){const W=[];for(const H of F)W.push(new c.pointGeometry(H[0],H[1]));D.push(W)}return D}}toGeoJSON(D,F,W){return Ue.call(this,D,F,W)}}class lt{constructor(D){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=D.length,this._features=D}feature(D){return new $e(this._features[D])}}var dt={exports:{}},pt=c.pointGeometry,ci=c.vectorTile.VectorTileFeature,Ct=ei;function ei(Z,D){this.options=D||{},this.features=Z,this.length=Z.length}function _i(Z,D){this.id=typeof Z.id=="number"?Z.id:void 0,this.type=Z.type,this.rawGeometry=Z.type===1?[Z.geometry]:Z.geometry,this.properties=Z.tags,this.extent=D||4096}ei.prototype.feature=function(Z){return new _i(this.features[Z],this.options.extent)},_i.prototype.loadGeometry=function(){var Z=this.rawGeometry;this.geometry=[];for(var D=0;D<Z.length;D++){for(var F=Z[D],W=[],H=0;H<F.length;H++)W.push(new pt(F[H][0],F[H][1]));this.geometry.push(W)}return this.geometry},_i.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Z=this.geometry,D=1/0,F=-1/0,W=1/0,H=-1/0,ie=0;ie<Z.length;ie++)for(var ce=Z[ie],se=0;se<ce.length;se++){var ne=ce[se];D=Math.min(D,ne.x),F=Math.max(F,ne.x),W=Math.min(W,ne.y),H=Math.max(H,ne.y)}return[D,W,F,H]},_i.prototype.toGeoJSON=ci.prototype.toGeoJSON;var $n=c.pbf,Ni=Ct;function xr(Z){var D=new $n;return function(F,W){for(var H in F.layers)W.writeMessage(3,ut,F.layers[H])}(Z,D),D.finish()}function ut(Z,D){var F;D.writeVarintField(15,Z.version||1),D.writeStringField(1,Z.name||""),D.writeVarintField(5,Z.extent||4096);var W={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<Z.length;F++)W.feature=Z.feature(F),D.writeMessage(2,Ji,W);var H=W.keys;for(F=0;F<H.length;F++)D.writeStringField(3,H[F]);var ie=W.values;for(F=0;F<ie.length;F++)D.writeMessage(4,Ut,ie[F])}function Ji(Z,D){var F=Z.feature;F.id!==void 0&&D.writeVarintField(1,F.id),D.writeMessage(2,Re,Z),D.writeVarintField(3,F.type),D.writeMessage(4,Tt,F)}function Re(Z,D){var F=Z.feature,W=Z.keys,H=Z.values,ie=Z.keycache,ce=Z.valuecache;for(var se in F.properties){var ne=F.properties[se],de=ie[se];if(ne!==null){de===void 0&&(W.push(se),ie[se]=de=W.length-1),D.writeVarint(de);var Pe=typeof ne;Pe!=="string"&&Pe!=="boolean"&&Pe!=="number"&&(ne=JSON.stringify(ne));var Be=Pe+":"+ne,Ee=ce[Be];Ee===void 0&&(H.push(ne),ce[Be]=Ee=H.length-1),D.writeVarint(Ee)}}}function vt(Z,D){return(D<<3)+(7&Z)}function Ge(Z){return Z<<1^Z>>31}function Tt(Z,D){for(var F=Z.loadGeometry(),W=Z.type,H=0,ie=0,ce=F.length,se=0;se<ce;se++){var ne=F[se],de=1;W===1&&(de=ne.length),D.writeVarint(vt(1,de));for(var Pe=W===3?ne.length-1:ne.length,Be=0;Be<Pe;Be++){Be===1&&W!==1&&D.writeVarint(vt(2,Pe-1));var Ee=ne[Be].x-H,at=ne[Be].y-ie;D.writeVarint(Ge(Ee)),D.writeVarint(Ge(at)),H+=Ee,ie+=at}W===3&&D.writeVarint(vt(7,1))}}function Ut(Z,D){var F=typeof Z;F==="string"?D.writeStringField(1,Z):F==="boolean"?D.writeBooleanField(7,Z):F==="number"&&(Z%1!=0?D.writeDoubleField(3,Z):Z<0?D.writeSVarintField(6,Z):D.writeVarintField(5,Z))}function bi(Z,D,F,W,H,ie){if(H-W<=F)return;const ce=W+H>>1;ni(Z,D,ce,W,H,ie%2),bi(Z,D,F,W,ce-1,ie+1),bi(Z,D,F,ce+1,H,ie+1)}function ni(Z,D,F,W,H,ie){for(;H>W;){if(H-W>600){const de=H-W+1,Pe=F-W+1,Be=Math.log(de),Ee=.5*Math.exp(2*Be/3),at=.5*Math.sqrt(Be*Ee*(de-Ee)/de)*(Pe-de/2<0?-1:1);ni(Z,D,F,Math.max(W,Math.floor(F-Pe*Ee/de+at)),Math.min(H,Math.floor(F+(de-Pe)*Ee/de+at)),ie)}const ce=D[2*F+ie];let se=W,ne=H;for(Lt(Z,D,W,F),D[2*H+ie]>ce&&Lt(Z,D,W,H);se<ne;){for(Lt(Z,D,se,ne),se++,ne--;D[2*se+ie]<ce;)se++;for(;D[2*ne+ie]>ce;)ne--}D[2*W+ie]===ce?Lt(Z,D,W,ne):(ne++,Lt(Z,D,ne,H)),ne<=F&&(W=ne+1),F<=ne&&(H=ne-1)}}function Lt(Z,D,F,W){Dt(Z,F,W),Dt(D,2*F,2*W),Dt(D,2*F+1,2*W+1)}function Dt(Z,D,F){const W=Z[D];Z[D]=Z[F],Z[F]=W}function Ai(Z,D,F,W){const H=Z-F,ie=D-W;return H*H+ie*ie}dt.exports=xr,dt.exports.fromVectorTileJs=xr,dt.exports.fromGeojsonVt=function(Z,D){D=D||{};var F={};for(var W in Z)F[W]=new Ni(Z[W].features,D),F[W].name=W,F[W].version=D.version,F[W].extent=D.extent;return xr({layers:F})},dt.exports.GeoJSONWrapper=Ni;const pn=Z=>Z[0],fn=Z=>Z[1];class co{constructor(D,F=pn,W=fn,H=64,ie=Float64Array){this.nodeSize=H,this.points=D;const ce=D.length<65536?Uint16Array:Uint32Array,se=this.ids=new ce(D.length),ne=this.coords=new ie(2*D.length);for(let de=0;de<D.length;de++)se[de]=de,ne[2*de]=F(D[de]),ne[2*de+1]=W(D[de]);bi(se,ne,H,0,se.length-1,0)}range(D,F,W,H){return function(ie,ce,se,ne,de,Pe,Be){const Ee=[0,ie.length-1,0],at=[];let ct,Ye;for(;Ee.length;){const yt=Ee.pop(),xt=Ee.pop(),Wt=Ee.pop();if(xt-Wt<=Be){for(let Vt=Wt;Vt<=xt;Vt++)ct=ce[2*Vt],Ye=ce[2*Vt+1],ct>=se&&ct<=de&&Ye>=ne&&Ye<=Pe&&at.push(ie[Vt]);continue}const Et=Math.floor((Wt+xt)/2);ct=ce[2*Et],Ye=ce[2*Et+1],ct>=se&&ct<=de&&Ye>=ne&&Ye<=Pe&&at.push(ie[Et]);const zt=(yt+1)%2;(yt===0?se<=ct:ne<=Ye)&&(Ee.push(Wt),Ee.push(Et-1),Ee.push(zt)),(yt===0?de>=ct:Pe>=Ye)&&(Ee.push(Et+1),Ee.push(xt),Ee.push(zt))}return at}(this.ids,this.coords,D,F,W,H,this.nodeSize)}within(D,F,W){return function(H,ie,ce,se,ne,de){const Pe=[0,H.length-1,0],Be=[],Ee=ne*ne;for(;Pe.length;){const at=Pe.pop(),ct=Pe.pop(),Ye=Pe.pop();if(ct-Ye<=de){for(let zt=Ye;zt<=ct;zt++)Ai(ie[2*zt],ie[2*zt+1],ce,se)<=Ee&&Be.push(H[zt]);continue}const yt=Math.floor((Ye+ct)/2),xt=ie[2*yt],Wt=ie[2*yt+1];Ai(xt,Wt,ce,se)<=Ee&&Be.push(H[yt]);const Et=(at+1)%2;(at===0?ce-ne<=xt:se-ne<=Wt)&&(Pe.push(Ye),Pe.push(yt-1),Pe.push(Et)),(at===0?ce+ne>=xt:se+ne>=Wt)&&(Pe.push(yt+1),Pe.push(ct),Pe.push(Et))}return Be}(this.ids,this.coords,D,F,W,this.nodeSize)}}const Bo={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Z=>Z},Dn=Math.fround||(mn=new Float32Array(1),Z=>(mn[0]=+Z,mn[0]));var mn;class Ms{constructor(D){this.options=Zr(Object.create(Bo),D),this.trees=new Array(this.options.maxZoom+1)}load(D){const{log:F,minZoom:W,maxZoom:H,nodeSize:ie}=this.options;F&&console.time("total time");const ce=`prepare ${D.length} points`;F&&console.time(ce),this.points=D;let se=[];for(let ne=0;ne<D.length;ne++)D[ne].geometry&&se.push(Oo(D[ne],ne));this.trees[H+1]=new co(se,ps,Gr,ie,Float32Array),F&&console.timeEnd(ce);for(let ne=H;ne>=W;ne--){const de=+Date.now();se=this._cluster(se,ne),this.trees[ne]=new co(se,ps,Gr,ie,Float32Array),F&&console.log("z%d: %d clusters in %dms",ne,se.length,+Date.now()-de)}return F&&console.timeEnd("total time"),this}getClusters(D,F){let W=((D[0]+180)%360+360)%360-180;const H=Math.max(-90,Math.min(90,D[1]));let ie=D[2]===180?180:((D[2]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)W=-180,ie=180;else if(W>ie){const Pe=this.getClusters([W,H,180,ce],F),Be=this.getClusters([-180,H,ie,ce],F);return Pe.concat(Be)}const se=this.trees[this._limitZoom(F)],ne=se.range(qt(W),or(ce),qt(ie),or(H)),de=[];for(const Pe of ne){const Be=se.points[Pe];de.push(Be.numPoints?ho(Be):this.points[Be.index])}return de}getChildren(D){const F=this._getOriginId(D),W=this._getOriginZoom(D),H="No cluster with the specified id.",ie=this.trees[W];if(!ie)throw new Error(H);const ce=ie.points[F];if(!ce)throw new Error(H);const se=this.options.radius/(this.options.extent*Math.pow(2,W-1)),ne=ie.within(ce.x,ce.y,se),de=[];for(const Pe of ne){const Be=ie.points[Pe];Be.parentId===D&&de.push(Be.numPoints?ho(Be):this.points[Be.index])}if(de.length===0)throw new Error(H);return de}getLeaves(D,F,W){const H=[];return this._appendLeaves(H,D,F=F||10,W=W||0,0),H}getTile(D,F,W){const H=this.trees[this._limitZoom(D)],ie=Math.pow(2,D),{extent:ce,radius:se}=this.options,ne=se/ce,de=(W-ne)/ie,Pe=(W+1+ne)/ie,Be={features:[]};return this._addTileFeatures(H.range((F-ne)/ie,de,(F+1+ne)/ie,Pe),H.points,F,W,ie,Be),F===0&&this._addTileFeatures(H.range(1-ne/ie,de,1,Pe),H.points,ie,W,ie,Be),F===ie-1&&this._addTileFeatures(H.range(0,de,ne/ie,Pe),H.points,-1,W,ie,Be),Be.features.length?Be:null}getClusterExpansionZoom(D){let F=this._getOriginZoom(D)-1;for(;F<=this.options.maxZoom;){const W=this.getChildren(D);if(F++,W.length!==1)break;D=W[0].properties.cluster_id}return F}_appendLeaves(D,F,W,H,ie){const ce=this.getChildren(F);for(const se of ce){const ne=se.properties;if(ne&&ne.cluster?ie+ne.point_count<=H?ie+=ne.point_count:ie=this._appendLeaves(D,ne.cluster_id,W,H,ie):ie<H?ie++:D.push(se),D.length===W)break}return ie}_addTileFeatures(D,F,W,H,ie,ce){for(const se of D){const ne=F[se],de=ne.numPoints;let Pe,Be,Ee;if(de)Pe=po(ne),Be=ne.x,Ee=ne.y;else{const Ye=this.points[ne.index];Pe=Ye.properties,Be=qt(Ye.geometry.coordinates[0]),Ee=or(Ye.geometry.coordinates[1])}const at={type:1,geometry:[[Math.round(this.options.extent*(Be*ie-W)),Math.round(this.options.extent*(Ee*ie-H))]],tags:Pe};let ct;de?ct=ne.id:this.options.generateId?ct=ne.index:this.points[ne.index].id&&(ct=this.points[ne.index].id),ct!==void 0&&(at.id=ct),ce.features.push(at)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(Math.floor(+D),this.options.maxZoom+1))}_cluster(D,F){const W=[],{radius:H,extent:ie,reduce:ce,minPoints:se}=this.options,ne=H/(ie*Math.pow(2,F));for(let de=0;de<D.length;de++){const Pe=D[de];if(Pe.zoom<=F)continue;Pe.zoom=F;const Be=this.trees[F+1],Ee=Be.within(Pe.x,Pe.y,ne),at=Pe.numPoints||1;let ct=at;for(const Ye of Ee){const yt=Be.points[Ye];yt.zoom>F&&(ct+=yt.numPoints||1)}if(ct>at&&ct>=se){let Ye=Pe.x*at,yt=Pe.y*at,xt=ce&&at>1?this._map(Pe,!0):null;const Wt=(de<<5)+(F+1)+this.points.length;for(const Et of Ee){const zt=Be.points[Et];if(zt.zoom<=F)continue;zt.zoom=F;const Vt=zt.numPoints||1;Ye+=zt.x*Vt,yt+=zt.y*Vt,zt.parentId=Wt,ce&&(xt||(xt=this._map(Pe,!0)),ce(xt,this._map(zt)))}Pe.parentId=Wt,W.push(Vr(Ye/ct,yt/ct,Wt,ct,xt))}else if(W.push(Pe),ct>1)for(const Ye of Ee){const yt=Be.points[Ye];yt.zoom<=F||(yt.zoom=F,W.push(yt))}}return W}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,F){if(D.numPoints)return F?Zr({},D.properties):D.properties;const W=this.points[D.index].properties,H=this.options.map(W);return F&&H===W?Zr({},H):H}}function Vr(Z,D,F,W,H){return{x:Dn(Z),y:Dn(D),zoom:1/0,id:F,parentId:-1,numPoints:W,properties:H}}function Oo(Z,D){const[F,W]=Z.geometry.coordinates;return{x:Dn(qt(F)),y:Dn(or(W)),zoom:1/0,index:D,parentId:-1}}function ho(Z){return{type:"Feature",id:Z.id,properties:po(Z),geometry:{type:"Point",coordinates:[(D=Z.x,360*(D-.5)),wr(Z.y)]}};var D}function po(Z){const D=Z.numPoints,F=D>=1e4?`${Math.round(D/1e3)}k`:D>=1e3?Math.round(D/100)/10+"k":D;return Zr(Zr({},Z.properties),{cluster:!0,cluster_id:Z.id,point_count:D,point_count_abbreviated:F})}function qt(Z){return Z/360+.5}function or(Z){const D=Math.sin(Z*Math.PI/180),F=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return F<0?0:F>1?1:F}function wr(Z){const D=(180-360*Z)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function Zr(Z,D){for(const F in D)Z[F]=D[F];return Z}function ps(Z){return Z.x}function Gr(Z){return Z.y}function jr(Z,D,F,W){for(var H,ie=W,ce=F-D>>1,se=F-D,ne=Z[D],de=Z[D+1],Pe=Z[F],Be=Z[F+1],Ee=D+3;Ee<F;Ee+=3){var at=fo(Z[Ee],Z[Ee+1],ne,de,Pe,Be);if(at>ie)H=Ee,ie=at;else if(at===ie){var ct=Math.abs(Ee-ce);ct<se&&(H=Ee,se=ct)}}ie>W&&(H-D>3&&jr(Z,D,H,W),Z[H+2]=ie,F-H>3&&jr(Z,H,F,W))}function fo(Z,D,F,W,H,ie){var ce=H-F,se=ie-W;if(ce!==0||se!==0){var ne=((Z-F)*ce+(D-W)*se)/(ce*ce+se*se);ne>1?(F=H,W=ie):ne>0&&(F+=ce*ne,W+=se*ne)}return(ce=Z-F)*ce+(se=D-W)*se}function br(Z,D,F,W){var H={id:Z===void 0?null:Z,type:D,geometry:F,tags:W,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ie){var ce=ie.geometry,se=ie.type;if(se==="Point"||se==="MultiPoint"||se==="LineString")ke(ie,ce);else if(se==="Polygon"||se==="MultiLineString")for(var ne=0;ne<ce.length;ne++)ke(ie,ce[ne]);else if(se==="MultiPolygon")for(ne=0;ne<ce.length;ne++)for(var de=0;de<ce[ne].length;de++)ke(ie,ce[ne][de])}(H),H}function ke(Z,D){for(var F=0;F<D.length;F+=3)Z.minX=Math.min(Z.minX,D[F]),Z.minY=Math.min(Z.minY,D[F+1]),Z.maxX=Math.max(Z.maxX,D[F]),Z.maxY=Math.max(Z.maxY,D[F+1])}function Xe(Z,D,F,W){if(D.geometry){var H=D.geometry.coordinates,ie=D.geometry.type,ce=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2),se=[],ne=D.id;if(F.promoteId?ne=D.properties[F.promoteId]:F.generateId&&(ne=W||0),ie==="Point")mo(H,se);else if(ie==="MultiPoint")for(var de=0;de<H.length;de++)mo(H[de],se);else if(ie==="LineString")Wn(H,se,ce,!1);else if(ie==="MultiLineString"){if(F.lineMetrics){for(de=0;de<H.length;de++)Wn(H[de],se=[],ce,!1),Z.push(br(ne,"LineString",se,D.properties));return}$t(H,se,ce,!1)}else if(ie==="Polygon")$t(H,se,ce,!0);else{if(ie!=="MultiPolygon"){if(ie==="GeometryCollection"){for(de=0;de<D.geometry.geometries.length;de++)Xe(Z,{id:ne,geometry:D.geometry.geometries[de],properties:D.properties},F,W);return}throw new Error("Input data is not a valid GeoJSON object.")}for(de=0;de<H.length;de++){var Pe=[];$t(H[de],Pe,ce,!0),se.push(Pe)}}Z.push(br(ne,ie,se,D.properties))}}function mo(Z,D){D.push(Rn(Z[0])),D.push(_n(Z[1])),D.push(0)}function Wn(Z,D,F,W){for(var H,ie,ce=0,se=0;se<Z.length;se++){var ne=Rn(Z[se][0]),de=_n(Z[se][1]);D.push(ne),D.push(de),D.push(0),se>0&&(ce+=W?(H*de-ne*ie)/2:Math.sqrt(Math.pow(ne-H,2)+Math.pow(de-ie,2))),H=ne,ie=de}var Pe=D.length-3;D[2]=1,jr(D,0,Pe,F),D[Pe+2]=1,D.size=Math.abs(ce),D.start=0,D.end=D.size}function $t(Z,D,F,W){for(var H=0;H<Z.length;H++){var ie=[];Wn(Z[H],ie,F,W),D.push(ie)}}function Rn(Z){return Z/360+.5}function _n(Z){var D=Math.sin(Z*Math.PI/180),F=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return F<0?0:F>1?1:F}function bn(Z,D,F,W,H,ie,ce,se){if(W/=D,ie>=(F/=D)&&ce<W)return Z;if(ce<F||ie>=W)return null;for(var ne=[],de=0;de<Z.length;de++){var Pe=Z[de],Be=Pe.geometry,Ee=Pe.type,at=H===0?Pe.minX:Pe.minY,ct=H===0?Pe.maxX:Pe.maxY;if(at>=F&&ct<W)ne.push(Pe);else if(!(ct<F||at>=W)){var Ye=[];if(Ee==="Point"||Ee==="MultiPoint")_o(Be,Ye,F,W,H);else if(Ee==="LineString")je(Be,Ye,F,W,H,!1,se.lineMetrics);else if(Ee==="MultiLineString")Pt(Be,Ye,F,W,H,!1);else if(Ee==="Polygon")Pt(Be,Ye,F,W,H,!0);else if(Ee==="MultiPolygon")for(var yt=0;yt<Be.length;yt++){var xt=[];Pt(Be[yt],xt,F,W,H,!0),xt.length&&Ye.push(xt)}if(Ye.length){if(se.lineMetrics&&Ee==="LineString"){for(yt=0;yt<Ye.length;yt++)ne.push(br(Pe.id,Ee,Ye[yt],Pe.tags));continue}Ee!=="LineString"&&Ee!=="MultiLineString"||(Ye.length===1?(Ee="LineString",Ye=Ye[0]):Ee="MultiLineString"),Ee!=="Point"&&Ee!=="MultiPoint"||(Ee=Ye.length===3?"Point":"MultiPoint"),ne.push(br(Pe.id,Ee,Ye,Pe.tags))}}}return ne.length?ne:null}function _o(Z,D,F,W,H){for(var ie=0;ie<Z.length;ie+=3){var ce=Z[ie+H];ce>=F&&ce<=W&&(D.push(Z[ie]),D.push(Z[ie+1]),D.push(Z[ie+2]))}}function je(Z,D,F,W,H,ie,ce){for(var se,ne,de=At(Z),Pe=H===0?qr:St,Be=Z.start,Ee=0;Ee<Z.length-3;Ee+=3){var at=Z[Ee],ct=Z[Ee+1],Ye=Z[Ee+2],yt=Z[Ee+3],xt=Z[Ee+4],Wt=H===0?at:ct,Et=H===0?yt:xt,zt=!1;ce&&(se=Math.sqrt(Math.pow(at-yt,2)+Math.pow(ct-xt,2))),Wt<F?Et>F&&(ne=Pe(de,at,ct,yt,xt,F),ce&&(de.start=Be+se*ne)):Wt>W?Et<W&&(ne=Pe(de,at,ct,yt,xt,W),ce&&(de.start=Be+se*ne)):$i(de,at,ct,Ye),Et<F&&Wt>=F&&(ne=Pe(de,at,ct,yt,xt,F),zt=!0),Et>W&&Wt<=W&&(ne=Pe(de,at,ct,yt,xt,W),zt=!0),!ie&&zt&&(ce&&(de.end=Be+se*ne),D.push(de),de=At(Z)),ce&&(Be+=se)}var Vt=Z.length-3;at=Z[Vt],ct=Z[Vt+1],Ye=Z[Vt+2],(Wt=H===0?at:ct)>=F&&Wt<=W&&$i(de,at,ct,Ye),Vt=de.length-3,ie&&Vt>=3&&(de[Vt]!==de[0]||de[Vt+1]!==de[1])&&$i(de,de[0],de[1],de[2]),de.length&&D.push(de)}function At(Z){var D=[];return D.size=Z.size,D.start=Z.start,D.end=Z.end,D}function Pt(Z,D,F,W,H,ie){for(var ce=0;ce<Z.length;ce++)je(Z[ce],D,F,W,H,ie,!1)}function $i(Z,D,F,W){Z.push(D),Z.push(F),Z.push(W)}function qr(Z,D,F,W,H,ie){var ce=(ie-D)/(W-D);return Z.push(ie),Z.push(F+(H-F)*ce),Z.push(1),ce}function St(Z,D,F,W,H,ie){var ce=(ie-F)/(H-F);return Z.push(D+(W-D)*ce),Z.push(ie),Z.push(1),ce}function $r(Z,D){for(var F=[],W=0;W<Z.length;W++){var H,ie=Z[W],ce=ie.type;if(ce==="Point"||ce==="MultiPoint"||ce==="LineString")H=Wi(ie.geometry,D);else if(ce==="MultiLineString"||ce==="Polygon"){H=[];for(var se=0;se<ie.geometry.length;se++)H.push(Wi(ie.geometry[se],D))}else if(ce==="MultiPolygon")for(H=[],se=0;se<ie.geometry.length;se++){for(var ne=[],de=0;de<ie.geometry[se].length;de++)ne.push(Wi(ie.geometry[se][de],D));H.push(ne)}F.push(br(ie.id,ce,H,ie.tags))}return F}function Wi(Z,D){var F=[];F.size=Z.size,Z.start!==void 0&&(F.start=Z.start,F.end=Z.end);for(var W=0;W<Z.length;W+=3)F.push(Z[W]+D,Z[W+1],Z[W+2]);return F}function fs(Z,D){if(Z.transformed)return Z;var F,W,H,ie=1<<Z.z,ce=Z.x,se=Z.y;for(F=0;F<Z.features.length;F++){var ne=Z.features[F],de=ne.geometry,Pe=ne.type;if(ne.geometry=[],Pe===1)for(W=0;W<de.length;W+=2)ne.geometry.push(Di(de[W],de[W+1],D,ie,ce,se));else for(W=0;W<de.length;W++){var Be=[];for(H=0;H<de[W].length;H+=2)Be.push(Di(de[W][H],de[W][H+1],D,ie,ce,se));ne.geometry.push(Be)}}return Z.transformed=!0,Z}function Di(Z,D,F,W,H,ie){return[Math.round(F*(Z*W-H)),Math.round(F*(D*W-ie))]}function gn(Z,D,F,W,H){for(var ie=D===H.maxZoom?0:H.tolerance/((1<<D)*H.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:F,y:W,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},se=0;se<Z.length;se++){ce.numFeatures++,oi(ce,Z[se],ie,H);var ne=Z[se].minX,de=Z[se].minY,Pe=Z[se].maxX,Be=Z[se].maxY;ne<ce.minX&&(ce.minX=ne),de<ce.minY&&(ce.minY=de),Pe>ce.maxX&&(ce.maxX=Pe),Be>ce.maxY&&(ce.maxY=Be)}return ce}function oi(Z,D,F,W){var H=D.geometry,ie=D.type,ce=[];if(ie==="Point"||ie==="MultiPoint")for(var se=0;se<H.length;se+=3)ce.push(H[se]),ce.push(H[se+1]),Z.numPoints++,Z.numSimplified++;else if(ie==="LineString")go(ce,H,Z,F,!1,!1);else if(ie==="MultiLineString"||ie==="Polygon")for(se=0;se<H.length;se++)go(ce,H[se],Z,F,ie==="Polygon",se===0);else if(ie==="MultiPolygon")for(var ne=0;ne<H.length;ne++){var de=H[ne];for(se=0;se<de.length;se++)go(ce,de[se],Z,F,!0,se===0)}if(ce.length){var Pe=D.tags||null;if(ie==="LineString"&&W.lineMetrics){for(var Be in Pe={},D.tags)Pe[Be]=D.tags[Be];Pe.mapbox_clip_start=H.start/H.size,Pe.mapbox_clip_end=H.end/H.size}var Ee={geometry:ce,type:ie==="Polygon"||ie==="MultiPolygon"?3:ie==="LineString"||ie==="MultiLineString"?2:1,tags:Pe};D.id!==null&&(Ee.id=D.id),Z.features.push(Ee)}}function go(Z,D,F,W,H,ie){var ce=W*W;if(W>0&&D.size<(H?ce:W))F.numPoints+=D.length/3;else{for(var se=[],ne=0;ne<D.length;ne+=3)(W===0||D[ne+2]>ce)&&(F.numSimplified++,se.push(D[ne]),se.push(D[ne+1])),F.numPoints++;H&&function(de,Pe){for(var Be=0,Ee=0,at=de.length,ct=at-2;Ee<at;ct=Ee,Ee+=2)Be+=(de[Ee]-de[ct])*(de[Ee+1]+de[ct+1]);if(Be>0===Pe)for(Ee=0,at=de.length;Ee<at/2;Ee+=2){var Ye=de[Ee],yt=de[Ee+1];de[Ee]=de[at-2-Ee],de[Ee+1]=de[at-1-Ee],de[at-2-Ee]=Ye,de[at-1-Ee]=yt}}(se,ie),Z.push(se)}}function Tr(Z,D){var F=(D=this.options=function(H,ie){for(var ce in ie)H[ce]=ie[ce];return H}(Object.create(this.options),D)).debug;if(F&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var W=function(H,ie){var ce=[];if(H.type==="FeatureCollection")for(var se=0;se<H.features.length;se++)Xe(ce,H.features[se],ie,se);else Xe(ce,H.type==="Feature"?H:{geometry:H},ie);return ce}(Z,D);this.tiles={},this.tileCoords=[],F&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),W=function(H,ie){var ce=ie.buffer/ie.extent,se=H,ne=bn(H,1,-1-ce,ce,0,-1,2,ie),de=bn(H,1,1-ce,2+ce,0,-1,2,ie);return(ne||de)&&(se=bn(H,1,-ce,1+ce,0,-1,2,ie)||[],ne&&(se=$r(ne,1).concat(se)),de&&(se=se.concat($r(de,-1)))),se}(W,D),W.length&&this.splitTile(W,0,0,0),F&&(W.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Fo(Z,D,F){return 32*((1<<Z)*F+D)+Z}function No(Z,D){const F=Z.tileID.canonical;if(!this._geoJSONIndex)return D(null,null);const W=this._geoJSONIndex.getTile(F.z,F.x,F.y);if(!W)return D(null,null);const H=new lt(W.features);let ie=dt.exports(H);ie.byteOffset===0&&ie.byteLength===ie.buffer.byteLength||(ie=new Uint8Array(ie)),D(null,{vectorTile:H,rawData:ie.buffer})}Tr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Tr.prototype.splitTile=function(Z,D,F,W,H,ie,ce){for(var se=[Z,D,F,W],ne=this.options,de=ne.debug;se.length;){W=se.pop(),F=se.pop(),D=se.pop(),Z=se.pop();var Pe=1<<D,Be=Fo(D,F,W),Ee=this.tiles[Be];if(!Ee&&(de>1&&console.time("creation"),Ee=this.tiles[Be]=gn(Z,D,F,W,ne),this.tileCoords.push({z:D,x:F,y:W}),de)){de>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,F,W,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));var at="z"+D;this.stats[at]=(this.stats[at]||0)+1,this.total++}if(Ee.source=Z,H){if(D===ne.maxZoom||D===H)continue;var ct=1<<H-D;if(F!==Math.floor(ie/ct)||W!==Math.floor(ce/ct))continue}else if(D===ne.indexMaxZoom||Ee.numPoints<=ne.indexMaxPoints)continue;if(Ee.source=null,Z.length!==0){de>1&&console.time("clipping");var Ye,yt,xt,Wt,Et,zt,Vt=.5*ne.buffer/ne.extent,Jt=.5-Vt,Ui=.5+Vt,gi=1+Vt;Ye=yt=xt=Wt=null,Et=bn(Z,Pe,F-Vt,F+Ui,0,Ee.minX,Ee.maxX,ne),zt=bn(Z,Pe,F+Jt,F+gi,0,Ee.minX,Ee.maxX,ne),Z=null,Et&&(Ye=bn(Et,Pe,W-Vt,W+Ui,1,Ee.minY,Ee.maxY,ne),yt=bn(Et,Pe,W+Jt,W+gi,1,Ee.minY,Ee.maxY,ne),Et=null),zt&&(xt=bn(zt,Pe,W-Vt,W+Ui,1,Ee.minY,Ee.maxY,ne),Wt=bn(zt,Pe,W+Jt,W+gi,1,Ee.minY,Ee.maxY,ne),zt=null),de>1&&console.timeEnd("clipping"),se.push(Ye||[],D+1,2*F,2*W),se.push(yt||[],D+1,2*F,2*W+1),se.push(xt||[],D+1,2*F+1,2*W),se.push(Wt||[],D+1,2*F+1,2*W+1)}}},Tr.prototype.getTile=function(Z,D,F){var W=this.options,H=W.extent,ie=W.debug;if(Z<0||Z>24)return null;var ce=1<<Z,se=Fo(Z,D=(D%ce+ce)%ce,F);if(this.tiles[se])return fs(this.tiles[se],H);ie>1&&console.log("drilling down to z%d-%d-%d",Z,D,F);for(var ne,de=Z,Pe=D,Be=F;!ne&&de>0;)de--,Pe=Math.floor(Pe/2),Be=Math.floor(Be/2),ne=this.tiles[Fo(de,Pe,Be)];return ne&&ne.source?(ie>1&&console.log("found parent tile z%d-%d-%d",de,Pe,Be),ie>1&&console.time("drilling down"),this.splitTile(ne.source,de,Pe,Be,Z,D,F),ie>1&&console.timeEnd("drilling down"),this.tiles[se]?fs(this.tiles[se],H):null):null};class ms extends De{constructor(D,F,W,H){super(D,F,W,No),H&&(this.loadGeoJSON=H)}loadData(D,F){var W;(W=this._pendingRequest)===null||W===void 0||W.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const H=!!(D&&D.request&&D.request.collectResourceTiming)&&new c.RequestPerformance(D.request);this._pendingCallback=F,this._pendingRequest=this.loadGeoJSON(D,(ie,ce)=>{if(delete this._pendingCallback,delete this._pendingRequest,ie||!ce)return F(ie);if(typeof ce!="object")return F(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));{ye(ce,!0);try{if(D.filter){const ne=c.createExpression(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ne.result==="error")throw new Error(ne.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));ce={type:"FeatureCollection",features:ce.features.filter(Pe=>ne.value.evaluate({zoom:0},Pe))}}this._geoJSONIndex=D.cluster?new Ms(function({superclusterOptions:ne,clusterProperties:de}){if(!de||!ne)return ne;const Pe={},Be={},Ee={accumulated:null,zoom:0},at={properties:null},ct=Object.keys(de);for(const Ye of ct){const[yt,xt]=de[Ye],Wt=c.createExpression(xt),Et=c.createExpression(typeof yt=="string"?[yt,["accumulated"],["get",Ye]]:yt);Pe[Ye]=Wt.value,Be[Ye]=Et.value}return ne.map=Ye=>{at.properties=Ye;const yt={};for(const xt of ct)yt[xt]=Pe[xt].evaluate(Ee,at);return yt},ne.reduce=(Ye,yt)=>{at.properties=yt;for(const xt of ct)Ee.accumulated=Ye[xt],Ye[xt]=Be[xt].evaluate(Ee,at)},ne}(D)).load(ce.features):function(ne,de){return new Tr(ne,de)}(ce,D.geojsonVtOptions)}catch(ne){return F(ne)}this.loaded={};const se={};if(H){const ne=H.finish();ne&&(se.resourceTiming={},se.resourceTiming[D.source]=JSON.parse(JSON.stringify(ne)))}F(null,se)}})}reloadTile(D,F){const W=this.loaded;return W&&W[D.uid]?super.reloadTile(D,F):this.loadTile(D,F)}loadGeoJSON(D,F){if(D.request)return c.getJSON(D.request,F);if(typeof D.data=="string")try{F(null,JSON.parse(D.data))}catch{F(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`))}else F(new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(D,F){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),F()}getClusterExpansionZoom(D,F){try{F(null,this._geoJSONIndex.getClusterExpansionZoom(D.clusterId))}catch(W){F(W)}}getClusterChildren(D,F){try{F(null,this._geoJSONIndex.getChildren(D.clusterId))}catch(W){F(W)}}getClusterLeaves(D,F){try{F(null,this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset))}catch(W){F(W)}}}class nn{constructor(D){this.self=D,this.actor=new c.Actor(D,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:De,geojson:ms},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(F,W)=>{if(this.workerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.workerSourceTypes[F]=W},this.self.registerRTLTextPlugin=F=>{if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=F.applyArabicShaping,c.plugin.processBidirectionalText=F.processBidirectionalText,c.plugin.processStyledBidirectionalText=F.processStyledBidirectionalText}}setReferrer(D,F){this.referrer=F}setImages(D,F,W){this.availableImages[D]=F;for(const H in this.workerSources[D]){const ie=this.workerSources[D][H];for(const ce in ie)ie[ce].availableImages=F}W()}setLayers(D,F,W){this.getLayerIndex(D).replace(F),W()}updateLayers(D,F,W){this.getLayerIndex(D).update(F.layers,F.removedIds),W()}loadTile(D,F,W){this.getWorkerSource(D,F.type,F.source).loadTile(F,W)}loadDEMTile(D,F,W){this.getDEMWorkerSource(D,F.source).loadTile(F,W)}reloadTile(D,F,W){this.getWorkerSource(D,F.type,F.source).reloadTile(F,W)}abortTile(D,F,W){this.getWorkerSource(D,F.type,F.source).abortTile(F,W)}removeTile(D,F,W){this.getWorkerSource(D,F.type,F.source).removeTile(F,W)}removeDEMTile(D,F){this.getDEMWorkerSource(D,F.source).removeTile(F)}removeSource(D,F,W){if(!this.workerSources[D]||!this.workerSources[D][F.type]||!this.workerSources[D][F.type][F.source])return;const H=this.workerSources[D][F.type][F.source];delete this.workerSources[D][F.type][F.source],H.removeSource!==void 0?H.removeSource(F,W):W()}loadWorkerSource(D,F,W){try{this.self.importScripts(F.url),W()}catch(H){W(H.toString())}}syncRTLPluginState(D,F,W){try{c.plugin.setState(F);const H=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&H!=null){this.self.importScripts(H);const ie=c.plugin.isParsed();W(ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${H}`),ie)}}catch(H){W(H.toString())}}getAvailableImages(D){let F=this.availableImages[D];return F||(F=[]),F}getLayerIndex(D){let F=this.layerIndexes[D];return F||(F=this.layerIndexes[D]=new Ie),F}getWorkerSource(D,F,W){if(this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][F]||(this.workerSources[D][F]={}),!this.workerSources[D][F][W]){const H={send:(ie,ce,se)=>{this.actor.send(ie,ce,se,D)}};this.workerSources[D][F][W]=new this.workerSourceTypes[F](H,this.getLayerIndex(D),this.getAvailableImages(D))}return this.workerSources[D][F][W]}getDEMWorkerSource(D,F){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][F]||(this.demWorkerSources[D][F]=new Qt),this.demWorkerSources[D][F]}enforceCacheSizeLimit(D,F){c.enforceCacheSizeLimit(F)}}return c.isWorker()&&(self.worker=new nn(self)),nn}),b(["./shared"],function(c){var q=le;function le(f){return!function(i){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var h,_,v=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(v);try{_=new Worker(T),h=!0}catch{h=!1}return _&&_.terminate(),URL.revokeObjectURL(T),h}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var h=document.createElement("canvas");h.width=h.height=1;var _=h.getContext("2d");if(!_)return!1;var v=_.getImageData(0,0,1,1);return v&&v.width===h.width}()?(Ie[a=i&&i.failIfMajorPerformanceCaveat]===void 0&&(Ie[a]=function(h){var _,v=function(T){var C=document.createElement("canvas"),I=Object.create(le.webGLContextAttributes);return I.failIfMajorPerformanceCaveat=T,C.getContext("webgl",I)||C.getContext("experimental-webgl",I)}(h);if(!v)return!1;try{_=v.createShader(v.VERTEX_SHADER)}catch{return!1}return!(!_||v.isContextLost())&&(v.shaderSource(_,"void main() {}"),v.compileShader(_),v.getShaderParameter(_,v.COMPILE_STATUS)===!0)}(a)),Ie[a]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var a}(f)}var Ie={};function ge(f,i){if(Array.isArray(f)){if(!Array.isArray(i)||f.length!==i.length)return!1;for(let a=0;a<f.length;a++)if(!ge(f[a],i[a]))return!1;return!0}if(typeof f=="object"&&f!==null&&i!==null){if(typeof i!="object"||Object.keys(f).length!==Object.keys(i).length)return!1;for(const a in f)if(!ge(f[a],i[a]))return!1;return!0}return f===i}le.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class K{static testProp(i){if(!K.docStyle)return i[0];for(let a=0;a<i.length;a++)if(i[a]in K.docStyle)return i[a];return i[0]}static create(i,a,h){const _=window.document.createElement(i);return a!==void 0&&(_.className=a),h&&h.appendChild(_),_}static createNS(i,a){return window.document.createElementNS(i,a)}static disableDrag(){K.docStyle&&K.selectProp&&(K.userSelect=K.docStyle[K.selectProp],K.docStyle[K.selectProp]="none")}static enableDrag(){K.docStyle&&K.selectProp&&(K.docStyle[K.selectProp]=K.userSelect)}static setTransform(i,a){i.style[K.transformProp]=a}static addEventListener(i,a,h,_={}){i.addEventListener(a,h,"passive"in _?_:_.capture)}static removeEventListener(i,a,h,_={}){i.removeEventListener(a,h,"passive"in _?_:_.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",K.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",K.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",K.suppressClickInternal,!0)},0)}static mousePos(i,a){const h=i.getBoundingClientRect();return new c.pointGeometry(a.clientX-h.left-i.clientLeft,a.clientY-h.top-i.clientTop)}static touchPos(i,a){const h=i.getBoundingClientRect(),_=[];for(let v=0;v<a.length;v++)_.push(new c.pointGeometry(a[v].clientX-h.left-i.clientLeft,a[v].clientY-h.top-i.clientTop));return _}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}}K.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,K.selectProp=K.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),K.transformProp=K.testProp(["transform","WebkitTransform"]);class Ze{constructor(i){this._transformRequestFn=i}transformRequest(i,a){return this._transformRequestFn&&this._transformRequestFn(i,a)||{url:i}}normalizeSpriteURL(i,a,h){const _=function(v){const T=v.match(Ve);if(!T)throw new Error(`Unable to parse URL "${v}"`);return{protocol:T[1],authority:T[2],path:T[3]||"/",params:T[4]?T[4].split("&"):[]}}(i);return _.path+=`${a}${h}`,function(v){const T=v.params.length?`?${v.params.join("&")}`:"";return`${v.protocol}://${v.authority}${v.path}${T}`}(_)}setTransformRequest(i){this._transformRequestFn=i}}const Ve=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class De{constructor(i,a,h,_){this.context=i,this.format=h,this.texture=i.gl.createTexture(),this.update(a,_)}update(i,a,h){const{width:_,height:v}=i,T=!(this.size&&this.size[0]===_&&this.size[1]===v||h),{context:C}=this,{gl:I}=C;if(this.useMipmap=Boolean(a&&a.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!a||a.premultiply!==!1)),T)this.size=[_,v],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.isImageBitmap(i)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,i):I.texImage2D(I.TEXTURE_2D,0,this.format,_,v,0,this.format,I.UNSIGNED_BYTE,i.data);else{const{x:z,y:B}=h||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||c.isImageBitmap(i)?I.texSubImage2D(I.TEXTURE_2D,0,z,B,I.RGBA,I.UNSIGNED_BYTE,i):I.texSubImage2D(I.TEXTURE_2D,0,z,B,_,v,I.RGBA,I.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)}bind(i,a,h){const{context:_}=this,{gl:v}=_;v.bindTexture(v.TEXTURE_2D,this.texture),h!==v.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=v.LINEAR),i!==this.filter&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MAG_FILTER,i),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_MIN_FILTER,h||i),this.filter=i),a!==this.wrap&&(v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,a),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}function Qt(f){const{userImage:i}=f;return!!(i&&i.render&&i.render())&&(f.data.replace(new Uint8Array(i.data.buffer)),!0)}class ye extends c.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:a,callback:h}of this.requestors)this._notify(a,h);this.requestors=[]}}getImage(i){return this.images[i]}addImage(i,a){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,a)&&(this.images[i]=a)}_validate(i,a){let h=!0;return this._validateStretch(a.stretchX,a.data&&a.data.width)||(this.fire(new c.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),h=!1),this._validateStretch(a.stretchY,a.data&&a.data.height)||(this.fire(new c.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),h=!1),this._validateContent(a.content,a)||(this.fire(new c.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),h=!1),h}_validateStretch(i,a){if(!i)return!0;let h=0;for(const _ of i){if(_[0]<h||_[1]<_[0]||a<_[1])return!1;h=_[1]}return!0}_validateContent(i,a){return!(i&&(i.length!==4||i[0]<0||a.data.width<i[0]||i[1]<0||a.data.height<i[1]||i[2]<0||a.data.width<i[2]||i[3]<0||a.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,a){const h=this.images[i];if(h.data.width!==a.data.width||h.data.height!==a.data.height)throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=h.version+1,this.images[i]=a,this.updatedImages[i]=!0}removeImage(i){const a=this.images[i];delete this.images[i],delete this.patterns[i],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,a){let h=!0;if(!this.isLoaded())for(const _ of i)this.images[_]||(h=!1);this.isLoaded()||h?this._notify(i,a):this.requestors.push({ids:i,callback:a})}_notify(i,a){const h={};for(const _ of i){this.images[_]||this.fire(new c.Event("styleimagemissing",{id:_}));const v=this.images[_];v?h[_]={data:v.data.clone(),pixelRatio:v.pixelRatio,sdf:v.sdf,version:v.version,stretchX:v.stretchX,stretchY:v.stretchY,content:v.content,hasRenderCallback:Boolean(v.userImage&&v.userImage.render)}:c.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}a(null,h)}getPixelSize(){const{width:i,height:a}=this.atlasImage;return{width:i,height:a}}getPattern(i){const a=this.patterns[i],h=this.getImage(i);if(!h)return null;if(a&&a.position.version===h.version)return a.position;if(a)a.position.version=h.version;else{const _={w:h.data.width+2,h:h.data.height+2,x:0,y:0},v=new c.ImagePosition(_,h);this.patterns[i]={bin:_,position:v}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const a=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new De(i,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const v in this.patterns)i.push(this.patterns[v].bin);const{w:a,h}=c.potpack(i),_=this.atlasImage;_.resize({width:a||1,height:h||1});for(const v in this.patterns){const{bin:T}=this.patterns[v],C=T.x+1,I=T.y+1,z=this.images[v].data,B=z.width,N=z.height;c.RGBAImage.copy(z,_,{x:0,y:0},{x:C,y:I},{width:B,height:N}),c.RGBAImage.copy(z,_,{x:0,y:N-1},{x:C,y:I-1},{width:B,height:1}),c.RGBAImage.copy(z,_,{x:0,y:0},{x:C,y:I+N},{width:B,height:1}),c.RGBAImage.copy(z,_,{x:B-1,y:0},{x:C-1,y:I},{width:1,height:N}),c.RGBAImage.copy(z,_,{x:0,y:0},{x:C+B,y:I},{width:1,height:N})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const a of i){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const h=this.images[a];h||c.warnOnce(`Image with ID: "${a}" was not found`),Qt(h)&&this.updateImage(a,h)}}}const ue=1e20;function me(f,i,a,h,_,v,T,C,I){for(let z=i;z<i+h;z++)Ue(f,a*v+z,v,_,T,C,I);for(let z=a;z<a+_;z++)Ue(f,z*v+i,1,h,T,C,I)}function Ue(f,i,a,h,_,v,T){v[0]=0,T[0]=-ue,T[1]=ue,_[0]=f[i];for(let C=1,I=0,z=0;C<h;C++){_[C]=f[i+C*a];const B=C*C;do{const N=v[I];z=(_[C]-_[N]+B-N*N)/(C-N)/2}while(z<=T[I]&&--I>-1);I++,v[I]=C,T[I]=z,T[I+1]=ue}for(let C=0,I=0;C<h;C++){for(;T[I+1]<C;)I++;const z=v[I],B=C-z;f[i+C*a]=_[z]+B*B}}class $e{constructor(i,a){this.requestManager=i,this.localIdeographFontFamily=a,this.entries={}}setURL(i){this.url=i}getGlyphs(i,a){const h=[];for(const _ in i)for(const v of i[_])h.push({stack:_,id:v});c.asyncAll(h,({stack:_,id:v},T)=>{let C=this.entries[_];C||(C=this.entries[_]={glyphs:{},requests:{},ranges:{}});let I=C.glyphs[v];if(I!==void 0)return void T(null,{stack:_,id:v,glyph:I});if(I=this._tinySDF(C,_,v),I)return C.glyphs[v]=I,void T(null,{stack:_,id:v,glyph:I});const z=Math.floor(v/256);if(256*z>65535)return void T(new Error("glyphs > 65535 not supported"));if(C.ranges[z])return void T(null,{stack:_,id:v,glyph:I});let B=C.requests[z];B||(B=C.requests[z]=[],$e.loadGlyphRange(_,z,this.url,this.requestManager,(N,G)=>{if(G){for(const Y in G)this._doesCharSupportLocalGlyph(+Y)||(C.glyphs[+Y]=G[+Y]);C.ranges[z]=!0}for(const Y of B)Y(N,G);delete C.requests[z]})),B.push((N,G)=>{N?T(N):G&&T(null,{stack:_,id:v,glyph:G[v]||null})})},(_,v)=>{if(_)a(_);else if(v){const T={};for(const{stack:C,id:I,glyph:z}of v)(T[C]||(T[C]={}))[I]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};a(null,T)}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(c.unicodeBlockLookup["CJK Unified Ideographs"](i)||c.unicodeBlockLookup["Hangul Syllables"](i)||c.unicodeBlockLookup.Hiragana(i)||c.unicodeBlockLookup.Katakana(i))}_tinySDF(i,a,h){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(h))return;let v=i.tinySDF;if(!v){let C="400";/bold/i.test(a)?C="900":/medium/i.test(a)?C="500":/light/i.test(a)&&(C="200"),v=i.tinySDF=new $e.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:_,fontWeight:C})}const T=v.draw(String.fromCharCode(h));return{id:h,bitmap:new c.AlphaImage({width:T.width||30,height:T.height||30},T.data),metrics:{width:T.glyphWidth||24,height:T.glyphHeight||24,left:T.glyphLeft||0,top:T.glyphTop-27||-8,advance:T.glyphAdvance||24}}}}$e.loadGlyphRange=function(f,i,a,h,_){const v=256*i,T=v+255,C=h.transformRequest(a.replace("{fontstack}",f).replace("{range}",`${v}-${T}`),c.ResourceType.Glyphs);c.getArrayBuffer(C,(I,z)=>{if(I)_(I);else if(z){const B={};for(const N of c.parseGlyphPbf(z))B[N.id]=N;_(null,B)}})},$e.TinySDF=class{constructor({fontSize:f=24,buffer:i=3,radius:a=8,cutoff:h=.25,fontFamily:_="sans-serif",fontWeight:v="normal",fontStyle:T="normal"}={}){this.buffer=i,this.cutoff=h,this.radius=a;const C=this.size=f+4*i,I=this._createCanvas(C),z=this.ctx=I.getContext("2d",{willReadFrequently:!0});z.font=`${T} ${v} ${f}px ${_}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Uint16Array(C)}_createCanvas(f){const i=document.createElement("canvas");return i.width=i.height=f,i}draw(f){const{width:i,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:_,actualBoundingBoxRight:v}=this.ctx.measureText(f),T=Math.ceil(a),C=Math.min(this.size-this.buffer,Math.ceil(v-_)),I=Math.min(this.size-this.buffer,T+Math.ceil(h)),z=C+2*this.buffer,B=I+2*this.buffer,N=Math.max(z*B,0),G=new Uint8ClampedArray(N),Y={data:G,width:z,height:B,glyphWidth:C,glyphHeight:I,glyphTop:T,glyphLeft:0,glyphAdvance:i};if(C===0||I===0)return Y;const{ctx:X,buffer:J,gridInner:ae,gridOuter:pe}=this;X.clearRect(J,J,C,I),X.fillText(f,J,J+T);const ve=X.getImageData(J,J,C,I);pe.fill(ue,0,N),ae.fill(0,0,N);for(let Q=0;Q<I;Q++)for(let be=0;be<C;be++){const xe=ve.data[4*(Q*C+be)+3]/255;if(xe===0)continue;const Ae=(Q+J)*z+be+J;if(xe===1)pe[Ae]=0,ae[Ae]=ue;else{const ze=.5-xe;pe[Ae]=ze>0?ze*ze:0,ae[Ae]=ze<0?ze*ze:0}}me(pe,0,0,z,B,z,this.f,this.v,this.z),me(ae,J,J,C,I,z,this.f,this.v,this.z);for(let Q=0;Q<N;Q++){const be=Math.sqrt(pe[Q])-Math.sqrt(ae[Q]);G[Q]=Math.round(255-255*(be/this.radius+this.cutoff))}return Y}};const lt=new c.Properties({anchor:new c.DataConstantProperty(c.spec.light.anchor),position:new class{constructor(){this.specification=c.spec.light.position}possiblyEvaluate(f,i){return c.sphericalToCartesian(f.expression.evaluate(i))}interpolate(f,i,a){return{x:c.number(f.x,i.x,a),y:c.number(f.y,i.y,a),z:c.number(f.z,i.z,a)}}},color:new c.DataConstantProperty(c.spec.light.color),intensity:new c.DataConstantProperty(c.spec.light.intensity)}),dt="-transition";class pt extends c.Evented{constructor(i){super(),this._transitionable=new c.Transitionable(lt),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,a={}){if(!this._validate(c.validateLight,i,a))for(const h in i){const _=i[h];h.endsWith(dt)?this._transitionable.setTransition(h.slice(0,-dt.length),_):this._transitionable.setValue(h,_)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,a,h){return(!h||h.validate!==!1)&&c.emitValidationErrors(this,i.call(c.validateStyle,c.extend({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.spec})))}}class ci{constructor(i,a){this.width=i,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,a){const h=i.join(",")+String(a);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(i,a)),this.dashEntry[h]}getDashRanges(i,a,h){const _=[];let v=i.length%2==1?-i[i.length-1]*h:0,T=i[0]*h,C=!0;_.push({left:v,right:T,isDash:C,zeroLength:i[0]===0});let I=i[0];for(let z=1;z<i.length;z++){C=!C;const B=i[z];v=I*h,I+=B,T=I*h,_.push({left:v,right:T,isDash:C,zeroLength:B===0})}return _}addRoundDash(i,a,h){const _=a/2;for(let v=-h;v<=h;v++){const T=this.width*(this.nextRow+h+v);let C=0,I=i[C];for(let z=0;z<this.width;z++){z/I.right>1&&(I=i[++C]);const B=Math.abs(z-I.left),N=Math.abs(z-I.right),G=Math.min(B,N);let Y;const X=v/h*(_+1);if(I.isDash){const J=_-Math.abs(X);Y=Math.sqrt(G*G+J*J)}else Y=_-Math.sqrt(G*G+X*X);this.data[T+z]=Math.max(0,Math.min(255,Y+128))}}}addRegularDash(i){for(let C=i.length-1;C>=0;--C){const I=i[C],z=i[C+1];I.zeroLength?i.splice(C,1):z&&z.isDash===I.isDash&&(z.left=I.left,i.splice(C,1))}const a=i[0],h=i[i.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const _=this.width*this.nextRow;let v=0,T=i[v];for(let C=0;C<this.width;C++){C/T.right>1&&(T=i[++v]);const I=Math.abs(C-T.left),z=Math.abs(C-T.right),B=Math.min(I,z);this.data[_+C]=Math.max(0,Math.min(255,(T.isDash?B:-B)+128))}}addDash(i,a){const h=a?7:0,_=2*h+1;if(this.nextRow+_>this.height)return c.warnOnce("LineAtlas out of space"),null;let v=0;for(let C=0;C<i.length;C++)v+=i[C];if(v!==0){const C=this.width/v,I=this.getDashRanges(i,this.width,C);a?this.addRoundDash(I,C,h):this.addRegularDash(I)}const T={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:v};return this.nextRow+=_,this.dirty=!0,T}bind(i){const a=i.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}class Ct{constructor(i,a){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=c.uniqueId();const h=this.workerPool.acquire(this.id);for(let _=0;_<h.length;_++){const v=new Ct.Actor(h[_],a,this.id);v.name=`Worker ${_}`,this.actors.push(v)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,a,h){c.asyncAll(this.actors,(_,v)=>{_.send(i,a,v)},h=h||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function ei(f,i,a){const h=function(_,v){if(_)return a(_);if(v){const T=c.pick(c.extend(v,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);v.vector_layers&&(T.vectorLayers=v.vector_layers,T.vectorLayerIds=T.vectorLayers.map(C=>C.id)),a(null,T)}};return f.url?c.getJSON(i.transformRequest(f.url,c.ResourceType.Source),h):c.exported.frame(()=>h(null,f))}Ct.Actor=c.Actor;class _i{constructor(i,a,h){this.bounds=c.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=a||0,this.maxzoom=h||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const a=Math.pow(2,i.z),h=Math.floor(c.mercatorXfromLng(this.bounds.getWest())*a),_=Math.floor(c.mercatorYfromLat(this.bounds.getNorth())*a),v=Math.ceil(c.mercatorXfromLng(this.bounds.getEast())*a),T=Math.ceil(c.mercatorYfromLat(this.bounds.getSouth())*a);return i.x>=h&&i.x<v&&i.y>=_&&i.y<T}}class $n extends c.Evented{constructor(i,a,h,_){if(super(),this.id=i,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.extend(this,c.pick(a,["url","scheme","tileSize","promoteId"])),this._options=c.extend({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ei(this._options,this.map._requestManager,(i,a)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i?this.fire(new c.ErrorEvent(i)):a&&(c.extend(this,a),a.bounds&&(this.tileBounds=new _i(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.cancel(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return c.extend({},this._options)}loadTile(i,a){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_={request:this.map._requestManager.transformRequest(h,c.ResourceType.Tile),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function v(T,C){return delete i.request,i.aborted?a(null):T&&T.status!==404?a(T):(C&&C.resourceTiming&&(i.resourceTiming=C.resourceTiming),this.map._refreshExpiredTiles&&C&&i.setExpiryData(C),i.loadVectorData(C,this.map.painter),c.cacheEntryPossiblyAdded(this.dispatcher),a(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired"?i.state==="loading"?i.reloadCallback=a:i.request=i.actor.send("reloadTile",_,v.bind(this)):(i.actor=this.dispatcher.getActor(),i.request=i.actor.send("loadTile",_,v.bind(this)))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id},void 0)}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Ni extends c.Evented{constructor(i,a,h,_){super(),this.id=i,this.dispatcher=h,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.extend({type:"raster"},a),c.extend(this,c.pick(a,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ei(this._options,this.map._requestManager,(i,a)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new c.ErrorEvent(i)):a&&(c.extend(this,a),a.bounds&&(this.tileBounds=new _i(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return c.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,a){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.request=c.getImage(this.map._requestManager.transformRequest(h,c.ResourceType.Tile),(_,v,T)=>{if(delete i.request,i.aborted)i.state="unloaded",a(null);else if(_)i.state="errored",a(_);else if(v){this.map._refreshExpiredTiles&&i.setExpiryData(T);const C=this.map.painter.context,I=C.gl;i.texture=this.map.painter.getTileTexture(v.width),i.texture?i.texture.update(v,{useMipmap:!0}):(i.texture=new De(C,v,I.RGBA,{useMipmap:!0}),i.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),C.extTextureFilterAnisotropic&&I.texParameterf(I.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax)),i.state="loaded",c.cacheEntryPossiblyAdded(this.dispatcher),a(null)}})}abortTile(i,a){i.request&&(i.request.cancel(),delete i.request),a()}unloadTile(i,a){i.texture&&this.map.painter.saveTileTexture(i.texture),a()}hasTransition(){return!1}}let xr;class ut extends Ni{constructor(i,a,h,_){super(i,a,h,_),this.type="raster-dem",this.maxzoom=22,this._options=c.extend({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(i,a){const h=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function _(v,T){v&&(i.state="errored",a(v)),T&&(i.dem=T,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded",a(null))}i.request=c.getImage(this.map._requestManager.transformRequest(h,c.ResourceType.Tile),function(v,T){if(delete i.request,i.aborted)i.state="unloaded",a(null);else if(v)i.state="errored",a(v);else if(T){this.map._refreshExpiredTiles&&i.setExpiryData(T),delete T.cacheControl,delete T.expires;const C=c.isImageBitmap(T)&&(xr==null&&(xr=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),xr)?T:c.exported.getImageData(T,1),I={uid:i.uid,coord:i.tileID,source:this.id,rawImageData:C,encoding:this.encoding};i.actor&&i.state!=="expired"||(i.actor=this.dispatcher.getActor(),i.actor.send("loadDEMTile",I,_.bind(this)))}}.bind(this)),i.neighboringTiles=this._getNeighboringTiles(i.tileID)}_getNeighboringTiles(i){const a=i.canonical,h=Math.pow(2,a.z),_=(a.x-1+h)%h,v=a.x===0?i.wrap-1:i.wrap,T=(a.x+1+h)%h,C=a.x+1===h?i.wrap+1:i.wrap,I={};return I[new c.OverscaledTileID(i.overscaledZ,v,a.z,_,a.y).key]={backfilled:!1},I[new c.OverscaledTileID(i.overscaledZ,C,a.z,T,a.y).key]={backfilled:!1},a.y>0&&(I[new c.OverscaledTileID(i.overscaledZ,v,a.z,_,a.y-1).key]={backfilled:!1},I[new c.OverscaledTileID(i.overscaledZ,i.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},I[new c.OverscaledTileID(i.overscaledZ,C,a.z,T,a.y-1).key]={backfilled:!1}),a.y+1<h&&(I[new c.OverscaledTileID(i.overscaledZ,v,a.z,_,a.y+1).key]={backfilled:!1},I[new c.OverscaledTileID(i.overscaledZ,i.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},I[new c.OverscaledTileID(i.overscaledZ,C,a.z,T,a.y+1).key]={backfilled:!1}),I}unloadTile(i){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&i.actor.send("removeDEMTile",{uid:i.uid,source:this.id})}}class Ji extends c.Evented{constructor(i,a,h,_){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=h.getActor(),this.setEventedParent(_),this._data=a.data,this._options=c.extend({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const v=c.EXTENT/this.tileSize;this.workerOptions=c.extend({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*v,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*v,extent:c.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.EXTENT,radius:(a.clusterRadius||50)*v,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._updateWorkerData("content"),this}getClusterExpansionZoom(i,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:i,source:this.id},a),this}getClusterChildren(i,a){return this.actor.send("geojson.getClusterChildren",{clusterId:i,source:this.id},a),this}getClusterLeaves(i,a,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:i,limit:a,offset:h},_),this}_updateWorkerData(i){const a=c.extend({},this.workerOptions),h=this._data;typeof h=="string"?(a.request=this.map._requestManager.transformRequest(c.exported.resolveURL(h),c.ResourceType.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(h),this._pendingLoads++,this.fire(new c.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,a,(_,v)=>{if(this._pendingLoads--,this._removed||v&&v.abandoned)return void this.fire(new c.Event("dataabort",{dataType:"source",sourceDataType:i}));let T=null;if(v&&v.resourceTiming&&v.resourceTiming[this.id]&&(T=v.resourceTiming[this.id].slice(0)),_)return void this.fire(new c.ErrorEvent(_));const C={dataType:"source",sourceDataType:i};this._collectResourceTiming&&T&&T.length>0&&c.extend(C,{resourceTiming:T}),this.fire(new c.Event("data",C))})}loaded(){return this._pendingLoads===0}loadTile(i,a){const h=i.actor?"reloadTile":"loadTile";i.actor=this.actor;const _={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};i.request=this.actor.send(h,_,(v,T)=>(delete i.request,i.unloadVectorData(),i.aborted?a(null):v?a(v):(i.loadVectorData(T,this.map.painter,h==="reloadTile"),a(null))))}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.aborted=!0}unloadTile(i){i.unloadVectorData(),this.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return c.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Re=c.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class vt extends c.Evented{constructor(i,a,h,_){super(),this.id=i,this.dispatcher=h,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=a}load(i,a){this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this.url=this.options.url,c.getImage(this.map._requestManager.transformRequest(this.url,c.ResourceType.Image),(h,_)=>{this._loaded=!0,h?this.fire(new c.ErrorEvent(h)):_&&(this.image=_,i&&(this.coordinates=i),a&&a(),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}setCoordinates(i){this.coordinates=i;const a=i.map(c.MercatorCoordinate.fromLngLat);this.tileID=function(_){let v=1/0,T=1/0,C=-1/0,I=-1/0;for(const G of _)v=Math.min(v,G.x),T=Math.min(T,G.y),C=Math.max(C,G.x),I=Math.max(I,G.y);const z=Math.max(C-v,I-T),B=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),N=Math.pow(2,B);return new c.CanonicalTileID(B,Math.floor((v+C)/2*N),Math.floor((T+I)/2*N))}(a),this.minzoom=this.maxzoom=this.tileID.z;const h=a.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new c.RasterBoundsArray,this._boundsArray.emplaceBack(h[0].x,h[0].y,0,0),this._boundsArray.emplaceBack(h[1].x,h[1].y,c.EXTENT,0),this._boundsArray.emplaceBack(h[3].x,h[3].y,0,c.EXTENT),this._boundsArray.emplaceBack(h[2].x,h[2].y,c.EXTENT,c.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,a=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Re.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new De(i,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));for(const h in this.tiles){const _=this.tiles[h];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}loadTile(i,a){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},a(null)):(i.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ge extends vt{constructor(i,a,h,_){super(i,a,h,_),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const i=this.options;this.urls=[];for(const a of i.urls)this.urls.push(this.map._requestManager.transformRequest(a,c.ResourceType.Source).url);c.getVideo(this.urls,(a,h)=>{this._loaded=!0,a?this.fire(new c.ErrorEvent(a)):h&&(this.video=h,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const a=this.video.seekable;i<a.start(0)||i>a.end(0)?this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,a=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,Re.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new De(i,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));for(const h in this.tiles){const _=this.tiles[h];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Tt extends vt{constructor(i,a,h,_){super(i,a,h,_),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(T=>typeof T!="number"))||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${i}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.ErrorEvent(new c.ValidationError(`sources.${i}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,h=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Re.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new De(a,this.canvas,h.RGBA,{premultiply:!0});for(const _ in this.tiles){const v=this.tiles[_];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const Ut={vector:$n,raster:Ni,"raster-dem":ut,geojson:Ji,video:Ge,image:vt,canvas:Tt};function bi(f,i){const a=c.create();return c.translate(a,a,[1,1,0]),c.scale(a,a,[.5*f.width,.5*f.height,1]),c.multiply(a,a,f.calculatePosMatrix(i.toUnwrapped()))}function ni(f,i,a,h,_,v){const T=function(N,G,Y){if(N)for(const X of N){const J=G[X];if(J&&J.source===Y&&J.type==="fill-extrusion")return!0}else for(const X in G){const J=G[X];if(J.source===Y&&J.type==="fill-extrusion")return!0}return!1}(_&&_.layers,i,f.id),C=v.maxPitchScaleFactor(),I=f.tilesIn(h,C,T);I.sort(Lt);const z=[];for(const N of I)z.push({wrappedTileID:N.tileID.wrapped().key,queryResults:N.tile.queryRenderedFeatures(i,a,f._state,N.queryGeometry,N.cameraQueryGeometry,N.scale,_,v,C,bi(f.transform,N.tileID))});const B=function(N){const G={},Y={};for(const X of N){const J=X.queryResults,ae=X.wrappedTileID,pe=Y[ae]=Y[ae]||{};for(const ve in J){const Q=J[ve],be=pe[ve]=pe[ve]||{},xe=G[ve]=G[ve]||[];for(const Ae of Q)be[Ae.featureIndex]||(be[Ae.featureIndex]=!0,xe.push(Ae))}}return G}(z);for(const N in B)B[N].forEach(G=>{const Y=G.feature,X=f.getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=X});return B}function Lt(f,i){const a=f.tileID,h=i.tileID;return a.overscaledZ-h.overscaledZ||a.canonical.y-h.canonical.y||a.wrap-h.wrap||a.canonical.x-h.canonical.x}class Dt{constructor(i,a){this.tileID=i,this.uid=c.uniqueId(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(i){const a=i+this.timeAdded;a<c.exported.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.textures.forEach(a=>i.saveTileTexture(a)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(i,a,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(_,v){const T={};if(!v)return T;for(const C of _){const I=C.layerIds.map(z=>v.getLayer(z)).filter(Boolean);if(I.length!==0){C.layers=I,C.stateDependentLayerIds&&(C.stateDependentLayers=C.stateDependentLayerIds.map(z=>I.filter(B=>B.id===z)[0]));for(const z of I)T[z.id]=C}}return T}(i.buckets,a.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof c.SymbolBucket){if(this.hasSymbolBuckets=!0,!h)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const v=this.buckets[_];if(v instanceof c.SymbolBucket&&v.hasRTLText){this.hasRTLText=!0,c.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const _ in this.buckets){const v=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(_).queryRadius(v))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage)}else this.collisionBoxArray=new c.CollisionBoxArray}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const h in this.buckets){const _=this.buckets[h];_.uploadPending()&&_.upload(i)}const a=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new De(i,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new De(i,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,a,h,_,v,T,C,I,z,B){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:v,scale:T,tileSize:this.tileSize,pixelPosMatrix:B,transform:I,params:C,queryPadding:this.queryPadding*z},i,a,h):{}}querySourceFeatures(i,a){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const _=h.loadVTLayers(),v=a?a.sourceLayer:"",T=_._geojsonTileLayer||_[v];if(!T)return;const C=c.createFilter(a&&a.filter),{z:I,x:z,y:B}=this.tileID.canonical,N={z:I,x:z,y:B};for(let G=0;G<T.length;G++){const Y=T.feature(G);if(C.needGeometry){const ae=c.toEvaluationFeature(Y,!0);if(!C.filter(new c.EvaluationParameters(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!C.filter(new c.EvaluationParameters(this.tileID.overscaledZ),Y))continue;const X=h.getId(Y,v),J=new c.GeoJSONFeature(Y,I,z,B,X);J.tile=N,i.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const a=this.expirationTime;if(i.cacheControl){const h=c.parseCacheControl(i.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const h=Date.now();let _=!1;if(this.expirationTime>h)_=!1;else if(a)if(this.expirationTime<a)_=!0;else{const v=this.expirationTime-a;v?this.expirationTime=h+Math.max(v,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!a.style.hasLayer(_))continue;const v=this.buckets[_],T=v.layers[0].sourceLayer||"_geojsonTileLayer",C=h[T],I=i[T];if(!C||!I||Object.keys(I).length===0)continue;v.update(I,C,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=a&&a.style&&a.style.getLayer(_);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(v)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<c.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=c.exported.now()+i}setDependencies(i,a){const h={};for(const _ of a)h[_]=!0;this.dependencies[i]=h}hasDependency(i,a){for(const h of i){const _=this.dependencies[h];if(_){for(const v of a)if(_[v])return!0}}return!1}}class Ai{constructor(i,a){this.max=i,this.onRemove=a,this.reset()}reset(){for(const i in this.data)for(const a of this.data[i])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(i,a,h){const _=i.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const v={value:a,timeout:void 0};if(h!==void 0&&(v.timeout=setTimeout(()=>{this.remove(i,v)},h)),this.data[_].push(v),this.order.push(_),this.order.length>this.max){const T=this._getAndRemoveByKey(this.order[0]);T&&this.onRemove(T)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const a=this.data[i].shift();return a.timeout&&clearTimeout(a.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),a.value}getByKey(i){const a=this.data[i];return a?a[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,a){if(!this.has(i))return this;const h=i.wrapped().key,_=a===void 0?0:this.data[h].indexOf(a),v=this.data[h][_];return this.data[h].splice(_,1),v.timeout&&clearTimeout(v.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(v.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(i){const a=[];for(const h in this.data)for(const _ of this.data[h])i(_.value)||a.push(_);for(const h of a)this.remove(h.value.tileID,h)}}class pn{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,a,h){const _=String(a);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][_]=this.stateChanges[i][_]||{},c.extend(this.stateChanges[i][_],h),this.deletedStates[i]===null){this.deletedStates[i]={};for(const v in this.state[i])v!==_&&(this.deletedStates[i][v]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][_]===null){this.deletedStates[i][_]={};for(const v in this.state[i][_])h[v]||(this.deletedStates[i][_][v]=null)}else for(const v in h)this.deletedStates[i]&&this.deletedStates[i][_]&&this.deletedStates[i][_][v]===null&&delete this.deletedStates[i][_][v]}removeFeatureState(i,a,h){if(this.deletedStates[i]===null)return;const _=String(a);if(this.deletedStates[i]=this.deletedStates[i]||{},h&&a!==void 0)this.deletedStates[i][_]!==null&&(this.deletedStates[i][_]=this.deletedStates[i][_]||{},this.deletedStates[i][_][h]=null);else if(a!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][_])for(h in this.deletedStates[i][_]={},this.stateChanges[i][_])this.deletedStates[i][_][h]=null;else this.deletedStates[i][_]=null;else this.deletedStates[i]=null}getState(i,a){const h=String(a),_=c.extend({},(this.state[i]||{})[h],(this.stateChanges[i]||{})[h]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const v=this.deletedStates[i][a];if(v===null)return{};for(const T in v)delete _[T]}return _}initializeTileState(i,a){i.setFeatureState(this.state,a)}coalesceChanges(i,a){const h={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const v={};for(const T in this.stateChanges[_])this.state[_][T]||(this.state[_][T]={}),c.extend(this.state[_][T],this.stateChanges[_][T]),v[T]=this.state[_][T];h[_]=v}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const v={};if(this.deletedStates[_]===null)for(const T in this.state[_])v[T]={},this.state[_][T]={};else for(const T in this.deletedStates[_]){if(this.deletedStates[_][T]===null)this.state[_][T]={};else for(const C of Object.keys(this.deletedStates[_][T]))delete this.state[_][T][C];v[T]=this.state[_][T]}h[_]=h[_]||{},c.extend(h[_],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const _ in i)i[_].setFeatureState(h,a)}}class fn extends c.Evented{constructor(i,a,h){super(),this.id=i,this.dispatcher=h,this.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(_,v,T,C){const I=new Ut[v.type](_,v,T,C);if(I.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${I.id}`);return c.bindAll(["load","abort","unload","serialize","prepare"],I),I}(i,a,h,this),this._tiles={},this._cache=new Ai(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new pn}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const a=this._tiles[i];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,a){return this._source.loadTile(i,a)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){this._source.abortTile&&this._source.abortTile(i,()=>{}),this._source.fire(new c.Event("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const h=this._tiles[a];h.upload(i),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(co).map(i=>i.key)}getRenderableIds(i){const a=[];for(const h in this._tiles)this._isIdRenderable(h,i)&&a.push(this._tiles[h]);return i?a.sort((h,_)=>{const v=h.tileID,T=_.tileID,C=new c.pointGeometry(v.canonical.x,v.canonical.y)._rotate(this.transform.angle),I=new c.pointGeometry(T.canonical.x,T.canonical.y)._rotate(this.transform.angle);return v.overscaledZ-T.overscaledZ||I.y-C.y||I.x-C.x}).map(h=>h.tileID.key):a.map(h=>h.tileID).sort(co).map(h=>h.key)}hasRenderableParent(i){const a=this.findLoadedParent(i,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(i,a){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(a||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(i,"reloading")}}_reloadTile(i,a){const h=this._tiles[i];h&&(h.state!=="loading"&&(h.state=a),this._loadTile(h,this._tileLoaded.bind(this,h,i,a)))}_tileLoaded(i,a,h,_){if(_)return i.state="errored",void(_.status!==404?this._source.fire(new c.ErrorEvent(_,{tile:i})):this.update(this.transform,this.terrain));i.timeAdded=c.exported.now(),h==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(a,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new c.Event("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const a=this.getRenderableIds();for(let _=0;_<a.length;_++){const v=a[_];if(i.neighboringTiles&&i.neighboringTiles[v]){const T=this.getTileByID(v);h(i,T),h(T,i)}}function h(_,v){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let T=v.tileID.canonical.x-_.tileID.canonical.x;const C=v.tileID.canonical.y-_.tileID.canonical.y,I=Math.pow(2,_.tileID.canonical.z),z=v.tileID.key;T===0&&C===0||Math.abs(C)>1||(Math.abs(T)>1&&(Math.abs(T+I)===1?T+=I:Math.abs(T-I)===1&&(T-=I)),v.dem&&_.dem&&(_.dem.backfillBorder(v.dem,T,C),_.neighboringTiles&&_.neighboringTiles[z]&&(_.neighboringTiles[z].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,a,h,_){for(const v in this._tiles){let T=this._tiles[v];if(_[v]||!T.hasData()||T.tileID.overscaledZ<=a||T.tileID.overscaledZ>h)continue;let C=T.tileID;for(;T&&T.tileID.overscaledZ>a+1;){const z=T.tileID.scaledTo(T.tileID.overscaledZ-1);T=this._tiles[z.key],T&&T.hasData()&&(C=z)}let I=C;for(;I.overscaledZ>a;)if(I=I.scaledTo(I.overscaledZ-1),i[I.key]){_[C.key]=C;break}}}findLoadedParent(i,a){if(i.key in this._loadedParentTiles){const h=this._loadedParentTiles[i.key];return h&&h.tileID.overscaledZ>=a?h:null}for(let h=i.overscaledZ-1;h>=a;h--){const _=i.scaledTo(h),v=this._getLoadedTile(_);if(v)return v}}_getLoadedTile(i){const a=this._tiles[i.key];return a&&a.hasData()?a:this._cache.getByKey(i.wrapped().key)}updateCacheSize(i){const a=Math.ceil(i.width/this._source.tileSize)+1,h=Math.ceil(i.height/this._source.tileSize)+1,_=Math.floor(a*h*5),v=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(v)}handleWrapJump(i){const a=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,a){const h={};for(const _ in this._tiles){const v=this._tiles[_];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+a),h[v.tileID.key]=v}this._tiles=h;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(i,a){if(this.transform=i,this.terrain=a,!this._sourceLoaded||this._paused)return;let h;this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new c.OverscaledTileID(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(h=i.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(h=h.filter(z=>this._source.hasTile(z)))):h=[];const _=i.coveringZoomLevel(this._source),v=Math.max(_-fn.maxOverzooming,this._source.minzoom),T=Math.max(_+fn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const B of h)if(B.canonical.z>this._source.minzoom){const N=B.scaledTo(B.canonical.z-1);z[N.key]=N;const G=B.scaledTo(Math.max(this._source.minzoom,Math.min(B.canonical.z,5)));z[G.key]=G}h=h.concat(Object.values(z))}const C=this._updateRetainedTiles(h,_);if(Bo(this._source.type)){const z={},B={},N=Object.keys(C);for(const G of N){const Y=C[G],X=this._tiles[G];if(!X||X.fadeEndTime&&X.fadeEndTime<=c.exported.now())continue;const J=this.findLoadedParent(Y,v);J&&(this._addTile(J.tileID),z[J.tileID.key]=J.tileID),B[G]=Y}this._retainLoadedChildren(B,_,T,C);for(const G in z)C[G]||(this._coveredTiles[G]=!0,C[G]=z[G]);if(a){const G={},Y={};for(const X of h)this._tiles[X.key].hasData()?G[X.key]=X:Y[X.key]=X;for(const X in Y){const J=Y[X].children(this._source.maxzoom);this._tiles[J[0].key]&&this._tiles[J[1].key]&&this._tiles[J[2].key]&&this._tiles[J[3].key]&&(G[J[0].key]=C[J[0].key]=J[0],G[J[1].key]=C[J[1].key]=J[1],G[J[2].key]=C[J[2].key]=J[2],G[J[3].key]=C[J[3].key]=J[3],delete Y[X])}for(const X in Y){const J=this.findLoadedParent(Y[X],this._source.minzoom);if(J){G[J.tileID.key]=C[J.tileID.key]=J.tileID;for(const ae in G)G[ae].isChildOf(J.tileID)&&delete G[ae]}}for(const X in this._tiles)G[X]||(this._coveredTiles[X]=!0)}}for(const z in C)this._tiles[z].clearFadeHold();const I=c.keysDifference(this._tiles,C);for(const z of I){const B=this._tiles[z];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(i)}_updateRetainedTiles(i,a){const h={},_={},v=Math.max(a-fn.maxOverzooming,this._source.minzoom),T=Math.max(a+fn.maxUnderzooming,this._source.minzoom),C={};for(const I of i){const z=this._addTile(I);h[I.key]=I,z.hasData()||a<this._source.maxzoom&&(C[I.key]=I)}this._retainLoadedChildren(C,a,T,h);for(const I of i){let z=this._tiles[I.key];if(z.hasData())continue;if(a+1>this._source.maxzoom){const N=I.children(this._source.maxzoom)[0],G=this.getTile(N);if(G&&G.hasData()){h[N.key]=N;continue}}else{const N=I.children(this._source.maxzoom);if(h[N[0].key]&&h[N[1].key]&&h[N[2].key]&&h[N[3].key])continue}let B=z.wasRequested();for(let N=I.overscaledZ-1;N>=v;--N){const G=I.scaledTo(N);if(_[G.key]||(_[G.key]=!0,z=this.getTile(G),!z&&B&&(z=this._addTile(G)),z&&(h[G.key]=G,B=z.wasRequested(),z.hasData())))break}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const a=[];let h,_=this._tiles[i].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){h=this._loadedParentTiles[_.key];break}a.push(_.key);const v=_.scaledTo(_.overscaledZ-1);if(h=this._getLoadedTile(v),h)break;_=v}for(const v of a)this._loadedParentTiles[v]=h}}_addTile(i){let a=this._tiles[i.key];if(a)return a;a=this._cache.getAndRemove(i),a&&(this._setTileReloadTimer(i.key,a),a.tileID=i,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,a)));const h=a;return a||(a=new Dt(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(a,this._tileLoaded.bind(this,a,i.key,a.state))),a.uses++,this._tiles[i.key]=a,h||this._source.fire(new c.Event("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(i,a){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const h=a.getExpiryTimeout();h&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},h))}_removeTile(i){const a=this._tiles[i];a&&(a.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,a,h){const _=[],v=this.transform;if(!v)return _;const T=h?v.getCameraQueryGeometry(i):i,C=i.map(X=>v.pointCoordinate(X,this.terrain)),I=T.map(X=>v.pointCoordinate(X,this.terrain)),z=this.getIds();let B=1/0,N=1/0,G=-1/0,Y=-1/0;for(const X of I)B=Math.min(B,X.x),N=Math.min(N,X.y),G=Math.max(G,X.x),Y=Math.max(Y,X.y);for(let X=0;X<z.length;X++){const J=this._tiles[z[X]];if(J.holdingForFade())continue;const ae=J.tileID,pe=Math.pow(2,v.zoom-J.tileID.overscaledZ),ve=a*J.queryPadding*c.EXTENT/J.tileSize/pe,Q=[ae.getTilePoint(new c.MercatorCoordinate(B,N)),ae.getTilePoint(new c.MercatorCoordinate(G,Y))];if(Q[0].x-ve<c.EXTENT&&Q[0].y-ve<c.EXTENT&&Q[1].x+ve>=0&&Q[1].y+ve>=0){const be=C.map(Ae=>ae.getTilePoint(Ae)),xe=I.map(Ae=>ae.getTilePoint(Ae));_.push({tile:J,tileID:ae,queryGeometry:be,cameraQueryGeometry:xe,scale:pe})}}return _}getVisibleCoordinates(i){const a=this.getRenderableIds(i).map(h=>this._tiles[h].tileID);for(const h of a)h.posMatrix=this.transform.calculatePosMatrix(h.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Bo(this._source.type))for(const i in this._tiles){const a=this._tiles[i];if(a.fadeEndTime!==void 0&&a.fadeEndTime>=c.exported.now())return!0}return!1}setFeatureState(i,a,h){this._state.updateState(i=i||"_geojsonTileLayer",a,h)}removeFeatureState(i,a,h){this._state.removeFeatureState(i=i||"_geojsonTileLayer",a,h)}getFeatureState(i,a){return this._state.getState(i=i||"_geojsonTileLayer",a)}setDependencies(i,a,h){const _=this._tiles[i];_&&_.setDependencies(a,h)}reloadTilesForDependencies(i,a){for(const h in this._tiles)this._tiles[h].hasDependency(i,a)&&this._reloadTile(h,"reloading");this._cache.filter(h=>!h.hasDependency(i,a))}}function co(f,i){const a=Math.abs(2*f.wrap)-+(f.wrap<0),h=Math.abs(2*i.wrap)-+(i.wrap<0);return f.overscaledZ-i.overscaledZ||h-a||i.canonical.y-f.canonical.y||i.canonical.x-f.canonical.x}function Bo(f){return f==="raster"||f==="image"||f==="video"}fn.maxOverzooming=10,fn.maxUnderzooming=3;const Dn="mapboxgl_preloaded_worker_pool";class mn{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<mn.workerCount;)this.workers.push(new Worker(es.workerUrl));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Dn]}numActive(){return Object.keys(this.active).length}}const Ms=Math.floor(c.exported.hardwareConcurrency/2);let Vr;function Oo(){return Vr||(Vr=new mn),Vr}function ho(f,i){const a={};for(const h in f)h!=="ref"&&(a[h]=f[h]);return c.refProperties.forEach(h=>{h in i&&(a[h]=i[h])}),a}function po(f){f=f.slice();const i=Object.create(null);for(let a=0;a<f.length;a++)i[f[a].id]=f[a];for(let a=0;a<f.length;a++)"ref"in f[a]&&(f[a]=ho(f[a],i[f[a].ref]));return f}mn.workerCount=Math.max(Math.min(Ms,6),1);const qt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function or(f,i,a){a.push({command:qt.addSource,args:[f,i[f]]})}function wr(f,i,a){i.push({command:qt.removeSource,args:[f]}),a[f]=!0}function Zr(f,i,a,h){wr(f,a,h),or(f,i,a)}function ps(f,i,a){let h;for(h in f[a])if(Object.prototype.hasOwnProperty.call(f[a],h)&&h!=="data"&&!ge(f[a][h],i[a][h]))return!1;for(h in i[a])if(Object.prototype.hasOwnProperty.call(i[a],h)&&h!=="data"&&!ge(f[a][h],i[a][h]))return!1;return!0}function Gr(f,i,a,h,_,v){let T;for(T in i=i||{},f=f||{})Object.prototype.hasOwnProperty.call(f,T)&&(ge(f[T],i[T])||a.push({command:v,args:[h,T,i[T],_]}));for(T in i)Object.prototype.hasOwnProperty.call(i,T)&&!Object.prototype.hasOwnProperty.call(f,T)&&(ge(f[T],i[T])||a.push({command:v,args:[h,T,i[T],_]}))}function jr(f){return f.id}function fo(f,i){return f[i.id]=i,f}class br{constructor(i,a){this.reset(i,a)}reset(i,a){this.points=i||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=c.clamp(i,0,1);let a=1,h=this._distances[a];const _=i*this.paddedLength+this.padding;for(;h<_&&a<this._distances.length;)h=this._distances[++a];const v=a-1,T=this._distances[v],C=h-T,I=C>0?(_-T)/C:0;return this.points[v].mult(1-I).add(this.points[a].mult(I))}}function ke(f,i){let a=!0;return f==="always"||f!=="never"&&i!=="never"||(a=!1),a}class Xe{constructor(i,a,h){const _=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(i/h),this.yCellCount=Math.ceil(a/h);for(let T=0;T<this.xCellCount*this.yCellCount;T++)_.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=a,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,a,h,_,v){this._forEachCell(a,h,_,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(v)}insertCircle(i,a,h,_){this._forEachCell(a-_,h-_,a+_,h+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(a),this.circles.push(h),this.circles.push(_)}_insertBoxCell(i,a,h,_,v,T){this.boxCells[v].push(T)}_insertCircleCell(i,a,h,_,v,T){this.circleCells[v].push(T)}_query(i,a,h,_,v,T,C){if(h<0||i>this.width||_<0||a>this.height)return[];const I=[];if(i<=0&&a<=0&&this.width<=h&&this.height<=_){if(v)return[{key:null,x1:i,y1:a,x2:h,y2:_}];for(let z=0;z<this.boxKeys.length;z++)I.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const B=this.circles[3*z],N=this.circles[3*z+1],G=this.circles[3*z+2];I.push({key:this.circleKeys[z],x1:B-G,y1:N-G,x2:B+G,y2:N+G})}}else this._forEachCell(i,a,h,_,this._queryCell,I,{hitTest:v,overlapMode:T,seenUids:{box:{},circle:{}}},C);return I}query(i,a,h,_){return this._query(i,a,h,_,!1,null)}hitTest(i,a,h,_,v,T){return this._query(i,a,h,_,!0,v,T).length>0}hitTestCircle(i,a,h,_,v){const T=i-h,C=i+h,I=a-h,z=a+h;if(C<0||T>this.width||z<0||I>this.height)return!1;const B=[];return this._forEachCell(T,I,C,z,this._queryCellCircle,B,{hitTest:!0,overlapMode:_,circle:{x:i,y:a,radius:h},seenUids:{box:{},circle:{}}},v),B.length>0}_queryCell(i,a,h,_,v,T,C,I){const{seenUids:z,hitTest:B,overlapMode:N}=C,G=this.boxCells[v];if(G!==null){const X=this.bboxes;for(const J of G)if(!z.box[J]){z.box[J]=!0;const ae=4*J,pe=this.boxKeys[J];if(i<=X[ae+2]&&a<=X[ae+3]&&h>=X[ae+0]&&_>=X[ae+1]&&(!I||I(pe))&&(!B||!ke(N,pe.overlapMode))&&(T.push({key:pe,x1:X[ae],y1:X[ae+1],x2:X[ae+2],y2:X[ae+3]}),B))return!0}}const Y=this.circleCells[v];if(Y!==null){const X=this.circles;for(const J of Y)if(!z.circle[J]){z.circle[J]=!0;const ae=3*J,pe=this.circleKeys[J];if(this._circleAndRectCollide(X[ae],X[ae+1],X[ae+2],i,a,h,_)&&(!I||I(pe))&&(!B||!ke(N,pe.overlapMode))){const ve=X[ae],Q=X[ae+1],be=X[ae+2];if(T.push({key:pe,x1:ve-be,y1:Q-be,x2:ve+be,y2:Q+be}),B)return!0}}}return!1}_queryCellCircle(i,a,h,_,v,T,C,I){const{circle:z,seenUids:B,overlapMode:N}=C,G=this.boxCells[v];if(G!==null){const X=this.bboxes;for(const J of G)if(!B.box[J]){B.box[J]=!0;const ae=4*J,pe=this.boxKeys[J];if(this._circleAndRectCollide(z.x,z.y,z.radius,X[ae+0],X[ae+1],X[ae+2],X[ae+3])&&(!I||I(pe))&&!ke(N,pe.overlapMode))return T.push(!0),!0}}const Y=this.circleCells[v];if(Y!==null){const X=this.circles;for(const J of Y)if(!B.circle[J]){B.circle[J]=!0;const ae=3*J,pe=this.circleKeys[J];if(this._circlesCollide(X[ae],X[ae+1],X[ae+2],z.x,z.y,z.radius)&&(!I||I(pe))&&!ke(N,pe.overlapMode))return T.push(!0),!0}}}_forEachCell(i,a,h,_,v,T,C,I){const z=this._convertToXCellCoord(i),B=this._convertToYCellCoord(a),N=this._convertToXCellCoord(h),G=this._convertToYCellCoord(_);for(let Y=z;Y<=N;Y++)for(let X=B;X<=G;X++)if(v.call(this,i,a,h,_,this.xCellCount*X+Y,T,C,I))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,a,h,_,v,T){const C=_-i,I=v-a,z=h+T;return z*z>C*C+I*I}_circleAndRectCollide(i,a,h,_,v,T,C){const I=(T-_)/2,z=Math.abs(i-(_+I));if(z>I+h)return!1;const B=(C-v)/2,N=Math.abs(a-(v+B));if(N>B+h)return!1;if(z<=I||N<=B)return!0;const G=z-I,Y=N-B;return G*G+Y*Y<=h*h}}function mo(f,i,a,h,_){const v=c.create();return i?(c.scale(v,v,[1/_,1/_,1]),a||c.rotateZ(v,v,h.angle)):c.multiply(v,h.labelPlaneMatrix,f),v}function Wn(f,i,a,h,_){if(i){const v=c.clone(f);return c.scale(v,v,[_,_,1]),a||c.rotateZ(v,v,-h.angle),v}return h.glCoordMatrix}function $t(f,i,a){let h;a?(h=[f.x,f.y,a(f.x,f.y),1],c.transformMat4(h,h,i)):(h=[f.x,f.y,0,1],$r(h,h,i));const _=h[3];return{point:new c.pointGeometry(h[0]/_,h[1]/_),signedDistanceFromCamera:_}}function Rn(f,i){return .5+f/i*.5}function _n(f,i){const a=f[0]/f[3],h=f[1]/f[3];return a>=-i[0]&&a<=i[0]&&h>=-i[1]&&h<=i[1]}function bn(f,i,a,h,_,v,T,C,I,z){const B=h?f.textSizeData:f.iconSizeData,N=c.evaluateSizeForZoom(B,a.transform.zoom),G=[256/a.width*2+1,256/a.height*2+1],Y=h?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;Y.clear();const X=f.lineVertexArray,J=h?f.text.placedSymbolArray:f.icon.placedSymbolArray,ae=a.transform.width/a.transform.height;let pe=!1;for(let ve=0;ve<J.length;ve++){const Q=J.get(ve);if(Q.hidden||Q.writingMode===c.WritingMode.vertical&&!pe){St(Q.numGlyphs,Y);continue}let be;if(pe=!1,z?(be=[Q.anchorX,Q.anchorY,z(Q.anchorX,Q.anchorY),1],c.transformMat4(be,be,i)):(be=[Q.anchorX,Q.anchorY,0,1],$r(be,be,i)),!_n(be,G)){St(Q.numGlyphs,Y);continue}const xe=Rn(a.transform.cameraToCenterDistance,be[3]),Ae=c.evaluateSizeForFeature(B,N,Q),ze=T?Ae/xe:Ae*xe,Fe=new c.pointGeometry(Q.anchorX,Q.anchorY),Ce=$t(Fe,_,z).point,it={},Ke=At(Q,ze,!1,C,i,_,v,f.glyphOffsetArray,X,Y,Ce,Fe,it,ae,I,z);pe=Ke.useVertical,(Ke.notEnoughRoom||pe||Ke.needsFlipping&&At(Q,ze,!0,C,i,_,v,f.glyphOffsetArray,X,Y,Ce,Fe,it,ae,I,z).notEnoughRoom)&&St(Q.numGlyphs,Y)}h?f.text.dynamicLayoutVertexBuffer.updateData(Y):f.icon.dynamicLayoutVertexBuffer.updateData(Y)}function _o(f,i,a,h,_,v,T,C,I,z,B,N,G){const Y=C.glyphStartIndex+C.numGlyphs,X=C.lineStartIndex,J=C.lineStartIndex+C.lineLength,ae=i.getoffsetX(C.glyphStartIndex),pe=i.getoffsetX(Y-1),ve=$i(f*ae,a,h,_,v,T,C.segment,X,J,I,z,B,N,G);if(!ve)return null;const Q=$i(f*pe,a,h,_,v,T,C.segment,X,J,I,z,B,N,G);return Q?{first:ve,last:Q}:null}function je(f,i,a,h){return f===c.WritingMode.horizontal&&Math.abs(a.y-i.y)>Math.abs(a.x-i.x)*h?{useVertical:!0}:(f===c.WritingMode.vertical?i.y<a.y:i.x>a.x)?{needsFlipping:!0}:null}function At(f,i,a,h,_,v,T,C,I,z,B,N,G,Y,X,J){const ae=i/24,pe=f.lineOffsetX*ae,ve=f.lineOffsetY*ae;let Q;if(f.numGlyphs>1){const be=f.glyphStartIndex+f.numGlyphs,xe=f.lineStartIndex,Ae=f.lineStartIndex+f.lineLength,ze=_o(ae,C,pe,ve,a,B,N,f,I,v,G,X,J);if(!ze)return{notEnoughRoom:!0};const Fe=$t(ze.first.point,T,J).point,Ce=$t(ze.last.point,T,J).point;if(h&&!a){const it=je(f.writingMode,Fe,Ce,Y);if(it)return it}Q=[ze.first];for(let it=f.glyphStartIndex+1;it<be-1;it++)Q.push($i(ae*C.getoffsetX(it),pe,ve,a,B,N,f.segment,xe,Ae,I,v,G,X,J));Q.push(ze.last)}else{if(h&&!a){const xe=$t(N,_,J).point,Ae=f.lineStartIndex+f.segment+1,ze=new c.pointGeometry(I.getx(Ae),I.gety(Ae)),Fe=$t(ze,_,J),Ce=Fe.signedDistanceFromCamera>0?Fe.point:Pt(N,ze,xe,1,_,J),it=je(f.writingMode,xe,Ce,Y);if(it)return it}const be=$i(ae*C.getoffsetX(f.glyphStartIndex),pe,ve,a,B,N,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,I,v,G,X,J);if(!be)return{notEnoughRoom:!0};Q=[be]}for(const be of Q)c.addDynamicAttributes(z,be.point,be.angle);return{}}function Pt(f,i,a,h,_,v){const T=$t(f.add(f.sub(i)._unit()),_,v).point,C=a.sub(T);return a.add(C._mult(h/C.mag()))}function $i(f,i,a,h,_,v,T,C,I,z,B,N,G,Y){const X=h?f-i:f+i;let J=X>0?1:-1,ae=0;h&&(J*=-1,ae=Math.PI),J<0&&(ae+=Math.PI);let pe=J>0?C+T:C+T+1,ve=_,Q=_,be=0,xe=0;const Ae=Math.abs(X),ze=[];for(;be+xe<=Ae;){if(pe+=J,pe<C||pe>=I)return null;if(Q=ve,ze.push(ve),ve=N[pe],ve===void 0){const ot=new c.pointGeometry(z.getx(pe),z.gety(pe)),kt=$t(ot,B,Y);if(kt.signedDistanceFromCamera>0)ve=N[pe]=kt.point;else{const Bt=pe-J;ve=Pt(be===0?v:new c.pointGeometry(z.getx(Bt),z.gety(Bt)),ot,Q,Ae-be+1,B,Y)}}be+=xe,xe=Q.dist(ve)}const Fe=(Ae-be)/xe,Ce=ve.sub(Q),it=Ce.mult(Fe)._add(Q);it._add(Ce._unit()._perp()._mult(a*J));const Ke=ae+Math.atan2(ve.y-Q.y,ve.x-Q.x);return ze.push(it),{point:it,angle:G?Ke:0,path:ze}}const qr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function St(f,i){for(let a=0;a<f;a++){const h=i.length;i.resize(h+4),i.float32.set(qr,3*h)}}function $r(f,i,a){const h=i[0],_=i[1];return f[0]=a[0]*h+a[4]*_+a[12],f[1]=a[1]*h+a[5]*_+a[13],f[3]=a[3]*h+a[7]*_+a[15],f}const Wi=100;class fs{constructor(i,a=new Xe(i.width+200,i.height+200,25),h=new Xe(i.width+200,i.height+200,25)){this.transform=i,this.grid=a,this.ignoredGrid=h,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Wi,this.screenBottomBoundary=i.height+Wi,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,a,h,_,v,T){const C=this.projectAndGetPerspectiveRatio(_,i.anchorPointX,i.anchorPointY,T),I=h*C.perspectiveRatio,z=i.x1*I+C.point.x,B=i.y1*I+C.point.y,N=i.x2*I+C.point.x,G=i.y2*I+C.point.y;return!this.isInsideGrid(z,B,N,G)||a!=="always"&&this.grid.hitTest(z,B,N,G,a,v)||C.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[z,B,N,G],offscreen:this.isOffscreen(z,B,N,G)}}placeCollisionCircles(i,a,h,_,v,T,C,I,z,B,N,G,Y,X){const J=[],ae=new c.pointGeometry(a.anchorX,a.anchorY),pe=$t(ae,T,X),ve=Rn(this.transform.cameraToCenterDistance,pe.signedDistanceFromCamera),Q=(B?v/ve:v*ve)/c.ONE_EM,be=$t(ae,C,X).point,xe=_o(Q,_,a.lineOffsetX*Q,a.lineOffsetY*Q,!1,be,ae,a,h,C,{},!1,X);let Ae=!1,ze=!1,Fe=!0;if(xe){const Ce=.5*G*ve+Y,it=new c.pointGeometry(-100,-100),Ke=new c.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),ot=new br,kt=xe.first,Bt=xe.last;let _t=[];for(let Xt=kt.path.length-1;Xt>=1;Xt--)_t.push(kt.path[Xt]);for(let Xt=1;Xt<Bt.path.length;Xt++)_t.push(Bt.path[Xt]);const ai=2.5*Ce;if(I){const Xt=_t.map(Kt=>$t(Kt,I,X));_t=Xt.some(Kt=>Kt.signedDistanceFromCamera<=0)?[]:Xt.map(Kt=>Kt.point)}let li=[];if(_t.length>0){const Xt=_t[0].clone(),Kt=_t[0].clone();for(let hi=1;hi<_t.length;hi++)Xt.x=Math.min(Xt.x,_t[hi].x),Xt.y=Math.min(Xt.y,_t[hi].y),Kt.x=Math.max(Kt.x,_t[hi].x),Kt.y=Math.max(Kt.y,_t[hi].y);li=Xt.x>=it.x&&Kt.x<=Ke.x&&Xt.y>=it.y&&Kt.y<=Ke.y?[_t]:Kt.x<it.x||Xt.x>Ke.x||Kt.y<it.y||Xt.y>Ke.y?[]:c.clipLine([_t],it.x,it.y,Ke.x,Ke.y)}for(const Xt of li){ot.reset(Xt,.25*Ce);let Kt=0;Kt=ot.length<=.5*Ce?1:Math.ceil(ot.paddedLength/ai)+1;for(let hi=0;hi<Kt;hi++){const sn=hi/Math.max(Kt-1,1),Po=ot.lerp(sn),Qr=Po.x+Wi,Co=Po.y+Wi;J.push(Qr,Co,Ce,0);const Ss=Qr-Ce,Lr=Co-Ce,Jn=Qr+Ce,ts=Co+Ce;if(Fe=Fe&&this.isOffscreen(Ss,Lr,Jn,ts),ze=ze||this.isInsideGrid(Ss,Lr,Jn,ts),i!=="always"&&this.grid.hitTestCircle(Qr,Co,Ce,i,N)&&(Ae=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Ae}}}}return{circles:!z&&Ae||!ze||ve<this.perspectiveRatioCutoff?[]:J,offscreen:Fe,collisionDetected:Ae}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let h=1/0,_=1/0,v=-1/0,T=-1/0;for(const B of i){const N=new c.pointGeometry(B.x+Wi,B.y+Wi);h=Math.min(h,N.x),_=Math.min(_,N.y),v=Math.max(v,N.x),T=Math.max(T,N.y),a.push(N)}const C=this.grid.query(h,_,v,T).concat(this.ignoredGrid.query(h,_,v,T)),I={},z={};for(const B of C){const N=B.key;if(I[N.bucketInstanceId]===void 0&&(I[N.bucketInstanceId]={}),I[N.bucketInstanceId][N.featureIndex])continue;const G=[new c.pointGeometry(B.x1,B.y1),new c.pointGeometry(B.x2,B.y1),new c.pointGeometry(B.x2,B.y2),new c.pointGeometry(B.x1,B.y2)];c.polygonIntersectsPolygon(a,G)&&(I[N.bucketInstanceId][N.featureIndex]=!0,z[N.bucketInstanceId]===void 0&&(z[N.bucketInstanceId]=[]),z[N.bucketInstanceId].push(N.featureIndex))}return z}insertCollisionBox(i,a,h,_,v,T){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:v,collisionGroupID:T,overlapMode:a},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,a,h,_,v,T){const C=h?this.ignoredGrid:this.grid,I={bucketInstanceId:_,featureIndex:v,collisionGroupID:T,overlapMode:a};for(let z=0;z<i.length;z+=4)C.insertCircle(I,i[z],i[z+1],i[z+2])}projectAndGetPerspectiveRatio(i,a,h,_){let v;return _?(v=[a,h,_(a,h),1],c.transformMat4(v,v,i)):(v=[a,h,0,1],$r(v,v,i)),{point:new c.pointGeometry((v[0]/v[3]+1)/2*this.transform.width+Wi,(-v[1]/v[3]+1)/2*this.transform.height+Wi),perspectiveRatio:.5+this.transform.cameraToCenterDistance/v[3]*.5}}isOffscreen(i,a,h,_){return h<Wi||i>=this.screenRightBoundary||_<Wi||a>this.screenBottomBoundary}isInsideGrid(i,a,h,_){return h>=0&&i<this.gridRightBoundary&&_>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const i=c.identity([]);return c.translate(i,i,[-100,-100,0]),i}}function Di(f,i,a){return i*(c.EXTENT/(f.tileSize*Math.pow(2,a-f.tileID.overscaledZ)))}class gn{constructor(i,a,h,_){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?a:-a))):_&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class oi{constructor(i,a,h,_,v){this.text=new gn(i?i.text:null,a,h,v),this.icon=new gn(i?i.icon:null,a,_,v)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class go{constructor(i,a,h){this.text=i,this.icon=a,this.skipFade=h}}class Tr{constructor(){this.invProjMatrix=c.create(),this.viewportMatrix=c.create(),this.circles=[]}}class Fo{constructor(i,a,h,_,v){this.bucketInstanceId=i,this.featureIndex=a,this.sourceLayerIndex=h,this.bucketIndex=_,this.tileID=v}}class No{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const a=++this.maxGroupID;this.collisionGroups[i]={ID:a,predicate:h=>h.collisionGroupID===a}}return this.collisionGroups[i]}}function ms(f,i,a,h,_){const{horizontalAlign:v,verticalAlign:T}=c.getAnchorAlignment(f),C=-(v-.5)*i,I=-(T-.5)*a,z=c.evaluateVariableOffset(f,h);return new c.pointGeometry(C+z[0]*_,I+z[1]*_)}function nn(f,i,a,h,_,v){const{x1:T,x2:C,y1:I,y2:z,anchorPointX:B,anchorPointY:N}=f,G=new c.pointGeometry(i,a);return h&&G._rotate(_?v:-v),{x1:T+G.x,y1:I+G.y,x2:C+G.x,y2:z+G.y,anchorPointX:B,anchorPointY:N}}class Z{constructor(i,a,h,_,v){this.transform=i.clone(),this.terrain=a,this.collisionIndex=new fs(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new No(_),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,a,h,_){const v=h.getBucket(a),T=h.latestFeatureIndex;if(!v||!T||a.id!==v.layerIds[0])return;const C=h.collisionBoxArray,I=v.layers[0].layout,z=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),B=h.tileSize/c.EXTENT,N=this.transform.calculatePosMatrix(h.tileID.toUnwrapped()),G=I.get("text-pitch-alignment")==="map",Y=I.get("text-rotation-alignment")==="map",X=Di(h,1,this.transform.zoom),J=mo(N,G,Y,this.transform,X);let ae=null;if(G){const ve=Wn(N,G,Y,this.transform,X);ae=c.multiply([],this.transform.labelPlaneMatrix,ve)}this.retainedQueryData[v.bucketInstanceId]=new Fo(v.bucketInstanceId,T,v.sourceLayerIndex,v.index,h.tileID);const pe={bucket:v,layout:I,posMatrix:N,textLabelPlaneMatrix:J,labelToScreenMatrix:ae,scale:z,textPixelRatio:B,holdingForFade:h.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:c.evaluateSizeForZoom(v.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(v.sourceID)};if(_)for(const ve of v.sortKeyRanges){const{sortKey:Q,symbolInstanceStart:be,symbolInstanceEnd:xe}=ve;i.push({sortKey:Q,symbolInstanceStart:be,symbolInstanceEnd:xe,parameters:pe})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:v.symbolInstances.length,parameters:pe})}attemptAnchorPlacement(i,a,h,_,v,T,C,I,z,B,N,G,Y,X,J,ae){const pe=[G.textOffset0,G.textOffset1],ve=ms(i,h,_,pe,v),Q=this.collisionIndex.placeCollisionBox(nn(a,ve.x,ve.y,T,C,this.transform.angle),N,I,z,B.predicate,ae);if((!J||this.collisionIndex.placeCollisionBox(nn(J,ve.x,ve.y,T,C,this.transform.angle),N,I,z,B.predicate,ae).box.length!==0)&&Q.box.length>0){let be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(be=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:pe,width:h,height:_,anchor:i,textBoxScale:v,prevAnchor:be},this.markUsedJustification(Y,i,G,X),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,X,G),this.placedOrientations[G.crossTileID]=X),{shift:ve,placedGlyphBoxes:Q}}}placeLayerBucketPart(i,a,h){const{bucket:_,layout:v,posMatrix:T,textLabelPlaneMatrix:C,labelToScreenMatrix:I,textPixelRatio:z,holdingForFade:B,collisionBoxArray:N,partiallyEvaluatedTextSize:G,collisionGroup:Y}=i.parameters,X=v.get("text-optional"),J=v.get("icon-optional"),ae=c.getOverlapMode(v,"text-overlap","text-allow-overlap"),pe=ae==="always",ve=c.getOverlapMode(v,"icon-overlap","icon-allow-overlap"),Q=ve==="always",be=v.get("text-rotation-alignment")==="map",xe=v.get("text-pitch-alignment")==="map",Ae=v.get("icon-text-fit")!=="none",ze=v.get("symbol-z-order")==="viewport-y",Fe=pe&&(Q||!_.hasIconData()||J),Ce=Q&&(pe||!_.hasTextData()||X);!_.collisionArrays&&N&&_.deserializeCollisionBoxes(N);const it=(Ke,ot)=>{if(a[Ke.crossTileID])return;if(B)return void(this.placements[Ke.crossTileID]=new go(!1,!1,!1));let kt=!1,Bt=!1,_t=!0,ai=null,li={box:null,offscreen:null},Xt={box:null,offscreen:null},Kt=null,hi=null,sn=null,Po=0,Qr=0,Co=0;ot.textFeatureIndex?Po=ot.textFeatureIndex:Ke.useRuntimeCollisionCircles&&(Po=Ke.featureIndex),ot.verticalTextFeatureIndex&&(Qr=ot.verticalTextFeatureIndex);const Ss=this.retainedQueryData[_.bucketInstanceId].tileID,Lr=this.terrain?(Yi,Nt)=>this.terrain.getElevation(Ss,Yi,Nt):null;for(const Yi of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const Nt=ot[Yi];Nt&&(Nt.elevation=Lr?Lr(Nt.anchorPointX,Nt.anchorPointY):0)}const Jn=ot.textBox;if(Jn){const Yi=si=>{let an=c.WritingMode.horizontal;if(_.allowVerticalPlacement&&!si&&this.prevPlacement){const ln=this.prevPlacement.placedOrientations[Ke.crossTileID];ln&&(this.placedOrientations[Ke.crossTileID]=ln,an=ln,this.markUsedOrientation(_,an,Ke))}return an},Nt=(si,an)=>{if(_.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&ot.verticalTextBox){for(const ln of _.writingModes)if(ln===c.WritingMode.vertical?(li=an(),Xt=li):li=si(),li&&li.box&&li.box.length)break}else li=si()};if(v.get("text-variable-anchor")){let si=v.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ke.crossTileID]){const Pi=this.prevPlacement.variableOffsets[Ke.crossTileID];si.indexOf(Pi.anchor)>0&&(si=si.filter(Dr=>Dr!==Pi.anchor),si.unshift(Pi.anchor))}const an=(Pi,Dr,ta)=>{const ac=Pi.x2-Pi.x1,Na=Pi.y2-Pi.y1,wh=Ke.textBoxScale,lc=Ae&&ve==="never"?Dr:null;let Es={box:[],offscreen:!1};const ia=ae!=="never"?2*si.length:si.length;for(let na=0;na<ia;++na){const pu=this.attemptAnchorPlacement(si[na%si.length],Pi,ac,Na,wh,be,xe,z,T,Y,na>=si.length?ae:"never",Ke,_,ta,lc,Lr);if(pu&&(Es=pu.placedGlyphBoxes,Es&&Es.box&&Es.box.length)){kt=!0,ai=pu.shift;break}}return Es};Nt(()=>an(Jn,ot.iconBox,c.WritingMode.horizontal),()=>{const Pi=ot.verticalTextBox;return _.allowVerticalPlacement&&!(li&&li.box&&li.box.length)&&Ke.numVerticalGlyphVertices>0&&Pi?an(Pi,ot.verticalIconBox,c.WritingMode.vertical):{box:null,offscreen:null}}),li&&(kt=li.box,_t=li.offscreen);const ln=Yi(li&&li.box);if(!kt&&this.prevPlacement){const Pi=this.prevPlacement.variableOffsets[Ke.crossTileID];Pi&&(this.variableOffsets[Ke.crossTileID]=Pi,this.markUsedJustification(_,Pi.anchor,Ke,ln))}}else{const si=(an,ln)=>{const Pi=this.collisionIndex.placeCollisionBox(an,ae,z,T,Y.predicate,Lr);return Pi&&Pi.box&&Pi.box.length&&(this.markUsedOrientation(_,ln,Ke),this.placedOrientations[Ke.crossTileID]=ln),Pi};Nt(()=>si(Jn,c.WritingMode.horizontal),()=>{const an=ot.verticalTextBox;return _.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&an?si(an,c.WritingMode.vertical):{box:null,offscreen:null}}),Yi(li&&li.box&&li.box.length)}}if(Kt=li,kt=Kt&&Kt.box&&Kt.box.length>0,_t=Kt&&Kt.offscreen,Ke.useRuntimeCollisionCircles){const Yi=_.text.placedSymbolArray.get(Ke.centerJustifiedTextSymbolIndex),Nt=c.evaluateSizeForFeature(_.textSizeData,G,Yi),si=v.get("text-padding");hi=this.collisionIndex.placeCollisionCircles(ae,Yi,_.lineVertexArray,_.glyphOffsetArray,Nt,T,C,I,h,xe,Y.predicate,Ke.collisionCircleDiameter,si,Lr),hi.circles.length&&hi.collisionDetected&&!h&&c.warnOnce("Collisions detected, but collision boxes are not shown"),kt=pe||hi.circles.length>0&&!hi.collisionDetected,_t=_t&&hi.offscreen}if(ot.iconFeatureIndex&&(Co=ot.iconFeatureIndex),ot.iconBox){const Yi=Nt=>{const si=Ae&&ai?nn(Nt,ai.x,ai.y,be,xe,this.transform.angle):Nt;return this.collisionIndex.placeCollisionBox(si,ve,z,T,Y.predicate,Lr)};Xt&&Xt.box&&Xt.box.length&&ot.verticalIconBox?(sn=Yi(ot.verticalIconBox),Bt=sn.box.length>0):(sn=Yi(ot.iconBox),Bt=sn.box.length>0),_t=_t&&sn.offscreen}const ts=X||Ke.numHorizontalGlyphVertices===0&&Ke.numVerticalGlyphVertices===0,du=J||Ke.numIconVertices===0;if(ts||du?du?ts||(Bt=Bt&&kt):kt=Bt&&kt:Bt=kt=Bt&&kt,kt&&Kt&&Kt.box&&this.collisionIndex.insertCollisionBox(Kt.box,ae,v.get("text-ignore-placement"),_.bucketInstanceId,Xt&&Xt.box&&Qr?Qr:Po,Y.ID),Bt&&sn&&this.collisionIndex.insertCollisionBox(sn.box,ve,v.get("icon-ignore-placement"),_.bucketInstanceId,Co,Y.ID),hi&&(kt&&this.collisionIndex.insertCollisionCircles(hi.circles,ae,v.get("text-ignore-placement"),_.bucketInstanceId,Po,Y.ID),h)){const Yi=_.bucketInstanceId;let Nt=this.collisionCircleArrays[Yi];Nt===void 0&&(Nt=this.collisionCircleArrays[Yi]=new Tr);for(let si=0;si<hi.circles.length;si+=4)Nt.circles.push(hi.circles[si+0]),Nt.circles.push(hi.circles[si+1]),Nt.circles.push(hi.circles[si+2]),Nt.circles.push(hi.collisionDetected?1:0)}if(Ke.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ke.crossTileID]=new go(kt||Fe,Bt||Ce,_t||_.justReloaded),a[Ke.crossTileID]=!0};if(ze){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ke=_.getSortedSymbolIndexes(this.transform.angle);for(let ot=Ke.length-1;ot>=0;--ot){const kt=Ke[ot];it(_.symbolInstances.get(kt),_.collisionArrays[kt])}}else for(let Ke=i.symbolInstanceStart;Ke<i.symbolInstanceEnd;Ke++)it(_.symbolInstances.get(Ke),_.collisionArrays[Ke]);if(h&&_.bucketInstanceId in this.collisionCircleArrays){const Ke=this.collisionCircleArrays[_.bucketInstanceId];c.invert(Ke.invProjMatrix,T),Ke.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(i,a,h,_){let v;v=_===c.WritingMode.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[c.getAnchorJustification(a)];const T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const C of T)C>=0&&(i.text.placedSymbolArray.get(C).crossTileID=v>=0&&C!==v?0:h.crossTileID)}markUsedOrientation(i,a,h){const _=a===c.WritingMode.horizontal||a===c.WritingMode.horizontalOnly?a:0,v=a===c.WritingMode.vertical?a:0,T=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const C of T)i.text.placedSymbolArray.get(C).placedOrientation=_;h.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=v)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let h=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const _=a?a.symbolFadeChange(i):1,v=a?a.opacities:{},T=a?a.variableOffsets:{},C=a?a.placedOrientations:{};for(const I in this.placements){const z=this.placements[I],B=v[I];B?(this.opacities[I]=new oi(B,_,z.text,z.icon),h=h||z.text!==B.text.placed||z.icon!==B.icon.placed):(this.opacities[I]=new oi(null,_,z.text,z.icon,z.skipFade),h=h||z.text||z.icon)}for(const I in v){const z=v[I];if(!this.opacities[I]){const B=new oi(z,_,!1,!1);B.isHidden()||(this.opacities[I]=B,h=h||z.text.placed||z.icon.placed)}}for(const I in T)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=T[I]);for(const I in C)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=C[I]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:i)}updateLayerOpacities(i,a){const h={};for(const _ of a){const v=_.getBucket(i);v&&_.latestFeatureIndex&&i.id===v.layerIds[0]&&this.updateBucketOpacities(v,h,_.collisionBoxArray)}}updateBucketOpacities(i,a,h){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const _=i.layers[0].layout,v=new oi(null,0,!1,!1,!0),T=_.get("text-allow-overlap"),C=_.get("icon-allow-overlap"),I=_.get("text-variable-anchor"),z=_.get("text-rotation-alignment")==="map",B=_.get("text-pitch-alignment")==="map",N=_.get("icon-text-fit")!=="none",G=new oi(null,0,T&&(C||!i.hasIconData()||_.get("icon-optional")),C&&(T||!i.hasTextData()||_.get("text-optional")),!0);!i.collisionArrays&&h&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(h);const Y=(X,J,ae)=>{for(let pe=0;pe<J/4;pe++)X.opacityVertexArray.emplaceBack(ae)};for(let X=0;X<i.symbolInstances.length;X++){const J=i.symbolInstances.get(X),{numHorizontalGlyphVertices:ae,numVerticalGlyphVertices:pe,crossTileID:ve}=J;let Q=this.opacities[ve];a[ve]?Q=v:Q||(Q=G,this.opacities[ve]=Q),a[ve]=!0;const be=J.numIconVertices>0,xe=this.placedOrientations[J.crossTileID],Ae=xe===c.WritingMode.vertical,ze=xe===c.WritingMode.horizontal||xe===c.WritingMode.horizontalOnly;if(ae>0||pe>0){const Fe=de(Q.text);Y(i.text,ae,Ae?Pe:Fe),Y(i.text,pe,ze?Pe:Fe);const Ce=Q.text.isHidden();[J.rightJustifiedTextSymbolIndex,J.centerJustifiedTextSymbolIndex,J.leftJustifiedTextSymbolIndex].forEach(ot=>{ot>=0&&(i.text.placedSymbolArray.get(ot).hidden=Ce||Ae?1:0)}),J.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(J.verticalPlacedTextSymbolIndex).hidden=Ce||ze?1:0);const it=this.variableOffsets[J.crossTileID];it&&this.markUsedJustification(i,it.anchor,J,xe);const Ke=this.placedOrientations[J.crossTileID];Ke&&(this.markUsedJustification(i,"left",J,Ke),this.markUsedOrientation(i,Ke,J))}if(be){const Fe=de(Q.icon),Ce=!(N&&J.verticalPlacedIconSymbolIndex&&Ae);J.placedIconSymbolIndex>=0&&(Y(i.icon,J.numIconVertices,Ce?Fe:Pe),i.icon.placedSymbolArray.get(J.placedIconSymbolIndex).hidden=Q.icon.isHidden()),J.verticalPlacedIconSymbolIndex>=0&&(Y(i.icon,J.numVerticalIconVertices,Ce?Pe:Fe),i.icon.placedSymbolArray.get(J.verticalPlacedIconSymbolIndex).hidden=Q.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const Fe=i.collisionArrays[X];if(Fe){let Ce=new c.pointGeometry(0,0);if(Fe.textBox||Fe.verticalTextBox){let Ke=!0;if(I){const ot=this.variableOffsets[ve];ot?(Ce=ms(ot.anchor,ot.width,ot.height,ot.textOffset,ot.textBoxScale),z&&Ce._rotate(B?this.transform.angle:-this.transform.angle)):Ke=!1}Fe.textBox&&D(i.textCollisionBox.collisionVertexArray,Q.text.placed,!Ke||Ae,Ce.x,Ce.y),Fe.verticalTextBox&&D(i.textCollisionBox.collisionVertexArray,Q.text.placed,!Ke||ze,Ce.x,Ce.y)}const it=Boolean(!ze&&Fe.verticalIconBox);Fe.iconBox&&D(i.iconCollisionBox.collisionVertexArray,Q.icon.placed,it,N?Ce.x:0,N?Ce.y:0),Fe.verticalIconBox&&D(i.iconCollisionBox.collisionVertexArray,Q.icon.placed,!it,N?Ce.x:0,N?Ce.y:0)}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);if(i.bucketInstanceId in this.collisionCircleArrays){const X=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=X.invProjMatrix,i.placementViewportMatrix=X.viewportMatrix,i.collisionCircleArray=X.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,a){const h=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*h>i}setStale(){this.stale=!0}}function D(f,i,a,h,_){f.emplaceBack(i?1:0,a?1:0,h||0,_||0),f.emplaceBack(i?1:0,a?1:0,h||0,_||0),f.emplaceBack(i?1:0,a?1:0,h||0,_||0),f.emplaceBack(i?1:0,a?1:0,h||0,_||0)}const F=Math.pow(2,25),W=Math.pow(2,24),H=Math.pow(2,17),ie=Math.pow(2,16),ce=Math.pow(2,9),se=Math.pow(2,8),ne=Math.pow(2,1);function de(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const i=f.placed?1:0,a=Math.floor(127*f.opacity);return a*F+i*W+a*H+i*ie+a*ce+i*se+a*ne+i}const Pe=0;class Be{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,a,h,_,v){const T=this._bucketParts;for(;this._currentTileIndex<i.length;)if(a.getBucketParts(T,_,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((C,I)=>C.sortKey-I.sortKey));this._currentPartIndex<T.length;)if(a.placeLayerBucketPart(T[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,v())return!0;return!1}}class Ee{constructor(i,a,h,_,v,T,C,I){this.placement=new Z(i,a,T,C,I),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(i,a,h){const _=c.exported.now(),v=()=>{const T=c.exported.now()-_;return!this._forceFullPlacement&&T>2};for(;this._currentPlacementIndex>=0;){const T=a[i[this._currentPlacementIndex]],C=this.placement.collisionIndex.transform.zoom;if(T.type==="symbol"&&(!T.minzoom||T.minzoom<=C)&&(!T.maxzoom||T.maxzoom>C)){if(this._inProgressLayer||(this._inProgressLayer=new Be(T)),this._inProgressLayer.continuePlacement(h[T.source],this.placement,this._showCollisionBoxes,T,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const at=512/c.EXTENT/2;class ct{constructor(i,a,h){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=h;for(let _=0;_<a.length;_++){const v=a.get(_),T=v.key;this.indexedSymbolInstances[T]||(this.indexedSymbolInstances[T]=[]),this.indexedSymbolInstances[T].push({crossTileID:v.crossTileID,coord:this.getScaledCoordinates(v,i)})}}getScaledCoordinates(i,a){const h=at/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*c.EXTENT+i.anchorX)*h),y:Math.floor((a.canonical.y*c.EXTENT+i.anchorY)*h)}}findMatches(i,a,h){const _=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let v=0;v<i.length;v++){const T=i.get(v);if(T.crossTileID)continue;const C=this.indexedSymbolInstances[T.key];if(!C)continue;const I=this.getScaledCoordinates(T,a);for(const z of C)if(Math.abs(z.coord.x-I.x)<=_&&Math.abs(z.coord.y-I.y)<=_&&!h[z.crossTileID]){h[z.crossTileID]=!0,T.crossTileID=z.crossTileID;break}}}}class Ye{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class yt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const a=Math.round((i-this.lng)/360);if(a!==0)for(const h in this.indexes){const _=this.indexes[h],v={};for(const T in _){const C=_[T];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+a),v[C.tileID.key]=C}this.indexes[h]=v}this.lng=i}addBucket(i,a,h){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let v=0;v<a.symbolInstances.length;v++)a.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const _=this.usedCrossTileIDs[i.overscaledZ];for(const v in this.indexes){const T=this.indexes[v];if(Number(v)>i.overscaledZ)for(const C in T){const I=T[C];I.tileID.isChildOf(i)&&I.findMatches(a.symbolInstances,i,_)}else{const C=T[i.scaledTo(Number(v)).key];C&&C.findMatches(a.symbolInstances,i,_)}}for(let v=0;v<a.symbolInstances.length;v++){const T=a.symbolInstances.get(v);T.crossTileID||(T.crossTileID=h.generate(),_[T.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new ct(i,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(i,a){for(const h in a.indexedSymbolInstances)for(const _ of a.indexedSymbolInstances[h])delete this.usedCrossTileIDs[i][_.crossTileID]}removeStaleBuckets(i){let a=!1;for(const h in this.indexes){const _=this.indexes[h];for(const v in _)i[_[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,_[v]),delete _[v],a=!0)}return a}}class xt{constructor(){this.layerIndexes={},this.crossTileIDs=new Ye,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,a,h){let _=this.layerIndexes[i.id];_===void 0&&(_=this.layerIndexes[i.id]=new yt);let v=!1;const T={};_.handleWrapJump(h);for(const C of a){const I=C.getBucket(i);I&&i.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(C.tileID,I,this.crossTileIDs)&&(v=!0),T[I.bucketInstanceId]=!0)}return _.removeStaleBuckets(T)&&(v=!0),v}pruneUnusedLayers(i){const a={};i.forEach(h=>{a[h]=!0});for(const h in this.layerIndexes)a[h]||delete this.layerIndexes[h]}}var Wt=c.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Et extends c.Evented{constructor(i){super(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=i._cache.max,i.usedForTerrain=!0,i.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const i in this._tiles){const a=this._tiles[i];a.textures.forEach(h=>h.destroy()),a.textures=[]}}update(i,a){this.sourceCache.update(i,a),this._renderableTilesKeys=[];for(const h of i.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.posMatrix=new Float64Array(16),c.ortho(h.posMatrix,0,c.EXTENT,0,c.EXTENT,0,1),this._tiles[h.key]=new Dt(h,this.tileSize))}removeOutdated(i){const a={};this.renderHistory=this.renderHistory.filter((h,_)=>this.renderHistory.indexOf(h)===_).slice(0,this.renderHistorySize);for(const h of this._renderableTilesKeys)a[h]=!0;for(const h of this.renderHistory)a[h]=!0;for(const h in this._tiles)a[h]||(this._tiles[h].clearTextures(i),delete this._tiles[h])}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i){const a={};for(const h of this._renderableTilesKeys){const _=this._tiles[h].tileID;if(_.canonical.equals(i.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16),c.ortho(v.posMatrix,0,c.EXTENT,0,c.EXTENT,0,1),a[h]=v}else if(_.canonical.isChildOf(i.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16);const T=_.canonical.z-i.canonical.z,C=_.canonical.x-(_.canonical.x>>T<<T),I=_.canonical.y-(_.canonical.y>>T<<T),z=c.EXTENT>>T;c.ortho(v.posMatrix,0,z,0,z,0,1),c.translate(v.posMatrix,v.posMatrix,[-C*z,-I*z,0]),a[h]=v}else if(i.canonical.isChildOf(_.canonical)){const v=i.clone();v.posMatrix=new Float64Array(16);const T=i.canonical.z-_.canonical.z,C=i.canonical.x-(i.canonical.x>>T<<T),I=i.canonical.y-(i.canonical.y>>T<<T),z=c.EXTENT>>T;c.ortho(v.posMatrix,0,c.EXTENT,0,c.EXTENT,0,1),c.translate(v.posMatrix,v.posMatrix,[C*z,I*z,0]),c.scale(v.posMatrix,v.posMatrix,[1/2**T,1/2**T,0]),a[h]=v}}return a}getSourceTile(i,a){const h=this.sourceCache._source;let _=i.overscaledZ-this.deltaZoom;if(_>h.maxzoom&&(_=h.maxzoom),_<h.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(_).key);let v=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!v||!v.dem)&&a)for(;_>=h.minzoom&&(!v||!v.dem);)v=this.sourceCache.getTileByID(i.scaledTo(_--).key);return v}tilesAfterTime(i=Date.now()){return Object.values(this._tiles).filter(a=>a.timeLoaded>=i)}}class zt{constructor(i,a,h){this.style=i,this.sourceCache=new Et(a),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.elevationOffset=typeof h.elevationOffset=="number"?h.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(i,a,h,_=c.EXTENT){if(!(a>=0&&a<_&&h>=0&&h<_))return this.elevationOffset;let v=0;const T=this.getTerrainData(i);if(T.tile&&T.tile.dem){const C=c.transformMat4$1([],[a/_*c.EXTENT,h/_*c.EXTENT],T.u_terrain_matrix),I=[C[0]*T.tile.dem.dim,C[1]*T.tile.dem.dim],z=[Math.floor(I[0]),Math.floor(I[1])],B=T.tile.dem.get(z[0],z[1]),N=T.tile.dem.get(z[0],z[1]+1),G=T.tile.dem.get(z[0]+1,z[1]),Y=T.tile.dem.get(z[0]+1,z[1]+1);v=c.number(c.number(B,N,I[0]-z[0]),c.number(G,Y,I[0]-z[0]),I[1]-z[1])}return v}rememberForRerender(i,a){for(const h in this.sourceCache._tiles){const _=this.sourceCache._tiles[h];(_.tileID.equals(a)||_.tileID.isChildOf(a))&&(i===this.sourceCache.sourceCache.id&&(_.timeLoaded=Date.now()),this._rerender[i]=this._rerender[i]||{},this._rerender[i][_.tileID.key]=!0)}}needsRerender(i,a){return this._rerender[i]&&this._rerender[i][a.key]}clearRerenderCache(){this._rerender={}}getElevation(i,a,h,_=c.EXTENT){return(this.getDEMElevation(i,a,h,_)+this.elevationOffset)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const _=this.style.map.painter.context,v=new c.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new De(_,v,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new De(_,new c.RGBAImage({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.identity([])}const a=this.sourceCache.getSourceTile(i,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const _=this.style.map.painter.context;a.demTexture=this.style.map.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new De(_,a.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),a.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const h=a&&a+a.tileID.key+i.key;if(h&&!this._demMatrixCache[h]){const _=this.sourceCache.sourceCache._source.maxzoom;let v=i.canonical.z-a.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=_?v=i.canonical.z-_:c.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const T=i.canonical.x-(i.canonical.x>>v<<v),C=i.canonical.y-(i.canonical.y>>v<<v),I=c.fromScaling(new Float64Array(16),[1/(c.EXTENT<<v),1/(c.EXTENT<<v),0]);c.translate(I,I,[T*c.EXTENT,C*c.EXTENT,0]),this._demMatrixCache[i.key]={matrix:I,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getRTTFramebuffer(){const i=this.style.map.painter;if(!this._rttFramebuffer){const a=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=i.context.createFramebuffer(a,a,!0),this._rttFramebuffer.depthAttachment.set(i.context.createRenderbuffer(i.context.gl.DEPTH_COMPONENT16,a,a))}return this._rttFramebuffer}getFramebuffer(i){const a=this.style.map.painter,h=a.width/devicePixelRatio,_=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new De(a.context,{width:h,height:_,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new De(a.context,{width:h,height:_,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(h,_,!0),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,h,_))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let v=0,T=0;v<this._coordsTextureSize;v++)for(let C=0;C<this._coordsTextureSize;C++,T+=4)a[T+0]=255&C,a[T+1]=255&v,a[T+2]=C>>8<<4|v>>8,a[T+3]=0;const h=new c.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),_=new De(i,h,i.gl.RGBA,{premultiply:!1});return _.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(i){const a=new Uint8Array(4),h=this.style.map.painter,_=h.context,v=_.gl;_.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),v.readPixels(i.x,h.height/devicePixelRatio-i.y-1,1,1,v.RGBA,v.UNSIGNED_BYTE,a),_.bindFramebuffer.set(null);const T=a[0]+(a[2]>>4<<8),C=a[1]+((15&a[2])<<8),I=this.coordsIndex[255-a[3]],z=I&&this.sourceCache.getTileByID(I);if(!z)return null;const B=this._coordsTextureSize,N=(1<<z.tileID.canonical.z)*B;return new c.MercatorCoordinate((z.tileID.canonical.x*B+T)/N,(z.tileID.canonical.y*B+C)/N,this.getElevation(z.tileID,T,C,B))}getTerrainMesh(){if(this._mesh)return this._mesh;const i=this.style.map.painter.context,a=new c.PosArray,h=new c.TriangleIndexArray,_=this.meshSize,v=c.EXTENT/_,T=_*_;for(let C=0;C<=_;C++)for(let I=0;I<=_;I++)a.emplaceBack(I*v,C*v);for(let C=0;C<T;C+=_+1)for(let I=0;I<_;I++)h.emplaceBack(I+C,_+I+C+1,_+I+C+2),h.emplaceBack(I+C,_+I+C+2,I+C+1);return this._mesh={indexBuffer:i.createIndexBuffer(h),vertexBuffer:i.createVertexBuffer(a,Wt.members),segments:c.SegmentVector.simpleSegment(0,0,a.length,h.length)},this._mesh}getMinMaxElevation(i){const a=this.getTerrainData(i).tile,h={minElevation:null,maxElevation:null};return a&&a.dem&&(h.minElevation=(a.dem.min+this.elevationOffset)*this.exaggeration,h.maxElevation=(a.dem.max+this.elevationOffset)*this.exaggeration),h}}const Vt=(f,i)=>c.emitValidationErrors(f,i&&i.filter(a=>a.identifier!=="source.canvas")),Jt=c.pick(qt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ui=c.pick(qt,["setCenter","setZoom","setBearing","setPitch"]),gi=function(){const f={},i=c.spec.$version;for(const a in c.spec.$root){const h=c.spec.$root[a];if(h.required){let _=null;_=a==="version"?i:h.type==="array"?[]:{},_!=null&&(f[a]=_)}}return f}();class Ri extends c.Evented{constructor(i,a={}){super(),this.map=i,this.dispatcher=new Ct(Oo(),this),this.imageManager=new ye,this.imageManager.setEventedParent(this),this.glyphManager=new $e(i._requestManager,a.localIdeographFontFamily),this.lineAtlas=new ci(256,512),this.crossTileSymbolIndex=new xt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.getReferrer());const h=this;this._rtlTextPluginCallback=Ri.registerForPluginStateChange(_=>{h.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(v,T)=>{if(c.triggerPluginCompletionEvent(v),T&&T.every(C=>C))for(const C in h.sourceCaches)h.sourceCaches[C].reload()})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const v=this.sourceCaches[_.sourceId];if(!v)return;const T=v.getSource();if(T&&T.vectorLayerIds)for(const C in this._layers){const I=this._layers[C];I.source===T.id&&this._validateLayer(I)}})}loadURL(i,a={}){this.fire(new c.Event("dataloading",{dataType:"style"}));const h=typeof a.validate!="boolean"||a.validate,_=this.map._requestManager.transformRequest(i,c.ResourceType.Style);this._request=c.getJSON(_,(v,T)=>{this._request=null,v?this.fire(new c.ErrorEvent(v)):T&&this._load(T,h)})}loadJSON(i,a={}){this.fire(new c.Event("dataloading",{dataType:"style"})),this._request=c.exported.frame(()=>{this._request=null,this._load(i,a.validate!==!1)})}loadEmpty(){this.fire(new c.Event("dataloading",{dataType:"style"})),this._load(gi,!1)}_load(i,a){if(a&&Vt(this,c.validateStyle(i)))return;this._loaded=!0,this.stylesheet=i;for(const _ in i.sources)this.addSource(_,i.sources[_],{validate:!1});i.sprite?this._loadSprite(i.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(i.glyphs);const h=po(this.stylesheet.layers);this._order=h.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of h)_=c.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new pt(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new c.Event("data",{dataType:"style"})),this.fire(new c.Event("style.load"))}_loadSprite(i){this._spriteRequest=function(a,h,_,v){let T,C,I;const z=_>1?"@2x":"";let B=c.getJSON(h.transformRequest(h.normalizeSpriteURL(a,z,".json"),c.ResourceType.SpriteJSON),(Y,X)=>{B=null,I||(I=Y,T=X,G())}),N=c.getImage(h.transformRequest(h.normalizeSpriteURL(a,z,".png"),c.ResourceType.SpriteImage),(Y,X)=>{N=null,I||(I=Y,C=X,G())});function G(){if(I)v(I);else if(T&&C){const Y=c.exported.getImageData(C),X={};for(const J in T){const{width:ae,height:pe,x:ve,y:Q,sdf:be,pixelRatio:xe,stretchX:Ae,stretchY:ze,content:Fe}=T[J],Ce=new c.RGBAImage({width:ae,height:pe});c.RGBAImage.copy(Y,Ce,{x:ve,y:Q},{x:0,y:0},{width:ae,height:pe}),X[J]={data:Ce,pixelRatio:xe,sdf:be,stretchX:Ae,stretchY:ze,content:Fe}}v(null,X)}}return{cancel(){B&&(B.cancel(),B=null),N&&(N.cancel(),N=null)}}}(i,this.map._requestManager,this.map.getPixelRatio(),(a,h)=>{if(this._spriteRequest=null,a)this.fire(new c.ErrorEvent(a));else if(h)for(const _ in h)this.imageManager.addImage(_,h[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))})}_validateLayer(i){const a=this.sourceCaches[i.source];if(!a)return;const h=i.sourceLayer;if(!h)return;const _=a.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(h)===-1)&&this.fire(new c.ErrorEvent(new Error(`Source layer "${h}" does not exist on source "${_.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const a=[];for(const h of i){const _=this._layers[h];_.type!=="custom"&&a.push(_.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const i in this.sourceCaches)if(this.sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const a=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),v=Object.keys(this._removedLayers);(_.length||v.length)&&this._updateWorkerLayers(_,v);for(const T in this._updatedSources){const C=this._updatedSources[T];if(C==="reload")this._reloadSource(T);else{if(C!=="clear")throw new Error(`Invalid action ${C}`);this._clearSource(T)}}this._updateTilesForChangedImages();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(i);this.light.updateTransitions(i),this._resetUpdates()}const h={};for(const _ in this.sourceCaches){const v=this.sourceCaches[_];h[_]=v.used,v.used=!1}for(const _ of this._order){const v=this._layers[_];v.recalculate(i,this._availableImages),!v.isHidden(i.zoom)&&v.source&&(this.sourceCaches[v.source].used=!0)}for(const _ in h){const v=this.sourceCaches[_];h[_]!==v.used&&v.fire(new c.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(i),this.z=i.zoom,a&&this.fire(new c.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,a){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(i){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),i){const a=this.sourceCaches[i.source];if(!a)throw new Error(`cannot load terrain, because there exists no source with ID: ${i.source}`);this.terrain=new zt(this,a,i),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=h=>{h.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=h=>{h.tile&&(h.sourceId===i.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(h.sourceId,h.tile.tileID)):h.source.type==="geojson"&&this.terrain.rememberForRerender(h.sourceId,h.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new c.Event("terrain",{terrain:i}))}setState(i){if(this._checkLoaded(),Vt(this,c.validateStyle(i)))return!1;(i=c.clone$1(i)).layers=po(i.layers);const a=function(_,v){if(!_)return[{command:qt.setStyle,args:[v]}];let T=[];try{if(!ge(_.version,v.version))return[{command:qt.setStyle,args:[v]}];ge(_.center,v.center)||T.push({command:qt.setCenter,args:[v.center]}),ge(_.zoom,v.zoom)||T.push({command:qt.setZoom,args:[v.zoom]}),ge(_.bearing,v.bearing)||T.push({command:qt.setBearing,args:[v.bearing]}),ge(_.pitch,v.pitch)||T.push({command:qt.setPitch,args:[v.pitch]}),ge(_.sprite,v.sprite)||T.push({command:qt.setSprite,args:[v.sprite]}),ge(_.glyphs,v.glyphs)||T.push({command:qt.setGlyphs,args:[v.glyphs]}),ge(_.transition,v.transition)||T.push({command:qt.setTransition,args:[v.transition]}),ge(_.light,v.light)||T.push({command:qt.setLight,args:[v.light]});const C={},I=[];(function(B,N,G,Y){let X;for(X in N=N||{},B=B||{})Object.prototype.hasOwnProperty.call(B,X)&&(Object.prototype.hasOwnProperty.call(N,X)||wr(X,G,Y));for(X in N)Object.prototype.hasOwnProperty.call(N,X)&&(Object.prototype.hasOwnProperty.call(B,X)?ge(B[X],N[X])||(B[X].type==="geojson"&&N[X].type==="geojson"&&ps(B,N,X)?G.push({command:qt.setGeoJSONSourceData,args:[X,N[X].data]}):Zr(X,N,G,Y)):or(X,N,G))})(_.sources,v.sources,I,C);const z=[];_.layers&&_.layers.forEach(B=>{C[B.source]?T.push({command:qt.removeLayer,args:[B.id]}):z.push(B)}),T=T.concat(I),function(B,N,G){N=N||[];const Y=(B=B||[]).map(jr),X=N.map(jr),J=B.reduce(fo,{}),ae=N.reduce(fo,{}),pe=Y.slice(),ve=Object.create(null);let Q,be,xe,Ae,ze,Fe,Ce;for(Q=0,be=0;Q<Y.length;Q++)xe=Y[Q],Object.prototype.hasOwnProperty.call(ae,xe)?be++:(G.push({command:qt.removeLayer,args:[xe]}),pe.splice(pe.indexOf(xe,be),1));for(Q=0,be=0;Q<X.length;Q++)xe=X[X.length-1-Q],pe[pe.length-1-Q]!==xe&&(Object.prototype.hasOwnProperty.call(J,xe)?(G.push({command:qt.removeLayer,args:[xe]}),pe.splice(pe.lastIndexOf(xe,pe.length-be),1)):be++,Fe=pe[pe.length-Q],G.push({command:qt.addLayer,args:[ae[xe],Fe]}),pe.splice(pe.length-Q,0,xe),ve[xe]=!0);for(Q=0;Q<X.length;Q++)if(xe=X[Q],Ae=J[xe],ze=ae[xe],!ve[xe]&&!ge(Ae,ze))if(ge(Ae.source,ze.source)&&ge(Ae["source-layer"],ze["source-layer"])&&ge(Ae.type,ze.type)){for(Ce in Gr(Ae.layout,ze.layout,G,xe,null,qt.setLayoutProperty),Gr(Ae.paint,ze.paint,G,xe,null,qt.setPaintProperty),ge(Ae.filter,ze.filter)||G.push({command:qt.setFilter,args:[xe,ze.filter]}),ge(Ae.minzoom,ze.minzoom)&&ge(Ae.maxzoom,ze.maxzoom)||G.push({command:qt.setLayerZoomRange,args:[xe,ze.minzoom,ze.maxzoom]}),Ae)Object.prototype.hasOwnProperty.call(Ae,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?Gr(Ae[Ce],ze[Ce],G,xe,Ce.slice(6),qt.setPaintProperty):ge(Ae[Ce],ze[Ce])||G.push({command:qt.setLayerProperty,args:[xe,Ce,ze[Ce]]}));for(Ce in ze)Object.prototype.hasOwnProperty.call(ze,Ce)&&!Object.prototype.hasOwnProperty.call(Ae,Ce)&&Ce!=="layout"&&Ce!=="paint"&&Ce!=="filter"&&Ce!=="metadata"&&Ce!=="minzoom"&&Ce!=="maxzoom"&&(Ce.indexOf("paint.")===0?Gr(Ae[Ce],ze[Ce],G,xe,Ce.slice(6),qt.setPaintProperty):ge(Ae[Ce],ze[Ce])||G.push({command:qt.setLayerProperty,args:[xe,Ce,ze[Ce]]}))}else G.push({command:qt.removeLayer,args:[xe]}),Fe=pe[pe.lastIndexOf(xe)+1],G.push({command:qt.addLayer,args:[ze,Fe]})}(z,v.layers,T)}catch(C){console.warn("Unable to compute style diff:",C),T=[{command:qt.setStyle,args:[v]}]}return T}(this.serialize(),i).filter(_=>!(_.command in Ui));if(a.length===0)return!1;const h=a.filter(_=>!(_.command in Jt));if(h.length>0)throw new Error(`Unimplemented: ${h.map(_=>_.command).join(", ")}.`);return a.forEach(_=>{_.command!=="setTransition"&&this[_.command].apply(this,_.args)}),this.stylesheet=i,!0}addImage(i,a){if(this.getImage(i))return this.fire(new c.ErrorEvent(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,a),this._afterImageUpdated(i)}updateImage(i,a){this.imageManager.updateImage(i,a)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new c.ErrorEvent(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,a,h={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.validateStyle.source,`sources.${i}`,a,null,h))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const _=this.sourceCaches[i]=new fn(i,a,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:_.serialize(),sourceId:i})),_.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===i)return this.fire(new c.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${h}" is using it.`)));const a=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],a.fire(new c.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,a){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const h=this.sourceCaches[i].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(a),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,a,h={}){this._checkLoaded();const _=i.id;if(this.getLayer(_))return void this.fire(new c.ErrorEvent(new Error(`Layer "${_}" already exists on this map.`)));let v;if(i.type==="custom"){if(Vt(this,c.validateCustomStyleLayer(i)))return;v=c.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(_,i.source),i=c.clone$1(i),i=c.extend(i,{source:_})),this._validate(c.validateStyle.layer,`layers.${_}`,i,{arrayIndex:-1},h))return;v=c.createStyleLayer(i),this._validateLayer(v),v.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[v.id]=v.serialize()}const T=a?this._order.indexOf(a):this._order.length;if(a&&T===-1)this.fire(new c.ErrorEvent(new Error(`Cannot add layer "${_}" before non-existing layer "${a}".`)));else{if(this._order.splice(T,0,_),this._layerOrderChanged=!0,this._layers[_]=v,this._removedLayers[_]&&v.source&&v.type!=="custom"){const C=this._removedLayers[_];delete this._removedLayers[_],C.type!==v.type?this._updatedSources[v.source]="clear":(this._updatedSources[v.source]="reload",this.sourceCaches[v.source].pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map)}}moveLayer(i,a){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new c.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===a)return;const h=this._order.indexOf(i);this._order.splice(h,1);const _=a?this._order.indexOf(a):this._order.length;a&&_===-1?this.fire(new c.ErrorEvent(new Error(`Cannot move layer "${i}" before non-existing layer "${a}".`))):(this._order.splice(_,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const a=this._layers[i];if(!a)return void this.fire(new c.ErrorEvent(new Error(`Cannot remove non-existing layer "${i}".`)));a.setEventedParent(null);const h=this._order.indexOf(i);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=a,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],a.onRemove&&a.onRemove(this.map)}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,a,h){this._checkLoaded();const _=this.getLayer(i);_?_.minzoom===a&&_.maxzoom===h||(a!=null&&(_.minzoom=a),h!=null&&(_.maxzoom=h),this._updateLayer(_)):this.fire(new c.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,a,h={}){this._checkLoaded();const _=this.getLayer(i);if(_){if(!ge(_.filter,a))return a==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(c.validateStyle.filter,`layers.${_.id}.filter`,a,null,h)||(_.filter=c.clone$1(a),this._updateLayer(_)))}else this.fire(new c.ErrorEvent(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return c.clone$1(this.getLayer(i).filter)}setLayoutProperty(i,a,h,_={}){this._checkLoaded();const v=this.getLayer(i);v?ge(v.getLayoutProperty(a),h)||(v.setLayoutProperty(a,h,_),this._updateLayer(v)):this.fire(new c.ErrorEvent(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,a){const h=this.getLayer(i);if(h)return h.getLayoutProperty(a);this.fire(new c.ErrorEvent(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,a,h,_={}){this._checkLoaded();const v=this.getLayer(i);v?ge(v.getPaintProperty(a),h)||(v.setPaintProperty(a,h,_)&&this._updateLayer(v),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new c.ErrorEvent(new Error(`Cannot style non-existing layer "${i}".`)))}getPaintProperty(i,a){return this.getLayer(i).getPaintProperty(a)}setFeatureState(i,a){this._checkLoaded();const h=i.source,_=i.sourceLayer,v=this.sourceCaches[h];if(v===void 0)return void this.fire(new c.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)));const T=v.getSource().type;T==="geojson"&&_?this.fire(new c.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):T!=="vector"||_?(i.id===void 0&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),v.setFeatureState(_,i.id,a)):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,a){this._checkLoaded();const h=i.source,_=this.sourceCaches[h];if(_===void 0)return void this.fire(new c.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)));const v=_.getSource().type,T=v==="vector"?i.sourceLayer:void 0;v!=="vector"||T?a&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new c.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(T,i.id,a):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const a=i.source,h=i.sourceLayer,_=this.sourceCaches[a];if(_!==void 0)return _.getSource().type!=="vector"||h?(i.id===void 0&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(h,i.id)):void this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.ErrorEvent(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:c.mapObject(this.sourceCaches,i=>i.serialize()),layers:this._serializeLayers(this._order)},i=>i!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(i){const a=T=>this._layers[T].type==="fill-extrusion",h={},_=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(a(C)){h[C]=T;for(const I of i){const z=I[C];if(z)for(const B of z)_.push(B)}}}_.sort((T,C)=>C.intersectionZ-T.intersectionZ);const v=[];for(let T=this._order.length-1;T>=0;T--){const C=this._order[T];if(a(C))for(let I=_.length-1;I>=0;I--){const z=_[I].feature;if(h[z.layer.id]<T)break;v.push(z),_.pop()}else for(const I of i){const z=I[C];if(z)for(const B of z)v.push(B.feature)}}return v}queryRenderedFeatures(i,a,h){a&&a.filter&&this._validate(c.validateStyle.filter,"queryRenderedFeatures.filter",a.filter,null,a);const _={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new c.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const T of a.layers){const C=this._layers[T];if(!C)return this.fire(new c.ErrorEvent(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];_[C.source]=!0}}const v=[];a.availableImages=this._availableImages;for(const T in this.sourceCaches)a.layers&&!_[T]||v.push(ni(this.sourceCaches[T],this._layers,this._serializedLayers,i,a,h));return this.placement&&v.push(function(T,C,I,z,B,N,G){const Y={},X=N.queryRenderedSymbols(z),J=[];for(const ae of Object.keys(X).map(Number))J.push(G[ae]);J.sort(Lt);for(const ae of J){const pe=ae.featureIndex.lookupSymbolFeatures(X[ae.bucketInstanceId],C,ae.bucketIndex,ae.sourceLayerIndex,B.filter,B.layers,B.availableImages,T);for(const ve in pe){const Q=Y[ve]=Y[ve]||[],be=pe[ve];be.sort((xe,Ae)=>{const ze=ae.featureSortOrder;if(ze){const Fe=ze.indexOf(xe.featureIndex);return ze.indexOf(Ae.featureIndex)-Fe}return Ae.featureIndex-xe.featureIndex});for(const xe of be)Q.push(xe)}}for(const ae in Y)Y[ae].forEach(pe=>{const ve=pe.feature,Q=I[T[ae].source].getFeatureState(ve.layer["source-layer"],ve.id);ve.source=ve.layer.source,ve.layer["source-layer"]&&(ve.sourceLayer=ve.layer["source-layer"]),ve.state=Q});return Y}(this._layers,this._serializedLayers,this.sourceCaches,i,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(v)}querySourceFeatures(i,a){a&&a.filter&&this._validate(c.validateStyle.filter,"querySourceFeatures.filter",a.filter,null,a);const h=this.sourceCaches[i];return h?function(_,v){const T=_.getRenderableIds().map(z=>_.getTileByID(z)),C=[],I={};for(let z=0;z<T.length;z++){const B=T[z],N=B.tileID.canonical.key;I[N]||(I[N]=!0,B.querySourceFeatures(C,v))}return C}(h,a):[]}addSourceType(i,a,h){return Ri.getSourceType(i)?h(new Error(`A source type called "${i}" already exists.`)):(Ri.setSourceType(i,a),a.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:a.workerSourceURL},h):h(null,null))}getLight(){return this.light.getLight()}setLight(i,a={}){this._checkLoaded();const h=this.light.getLight();let _=!1;for(const T in i)if(!ge(i[T],h[T])){_=!0;break}if(!_)return;const v={now:c.exported.now(),transition:c.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,a),this.light.updateTransitions(v)}_validate(i,a,h,_,v={}){return(!v||v.validate!==!1)&&Vt(this,i.call(c.validateStyle,c.extend({key:a,style:this.serialize(),value:h,styleSpec:c.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this.sourceCaches){const a=this.sourceCaches[i];a.setEventedParent(null),a.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const a in this.sourceCaches)this.sourceCaches[a].update(i,this.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,a,h,_,v=!1){let T=!1,C=!1;const I={};for(const z of this._order){const B=this._layers[z];if(B.type!=="symbol")continue;if(!I[B.source]){const G=this.sourceCaches[B.source];I[B.source]=G.getRenderableIds(!0).map(Y=>G.getTileByID(Y)).sort((Y,X)=>X.tileID.overscaledZ-Y.tileID.overscaledZ||(Y.tileID.isLessThan(X.tileID)?-1:1))}const N=this.crossTileSymbolIndex.addLayer(B,I[B.source],i.center.lng);T=T||N}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((v=v||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.exported.now(),i.zoom))&&(this.pauseablePlacement=new Ee(i,this.terrain,this._order,v,a,h,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.exported.now()),C=!0),T&&this.pauseablePlacement.placement.setStale()),C||T)for(const z of this._order){const B=this._layers[z];B.type==="symbol"&&this.placement.updateLayerOpacities(B,I[B.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.exported.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,a,h){this.imageManager.getImages(a.icons,h),this._updateTilesForChangedImages();const _=this.sourceCaches[a.source];_&&_.setDependencies(a.tileID.key,a.type,a.icons)}getGlyphs(i,a,h){this.glyphManager.getGlyphs(a.stacks,h)}getResource(i,a,h){return c.makeRequest(a,h)}}Ri.getSourceType=function(f){return Ut[f]},Ri.setSourceType=function(f,i){Ut[f]=i},Ri.registerForPluginStateChange=c.registerForPluginStateChange;var Gt="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const di={prelude:ti(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:ti(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ti(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ti(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ti("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ti(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:ti(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ti("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ti("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ti("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ti(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:ti(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:ti(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:ti(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ti(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ti(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ti(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ti(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ti(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ti(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ti(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ti(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ti(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ti(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ti(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ti(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ti("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Gt),terrainDepth:ti("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Gt),terrainCoords:ti("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Gt)};function ti(f,i){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=i.match(/attribute ([\w]+) ([\w]+)/g),_=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),v=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),T=v?v.concat(_):_,C={};return{fragmentSource:f=f.replace(a,(I,z,B,N,G)=>(C[G]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${G}
varying ${B} ${N} ${G};
#else
uniform ${B} ${N} u_${G};
#endif
`:`
#ifdef HAS_UNIFORM_u_${G}
    ${B} ${N} ${G} = u_${G};
#endif
`)),vertexSource:i=i.replace(a,(I,z,B,N,G)=>{const Y=N==="float"?"vec2":"vec4",X=G.match(/color/)?"color":Y;return C[G]?z==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${B} ${Y} a_${G};
varying ${B} ${N} ${G};
#else
uniform ${B} ${N} u_${G};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${B} ${N} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${X}(a_${G}, u_${G}_t);
#else
    ${B} ${N} ${G} = u_${G};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
attribute ${B} ${Y} a_${G};
#else
uniform ${B} ${N} u_${G};
#endif
`:X==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${B} ${N} ${G} = a_${G};
#else
    ${B} ${N} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${B} ${N} ${G} = unpack_mix_${X}(a_${G}, u_${G}_t);
#else
    ${B} ${N} ${G} = u_${G};
#endif
`}),staticAttributes:h,staticUniforms:T}}class yo{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,a,h,_,v,T,C,I,z){this.context=i;let B=this.boundPaintVertexBuffers.length!==_.length;for(let N=0;!B&&N<_.length;N++)this.boundPaintVertexBuffers[N]!==_[N]&&(B=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===h&&!B&&this.boundIndexBuffer===v&&this.boundVertexOffset===T&&this.boundDynamicVertexBuffer===C&&this.boundDynamicVertexBuffer2===I&&this.boundDynamicVertexBuffer3===z?(i.bindVertexArrayOES.set(this.vao),C&&C.bind(),v&&v.dynamicDraw&&v.bind(),I&&I.bind(),z&&z.bind()):this.freshBind(a,h,_,v,T,C,I,z)}freshBind(i,a,h,_,v,T,C,I){let z;const B=i.numAttributes,N=this.context,G=N.gl;if(N.extVertexArrayObject)this.vao&&this.destroy(),this.vao=N.extVertexArrayObject.createVertexArrayOES(),N.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=i,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=_,this.boundVertexOffset=v,this.boundDynamicVertexBuffer=T,this.boundDynamicVertexBuffer2=C,this.boundDynamicVertexBuffer3=I;else{z=N.currentNumAttributes||0;for(let Y=B;Y<z;Y++)G.disableVertexAttribArray(Y)}a.enableAttributes(G,i);for(const Y of h)Y.enableAttributes(G,i);T&&T.enableAttributes(G,i),C&&C.enableAttributes(G,i),I&&I.enableAttributes(G,i),a.bind(),a.setVertexAttribPointers(G,i,v);for(const Y of h)Y.bind(),Y.setVertexAttribPointers(G,i,v);T&&(T.bind(),T.setVertexAttribPointers(G,i,v)),_&&_.bind(),C&&(C.bind(),C.setVertexAttribPointers(G,i,v)),I&&(I.bind(),I.setVertexAttribPointers(G,i,v)),N.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function vo(f){const i=[];for(let a=0;a<f.length;a++){if(f[a]===null)continue;const h=f[a].split(" ");i.push(h.pop())}return i}class wa{constructor(i,a,h,_,v,T,C){const I=i.gl;this.program=I.createProgram();const z=vo(h.staticAttributes),B=_?_.getBinderAttributes():[],N=z.concat(B),G=di.prelude.staticUniforms?vo(di.prelude.staticUniforms):[],Y=h.staticUniforms?vo(h.staticUniforms):[],X=_?_.getBinderUniforms():[],J=G.concat(Y).concat(X),ae=[];for(const ze of J)ae.indexOf(ze)<0&&ae.push(ze);const pe=_?_.defines():[];T&&pe.push("#define OVERDRAW_INSPECTOR;"),C&&pe.push("#define TERRAIN3D;");const ve=pe.concat(di.prelude.fragmentSource,h.fragmentSource).join(`
`),Q=pe.concat(di.prelude.vertexSource,h.vertexSource).join(`
`),be=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(be,ve),I.compileShader(be),I.attachShader(this.program,be);const xe=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(xe,Q),I.compileShader(xe),I.attachShader(this.program,xe),this.attributes={};const Ae={};this.numAttributes=N.length;for(let ze=0;ze<this.numAttributes;ze++)N[ze]&&(I.bindAttribLocation(this.program,ze,N[ze]),this.attributes[N[ze]]=ze);I.linkProgram(this.program),I.deleteShader(xe),I.deleteShader(be);for(let ze=0;ze<ae.length;ze++){const Fe=ae[ze];if(Fe&&!Ae[Fe]){const Ce=I.getUniformLocation(this.program,Fe);Ce&&(Ae[Fe]=Ce)}}this.fixedUniforms=v(i,Ae),this.terrainUniforms=((ze,Fe)=>({u_depth:new c.Uniform1i(ze,Fe.u_depth),u_terrain:new c.Uniform1i(ze,Fe.u_terrain),u_terrain_dim:new c.Uniform1f(ze,Fe.u_terrain_dim),u_terrain_matrix:new c.UniformMatrix4f(ze,Fe.u_terrain_matrix),u_terrain_unpack:new c.Uniform4f(ze,Fe.u_terrain_unpack),u_terrain_offset:new c.Uniform1f(ze,Fe.u_terrain_offset),u_terrain_exaggeration:new c.Uniform1f(ze,Fe.u_terrain_exaggeration)}))(i,Ae),this.binderUniforms=_?_.getUniforms(i,Ae):[]}draw(i,a,h,_,v,T,C,I,z,B,N,G,Y,X,J,ae,pe,ve){const Q=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(h),i.setStencilMode(_),i.setColorMode(v),i.setCullFace(T),I){i.activeTexture.set(Q.TEXTURE2),Q.bindTexture(Q.TEXTURE_2D,I.depthTexture),i.activeTexture.set(Q.TEXTURE3),Q.bindTexture(Q.TEXTURE_2D,I.texture);for(const xe in this.terrainUniforms)this.terrainUniforms[xe].set(I[xe])}for(const xe in this.fixedUniforms)this.fixedUniforms[xe].set(C[xe]);J&&J.setUniforms(i,this.binderUniforms,Y,{zoom:X});let be=0;switch(a){case Q.LINES:be=2;break;case Q.TRIANGLES:be=3;break;case Q.LINE_STRIP:be=1}for(const xe of G.get()){const Ae=xe.vaos||(xe.vaos={});(Ae[z]||(Ae[z]=new yo)).bind(i,this,B,J?J.getPaintVertexBuffers():[],N,xe.vertexOffset,ae,pe,ve),Q.drawElements(a,xe.primitiveLength*be,Q.UNSIGNED_SHORT,xe.primitiveOffset*be*2)}}}function Rt(f,i,a){const h=1/Di(a,1,i.transform.tileZoom),_=Math.pow(2,a.tileID.overscaledZ),v=a.tileSize*Math.pow(2,i.transform.tileZoom)/_,T=v*(a.tileID.canonical.x+a.tileID.wrap*_),C=v*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[h,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C]}}const Ei=(f,i,a,h)=>{const _=i.style.light,v=_.properties.get("position"),T=[v.x,v.y,v.z],C=c.create$1();_.properties.get("anchor")==="viewport"&&c.fromRotation(C,-i.transform.angle),c.transformMat3(T,T,C);const I=_.properties.get("color");return{u_matrix:f,u_lightpos:T,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+a,u_opacity:h}},fl=(f,i,a,h,_,v,T)=>c.extend(Ei(f,i,a,h),Rt(v,i,T),{u_height_factor:-Math.pow(2,_.overscaledZ)/T.tileSize/8}),Uo=f=>({u_matrix:f}),Tn=(f,i,a,h)=>c.extend(Uo(f),Rt(a,i,h)),eu=(f,i)=>({u_matrix:f,u_world:i}),Ls=(f,i,a,h,_)=>c.extend(Tn(f,i,a,h),{u_world:_}),xo=(f,i,a,h)=>{const _=f.transform;let v,T;if(h.paint.get("circle-pitch-alignment")==="map"){const C=Di(a,1,_.zoom);v=!0,T=[C,C]}else v=!1,T=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(h.paint.get("circle-pitch-scale")==="map"),u_matrix:f.translatePosMatrix(i.posMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+v,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:T}},yi=(f,i,a)=>{const h=Di(a,1,i.zoom),_=Math.pow(2,i.zoom-a.tileID.overscaledZ),v=a.tileID.overscaleFactor();return{u_matrix:f,u_camera_to_center_distance:i.cameraToCenterDistance,u_pixels_to_tile_units:h,u_extrude_scale:[i.pixelsToGLUnits[0]/(h*_),i.pixelsToGLUnits[1]/(h*_)],u_overscale_factor:v}},sr=(f,i,a=1)=>({u_matrix:f,u_color:i,u_overlay:0,u_overlay_scale:a}),Sr=f=>({u_matrix:f}),wo=(f,i,a,h)=>({u_matrix:f,u_extrude_scale:Di(i,1,a),u_intensity:h});function _s(f,i){const a=Math.pow(2,i.canonical.z),h=i.canonical.y;return[new c.MercatorCoordinate(0,h/a).toLngLat().lat,new c.MercatorCoordinate(0,(h+1)/a).toLngLat().lat]}const Er=(f,i,a,h)=>{const _=f.transform;return{u_matrix:Vo(f,i,a,h),u_ratio:1/Di(i,1,_.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},Ds=(f,i,a,h,_)=>c.extend(Er(f,i,a,_),{u_image:0,u_image_height:h}),gs=(f,i,a,h,_)=>{const v=f.transform,T=pi(i,v);return{u_matrix:Vo(f,i,a,_),u_texsize:i.imageAtlasTexture.size,u_ratio:1/Di(i,1,v.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[T,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},bo=(f,i,a,h,_,v)=>{const T=f.lineAtlas,C=pi(i,f.transform),I=a.layout.get("line-cap")==="round",z=T.getDash(h.from,I),B=T.getDash(h.to,I),N=z.width*_.fromScale,G=B.width*_.toScale;return c.extend(Er(f,i,a,v),{u_patternscale_a:[C/N,-z.height/2],u_patternscale_b:[C/G,-B.height/2],u_sdfgamma:T.width/(256*Math.min(N,G)*f.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:B.y,u_mix:_.t})};function pi(f,i){return 1/Di(f,1,i.tileZoom)}function Vo(f,i,a,h){return f.translatePosMatrix(h?h.posMatrix:i.tileID.posMatrix,i,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Rs=(f,i,a,h,_)=>{return{u_matrix:f,u_tl_parent:i,u_scale_parent:a,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(T=_.paint.get("raster-saturation"),T>0?1-1/(1.001-T):-T),u_contrast_factor:(v=_.paint.get("raster-contrast"),v>0?1/(1-v):1+v),u_spin_weights:ml(_.paint.get("raster-hue-rotate"))};var v,T};function ml(f){f*=Math.PI/180;const i=Math.sin(f),a=Math.cos(f);return[(2*a+1)/3,(-Math.sqrt(3)*i-a+1)/3,(Math.sqrt(3)*i-a+1)/3]}const Bs=(f,i,a,h,_,v,T,C,I,z)=>{const B=_.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:B.width/B.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:T,u_coord_matrix:C,u_is_text:+I,u_pitch_with_map:+h,u_texsize:z,u_texture:0}},ba=(f,i,a,h,_,v,T,C,I,z,B)=>{const N=_.transform;return c.extend(Bs(f,i,a,h,_,v,T,C,I,z),{u_gamma_scale:h?Math.cos(N._pitch)*N.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+B})},Mt=(f,i,a,h,_,v,T,C,I,z)=>c.extend(ba(f,i,a,h,_,v,T,C,!0,I,!0),{u_texsize_icon:z,u_texture_icon:1}),Pr=(f,i,a)=>({u_matrix:f,u_opacity:i,u_color:a}),vi=(f,i,a,h,_,v)=>c.extend(function(T,C,I,z){const B=I.imageManager.getPattern(T.from.toString()),N=I.imageManager.getPattern(T.to.toString()),{width:G,height:Y}=I.imageManager.getPixelSize(),X=Math.pow(2,z.tileID.overscaledZ),J=z.tileSize*Math.pow(2,I.transform.tileZoom)/X,ae=J*(z.tileID.canonical.x+z.tileID.wrap*X),pe=J*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:B.tl,u_pattern_br_a:B.br,u_pattern_tl_b:N.tl,u_pattern_br_b:N.br,u_texsize:[G,Y],u_mix:C.t,u_pattern_size_a:B.displaySize,u_pattern_size_b:N.displaySize,u_scale_a:C.fromScale,u_scale_b:C.toScale,u_tile_units_to_pixels:1/Di(z,1,I.transform.tileZoom),u_pixel_coord_upper:[ae>>16,pe>>16],u_pixel_coord_lower:[65535&ae,65535&pe]}}(h,v,a,_),{u_matrix:f,u_opacity:i}),Ta={fillExtrusion:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_lightpos:new c.Uniform3f(f,i.u_lightpos),u_lightintensity:new c.Uniform1f(f,i.u_lightintensity),u_lightcolor:new c.Uniform3f(f,i.u_lightcolor),u_vertical_gradient:new c.Uniform1f(f,i.u_vertical_gradient),u_opacity:new c.Uniform1f(f,i.u_opacity)}),fillExtrusionPattern:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_lightpos:new c.Uniform3f(f,i.u_lightpos),u_lightintensity:new c.Uniform1f(f,i.u_lightintensity),u_lightcolor:new c.Uniform3f(f,i.u_lightcolor),u_vertical_gradient:new c.Uniform1f(f,i.u_vertical_gradient),u_height_factor:new c.Uniform1f(f,i.u_height_factor),u_image:new c.Uniform1i(f,i.u_image),u_texsize:new c.Uniform2f(f,i.u_texsize),u_pixel_coord_upper:new c.Uniform2f(f,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,i.u_pixel_coord_lower),u_scale:new c.Uniform3f(f,i.u_scale),u_fade:new c.Uniform1f(f,i.u_fade),u_opacity:new c.Uniform1f(f,i.u_opacity)}),fill:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix)}),fillPattern:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_image:new c.Uniform1i(f,i.u_image),u_texsize:new c.Uniform2f(f,i.u_texsize),u_pixel_coord_upper:new c.Uniform2f(f,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,i.u_pixel_coord_lower),u_scale:new c.Uniform3f(f,i.u_scale),u_fade:new c.Uniform1f(f,i.u_fade)}),fillOutline:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_world:new c.Uniform2f(f,i.u_world)}),fillOutlinePattern:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_world:new c.Uniform2f(f,i.u_world),u_image:new c.Uniform1i(f,i.u_image),u_texsize:new c.Uniform2f(f,i.u_texsize),u_pixel_coord_upper:new c.Uniform2f(f,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,i.u_pixel_coord_lower),u_scale:new c.Uniform3f(f,i.u_scale),u_fade:new c.Uniform1f(f,i.u_fade)}),circle:(f,i)=>({u_camera_to_center_distance:new c.Uniform1f(f,i.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(f,i.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(f,i.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(f,i.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(f,i.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(f,i.u_matrix)}),collisionBox:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_camera_to_center_distance:new c.Uniform1f(f,i.u_camera_to_center_distance),u_pixels_to_tile_units:new c.Uniform1f(f,i.u_pixels_to_tile_units),u_extrude_scale:new c.Uniform2f(f,i.u_extrude_scale),u_overscale_factor:new c.Uniform1f(f,i.u_overscale_factor)}),collisionCircle:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_inv_matrix:new c.UniformMatrix4f(f,i.u_inv_matrix),u_camera_to_center_distance:new c.Uniform1f(f,i.u_camera_to_center_distance),u_viewport_size:new c.Uniform2f(f,i.u_viewport_size)}),debug:(f,i)=>({u_color:new c.UniformColor(f,i.u_color),u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_overlay:new c.Uniform1i(f,i.u_overlay),u_overlay_scale:new c.Uniform1f(f,i.u_overlay_scale)}),clippingMask:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix)}),heatmap:(f,i)=>({u_extrude_scale:new c.Uniform1f(f,i.u_extrude_scale),u_intensity:new c.Uniform1f(f,i.u_intensity),u_matrix:new c.UniformMatrix4f(f,i.u_matrix)}),heatmapTexture:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_world:new c.Uniform2f(f,i.u_world),u_image:new c.Uniform1i(f,i.u_image),u_color_ramp:new c.Uniform1i(f,i.u_color_ramp),u_opacity:new c.Uniform1f(f,i.u_opacity)}),hillshade:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_image:new c.Uniform1i(f,i.u_image),u_latrange:new c.Uniform2f(f,i.u_latrange),u_light:new c.Uniform2f(f,i.u_light),u_shadow:new c.UniformColor(f,i.u_shadow),u_highlight:new c.UniformColor(f,i.u_highlight),u_accent:new c.UniformColor(f,i.u_accent)}),hillshadePrepare:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_image:new c.Uniform1i(f,i.u_image),u_dimension:new c.Uniform2f(f,i.u_dimension),u_zoom:new c.Uniform1f(f,i.u_zoom),u_unpack:new c.Uniform4f(f,i.u_unpack)}),line:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_ratio:new c.Uniform1f(f,i.u_ratio),u_device_pixel_ratio:new c.Uniform1f(f,i.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(f,i.u_units_to_pixels)}),lineGradient:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_ratio:new c.Uniform1f(f,i.u_ratio),u_device_pixel_ratio:new c.Uniform1f(f,i.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(f,i.u_units_to_pixels),u_image:new c.Uniform1i(f,i.u_image),u_image_height:new c.Uniform1f(f,i.u_image_height)}),linePattern:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_texsize:new c.Uniform2f(f,i.u_texsize),u_ratio:new c.Uniform1f(f,i.u_ratio),u_device_pixel_ratio:new c.Uniform1f(f,i.u_device_pixel_ratio),u_image:new c.Uniform1i(f,i.u_image),u_units_to_pixels:new c.Uniform2f(f,i.u_units_to_pixels),u_scale:new c.Uniform3f(f,i.u_scale),u_fade:new c.Uniform1f(f,i.u_fade)}),lineSDF:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_ratio:new c.Uniform1f(f,i.u_ratio),u_device_pixel_ratio:new c.Uniform1f(f,i.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(f,i.u_units_to_pixels),u_patternscale_a:new c.Uniform2f(f,i.u_patternscale_a),u_patternscale_b:new c.Uniform2f(f,i.u_patternscale_b),u_sdfgamma:new c.Uniform1f(f,i.u_sdfgamma),u_image:new c.Uniform1i(f,i.u_image),u_tex_y_a:new c.Uniform1f(f,i.u_tex_y_a),u_tex_y_b:new c.Uniform1f(f,i.u_tex_y_b),u_mix:new c.Uniform1f(f,i.u_mix)}),raster:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_tl_parent:new c.Uniform2f(f,i.u_tl_parent),u_scale_parent:new c.Uniform1f(f,i.u_scale_parent),u_buffer_scale:new c.Uniform1f(f,i.u_buffer_scale),u_fade_t:new c.Uniform1f(f,i.u_fade_t),u_opacity:new c.Uniform1f(f,i.u_opacity),u_image0:new c.Uniform1i(f,i.u_image0),u_image1:new c.Uniform1i(f,i.u_image1),u_brightness_low:new c.Uniform1f(f,i.u_brightness_low),u_brightness_high:new c.Uniform1f(f,i.u_brightness_high),u_saturation_factor:new c.Uniform1f(f,i.u_saturation_factor),u_contrast_factor:new c.Uniform1f(f,i.u_contrast_factor),u_spin_weights:new c.Uniform3f(f,i.u_spin_weights)}),symbolIcon:(f,i)=>({u_is_size_zoom_constant:new c.Uniform1i(f,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(f,i.u_is_size_feature_constant),u_size_t:new c.Uniform1f(f,i.u_size_t),u_size:new c.Uniform1f(f,i.u_size),u_camera_to_center_distance:new c.Uniform1f(f,i.u_camera_to_center_distance),u_pitch:new c.Uniform1f(f,i.u_pitch),u_rotate_symbol:new c.Uniform1i(f,i.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(f,i.u_aspect_ratio),u_fade_change:new c.Uniform1f(f,i.u_fade_change),u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(f,i.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(f,i.u_coord_matrix),u_is_text:new c.Uniform1i(f,i.u_is_text),u_pitch_with_map:new c.Uniform1i(f,i.u_pitch_with_map),u_texsize:new c.Uniform2f(f,i.u_texsize),u_texture:new c.Uniform1i(f,i.u_texture)}),symbolSDF:(f,i)=>({u_is_size_zoom_constant:new c.Uniform1i(f,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(f,i.u_is_size_feature_constant),u_size_t:new c.Uniform1f(f,i.u_size_t),u_size:new c.Uniform1f(f,i.u_size),u_camera_to_center_distance:new c.Uniform1f(f,i.u_camera_to_center_distance),u_pitch:new c.Uniform1f(f,i.u_pitch),u_rotate_symbol:new c.Uniform1i(f,i.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(f,i.u_aspect_ratio),u_fade_change:new c.Uniform1f(f,i.u_fade_change),u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(f,i.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(f,i.u_coord_matrix),u_is_text:new c.Uniform1i(f,i.u_is_text),u_pitch_with_map:new c.Uniform1i(f,i.u_pitch_with_map),u_texsize:new c.Uniform2f(f,i.u_texsize),u_texture:new c.Uniform1i(f,i.u_texture),u_gamma_scale:new c.Uniform1f(f,i.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(f,i.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(f,i.u_is_halo)}),symbolTextAndIcon:(f,i)=>({u_is_size_zoom_constant:new c.Uniform1i(f,i.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(f,i.u_is_size_feature_constant),u_size_t:new c.Uniform1f(f,i.u_size_t),u_size:new c.Uniform1f(f,i.u_size),u_camera_to_center_distance:new c.Uniform1f(f,i.u_camera_to_center_distance),u_pitch:new c.Uniform1f(f,i.u_pitch),u_rotate_symbol:new c.Uniform1i(f,i.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(f,i.u_aspect_ratio),u_fade_change:new c.Uniform1f(f,i.u_fade_change),u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(f,i.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(f,i.u_coord_matrix),u_is_text:new c.Uniform1i(f,i.u_is_text),u_pitch_with_map:new c.Uniform1i(f,i.u_pitch_with_map),u_texsize:new c.Uniform2f(f,i.u_texsize),u_texsize_icon:new c.Uniform2f(f,i.u_texsize_icon),u_texture:new c.Uniform1i(f,i.u_texture),u_texture_icon:new c.Uniform1i(f,i.u_texture_icon),u_gamma_scale:new c.Uniform1f(f,i.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(f,i.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(f,i.u_is_halo)}),background:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_opacity:new c.Uniform1f(f,i.u_opacity),u_color:new c.UniformColor(f,i.u_color)}),backgroundPattern:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_opacity:new c.Uniform1f(f,i.u_opacity),u_image:new c.Uniform1i(f,i.u_image),u_pattern_tl_a:new c.Uniform2f(f,i.u_pattern_tl_a),u_pattern_br_a:new c.Uniform2f(f,i.u_pattern_br_a),u_pattern_tl_b:new c.Uniform2f(f,i.u_pattern_tl_b),u_pattern_br_b:new c.Uniform2f(f,i.u_pattern_br_b),u_texsize:new c.Uniform2f(f,i.u_texsize),u_mix:new c.Uniform1f(f,i.u_mix),u_pattern_size_a:new c.Uniform2f(f,i.u_pattern_size_a),u_pattern_size_b:new c.Uniform2f(f,i.u_pattern_size_b),u_scale_a:new c.Uniform1f(f,i.u_scale_a),u_scale_b:new c.Uniform1f(f,i.u_scale_b),u_pixel_coord_upper:new c.Uniform2f(f,i.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(f,i.u_pixel_coord_lower),u_tile_units_to_pixels:new c.Uniform1f(f,i.u_tile_units_to_pixels)}),terrain:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_texture:new c.Uniform1i(f,i.u_texture)}),terrainDepth:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix)}),terrainCoords:(f,i)=>({u_matrix:new c.UniformMatrix4f(f,i.u_matrix),u_texture:new c.Uniform1i(f,i.u_texture),u_terrain_coords_id:new c.Uniform1f(f,i.u_terrain_coords_id)})};class Os{constructor(i,a,h){this.context=i;const _=i.gl;this.buffer=_.createBuffer(),this.dynamicDraw=Boolean(h),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Fs={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ns{constructor(i,a,h,_){this.length=a.length,this.attributes=h,this.itemSize=a.bytesPerElement,this.dynamicDraw=_,this.context=i;const v=i.gl;this.buffer=v.createBuffer(),i.bindVertexBuffer.set(this.buffer),v.bufferData(v.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,a){for(let h=0;h<this.attributes.length;h++){const _=a.attributes[this.attributes[h].name];_!==void 0&&i.enableVertexAttribArray(_)}}setVertexAttribPointers(i,a,h){for(let _=0;_<this.attributes.length;_++){const v=this.attributes[_],T=a.attributes[v.name];T!==void 0&&i.vertexAttribPointer(T,v.components,i[Fs[v.type]],!1,this.itemSize,v.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ft{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Sa extends Ft{getDefault(){return c.Color.transparent}set(i){const a=this.current;(i.r!==a.r||i.g!==a.g||i.b!==a.b||i.a!==a.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Us extends Ft{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class zi extends Ft{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class ar extends Ft{getDefault(){return[!0,!0,!0,!0]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||i[2]!==a[2]||i[3]!==a[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class _l extends Ft{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Sn extends Ft{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class gl extends Ft{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const a=this.current;(i.func!==a.func||i.ref!==a.ref||i.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Vs extends Ft{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||i[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class ys extends Ft{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=i,this.dirty=!1}}class yl extends Ft{getDefault(){return[0,1]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Ea extends Ft{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=i,this.dirty=!1}}class jt extends Ft{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class vl extends Ft{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.BLEND):a.disable(a.BLEND),this.current=i,this.dirty=!1}}class Bn extends Ft{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class To extends Ft{getDefault(){return c.Color.transparent}set(i){const a=this.current;(i.r!==a.r||i.g!==a.g||i.b!==a.b||i.a!==a.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class xl extends Ft{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class tu extends Ft{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;i?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=i,this.dirty=!1}}class So extends Ft{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Qu extends Ft{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class iu extends Ft{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class ec extends Ft{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class tc extends Ft{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const a=this.current;(i[0]!==a[0]||i[1]!==a[1]||i[2]!==a[2]||i[3]!==a[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class wl extends Ft{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class ic extends Ft{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Hn extends Ft{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Pa extends Ft{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Ca extends Ft{getDefault(){return null}set(i){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Cr extends Ft{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class Zo extends Ft{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class bl extends Ft{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class nu extends Ft{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Ia extends Ft{constructor(i,a){super(i),this.context=i,this.parent=a}getDefault(){return null}}class Wr extends Ia{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class ru extends Ia{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Go{constructor(i,a,h,_){this.context=i,this.width=a,this.height=h;const v=i.gl,T=this.framebuffer=v.createFramebuffer();if(this.colorAttachment=new Wr(i,T),_&&(this.depthAttachment=new ru(i,T)),v.checkFramebufferStatus(v.FRAMEBUFFER)!==v.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const i=this.context.gl,a=this.colorAttachment.get();if(a&&i.deleteTexture(a),this.depthAttachment){const h=this.depthAttachment.get();h&&i.deleteRenderbuffer(h)}i.deleteFramebuffer(this.framebuffer)}}class fi{constructor(i,a,h){this.blendFunction=i,this.blendColor=a,this.mask=h}}fi.Replace=[1,0],fi.disabled=new fi(fi.Replace,c.Color.transparent,[!1,!1,!1,!1]),fi.unblended=new fi(fi.Replace,c.Color.transparent,[!0,!0,!0,!0]),fi.alphaBlended=new fi([1,771],c.Color.transparent,[!0,!0,!0,!0]);class Zs{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Sa(this),this.clearDepth=new Us(this),this.clearStencil=new zi(this),this.colorMask=new ar(this),this.depthMask=new _l(this),this.stencilMask=new Sn(this),this.stencilFunc=new gl(this),this.stencilOp=new Vs(this),this.stencilTest=new ys(this),this.depthRange=new yl(this),this.depthTest=new Ea(this),this.depthFunc=new jt(this),this.blend=new vl(this),this.blendFunc=new Bn(this),this.blendColor=new To(this),this.blendEquation=new xl(this),this.cullFace=new tu(this),this.cullFaceSide=new So(this),this.frontFace=new Qu(this),this.program=new iu(this),this.activeTexture=new ec(this),this.viewport=new tc(this),this.bindFramebuffer=new wl(this),this.bindRenderbuffer=new ic(this),this.bindTexture=new Hn(this),this.bindVertexBuffer=new Pa(this),this.bindElementBuffer=new Ca(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Cr(this),this.pixelStoreUnpack=new Zo(this),this.pixelStoreUnpackPremultiplyAlpha=new bl(this),this.pixelStoreUnpackFlipY=new nu(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,a){return new Os(this,i,a)}createVertexBuffer(i,a,h){return new Ns(this,i,a,h)}createRenderbuffer(i,a,h){const _=this.gl,v=_.createRenderbuffer();return this.bindRenderbuffer.set(v),_.renderbufferStorage(_.RENDERBUFFER,i,a,h),this.bindRenderbuffer.set(null),v}createFramebuffer(i,a,h){return new Go(this,i,a,h)}clear({color:i,depth:a}){const h=this.gl;let _=0;i&&(_|=h.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(_|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),h.clear(_)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){ge(i.blendFunction,fi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class It{constructor(i,a,h){this.func=i,this.mask=a,this.range=h}}It.ReadOnly=!1,It.ReadWrite=!0,It.disabled=new It(519,It.ReadOnly,[0,1]);const Yt=7680;class ri{constructor(i,a,h,_,v,T){this.test=i,this.ref=a,this.mask=h,this.fail=_,this.depthFail=v,this.pass=T}}ri.disabled=new ri({func:519,mask:0},0,0,Yt,Yt,Yt);class Ht{constructor(i,a,h){this.enable=i,this.mode=a,this.frontFace=h}}let vs;function jo(f,i,a,h,_,v,T){const C=f.context,I=C.gl,z=f.useProgram("collisionBox"),B=[];let N=0,G=0;for(let Q=0;Q<h.length;Q++){const be=h[Q],xe=i.getTile(be),Ae=xe.getBucket(a);if(!Ae)continue;let ze=be.posMatrix;_[0]===0&&_[1]===0||(ze=f.translatePosMatrix(be.posMatrix,xe,_,v));const Fe=T?Ae.textCollisionBox:Ae.iconCollisionBox,Ce=Ae.collisionCircleArray;if(Ce.length>0){const it=c.create(),Ke=ze;c.mul(it,Ae.placementInvProjMatrix,f.transform.glCoordMatrix),c.mul(it,it,Ae.placementViewportMatrix),B.push({circleArray:Ce,circleOffset:G,transform:Ke,invTransform:it,coord:be}),N+=Ce.length/4,G=N}Fe&&z.draw(C,I.LINES,It.disabled,ri.disabled,f.colorModeForRenderPass(),Ht.disabled,yi(ze,f.transform,xe),f.style.terrain&&f.style.terrain.getTerrainData(be),a.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,null,f.transform.zoom,null,null,Fe.collisionVertexBuffer)}if(!T||!B.length)return;const Y=f.useProgram("collisionCircle"),X=new c.CollisionCircleLayoutArray;X.resize(4*N),X._trim();let J=0;for(const Q of B)for(let be=0;be<Q.circleArray.length/4;be++){const xe=4*be,Ae=Q.circleArray[xe+0],ze=Q.circleArray[xe+1],Fe=Q.circleArray[xe+2],Ce=Q.circleArray[xe+3];X.emplace(J++,Ae,ze,Fe,Ce,0),X.emplace(J++,Ae,ze,Fe,Ce,1),X.emplace(J++,Ae,ze,Fe,Ce,2),X.emplace(J++,Ae,ze,Fe,Ce,3)}(!vs||vs.length<2*N)&&(vs=function(Q){const be=2*Q,xe=new c.QuadTriangleArray;xe.resize(be),xe._trim();for(let Ae=0;Ae<be;Ae++){const ze=6*Ae;xe.uint16[ze+0]=4*Ae+0,xe.uint16[ze+1]=4*Ae+1,xe.uint16[ze+2]=4*Ae+2,xe.uint16[ze+3]=4*Ae+2,xe.uint16[ze+4]=4*Ae+3,xe.uint16[ze+5]=4*Ae+0}return xe}(N));const ae=C.createIndexBuffer(vs,!0),pe=C.createVertexBuffer(X,c.collisionCircleLayout.members,!0);for(const Q of B){const be={u_matrix:Q.transform,u_inv_matrix:Q.invTransform,u_camera_to_center_distance:(ve=f.transform).cameraToCenterDistance,u_viewport_size:[ve.width,ve.height]};Y.draw(C,I.TRIANGLES,It.disabled,ri.disabled,f.colorModeForRenderPass(),Ht.disabled,be,f.style.terrain&&f.style.terrain.getTerrainData(Q.coord),a.id,pe,ae,c.SegmentVector.simpleSegment(0,2*Q.circleOffset,Q.circleArray.length,Q.circleArray.length/2),null,f.transform.zoom,null,null,null)}var ve;pe.destroy(),ae.destroy()}Ht.disabled=new Ht(!1,1029,2305),Ht.backCCW=new Ht(!0,1029,2305);const nc=c.identity(new Float32Array(16));function ou(f,i,a,h,_,v){const{horizontalAlign:T,verticalAlign:C}=c.getAnchorAlignment(f),I=-(T-.5)*i,z=-(C-.5)*a,B=c.evaluateVariableOffset(f,h);return new c.pointGeometry((I/_+B[0])*v,(z/_+B[1])*v)}function Tl(f,i,a,h,_,v,T,C,I,z,B){const N=f.text.placedSymbolArray,G=f.text.dynamicLayoutVertexArray,Y=f.icon.dynamicLayoutVertexArray,X={};G.clear();for(let J=0;J<N.length;J++){const ae=N.get(J),pe=f.allowVerticalPlacement&&!ae.placedOrientation,ve=ae.hidden||!ae.crossTileID||pe?null:h[ae.crossTileID];if(ve){const Q=new c.pointGeometry(ae.anchorX,ae.anchorY),be=$t(Q,a?T:v,B),xe=Rn(_.cameraToCenterDistance,be.signedDistanceFromCamera);let Ae=c.evaluateSizeForFeature(f.textSizeData,I,ae)*xe/c.ONE_EM;a&&(Ae*=f.tilePixelRatio/C);const{width:ze,height:Fe,anchor:Ce,textOffset:it,textBoxScale:Ke}=ve,ot=ou(Ce,ze,Fe,it,Ke,Ae),kt=a?$t(Q.add(ot),v,B).point:be.point.add(i?ot.rotate(-_.angle):ot),Bt=f.allowVerticalPlacement&&ae.placedOrientation===c.WritingMode.vertical?Math.PI/2:0;for(let _t=0;_t<ae.numGlyphs;_t++)c.addDynamicAttributes(G,kt,Bt);z&&ae.associatedIconIndex>=0&&(X[ae.associatedIconIndex]={shiftedAnchor:kt,angle:Bt})}else St(ae.numGlyphs,G)}if(z){Y.clear();const J=f.icon.placedSymbolArray;for(let ae=0;ae<J.length;ae++){const pe=J.get(ae);if(pe.hidden)St(pe.numGlyphs,Y);else{const ve=X[ae];if(ve)for(let Q=0;Q<pe.numGlyphs;Q++)c.addDynamicAttributes(Y,ve.shiftedAnchor,ve.angle);else St(pe.numGlyphs,Y)}}f.icon.dynamicLayoutVertexBuffer.updateData(Y)}f.text.dynamicLayoutVertexBuffer.updateData(G)}function rc(f,i,a){return a.iconsInText&&i?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function xs(f,i,a,h,_,v,T,C,I,z,B,N){const G=f.context,Y=G.gl,X=f.transform,J=C==="map",ae=I==="map",pe=C!=="viewport"&&a.layout.get("symbol-placement")!=="point",ve=J&&!ae&&!pe,Q=!a.layout.get("symbol-sort-key").isConstant();let be=!1;const xe=f.depthModeForSublayer(0,It.ReadOnly),Ae=a.layout.get("text-variable-anchor"),ze=[];for(const Fe of h){const Ce=i.getTile(Fe),it=Ce.getBucket(a);if(!it)continue;const Ke=_?it.text:it.icon;if(!Ke||!Ke.segments.get().length)continue;const ot=Ke.programConfigurations.get(a.id),kt=_||it.sdfIcons,Bt=_?it.textSizeData:it.iconSizeData,_t=ae||X.pitch!==0,ai=f.useProgram(rc(kt,_,it),ot),li=c.evaluateSizeForZoom(Bt,X.zoom),Xt=f.style.terrain&&f.style.terrain.getTerrainData(Fe);let Kt,hi,sn,Po,Qr=[0,0],Co=null;if(_){if(hi=Ce.glyphAtlasTexture,sn=Y.LINEAR,Kt=Ce.glyphAtlasTexture.size,it.iconsInText){Qr=Ce.imageAtlasTexture.size,Co=Ce.imageAtlasTexture;const Dr=Bt.kind==="composite"||Bt.kind==="camera";Po=_t||f.options.rotating||f.options.zooming||Dr?Y.LINEAR:Y.NEAREST}}else{const Dr=a.layout.get("icon-size").constantOr(0)!==1||it.iconsNeedLinear;hi=Ce.imageAtlasTexture,sn=kt||f.options.rotating||f.options.zooming||Dr||_t?Y.LINEAR:Y.NEAREST,Kt=Ce.imageAtlasTexture.size}const Ss=Di(Ce,1,f.transform.zoom),Lr=mo(Fe.posMatrix,ae,J,f.transform,Ss),Jn=Wn(Fe.posMatrix,ae,J,f.transform,Ss),ts=Ae&&it.hasTextData(),du=a.layout.get("icon-text-fit")!=="none"&&ts&&it.hasIconData();if(pe){const Dr=f.style.terrain?(ac,Na)=>f.style.terrain.getElevation(Fe,ac,Na):null,ta=a.layout.get("text-rotation-alignment")==="map";bn(it,Fe.posMatrix,f,_,Lr,Jn,ae,z,ta,Dr)}const Yi=f.translatePosMatrix(Fe.posMatrix,Ce,v,T),Nt=pe||_&&Ae||du?nc:Lr,si=f.translatePosMatrix(Jn,Ce,v,T,!0),an=kt&&a.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ln;ln=kt?it.iconsInText?Mt(Bt.kind,li,ve,ae,f,Yi,Nt,si,Kt,Qr):ba(Bt.kind,li,ve,ae,f,Yi,Nt,si,_,Kt,!0):Bs(Bt.kind,li,ve,ae,f,Yi,Nt,si,_,Kt);const Pi={program:ai,buffers:Ke,uniformValues:ln,atlasTexture:hi,atlasTextureIcon:Co,atlasInterpolation:sn,atlasInterpolationIcon:Po,isSDF:kt,hasHalo:an};if(Q&&it.canOverlap){be=!0;const Dr=Ke.segments.get();for(const ta of Dr)ze.push({segments:new c.SegmentVector([ta]),sortKey:ta.sortKey,state:Pi,terrainData:Xt})}else ze.push({segments:Ke.segments,sortKey:0,state:Pi,terrainData:Xt})}be&&ze.sort((Fe,Ce)=>Fe.sortKey-Ce.sortKey);for(const Fe of ze){const Ce=Fe.state;if(G.activeTexture.set(Y.TEXTURE0),Ce.atlasTexture.bind(Ce.atlasInterpolation,Y.CLAMP_TO_EDGE),Ce.atlasTextureIcon&&(G.activeTexture.set(Y.TEXTURE1),Ce.atlasTextureIcon&&Ce.atlasTextureIcon.bind(Ce.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),Ce.isSDF){const it=Ce.uniformValues;Ce.hasHalo&&(it.u_is_halo=1,qo(Ce.buffers,Fe.segments,a,f,Ce.program,xe,B,N,it,Fe.terrainData)),it.u_is_halo=0}qo(Ce.buffers,Fe.segments,a,f,Ce.program,xe,B,N,Ce.uniformValues,Fe.terrainData)}}function qo(f,i,a,h,_,v,T,C,I,z){const B=h.context;_.draw(B,B.gl.TRIANGLES,v,T,C,Ht.disabled,I,z,a.id,f.layoutVertexBuffer,f.indexBuffer,i,a.paint,h.transform.zoom,f.programConfigurations.get(a.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function Gs(f,i,a,h,_,v,T){const C=f.context.gl,I=a.paint.get("fill-pattern"),z=I&&I.constantOr(1),B=a.getCrossfadeParameters();let N,G,Y,X,J;T?(G=z&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=C.LINES):(G=z?"fillPattern":"fill",N=C.TRIANGLES);for(const ae of h){const pe=i.getTile(ae);if(z&&!pe.patternsLoaded())continue;const ve=pe.getBucket(a);if(!ve)continue;const Q=ve.programConfigurations.get(a.id),be=f.useProgram(G,Q),xe=f.style.terrain&&f.style.terrain.getTerrainData(ae);z&&(f.context.activeTexture.set(C.TEXTURE0),pe.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),Q.updatePaintBuffers(B));const Ae=I.constantOr(null);if(Ae&&pe.imageAtlas){const Ce=pe.imageAtlas,it=Ce.patternPositions[Ae.to.toString()],Ke=Ce.patternPositions[Ae.from.toString()];it&&Ke&&Q.setConstantPatternPositions(it,Ke)}const ze=xe?ae:null,Fe=f.translatePosMatrix(ze?ze.posMatrix:ae.posMatrix,pe,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(T){X=ve.indexBuffer2,J=ve.segments2;const Ce=[C.drawingBufferWidth,C.drawingBufferHeight];Y=G==="fillOutlinePattern"&&z?Ls(Fe,f,B,pe,Ce):eu(Fe,Ce)}else X=ve.indexBuffer,J=ve.segments,Y=z?Tn(Fe,f,B,pe):Uo(Fe);be.draw(f.context,N,_,f.stencilModeForClipping(ae),v,Ht.disabled,Y,xe,a.id,ve.layoutVertexBuffer,X,J,a.paint,f.transform.zoom,Q)}}function js(f,i,a,h,_,v,T){const C=f.context,I=C.gl,z=a.paint.get("fill-extrusion-pattern"),B=z.constantOr(1),N=a.getCrossfadeParameters(),G=a.paint.get("fill-extrusion-opacity");for(const Y of h){const X=i.getTile(Y),J=X.getBucket(a);if(!J)continue;const ae=f.style.terrain&&f.style.terrain.getTerrainData(Y),pe=J.programConfigurations.get(a.id),ve=f.useProgram(B?"fillExtrusionPattern":"fillExtrusion",pe);B&&(f.context.activeTexture.set(I.TEXTURE0),X.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),pe.updatePaintBuffers(N));const Q=z.constantOr(null);if(Q&&X.imageAtlas){const ze=X.imageAtlas,Fe=ze.patternPositions[Q.to.toString()],Ce=ze.patternPositions[Q.from.toString()];Fe&&Ce&&pe.setConstantPatternPositions(Fe,Ce)}const be=f.translatePosMatrix(Y.posMatrix,X,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),xe=a.paint.get("fill-extrusion-vertical-gradient"),Ae=B?fl(be,f,xe,G,Y,N,X):Ei(be,f,xe,G);ve.draw(C,C.gl.TRIANGLES,_,v,T,Ht.backCCW,Ae,ae,a.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,a.paint,f.transform.zoom,pe,f.style.terrain&&J.centroidVertexBuffer)}}function ka(f,i,a,h,_,v,T){const C=f.context,I=C.gl,z=a.fbo;if(!z)return;const B=f.useProgram("hillshade"),N=f.style.terrain&&f.style.terrain.getTerrainData(i);C.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,z.colorAttachment.get()),B.draw(C,I.TRIANGLES,_,v,T,Ht.disabled,((G,Y,X,J)=>{const ae=X.paint.get("hillshade-shadow-color"),pe=X.paint.get("hillshade-highlight-color"),ve=X.paint.get("hillshade-accent-color");let Q=X.paint.get("hillshade-illumination-direction")*(Math.PI/180);X.paint.get("hillshade-illumination-anchor")==="viewport"&&(Q-=G.transform.angle);const be=!G.options.moving;return{u_matrix:J?J.posMatrix:G.transform.calculatePosMatrix(Y.tileID.toUnwrapped(),be),u_image:0,u_latrange:_s(0,Y.tileID),u_light:[X.paint.get("hillshade-exaggeration"),Q],u_shadow:ae,u_highlight:pe,u_accent:ve}})(f,a,h,N?i:null),N,h.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}function su(f,i,a,h,_,v){const T=f.context,C=T.gl,I=i.dem;if(I&&I.data){const z=I.dim,B=I.stride,N=I.getPixels();if(T.activeTexture.set(C.TEXTURE1),T.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||f.getTileTexture(B),i.demTexture){const Y=i.demTexture;Y.update(N,{premultiply:!1}),Y.bind(C.NEAREST,C.CLAMP_TO_EDGE)}else i.demTexture=new De(T,N,C.RGBA,{premultiply:!1}),i.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE);T.activeTexture.set(C.TEXTURE0);let G=i.fbo;if(!G){const Y=new De(T,{width:z,height:z,data:null},C.RGBA);Y.bind(C.LINEAR,C.CLAMP_TO_EDGE),G=i.fbo=T.createFramebuffer(z,z,!0),G.colorAttachment.set(Y.texture)}T.bindFramebuffer.set(G.framebuffer),T.viewport.set([0,0,z,z]),f.useProgram("hillshadePrepare").draw(T,C.TRIANGLES,h,_,v,Ht.disabled,((Y,X)=>{const J=X.stride,ae=c.create();return c.ortho(ae,0,c.EXTENT,-c.EXTENT,0,0,1),c.translate(ae,ae,[0,-c.EXTENT,0]),{u_matrix:ae,u_image:1,u_dimension:[J,J],u_zoom:Y.overscaledZ,u_unpack:X.getUnpackVector()}})(i.tileID,I),null,a.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments),i.needsHillshadePrepare=!1}}function En(f,i,a,h,_,v){const T=h.paint.get("raster-fade-duration");if(!v&&T>0){const C=c.exported.now(),I=(C-f.timeAdded)/T,z=i?(C-i.timeAdded)/T:-1,B=a.getSource(),N=_.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),G=!i||Math.abs(i.tileID.overscaledZ-N)>Math.abs(f.tileID.overscaledZ-N),Y=G&&f.refreshedUponExpiration?1:c.clamp(G?I:1-z,0,1);return f.refreshedUponExpiration&&I>=1&&(f.refreshedUponExpiration=!1),i?{opacity:1,mix:1-Y}:{opacity:Y,mix:0}}return{opacity:1,mix:0}}const Hr=new c.Color(1,0,0,1),lr=new c.Color(0,1,0,1),Ir=new c.Color(0,0,1,1),Sl=new c.Color(1,0,1,1),$o=new c.Color(0,1,1,1);function Wo(f,i,a,h){Ho(f,0,i+a/2,f.transform.width,a,h)}function Xr(f,i,a,h){Ho(f,i-a/2,0,a,f.transform.height,h)}function Ho(f,i,a,h,_,v){const T=f.context,C=T.gl;C.enable(C.SCISSOR_TEST),C.scissor(i*f.pixelRatio,a*f.pixelRatio,h*f.pixelRatio,_*f.pixelRatio),T.clear({color:v}),C.disable(C.SCISSOR_TEST)}function Aa(f,i,a){const h=f.context,_=h.gl,v=a.posMatrix,T=f.useProgram("debug"),C=It.disabled,I=ri.disabled,z=f.colorModeForRenderPass(),B="$debug",N=f.style.terrain&&f.style.terrain.getTerrainData(a);h.activeTexture.set(_.TEXTURE0),f.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE);const G=i.getTileByID(a.key).latestRawTileData,Y=Math.floor((G&&G.byteLength||0)/1024),X=i.getTile(a).tileSize,J=512/Math.min(X,512)*(a.overscaledZ/f.transform.zoom)*.5;let ae=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ae+=` => ${a.overscaledZ}`),function(pe,ve){pe.initDebugOverlayCanvas();const Q=pe.debugOverlayCanvas,be=pe.context.gl,xe=pe.debugOverlayCanvas.getContext("2d");xe.clearRect(0,0,Q.width,Q.height),xe.shadowColor="white",xe.shadowBlur=2,xe.lineWidth=1.5,xe.strokeStyle="white",xe.textBaseline="top",xe.font="bold 36px Open Sans, sans-serif",xe.fillText(ve,5,5),xe.strokeText(ve,5,5),pe.debugOverlayTexture.update(Q),pe.debugOverlayTexture.bind(be.LINEAR,be.CLAMP_TO_EDGE)}(f,`${ae} ${Y}kB`),T.draw(h,_.TRIANGLES,C,I,fi.alphaBlended,Ht.disabled,sr(v,c.Color.transparent,J),null,B,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),T.draw(h,_.LINE_STRIP,C,I,z,Ht.disabled,sr(v,c.Color.red),N,B,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function za(f,i,a){const h=f.context,_=h.gl,v=f.colorModeForRenderPass(),T=new It(_.LEQUAL,It.ReadWrite,f.depthRangeFor3D),C=f.useProgram("terrain"),I=i.getTerrainMesh(),z=i.getTerrainData(a.tileID);h.bindFramebuffer.set(null),h.viewport.set([0,0,f.width,f.height]),h.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,i.getRTTFramebuffer().colorAttachment.get());const B=f.transform.calculatePosMatrix(a.tileID.toUnwrapped());C.draw(h,_.TRIANGLES,T,ri.disabled,v,Ht.backCCW,{u_matrix:B,u_texture:0},z,"terrain",I.vertexBuffer,I.indexBuffer,I.segments)}function Kr(f,i,a,h){const _=f.context,v=a.tileSize*i.qualityFactor;a.textures[h]||(a.textures[h]=f.getTileTexture(v)||new De(_,{width:v,height:v,data:null},_.gl.RGBA),a.textures[h].bind(_.gl.LINEAR,_.gl.CLAMP_TO_EDGE),h===0&&i.sourceCache.renderHistory.unshift(a.tileID.key));const T=i.getRTTFramebuffer();T.colorAttachment.set(a.textures[h].texture),_.bindFramebuffer.set(T.framebuffer),_.viewport.set([0,0,v,v])}class qs{constructor(i){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=i,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=i.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const i=this.painter.style,a=i.terrain;for(const h in i.sourceCaches){this._coordsDescendingInv[h]={};const _=i.sourceCaches[h].getVisibleCoordinates();for(const v of _){const T=a.sourceCache.getTerrainCoords(v);for(const C in T)this._coordsDescendingInv[h][C]||(this._coordsDescendingInv[h][C]=[]),this._coordsDescendingInv[h][C].push(T[C])}}for(const h of i._order){const _=i._layers[h],v=_.source;if(this._renderToTexture[_.type]&&!this._coordsDescendingInvStr[v]){this._coordsDescendingInvStr[v]={};for(const T in this._coordsDescendingInv[v])this._coordsDescendingInvStr[v][T]=this._coordsDescendingInv[v][T].map(C=>C.key).sort().join()}}return this._renderableTiles.forEach(h=>{for(const _ in this._coordsDescendingInvStr){const v=this._coordsDescendingInvStr[_][h.tileID.key];v&&v!==h.textureCoords[_]&&h.clearTextures(this.painter),a.needsRerender(_,h.tileID)&&h.clearTextures(this.painter)}this._rerender[h.tileID.key]=!h.textures.length}),a.clearRerenderCache(),a.sourceCache.removeOutdated(this.painter),this}renderLayer(i){const a=i.type,h=this.painter,_=h.style._order,v=h.currentLayer,T=v+1===_.length;if(this._renderToTexture[a]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(_[v]),!T))return!0;if(this._renderToTexture[this._prevType]||a==="hillshade"||this._renderToTexture[a]&&T){this._prevType=a;const C=this._stacks.length-1,I=this._stacks[C]||[];for(const z of this._renderableTiles){if(Kr(h,h.style.terrain,z,C),this._rerender[z.tileID.key]){h.context.clear({color:c.Color.transparent});for(let B=0;B<I.length;B++){const N=h.style._layers[I[B]],G=N.source?this._coordsDescendingInv[N.source][z.tileID.key]:[z.tileID];h._renderTileClippingMasks(N,G),h.renderLayer(h,h.style.sourceCaches[N.source],N,G),N.source&&(z.textureCoords[N.source]=this._coordsDescendingInvStr[N.source][z.tileID.key])}}za(h,h.style.terrain,z)}if(a==="hillshade"){this._stacks.push([_[v]]);for(const z of this._renderableTiles){const B=this._coordsDescendingInv[i.source][z.tileID.key];Kr(h,h.style.terrain,z,this._stacks.length-1),h.context.clear({color:c.Color.transparent}),h._renderTileClippingMasks(i,B),h.renderLayer(h,h.style.sourceCaches[i.source],i,B),za(h,h.style.terrain,z)}return!0}return this._renderToTexture[a]}return!1}}const $s={symbol:function(f,i,a,h,_){if(f.renderPass!=="translucent")return;const v=ri.disabled,T=f.colorModeForRenderPass();a.layout.get("text-variable-anchor")&&function(C,I,z,B,N,G,Y){const X=I.transform,J=N==="map",ae=G==="map";for(const pe of C){const ve=B.getTile(pe),Q=ve.getBucket(z);if(!Q||!Q.text||!Q.text.segments.get().length)continue;const be=c.evaluateSizeForZoom(Q.textSizeData,X.zoom),xe=Di(ve,1,I.transform.zoom),Ae=mo(pe.posMatrix,ae,J,I.transform,xe),ze=z.layout.get("icon-text-fit")!=="none"&&Q.hasIconData();if(be){const Fe=Math.pow(2,X.zoom-ve.tileID.overscaledZ);Tl(Q,J,ae,Y,X,Ae,pe.posMatrix,Fe,be,ze,I.style.terrain?(Ce,it)=>I.style.terrain.getElevation(pe,Ce,it):null)}}}(h,f,a,i,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),_),a.paint.get("icon-opacity").constantOr(1)!==0&&xs(f,i,a,h,!1,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),a.layout.get("icon-rotation-alignment"),a.layout.get("icon-pitch-alignment"),a.layout.get("icon-keep-upright"),v,T),a.paint.get("text-opacity").constantOr(1)!==0&&xs(f,i,a,h,!0,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),a.layout.get("text-keep-upright"),v,T),i.map.showCollisionBoxes&&(jo(f,i,a,h,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),jo(f,i,a,h,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))},circle:function(f,i,a,h){if(f.renderPass!=="translucent")return;const _=a.paint.get("circle-opacity"),v=a.paint.get("circle-stroke-width"),T=a.paint.get("circle-stroke-opacity"),C=!a.layout.get("circle-sort-key").isConstant();if(_.constantOr(1)===0&&(v.constantOr(1)===0||T.constantOr(1)===0))return;const I=f.context,z=I.gl,B=f.depthModeForSublayer(0,It.ReadOnly),N=ri.disabled,G=f.colorModeForRenderPass(),Y=[];for(let X=0;X<h.length;X++){const J=h[X],ae=i.getTile(J),pe=ae.getBucket(a);if(!pe)continue;const ve=pe.programConfigurations.get(a.id),Q=f.useProgram("circle",ve),be=pe.layoutVertexBuffer,xe=pe.indexBuffer,Ae=f.style.terrain&&f.style.terrain.getTerrainData(J),ze={programConfiguration:ve,program:Q,layoutVertexBuffer:be,indexBuffer:xe,uniformValues:xo(f,J,ae,a),terrainData:Ae};if(C){const Fe=pe.segments.get();for(const Ce of Fe)Y.push({segments:new c.SegmentVector([Ce]),sortKey:Ce.sortKey,state:ze})}else Y.push({segments:pe.segments,sortKey:0,state:ze})}C&&Y.sort((X,J)=>X.sortKey-J.sortKey);for(const X of Y){const{programConfiguration:J,program:ae,layoutVertexBuffer:pe,indexBuffer:ve,uniformValues:Q,terrainData:be}=X.state;ae.draw(I,z.TRIANGLES,B,N,G,Ht.disabled,Q,be,a.id,pe,ve,X.segments,a.paint,f.transform.zoom,J)}},heatmap:function(f,i,a,h){if(a.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const _=f.context,v=_.gl,T=ri.disabled,C=new fi([v.ONE,v.ONE],c.Color.transparent,[!0,!0,!0,!0]);(function(I,z,B){const N=I.gl;I.activeTexture.set(N.TEXTURE1),I.viewport.set([0,0,z.width/4,z.height/4]);let G=B.heatmapFbo;if(G)N.bindTexture(N.TEXTURE_2D,G.colorAttachment.get()),I.bindFramebuffer.set(G.framebuffer);else{const Y=N.createTexture();N.bindTexture(N.TEXTURE_2D,Y),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,N.LINEAR),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR),G=B.heatmapFbo=I.createFramebuffer(z.width/4,z.height/4,!1),function(X,J,ae,pe){const ve=X.gl;ve.texImage2D(ve.TEXTURE_2D,0,ve.RGBA,J.width/4,J.height/4,0,ve.RGBA,X.extRenderToTextureHalfFloat?X.extTextureHalfFloat.HALF_FLOAT_OES:ve.UNSIGNED_BYTE,null),pe.colorAttachment.set(ae)}(I,z,Y,G)}})(_,f,a),_.clear({color:c.Color.transparent});for(let I=0;I<h.length;I++){const z=h[I];if(i.hasRenderableParent(z))continue;const B=i.getTile(z),N=B.getBucket(a);if(!N)continue;const G=N.programConfigurations.get(a.id),Y=f.useProgram("heatmap",G),{zoom:X}=f.transform;Y.draw(_,v.TRIANGLES,It.disabled,T,C,Ht.disabled,wo(z.posMatrix,B,X,a.paint.get("heatmap-intensity")),null,a.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,a.paint,f.transform.zoom,G)}_.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(_,v){const T=_.context,C=T.gl,I=v.heatmapFbo;if(!I)return;T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,I.colorAttachment.get()),T.activeTexture.set(C.TEXTURE1);let z=v.colorRampTexture;z||(z=v.colorRampTexture=new De(T,v.colorRamp,C.RGBA)),z.bind(C.LINEAR,C.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(T,C.TRIANGLES,It.disabled,ri.disabled,_.colorModeForRenderPass(),Ht.disabled,((B,N,G,Y)=>{const X=c.create();c.ortho(X,0,B.width,B.height,0,0,1);const J=B.context.gl;return{u_matrix:X,u_world:[J.drawingBufferWidth,J.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}})(_,v),null,v.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,v.paint,_.transform.zoom)}(f,a))},line:function(f,i,a,h){if(f.renderPass!=="translucent")return;const _=a.paint.get("line-opacity"),v=a.paint.get("line-width");if(_.constantOr(1)===0||v.constantOr(1)===0)return;const T=f.depthModeForSublayer(0,It.ReadOnly),C=f.colorModeForRenderPass(),I=a.paint.get("line-dasharray"),z=a.paint.get("line-pattern"),B=z.constantOr(1),N=a.paint.get("line-gradient"),G=a.getCrossfadeParameters(),Y=B?"linePattern":I?"lineSDF":N?"lineGradient":"line",X=f.context,J=X.gl;let ae=!0;for(const pe of h){const ve=i.getTile(pe);if(B&&!ve.patternsLoaded())continue;const Q=ve.getBucket(a);if(!Q)continue;const be=Q.programConfigurations.get(a.id),xe=f.context.program.get(),Ae=f.useProgram(Y,be),ze=ae||Ae.program!==xe,Fe=f.style.terrain&&f.style.terrain.getTerrainData(pe),Ce=z.constantOr(null);if(Ce&&ve.imageAtlas){const ot=ve.imageAtlas,kt=ot.patternPositions[Ce.to.toString()],Bt=ot.patternPositions[Ce.from.toString()];kt&&Bt&&be.setConstantPatternPositions(kt,Bt)}const it=Fe?pe:null,Ke=B?gs(f,ve,a,G,it):I?bo(f,ve,a,I,G,it):N?Ds(f,ve,a,Q.lineClipsArray.length,it):Er(f,ve,a,it);if(B)X.activeTexture.set(J.TEXTURE0),ve.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),be.updatePaintBuffers(G);else if(I&&(ze||f.lineAtlas.dirty))X.activeTexture.set(J.TEXTURE0),f.lineAtlas.bind(X);else if(N){const ot=Q.gradients[a.id];let kt=ot.texture;if(a.gradientVersion!==ot.version){let Bt=256;if(a.stepInterpolant){const _t=i.getSource().maxzoom,ai=pe.canonical.z===_t?Math.ceil(1<<f.transform.maxZoom-pe.canonical.z):1;Bt=c.clamp(c.nextPowerOfTwo(Q.maxLineLength/c.EXTENT*1024*ai),256,X.maxTextureSize)}ot.gradient=c.renderColorRamp({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:Bt,image:ot.gradient||void 0,clips:Q.lineClipsArray}),ot.texture?ot.texture.update(ot.gradient):ot.texture=new De(X,ot.gradient,J.RGBA),ot.version=a.gradientVersion,kt=ot.texture}X.activeTexture.set(J.TEXTURE0),kt.bind(a.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}Ae.draw(X,J.TRIANGLES,T,f.stencilModeForClipping(pe),C,Ht.disabled,Ke,Fe,a.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,a.paint,f.transform.zoom,be,Q.layoutVertexBuffer2),ae=!1}},fill:function(f,i,a,h){const _=a.paint.get("fill-color"),v=a.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const T=f.colorModeForRenderPass(),C=a.paint.get("fill-pattern"),I=f.opaquePassEnabledForLayer()&&!C.constantOr(1)&&_.constantOr(c.Color.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===I){const z=f.depthModeForSublayer(1,f.renderPass==="opaque"?It.ReadWrite:It.ReadOnly);Gs(f,i,a,h,z,T,!1)}if(f.renderPass==="translucent"&&a.paint.get("fill-antialias")){const z=f.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,It.ReadOnly);Gs(f,i,a,h,z,T,!0)}},"fill-extrusion":function(f,i,a,h){const _=a.paint.get("fill-extrusion-opacity");if(_!==0&&f.renderPass==="translucent"){const v=new It(f.context.gl.LEQUAL,It.ReadWrite,f.depthRangeFor3D);if(_!==1||a.paint.get("fill-extrusion-pattern").constantOr(1))js(f,i,a,h,v,ri.disabled,fi.disabled),js(f,i,a,h,v,f.stencilModeFor3D(),f.colorModeForRenderPass());else{const T=f.colorModeForRenderPass();js(f,i,a,h,v,ri.disabled,T)}}},hillshade:function(f,i,a,h){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent")return;const _=f.context,v=f.depthModeForSublayer(0,It.ReadOnly),T=f.colorModeForRenderPass(),[C,I]=f.renderPass==="translucent"?f.stencilConfigForOverlap(h):[{},h];for(const z of I){const B=i.getTile(z);B.needsHillshadePrepare!==void 0&&B.needsHillshadePrepare&&f.renderPass==="offscreen"?su(f,B,a,v,ri.disabled,T):f.renderPass==="translucent"&&ka(f,z,B,a,v,C[z.overscaledZ],T)}_.viewport.set([0,0,f.width,f.height])},raster:function(f,i,a,h){if(f.renderPass!=="translucent"||a.paint.get("raster-opacity")===0||!h.length)return;const _=f.context,v=_.gl,T=i.getSource(),C=f.useProgram("raster"),I=f.colorModeForRenderPass(),[z,B]=T instanceof vt?[{},h]:f.stencilConfigForOverlap(h),N=B[B.length-1].overscaledZ,G=!f.options.moving;for(const Y of B){const X=f.depthModeForSublayer(Y.overscaledZ-N,a.paint.get("raster-opacity")===1?It.ReadWrite:It.ReadOnly,v.LESS),J=i.getTile(Y);J.registerFadeDuration(a.paint.get("raster-fade-duration"));const ae=i.findLoadedParent(Y,0),pe=En(J,ae,i,a,f.transform,f.style.terrain);let ve,Q;const be=a.paint.get("raster-resampling")==="nearest"?v.NEAREST:v.LINEAR;_.activeTexture.set(v.TEXTURE0),J.texture.bind(be,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(v.TEXTURE1),ae?(ae.texture.bind(be,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST),ve=Math.pow(2,ae.tileID.overscaledZ-J.tileID.overscaledZ),Q=[J.tileID.canonical.x*ve%1,J.tileID.canonical.y*ve%1]):J.texture.bind(be,v.CLAMP_TO_EDGE,v.LINEAR_MIPMAP_NEAREST);const xe=f.style.terrain&&f.style.terrain.getTerrainData(Y),Ae=xe?Y:null,ze=Ae?Ae.posMatrix:f.transform.calculatePosMatrix(Y.toUnwrapped(),G),Fe=Rs(ze,Q||[0,0],ve||1,pe,a);T instanceof vt?C.draw(_,v.TRIANGLES,X,ri.disabled,I,Ht.disabled,Fe,xe,a.id,T.boundsBuffer,f.quadTriangleIndexBuffer,T.boundsSegments):C.draw(_,v.TRIANGLES,X,z[Y.overscaledZ],I,Ht.disabled,Fe,xe,a.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}},background:function(f,i,a,h){const _=a.paint.get("background-color"),v=a.paint.get("background-opacity");if(v===0)return;const T=f.context,C=T.gl,I=f.transform,z=I.tileSize,B=a.paint.get("background-pattern");if(f.isPatternMissing(B))return;const N=!B&&_.a===1&&v===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==N)return;const G=ri.disabled,Y=f.depthModeForSublayer(0,N==="opaque"?It.ReadWrite:It.ReadOnly),X=f.colorModeForRenderPass(),J=f.useProgram(B?"backgroundPattern":"background"),ae=h||I.coveringTiles({tileSize:z,terrain:f.style.terrain});B&&(T.activeTexture.set(C.TEXTURE0),f.imageManager.bind(f.context));const pe=a.getCrossfadeParameters();for(const ve of ae){const Q=h?ve.posMatrix:f.transform.calculatePosMatrix(ve.toUnwrapped()),be=B?vi(Q,v,f,B,{tileID:ve,tileSize:z},pe):Pr(Q,v,_),xe=f.style.terrain&&f.style.terrain.getTerrainData(ve);J.draw(T,C.TRIANGLES,Y,G,X,Ht.disabled,be,xe,a.id,f.tileExtentBuffer,f.quadTriangleIndexBuffer,f.tileExtentSegments)}},debug:function(f,i,a){for(let h=0;h<a.length;h++)Aa(f,i,a[h])},custom:function(f,i,a){const h=f.context,_=a.implementation;if(f.renderPass==="offscreen"){const v=_.prerender;v&&(f.setCustomLayerDefaults(),h.setColorMode(f.colorModeForRenderPass()),v.call(_,h.gl,f.transform.customLayerMatrix()),h.setDirty(),f.setBaseState())}else if(f.renderPass==="translucent"){f.setCustomLayerDefaults(),h.setColorMode(f.colorModeForRenderPass()),h.setStencilMode(ri.disabled);const v=_.renderingMode==="3d"?new It(f.context.gl.LEQUAL,It.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,It.ReadOnly);h.setDepthMode(v),_.render(h.gl,f.transform.customLayerMatrix()),h.setDirty(),f.setBaseState(),h.bindFramebuffer.set(null)}}};class Ws{constructor(i,a){this.context=new Zs(i),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.create(),renderTime:0},this.setup(),this.numSublayers=fn.maxUnderzooming+fn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new xt,this.gpuTimers={}}resize(i,a,h){if(this.width=i*h,this.height=a*h,this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const i=this.context,a=new c.PosArray;a.emplaceBack(0,0),a.emplaceBack(c.EXTENT,0),a.emplaceBack(0,c.EXTENT),a.emplaceBack(c.EXTENT,c.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(a,Wt.members),this.tileExtentSegments=c.SegmentVector.simpleSegment(0,0,4,2);const h=new c.PosArray;h.emplaceBack(0,0),h.emplaceBack(c.EXTENT,0),h.emplaceBack(0,c.EXTENT),h.emplaceBack(c.EXTENT,c.EXTENT),this.debugBuffer=i.createVertexBuffer(h,Wt.members),this.debugSegments=c.SegmentVector.simpleSegment(0,0,4,5);const _=new c.RasterBoundsArray;_.emplaceBack(0,0,0,0),_.emplaceBack(c.EXTENT,0,c.EXTENT,0),_.emplaceBack(0,c.EXTENT,0,c.EXTENT),_.emplaceBack(c.EXTENT,c.EXTENT,c.EXTENT,c.EXTENT),this.rasterBoundsBuffer=i.createVertexBuffer(_,Re.members),this.rasterBoundsSegments=c.SegmentVector.simpleSegment(0,0,4,2);const v=new c.PosArray;v.emplaceBack(0,0),v.emplaceBack(1,0),v.emplaceBack(0,1),v.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(v,Wt.members),this.viewportSegments=c.SegmentVector.simpleSegment(0,0,4,2);const T=new c.LineStripIndexArray;T.emplaceBack(0),T.emplaceBack(1),T.emplaceBack(3),T.emplaceBack(2),T.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(T);const C=new c.TriangleIndexArray;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(C),this.emptyTexture=new De(i,{width:1,height:1,data:new Uint8Array([0,0,0,0])},i.gl.RGBA);const I=this.context.gl;this.stencilClearMode=new ri({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO)}clearStencil(){const i=this.context,a=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=c.create();c.ortho(h,0,this.width,this.height,0,0,1),c.scale(h,h,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(i,a.TRIANGLES,It.disabled,this.stencilClearMode,fi.disabled,Ht.disabled,Sr(h),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,a){if(this.currentStencilSource===i.source||!i.isTileClipped()||!a||!a.length)return;this.currentStencilSource=i.source;const h=this.context,_=h.gl;this.nextStencilID+a.length>256&&this.clearStencil(),h.setColorMode(fi.disabled),h.setDepthMode(It.disabled);const v=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const T of a){const C=this._tileClippingMaskIDs[T.key]=this.nextStencilID++,I=this.style.terrain&&this.style.terrain.getTerrainData(T);v.draw(h,_.TRIANGLES,It.disabled,new ri({func:_.ALWAYS,mask:0},C,255,_.KEEP,_.KEEP,_.REPLACE),fi.disabled,Ht.disabled,Sr(T.posMatrix),I,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,a=this.context.gl;return new ri({func:a.NOTEQUAL,mask:255},i,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(i){const a=this.context.gl;return new ri({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(i){const a=this.context.gl,h=i.sort((T,C)=>C.overscaledZ-T.overscaledZ),_=h[h.length-1].overscaledZ,v=h[0].overscaledZ-_+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const T={};for(let C=0;C<v;C++)T[C+_]=new ri({func:a.GEQUAL,mask:255},C+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=v,[T,h]}return[{[_]:ri.disabled},h]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new fi([i.CONSTANT_COLOR,i.ONE],new c.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fi.unblended:fi.alphaBlended}depthModeForSublayer(i,a,h){if(!this.opaquePassEnabledForLayer())return It.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new It(h||this.context.gl.LEQUAL,a,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,a){this.style=i,this.options=a,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(c.exported.now()),this.imageManager.beginFrame();const h=this.style._order,_=this.style.sourceCaches,v=this.style.terrain&&new qs(this);for(const z in _){const B=_[z];B.used&&B.prepare(this.context)}const T={},C={},I={};for(const z in _){const B=_[z];T[z]=B.getVisibleCoordinates(),C[z]=T[z].slice().reverse(),I[z]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<h.length;z++)if(this.style._layers[h[z]].is3D()){this.opaquePassCutoff=z;break}if(v){this.opaquePassCutoff=0;const z=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!c.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||z.length)&&(c.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(B,N){const G=B.context,Y=G.gl,X=fi.unblended,J=new It(Y.LEQUAL,It.ReadWrite,[0,1]),ae=N.getTerrainMesh(),pe=N.sourceCache.getRenderableTiles(),ve=B.useProgram("terrainDepth");G.bindFramebuffer.set(N.getFramebuffer("depth").framebuffer),G.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),G.clear({color:c.Color.transparent,depth:1});for(const Q of pe){const be=N.getTerrainData(Q.tileID),xe=B.transform.calculatePosMatrix(Q.tileID.toUnwrapped());ve.draw(G,Y.TRIANGLES,J,ri.disabled,X,Ht.backCCW,{u_matrix:xe},be,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments)}G.bindFramebuffer.set(null),G.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain),function(B,N){const G=B.context,Y=G.gl,X=fi.unblended,J=new It(Y.LEQUAL,It.ReadWrite,[0,1]),ae=N.getTerrainMesh(),pe=N.getCoordsTexture(),ve=N.sourceCache.getRenderableTiles(),Q=B.useProgram("terrainCoords");G.bindFramebuffer.set(N.getFramebuffer("coords").framebuffer),G.viewport.set([0,0,B.width/devicePixelRatio,B.height/devicePixelRatio]),G.clear({color:c.Color.transparent,depth:1}),N.coordsIndex=[];for(const be of ve){const xe=N.getTerrainData(be.tileID);G.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,pe.texture);const Ae=B.transform.calculatePosMatrix(be.tileID.toUnwrapped());Q.draw(G,Y.TRIANGLES,J,ri.disabled,X,Ht.backCCW,{u_matrix:Ae,u_terrain_coords_id:(255-N.coordsIndex.length)/255,u_texture:0},xe,"terrain",ae.vertexBuffer,ae.indexBuffer,ae.segments),N.coordsIndex.push(be.tileID.key)}G.bindFramebuffer.set(null),G.viewport.set([0,0,B.width,B.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const z of h){const B=this.style._layers[z];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const N=C[B.source];(B.type==="custom"||N.length)&&this.renderLayer(this,_[B.source],B,N)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.Color.black:c.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!v)for(this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[h[this.currentLayer]],B=_[z.source],N=T[z.source];this._renderTileClippingMasks(z,N),this.renderLayer(this,B,z,N)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){const z=this.style._layers[h[this.currentLayer]],B=_[z.source];if(v&&v.renderLayer(z))continue;const N=(z.type==="symbol"?I:C)[z.source];this._renderTileClippingMasks(z,T[z.source]),this.renderLayer(this,B,z,N)}if(this.options.showTileBoundaries){let z,B;Object.values(this.style._layers).forEach(N=>{N.source&&!N.isHidden(this.transform.zoom)&&(N.source!==(B&&B.id)&&(B=this.style.sourceCaches[N.source]),(!z||z.getSource().maxzoom<B.getSource().maxzoom)&&(z=B))}),z&&$s.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const B=z.transform.padding;Wo(z,z.transform.height-(B.top||0),3,Hr),Wo(z,B.bottom||0,3,lr),Xr(z,B.left||0,3,Ir),Xr(z,z.transform.width-(B.right||0),3,Sl);const N=z.transform.centerPoint;(function(G,Y,X,J){Ho(G,Y-1,X-10,2,20,J),Ho(G,Y-10,X-1,20,2,J)})(z,N.x,z.transform.height-N.y,$o)}(this),this.context.setDefault()}renderLayer(i,a,h,_){h.isHidden(this.transform.zoom)||(h.type==="background"||h.type==="custom"||(_||[]).length)&&(this.id=h.id,this.gpuTimingStart(h),$s[h.type](i,a,h,_,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;let h=this.gpuTimers[i.id];h||(h=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),h.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,h.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}queryGpuTimers(i){const a={};for(const h in i){const _=i[h],v=this.context.extTimerQuery,T=v.getQueryObjectEXT(_.query,v.QUERY_RESULT_EXT)/1e6;v.deleteQueryEXT(_.query),a[h]=T}return a}translatePosMatrix(i,a,h,_,v){if(!h[0]&&!h[1])return i;const T=v?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(T){const z=Math.sin(T),B=Math.cos(T);h=[h[0]*B-h[1]*z,h[0]*z+h[1]*B]}const C=[v?h[0]:Di(a,h[0],this.transform.zoom),v?h[1]:Di(a,h[1],this.transform.zoom),0],I=new Float32Array(16);return c.translate(I,i,C),I}saveTileTexture(i){const a=this._tileTextures[i.size[0]];a?a.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const a=this._tileTextures[i];return a&&a.length>0?a.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const a=this.imageManager.getPattern(i.from.toString()),h=this.imageManager.getPattern(i.to.toString());return!a||!h}useProgram(i,a){this.cache=this.cache||{};const h=i+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[h]||(this.cache[h]=new wa(this.context,i,di[i],a,Ta[i],this._showOverdrawInspector,this.style.terrain)),this.cache[h]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new De(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Ma{constructor(i,a){this.points=i,this.planes=a}static fromInvProjectionMatrix(i,a,h){const _=Math.pow(2,h),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const I=1/(C=c.transformMat4([],C,i))[3]/a*_;return c.mul$1(C,C,[I,I,1/C[3],I])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const I=c.sub([],v[C[0]],v[C[1]]),z=c.sub([],v[C[2]],v[C[1]]),B=c.normalize([],c.cross([],I,z)),N=-c.dot(B,v[C[1]]);return B.concat(N)});return new Ma(v,T)}}class On{constructor(i,a){this.min=i,this.max=a,this.center=c.scale$1([],c.add([],this.min,this.max),.5)}quadrant(i){const a=[i%2==0,i<2],h=c.clone$2(this.min),_=c.clone$2(this.max);for(let v=0;v<a.length;v++)h[v]=a[v]?this.min[v]:this.center[v],_[v]=a[v]?this.center[v]:this.max[v];return _[2]=this.max[2],new On(h,_)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersects(i){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let h=!0;for(let _=0;_<i.planes.length;_++){const v=i.planes[_];let T=0;for(let C=0;C<a.length;C++)c.dot$1(v,a[C])>=0&&T++;if(T===0)return 0;T!==a.length&&(h=!1)}if(h)return 2;for(let _=0;_<3;_++){let v=Number.MAX_VALUE,T=-Number.MAX_VALUE;for(let C=0;C<i.points.length;C++){const I=i.points[C][_]-this.min[_];v=Math.min(v,I),T=Math.max(T,I)}if(T<0||v>this.max[_]-this.min[_])return 0}return 1}}class ws{constructor(i=0,a=0,h=0,_=0){if(isNaN(i)||i<0||isNaN(a)||a<0||isNaN(h)||h<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=a,this.left=h,this.right=_}interpolate(i,a,h){return a.top!=null&&i.top!=null&&(this.top=c.number(i.top,a.top,h)),a.bottom!=null&&i.bottom!=null&&(this.bottom=c.number(i.bottom,a.bottom,h)),a.left!=null&&i.left!=null&&(this.left=c.number(i.left,a.left,h)),a.right!=null&&i.right!=null&&(this.right=c.number(i.right,a.right,h)),this}getCenter(i,a){const h=c.clamp((this.left+i-this.right)/2,0,i),_=c.clamp((this.top+a-this.bottom)/2,0,a);return new c.pointGeometry(h,_)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new ws(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class kr{constructor(i,a,h,_,v){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=v===void 0||!!v,this._minZoom=i||0,this._maxZoom=a||22,this._minPitch=h??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new ws,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const i=new kr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i.tileSize=this.tileSize,i.latRange=this.latRange,i.width=this.width,i.height=this.height,i._center=this._center,i._elevation=this._elevation,i.zoom=this.zoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._calcMatrices(),i}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const a=-c.wrap(i,-180,180)*Math.PI/180;var h;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=(h=new c.ARRAY_TYPE(4),c.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h),function(_,v,T){var C=v[0],I=v[1],z=v[2],B=v[3],N=Math.sin(T),G=Math.cos(T);_[0]=C*G+z*N,_[1]=I*G+B*N,_[2]=C*-N+z*G,_[3]=I*-N+B*G}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const a=c.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(i){const a=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,a,h){this._unmodified=!1,this._edgeInsets.interpolate(i,a,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const a=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(i){const a=[new c.UnwrappedTileID(0,i)];if(this._renderWorldCopies){const h=this.pointCoordinate(new c.pointGeometry(0,0)),_=this.pointCoordinate(new c.pointGeometry(this.width,0)),v=this.pointCoordinate(new c.pointGeometry(this.width,this.height)),T=this.pointCoordinate(new c.pointGeometry(0,this.height)),C=Math.floor(Math.min(h.x,_.x,v.x,T.x)),I=Math.floor(Math.max(h.x,_.x,v.x,T.x)),z=1;for(let B=C-z;B<=I+z;B++)B!==0&&a.push(new c.UnwrappedTileID(B,i))}return a}coveringTiles(i){var a,h;let _=this.coveringZoomLevel(i);const v=_;if(i.minzoom!==void 0&&_<i.minzoom)return[];i.maxzoom!==void 0&&_>i.maxzoom&&(_=i.maxzoom);const T=this.pointCoordinate(this.getCameraPoint()),C=c.MercatorCoordinate.fromLngLat(this.center),I=Math.pow(2,_),z=[I*T.x,I*T.y,0],B=[I*C.x,I*C.y,0],N=Ma.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let G=i.minzoom||0;!i.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(G=_);const Y=i.terrain?2/Math.min(this.tileSize,i.tileSize)*this.tileSize:3,X=Q=>({aabb:new On([Q*I,0,0],[(Q+1)*I,I,0]),zoom:0,x:0,y:0,wrap:Q,fullyVisible:!1}),J=[],ae=[],pe=_,ve=i.reparseOverscaled?v:_;if(this._renderWorldCopies)for(let Q=1;Q<=3;Q++)J.push(X(-Q)),J.push(X(Q));for(J.push(X(0));J.length>0;){const Q=J.pop(),be=Q.x,xe=Q.y;let Ae=Q.fullyVisible;if(!Ae){const ot=Q.aabb.intersects(N);if(ot===0)continue;Ae=ot===2}const ze=i.terrain?z:B,Fe=Q.aabb.distanceX(ze),Ce=Q.aabb.distanceY(ze),it=Math.max(Math.abs(Fe),Math.abs(Ce)),Ke=Y+(1<<pe-Q.zoom)-2;if(Q.zoom===pe||it>Ke&&Q.zoom>=G){const ot=pe-Q.zoom,kt=z[0]-.5-(be<<ot),Bt=z[1]-.5-(xe<<ot);ae.push({tileID:new c.OverscaledTileID(Q.zoom===pe?ve:Q.zoom,Q.wrap,Q.zoom,be,xe),distanceSq:c.sqrLen([B[0]-.5-be,B[1]-.5-xe]),tileDistanceToCamera:Math.sqrt(kt*kt+Bt*Bt)})}else for(let ot=0;ot<4;ot++){const kt=(be<<1)+ot%2,Bt=(xe<<1)+(ot>>1),_t=Q.zoom+1;let ai=Q.aabb.quadrant(ot);if(i.terrain){const li=new c.OverscaledTileID(_t,Q.wrap,_t,kt,Bt),Xt=i.terrain.getMinMaxElevation(li),Kt=(a=Xt.minElevation)!==null&&a!==void 0?a:this.elevation,hi=(h=Xt.maxElevation)!==null&&h!==void 0?h:this.elevation;ai=new On([ai.min[0],ai.min[1],Kt],[ai.max[0],ai.max[1],hi])}J.push({aabb:ai,zoom:_t,x:kt,y:Bt,wrap:Q.wrap,fullyVisible:Ae})}}return ae.sort((Q,be)=>Q.distanceSq-be.distanceSq).map(Q=>Q.tileID)}resize(i,a){this.width=i,this.height=a,this.pixelsToGLUnits=[2/i,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const a=c.clamp(i.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.pointGeometry(c.mercatorXfromLng(i.lng)*this.worldSize,c.mercatorYfromLat(a)*this.worldSize)}unproject(i){return new c.MercatorCoordinate(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(i){this.freezeElevation||(this.elevation=i?this.getElevation(this._center,i):0)}getElevation(i,a){const h=c.MercatorCoordinate.fromLngLat(i),_=(1<<this.tileZoom)*c.EXTENT,v=h.x*_,T=h.y*_,C=Math.floor(v/c.EXTENT),I=Math.floor(T/c.EXTENT),z=new c.OverscaledTileID(this.tileZoom,0,this.tileZoom,C,I);return a.getElevation(z,v%c.EXTENT,T%c.EXTENT,c.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(i){const a=this.pointLocation(this.centerPoint,i),h=this.getElevation(a,i);if(!(this.elevation-h))return;const _=this.getCameraPosition(),v=c.MercatorCoordinate.fromLngLat(_.lngLat,_.altitude),T=c.MercatorCoordinate.fromLngLat(a,h),C=v.x-T.x,I=v.y-T.y,z=v.z-T.z,B=Math.sqrt(C*C+I*I+z*z),N=this.scaleZoom(this.cameraToCenterDistance/B/this.tileSize);this._elevation=h,this._center=a,this.zoom=N}setLocationAtPoint(i,a){const h=this.pointCoordinate(a),_=this.pointCoordinate(this.centerPoint),v=this.locationCoordinate(i),T=new c.MercatorCoordinate(v.x-(h.x-_.x),v.y-(h.y-_.y));this.center=this.coordinateLocation(T),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i,a){return a?this.coordinatePoint(this.locationCoordinate(i),this.getElevation(i,a),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(i))}pointLocation(i,a){return this.coordinateLocation(this.pointCoordinate(i,a))}locationCoordinate(i){return c.MercatorCoordinate.fromLngLat(i)}coordinateLocation(i){return i&&i.toLngLat()}pointCoordinate(i,a){if(a){const G=a.pointCoordinate(i);if(G!=null)return G}const h=[i.x,i.y,0,1],_=[i.x,i.y,1,1];c.transformMat4(h,h,this.pixelMatrixInverse),c.transformMat4(_,_,this.pixelMatrixInverse);const v=h[3],T=_[3],C=h[1]/v,I=_[1]/T,z=h[2]/v,B=_[2]/T,N=z===B?0:(0-z)/(B-z);return new c.MercatorCoordinate(c.number(h[0]/v,_[0]/T,N)/this.worldSize,c.number(C,I,N)/this.worldSize)}coordinatePoint(i,a=0,h=this.pixelMatrix){const _=[i.x*this.worldSize,i.y*this.worldSize,a,1];return c.transformMat4(_,_,h),new c.pointGeometry(_[0]/_[3],_[1]/_[3])}getBounds(){const i=Math.max(0,this.height/2-this.getHorizon());return new c.LngLatBounds().extend(this.pointLocation(new c.pointGeometry(0,i))).extend(this.pointLocation(new c.pointGeometry(this.width,i))).extend(this.pointLocation(new c.pointGeometry(this.width,this.height))).extend(this.pointLocation(new c.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new c.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(i){i?(this.lngRange=[i.getWest(),i.getEast()],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(i,a=!1){const h=i.key,_=a?this._alignedPosMatrixCache:this._posMatrixCache;if(_[h])return _[h];const v=i.canonical,T=this.worldSize/this.zoomScale(v.z),C=v.x+Math.pow(2,v.z)*i.wrap,I=c.identity(new Float64Array(16));return c.translate(I,I,[C*T,v.y*T,0]),c.scale(I,I,[T/c.EXTENT,T/c.EXTENT,1]),c.multiply(I,a?this.alignedProjMatrix:this.projMatrix,I),_[h]=new Float32Array(I),_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let i,a,h,_,v=-90,T=90,C=-180,I=180;const z=this.size,B=this._unmodified;if(this.latRange){const Y=this.latRange;v=c.mercatorYfromLat(Y[1])*this.worldSize,T=c.mercatorYfromLat(Y[0])*this.worldSize,i=T-v<z.y?z.y/(T-v):0}if(this.lngRange){const Y=this.lngRange;C=c.wrap(c.mercatorXfromLng(Y[0])*this.worldSize,0,this.worldSize),I=c.wrap(c.mercatorXfromLng(Y[1])*this.worldSize,0,this.worldSize),I<C&&(I+=this.worldSize),a=I-C<z.x?z.x/(I-C):0}const N=this.point,G=Math.max(a||0,i||0);if(G)return this.center=this.unproject(new c.pointGeometry(a?(I+C)/2:N.x,i?(T+v)/2:N.y)),this.zoom+=this.scaleZoom(G),this._unmodified=B,void(this._constraining=!1);if(this.latRange){const Y=N.y,X=z.y/2;Y-X<v&&(_=v+X),Y+X>T&&(_=T-X)}if(this.lngRange){const Y=(C+I)/2,X=c.wrap(N.x,Y-this.worldSize/2,Y+this.worldSize/2),J=z.x/2;X-J<C&&(h=C+J),X+J>I&&(h=I-J)}h===void 0&&_===void 0||(this.center=this.unproject(new c.pointGeometry(h!==void 0?h:N.x,_!==void 0?_:N.y)).wrap()),this._unmodified=B,this._constraining=!1}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,a=this.point.x,h=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=c.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let _=c.identity(new Float64Array(16));c.scale(_,_,[this.width/2,-this.height/2,1]),c.translate(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=c.identity(new Float64Array(16)),c.scale(_,_,[1,-1,1]),c.translate(_,_,[-1,-1,0]),c.scale(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const v=Math.PI/2+this._pitch,T=this._fov*(.5+i.y/this.height),C=Math.sin(T)*this.cameraToSeaLevelDistance/Math.sin(c.clamp(Math.PI-v-T,.01,Math.PI-.01)),I=this.getHorizon(),z=2*Math.atan(I/this.cameraToCenterDistance)*(.5+i.y/(2*I)),B=Math.sin(z)*this.cameraToSeaLevelDistance/Math.sin(c.clamp(Math.PI-v-z,.01,Math.PI-.01)),N=Math.cos(Math.PI/2-this._pitch)*C+this.cameraToSeaLevelDistance,G=Math.cos(Math.PI/2-this._pitch)*B+this.cameraToSeaLevelDistance,Y=1.01*Math.min(N,G),X=this.height/50;_=new Float64Array(16),c.perspective(_,this._fov,this.width/this.height,X,Y),_[8]=2*-i.x/this.width,_[9]=2*i.y/this.height,c.scale(_,_,[1,-1,1]),c.translate(_,_,[0,0,-this.cameraToCenterDistance]),c.rotateX(_,_,this._pitch),c.rotateZ(_,_,this.angle),c.translate(_,_,[-a,-h,0]),this.mercatorMatrix=c.scale([],_,[this.worldSize,this.worldSize,this.worldSize]),c.scale(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=c.multiply(new Float64Array(16),this.labelPlaneMatrix,_),c.translate(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=c.invert([],_),this.pixelMatrix3D=c.multiply(new Float64Array(16),this.labelPlaneMatrix,_);const J=this.width%2/2,ae=this.height%2/2,pe=Math.cos(this.angle),ve=Math.sin(this.angle),Q=a-Math.round(a)+pe*J+ve*ae,be=h-Math.round(h)+pe*ae+ve*J,xe=new Float64Array(_);if(c.translate(xe,xe,[Q>.5?Q-1:Q,be>.5?be-1:be,0]),this.alignedProjMatrix=xe,_=c.invert(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const i=this.pointCoordinate(new c.pointGeometry(0,0)),a=[i.x*this.worldSize,i.y*this.worldSize,0,1];return c.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.pointGeometry(0,i))}getCameraQueryGeometry(i){const a=this.getCameraPoint();if(i.length===1)return[i[0],a];{let h=a.x,_=a.y,v=a.x,T=a.y;for(const C of i)h=Math.min(h,C.x),_=Math.min(_,C.y),v=Math.max(v,C.x),T=Math.max(T,C.y);return[new c.pointGeometry(h,_),new c.pointGeometry(v,_),new c.pointGeometry(v,T),new c.pointGeometry(h,T),new c.pointGeometry(h,_)]}}}class au{constructor(i){this._hashName=i&&encodeURIComponent(i),c.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(a,h){let _=!1,v=null;const T=()=>{v=null,_&&(a(),v=setTimeout(T,300),_=!1)};return()=>(_=!0,v||T(),v)}(this._updateHashUnthrottled.bind(this))}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const a=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,_=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,_),T=Math.round(a.lng*v)/v,C=Math.round(a.lat*v)/v,I=this._map.getBearing(),z=this._map.getPitch();let B="";if(B+=i?`/${T}/${C}/${h}`:`${h}/${C}/${T}`,(I||z)&&(B+="/"+Math.round(10*I)/10),z&&(B+=`/${Math.round(z)}`),this._hashName){const N=this._hashName;let G=!1;const Y=window.location.hash.slice(1).split("&").map(X=>{const J=X.split("=")[0];return J===N?(G=!0,`${J}=${B}`):X}).filter(X=>X);return G||Y.push(`${N}=${B}`),`#${Y.join("&")}`}return`#${B}`}_getCurrentHash(){const i=window.location.hash.replace("#","");if(this._hashName){let a;return i.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(a=h)}),(a&&a[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._getCurrentHash();if(i.length>=3&&!i.some(a=>isNaN(a))){const a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:a,pitch:+(i[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,i)}catch{}}}const Fn={linearity:.3,easing:c.bezier(0,0,.3,1)},Hs=c.extend({deceleration:2500,maxSpeed:1400},Fn),El=c.extend({deceleration:20,maxSpeed:1400},Fn),La=c.extend({deceleration:1e3,maxSpeed:360},Fn),Jr=c.extend({deceleration:1e3,maxSpeed:90},Fn);class Da{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,a=c.exported.now();for(;i.length>0&&a-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new c.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)a.zoom+=v.zoomDelta||0,a.bearing+=v.bearingDelta||0,a.pitch+=v.pitchDelta||0,v.panDelta&&a.pan._add(v.panDelta),v.around&&(a.around=v.around),v.pinchAround&&(a.pinchAround=v.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(a.pan.mag()){const v=Ar(a.pan.mag(),h,c.extend({},Hs,i||{}));_.offset=a.pan.mult(v.amount/a.pan.mag()),_.center=this._map.transform.center,Eo(_,v)}if(a.zoom){const v=Ar(a.zoom,h,El);_.zoom=this._map.transform.zoom+v.amount,Eo(_,v)}if(a.bearing){const v=Ar(a.bearing,h,La);_.bearing=this._map.transform.bearing+c.clamp(v.amount,-179,179),Eo(_,v)}if(a.pitch){const v=Ar(a.pitch,h,Jr);_.pitch=this._map.transform.pitch+v.amount,Eo(_,v)}if(_.zoom||_.bearing){const v=a.pinchAround===void 0?a.around:a.pinchAround;_.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),c.extend(_,{noMoveStart:!0})}}function Eo(f,i){(!f.duration||f.duration<i.duration)&&(f.duration=i.duration,f.easing=i.easing)}function Ar(f,i,a){const{maxSpeed:h,linearity:_,deceleration:v}=a,T=c.clamp(f*_/(i/1e3),-h,h),C=Math.abs(T)/(v*_);return{easing:a.easing,duration:1e3*C,amount:T*(C/2)}}class rn extends c.Event{constructor(i,a,h,_={}){const v=K.mousePos(a.getCanvasContainer(),h),T=a.unproject(v);super(i,c.extend({point:v,lngLat:T,originalEvent:h},_)),this._defaultPrevented=!1,this.target=a}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Xo extends c.Event{constructor(i,a,h){const _=i==="touchend"?h.changedTouches:h.touches,v=K.touchPos(a.getCanvasContainer(),_),T=v.map(I=>a.unproject(I)),C=v.reduce((I,z,B,N)=>I.add(z.div(N.length)),new c.pointGeometry(0,0));super(i,{points:v,point:C,lngLats:T,lngLat:a.unproject(C),originalEvent:h}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Pn extends c.Event{constructor(i,a,h){super(i,{originalEvent:h}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class oc{constructor(i,a){this._map=i,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new Pn(i.type,this._map,i))}mousedown(i,a){return this._mousedownPos=a,this._firePreventable(new rn(i.type,this._map,i))}mouseup(i){this._map.fire(new rn(i.type,this._map,i))}click(i,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new rn(i.type,this._map,i))}dblclick(i){return this._firePreventable(new rn(i.type,this._map,i))}mouseover(i){this._map.fire(new rn(i.type,this._map,i))}mouseout(i){this._map.fire(new rn(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Xo(i.type,this._map,i))}touchmove(i){this._map.fire(new Xo(i.type,this._map,i))}touchend(i){this._map.fire(new Xo(i.type,this._map,i))}touchcancel(i){this._map.fire(new Xo(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ur{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new rn(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new rn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new rn(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class lu{constructor(i,a){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,a){this.isEnabled()&&i.shiftKey&&i.button===0&&(K.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(i,a){if(!this._active)return;const h=a;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=h,this._box||(this._box=K.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const v=Math.min(_.x,h.x),T=Math.max(_.x,h.x),C=Math.min(_.y,h.y),I=Math.max(_.y,h.y);K.setTransform(this._box,`translate(${v}px,${C}px)`),this._box.style.width=T-v+"px",this._box.style.height=I-C+"px"}mouseupWindow(i,a){if(!this._active||i.button!==0)return;const h=this._startPos,_=a;if(this.reset(),K.suppressClick(),h.x!==_.x||h.y!==_.y)return this._map.fire(new c.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:v=>v.fitScreenCoordinates(h,_,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(K.remove(this._box),this._box=null),K.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,a){return this._map.fire(new c.Event(i,{originalEvent:a}))}}function zr(f,i){if(f.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${i.length}`);const a={};for(let h=0;h<f.length;h++)a[f[h].identifier]=i[h];return a}class Xs{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,a,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),h.length===this.numTouches&&(this.centroid=function(_){const v=new c.pointGeometry(0,0);for(const T of _)v._add(T);return v.div(_.length)}(a),this.touches=zr(h,a)))}touchmove(i,a,h){if(this.aborted||!this.centroid)return;const _=zr(h,a);for(const v in this.touches){const T=this.touches[v],C=_[v];(!C||C.dist(T)>30)&&(this.aborted=!0)}}touchend(i,a,h){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Ra{constructor(i){this.singleTap=new Xs(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,a,h){this.singleTap.touchstart(i,a,h)}touchmove(i,a,h){this.singleTap.touchmove(i,a,h)}touchend(i,a,h){const _=this.singleTap.touchend(i,a,h);if(_){const v=i.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(_)<30;if(v&&T||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class sc{constructor(){this._zoomIn=new Ra({numTouches:1,numTaps:2}),this._zoomOut=new Ra({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,a,h){this._zoomIn.touchstart(i,a,h),this._zoomOut.touchstart(i,a,h)}touchmove(i,a,h){this._zoomIn.touchmove(i,a,h),this._zoomOut.touchmove(i,a,h)}touchend(i,a,h){const _=this._zoomIn.touchend(i,a,h),v=this._zoomOut.touchend(i,a,h);return _?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(_)},{originalEvent:i})}):v?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(v)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Mr={0:1,2:2};class Ko{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(i,a){return!1}_move(i,a){return{}}mousedown(i,a){if(this._lastPoint)return;const h=K.mouseButton(i);this._correctButton(i,h)&&(this._lastPoint=a,this._eventButton=h)}mousemoveWindow(i,a){const h=this._lastPoint;if(h){if(i.preventDefault(),function(_,v){const T=Mr[v];return _.buttons===void 0||(_.buttons&T)!==T}(i,this._eventButton))this.reset();else if(this._moved||!(a.dist(h)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(h,a)}}mouseupWindow(i){this._lastPoint&&K.mouseButton(i)===this._eventButton&&(this._moved&&K.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ks extends Ko{mousedown(i,a){super.mousedown(i,a),this._lastPoint&&(this._active=!0)}_correctButton(i,a){return a===0&&!i.ctrlKey}_move(i,a){return{around:a,panDelta:a.sub(i)}}}class Xn extends Ko{_correctButton(i,a){return a===0&&i.ctrlKey||a===2}_move(i,a){const h=.8*(a.x-i.x);if(h)return this._active=!0,{bearingDelta:h}}contextmenu(i){i.preventDefault()}}class nt extends Ko{_correctButton(i,a){return a===0&&i.ctrlKey||a===2}_move(i,a){const h=-.5*(a.y-i.y);if(h)return this._active=!0,{pitchDelta:h}}contextmenu(i){i.preventDefault()}}class Pl{constructor(i,a){this._minTouches=i.cooperativeGestures?2:1,this._clickTolerance=i.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(i,a,h){return this._calculateTransform(i,a,h)}touchmove(i,a,h){if(this._map._cooperativeGestures&&(this._minTouches===2&&h.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(i,!1,h.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(h.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,a,h)}touchend(i,a,h){this._calculateTransform(i,a,h),this._active&&h.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,a,h){h.length>0&&(this._active=!0);const _=zr(h,a),v=new c.pointGeometry(0,0),T=new c.pointGeometry(0,0);let C=0;for(const z in _){const B=_[z],N=this._touches[z];N&&(v._add(B),T._add(B.sub(N)),C++,_[z]=B)}if(this._touches=_,C<this._minTouches||!T.mag())return;const I=T.div(C);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(C),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jo{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(i){}_move(i,a,h){return{}}touchstart(i,a,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([a[0],a[1]]))}touchmove(i,a,h){if(!this._firstTwoTouches)return;i.preventDefault();const[_,v]=this._firstTwoTouches,T=Kn(h,a,_),C=Kn(h,a,v);if(!T||!C)return;const I=this._aroundCenter?null:T.add(C).div(2);return this._move([T,C],I,i)}touchend(i,a,h){if(!this._firstTwoTouches)return;const[_,v]=this._firstTwoTouches,T=Kn(h,a,_),C=Kn(h,a,v);T&&C||(this._active&&K.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kn(f,i,a){for(let h=0;h<f.length;h++)if(f[h].identifier===a)return i[h]}function Cl(f,i){return Math.log(f/i)/Math.LN2}class He extends Jo{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,a){const h=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Cl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Cl(this._distance,h),pinchAround:a}}}function Js(f,i){return 180*f.angleWith(i)/Math.PI}class uu extends Jo{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,a){const h=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Js(this._vector,h),pinchAround:a}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const a=25/(Math.PI*this._minDiameter)*360,h=Js(i,this._startVector);return Math.abs(h)<a}}function Il(f){return Math.abs(f.y)>Math.abs(f.x)}class cr extends Jo{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,a,h){super.touchstart(i,a,h),this._currentTouchCount=h.length}_start(i){this._lastPoints=i,Il(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,a,h){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const _=i[0].sub(this._lastPoints[0]),v=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,v,h.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(_.y+v.y)/2*-.5}):void 0}gestureBeginsVertically(i,a,h){if(this._valid!==void 0)return this._valid;const _=i.mag()>=2,v=a.mag()>=2;if(!_&&!v)return;if(!_||!v)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const T=i.y>0==a.y>0;return Il(i)&&Il(a)&&T}}const kl={panStep:100,bearingStep:15,pitchStep:10};class Al{constructor(){const i=kl;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let a=0,h=0,_=0,v=0,T=0;switch(i.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:i.shiftKey?h=-1:(i.preventDefault(),v=-1);break;case 39:i.shiftKey?h=1:(i.preventDefault(),v=1);break;case 38:i.shiftKey?_=1:(i.preventDefault(),T=-1);break;case 40:i.shiftKey?_=-1:(i.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(h=0,_=0),{cameraAnimation:C=>{const I=C.getZoom();C.easeTo({duration:300,easeId:"keyboardHandler",easing:Ys,zoom:a?Math.round(I)+a*(i.shiftKey?2:1):I,bearing:C.getBearing()+h*this._bearingStep,pitch:C.getPitch()+_*this._pitchStep,offset:[-v*this._panStep,-T*this._panStep],center:C.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ys(f){return f*(2-f)}const cu=4.000244140625;class bs{constructor(i,a){this._map=i,this._el=i.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,c.bindAll(["_onTimeout"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;i.preventDefault()}let a=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const h=c.exported.now(),_=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,a!==0&&a%cu==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(_*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),i.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=i,this._delta-=a,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=K.mousePos(this._el,i);this._around=c.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>cu?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&I!==0&&(I=1/I);const z=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):i.scale;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(z*I))),this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:i.zoom,h=this._startZoom,_=this._easing;let v,T=!1;if(this._type==="wheel"&&h&&_){const C=Math.min((c.exported.now()-this._lastWheelEventTime)/200,1),I=_(C);v=c.number(h,a,I),C<1?this._frameId||(this._frameId=!0):T=!0}else v=a,T=!0;return this._active=!0,T&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!T,zoomDelta:v-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let a=c.ease;if(this._prevEase){const h=this._prevEase,_=(c.exported.now()-h.start)/h.duration,v=h.easing(_+.01)-h.easing(_),T=.27/Math.sqrt(v*v+1e-4)*.01,C=Math.sqrt(.0729-T*T);a=c.bezier(T,C,.25,1)}return this._prevEase={start:c.exported.now(),duration:i,easing:a},a}reset(){this._active=!1}}class Yo{constructor(i,a){this._clickZoom=i,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ba{constructor(){this.reset()}reset(){this._active=!1}dblclick(i,a){return i.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:h.getZoom()+(i.shiftKey?-1:1),around:h.unproject(a)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oa{constructor(){this._tap=new Ra({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(i,a,h){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?h.length>0&&(this._swipePoint=a[0],this._swipeTouch=h[0].identifier):this._tap.touchstart(i,a,h))}touchmove(i,a,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const _=a[0],v=_.y-this._swipePoint.y;return this._swipePoint=_,i.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(i,a,h)}touchend(i,a,h){this._tapTime?this._swipePoint&&h.length===0&&this.reset():this._tap.touchend(i,a,h)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Cn{constructor(i,a,h){this._el=i,this._mousePan=a,this._touchPan=h}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Yr{constructor(i,a,h){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=a,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class zl{constructor(i,a,h,_){this._el=i,this._touchZoom=a,this._touchRotate=h,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Qo=f=>f.zoom||f.drag||f.pitch||f.rotate;class Fa extends c.Event{}function Ts(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class hu{constructor(i,a){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Da(i),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),c.bindAll(["handleEvent","handleWindowEvent"],this);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,v,T]of this._listeners)K.addEventListener(_,v,_===document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[i,a,h]of this._listeners)K.removeEventListener(i,a,i===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(i){const a=this._map,h=a.getCanvasContainer();this._add("mapEvent",new oc(a,i));const _=a.boxZoom=new lu(a,i);this._add("boxZoom",_);const v=new sc,T=new Ba;a.doubleClickZoom=new Yo(T,v),this._add("tapZoom",v),this._add("clickZoom",T);const C=new Oa;this._add("tapDragZoom",C);const I=a.touchPitch=new cr(a);this._add("touchPitch",I);const z=new Xn(i),B=new nt(i);a.dragRotate=new Yr(i,z,B),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",B,["mouseRotate"]);const N=new Ks(i),G=new Pl(i,a);a.dragPan=new Cn(h,N,G),this._add("mousePan",N),this._add("touchPan",G,["touchZoom","touchRotate"]);const Y=new uu,X=new He;a.touchZoomRotate=new zl(h,X,Y,C),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",X,["touchPan","touchRotate"]);const J=a.scrollZoom=new bs(a,this);this._add("scrollZoom",J,["mousePan"]);const ae=a.keyboard=new Al;this._add("keyboard",ae),this._add("blockableMapEvent",new ur(a));for(const pe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[pe]&&a[pe].enable(i[pe])}_add(i,a,h){this._handlers.push({handlerName:i,handler:a,allowed:h}),this._handlersById[i]=a}stop(i){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Qo(this._eventsInProgress))||this.isZooming()}_blockedByActive(i,a,h){for(const _ in i)if(_!==h&&(!a||a.indexOf(_)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const a=[];for(const h of i)this._el.contains(h.target)&&a.push(h);return a}handleEvent(i,a){if(i.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const h=i.type==="renderFrame"?void 0:i,_={needsRenderFrame:!1},v={},T={},C=i.touches,I=C?this._getMapTouches(C):void 0,z=I?K.touchPos(this._el,I):K.mousePos(this._el,i);for(const{handlerName:G,handler:Y,allowed:X}of this._handlers){if(!Y.isEnabled())continue;let J;this._blockedByActive(T,X,G)?Y.reset():Y[a||i.type]&&(J=Y[a||i.type](i,z,I),this.mergeHandlerResult(_,v,J,G,h),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||Y.isActive())&&(T[G]=Y)}const B={};for(const G in this._previousActiveHandlers)T[G]||(B[G]=h);this._previousActiveHandlers=T,(Object.keys(B).length||Ts(_))&&(this._changes.push([_,v,B]),this._triggerRenderFrame()),(Object.keys(T).length||Ts(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=_;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(i,a,h,_,v){if(!h)return;c.extend(i,h);const T={handlerName:_,originalEvent:h.originalEvent||v};h.zoomDelta!==void 0&&(a.zoom=T),h.panDelta!==void 0&&(a.drag=T),h.pitchDelta!==void 0&&(a.pitch=T),h.bearingDelta!==void 0&&(a.rotate=T)}_applyChanges(){const i={},a={},h={};for(const[_,v,T]of this._changes)_.panDelta&&(i.panDelta=(i.panDelta||new c.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(i.around=_.around),_.pinchAround!==void 0&&(i.pinchAround=_.pinchAround),_.noInertia&&(i.noInertia=_.noInertia),c.extend(a,v),c.extend(h,T);this._updateMapTransform(i,a,h),this._changes=[]}_updateMapTransform(i,a,h){const _=this._map,v=_.transform,T=_.style&&_.style.terrain;if(!(Ts(i)||T&&this._drag))return this._fireEvents(a,h,!0);let{panDelta:C,zoomDelta:I,bearingDelta:z,pitchDelta:B,around:N,pinchAround:G}=i;G!==void 0&&(N=G),_._stop(!0),N=N||_.transform.centerPoint;const Y=v.pointLocation(C?N.sub(C):N);z&&(v.bearing+=z),B&&(v.pitch+=B),I&&(v.zoom+=I),T?a.drag&&!this._drag?(this._drag={center:v.centerPoint,lngLat:v.pointLocation(N),point:N,handlerName:a.drag.handlerName},_.fire(new c.Event("freezeElevation",{freeze:!0}))):this._drag&&h[this._drag.handlerName]?(_.fire(new c.Event("freezeElevation",{freeze:!1})),this._drag=null):a.drag&&this._drag&&(v.center=v.pointLocation(v.centerPoint.sub(C))):v.setLocationAtPoint(Y,N),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(a,h,!0)}_fireEvents(i,a,h){const _=Qo(this._eventsInProgress),v=Qo(i),T={};for(const B in i){const{originalEvent:N}=i[B];this._eventsInProgress[B]||(T[`${B}start`]=N),this._eventsInProgress[B]=i[B]}!_&&v&&this._fireEvent("movestart",v.originalEvent);for(const B in T)this._fireEvent(B,T[B]);v&&this._fireEvent("move",v.originalEvent);for(const B in i){const{originalEvent:N}=i[B];this._fireEvent(B,N)}const C={};let I;for(const B in this._eventsInProgress){const{handlerName:N,originalEvent:G}=this._eventsInProgress[B];this._handlersById[N].isActive()||(delete this._eventsInProgress[B],I=a[N]||G,C[`${B}end`]=I)}for(const B in C)this._fireEvent(B,C[B]);const z=Qo(this._eventsInProgress);if(h&&(_||v)&&!z){this._updatingCamera=!0;const B=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;B?(N(B.bearing||this._map.getBearing())&&(B.bearing=0),this._map.easeTo(B,{originalEvent:I})):(this._map.fire(new c.Event("moveend",{originalEvent:I})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,a){this._map.fire(new c.Event(i,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new Fa("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Nn={extend:(f,...i)=>c.extend(f,...i),run(f){f()},logToElement(f,i=!1,a="log"){const h=window.document.getElementById(a);h&&(i&&(h.innerHTML=""),h.innerHTML+=`<br>${f}`)}};class xi extends c.Evented{constructor(i,a){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=a.bearingSnap,c.bindAll(["_renderFrameCallback"],this)}getCenter(){return new c.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,a){return this.jumpTo({center:i},a)}panBy(i,a,h){return i=c.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,c.extend({offset:i},a),h)}panTo(i,a,h){return this.easeTo(c.extend({center:i},a),h)}getZoom(){return this.transform.zoom}setZoom(i,a){return this.jumpTo({zoom:i},a),this}zoomTo(i,a,h){return this.easeTo(c.extend({zoom:i},a),h)}zoomIn(i,a){return this.zoomTo(this.getZoom()+1,i,a),this}zoomOut(i,a){return this.zoomTo(this.getZoom()-1,i,a),this}getBearing(){return this.transform.bearing}setBearing(i,a){return this.jumpTo({bearing:i},a),this}getPadding(){return this.transform.padding}setPadding(i,a){return this.jumpTo({padding:i},a),this}rotateTo(i,a,h){return this.easeTo(c.extend({bearing:i},a),h)}resetNorth(i,a){return this.rotateTo(0,c.extend({duration:1e3},i),a),this}resetNorthPitch(i,a){return this.easeTo(c.extend({bearing:0,pitch:0,duration:1e3},i),a),this}snapToNorth(i,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,a):this}getPitch(){return this.transform.pitch}setPitch(i,a){return this.jumpTo({pitch:i},a),this}cameraForBounds(i,a){i=c.LngLatBounds.convert(i);const h=a&&a.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),h,a)}_cameraForBoxAndBearing(i,a,h,_){const v={top:0,bottom:0,right:0,left:0};if(typeof(_=c.extend({padding:v,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const xe=_.padding;_.padding={top:xe,bottom:xe,right:xe,left:xe}}_.padding=c.extend(v,_.padding);const T=this.transform,C=T.padding,I=T.project(c.LngLat.convert(i)),z=T.project(c.LngLat.convert(a)),B=I.rotate(-h*Math.PI/180),N=z.rotate(-h*Math.PI/180),G=new c.pointGeometry(Math.max(B.x,N.x),Math.max(B.y,N.y)),Y=new c.pointGeometry(Math.min(B.x,N.x),Math.min(B.y,N.y)),X=G.sub(Y),J=(T.width-(C.left+C.right+_.padding.left+_.padding.right))/X.x,ae=(T.height-(C.top+C.bottom+_.padding.top+_.padding.bottom))/X.y;if(ae<0||J<0)return void c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const pe=Math.min(T.scaleZoom(T.scale*Math.min(J,ae)),_.maxZoom),ve=c.pointGeometry.convert(_.offset),Q=new c.pointGeometry((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(h*Math.PI/180),be=ve.add(Q).mult(T.scale/T.zoomScale(pe));return{center:T.unproject(I.add(z).div(2).sub(be)),zoom:pe,bearing:h}}fitBounds(i,a,h){return this._fitInternal(this.cameraForBounds(i,a),a,h)}fitScreenCoordinates(i,a,h,_,v){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.pointGeometry.convert(i)),this.transform.pointLocation(c.pointGeometry.convert(a)),h,_),_,v)}_fitInternal(i,a,h){return i?(delete(a=c.extend(i,a)).padding,a.linear?this.easeTo(a,h):this.flyTo(a,h)):this}jumpTo(i,a){this.stop();const h=this.transform;let _=!1,v=!1,T=!1;return"zoom"in i&&h.zoom!==+i.zoom&&(_=!0,h.zoom=+i.zoom),i.center!==void 0&&(h.center=c.LngLat.convert(i.center)),"bearing"in i&&h.bearing!==+i.bearing&&(v=!0,h.bearing=+i.bearing),"pitch"in i&&h.pitch!==+i.pitch&&(T=!0,h.pitch=+i.pitch),i.padding==null||h.isPaddingEqual(i.padding)||(h.padding=i.padding),this.fire(new c.Event("movestart",a)).fire(new c.Event("move",a)),_&&this.fire(new c.Event("zoomstart",a)).fire(new c.Event("zoom",a)).fire(new c.Event("zoomend",a)),v&&this.fire(new c.Event("rotatestart",a)).fire(new c.Event("rotate",a)).fire(new c.Event("rotateend",a)),T&&this.fire(new c.Event("pitchstart",a)).fire(new c.Event("pitch",a)).fire(new c.Event("pitchend",a)),this.fire(new c.Event("moveend",a))}calculateCameraOptionsFromTo(i,a,h,_=0){const v=c.MercatorCoordinate.fromLngLat(i,a),T=c.MercatorCoordinate.fromLngLat(h,_),C=T.x-v.x,I=T.y-v.y,z=T.z-v.z,B=Math.hypot(C,I,z);if(B===0)throw new Error("Can't calculate camera options with same From and To");const N=Math.hypot(C,I),G=this.transform.scaleZoom(this.transform.cameraToCenterDistance/B/this.transform.tileSize),Y=180*Math.atan2(C,-I)/Math.PI;let X=180*Math.acos(N/B)/Math.PI;return X=z<0?90-X:90+X,{center:T.toLngLat(),zoom:G,pitch:X,bearing:Y}}easeTo(i,a){this._stop(!1,i.easeId),((i=c.extend({offset:[0,0],duration:500,easing:c.ease},i)).animate===!1||!i.essential&&c.exported.prefersReducedMotion)&&(i.duration=0);const h=this.transform,_=this.getZoom(),v=this.getBearing(),T=this.getPitch(),C=this.getPadding(),I="zoom"in i?+i.zoom:_,z="bearing"in i?this._normalizeBearing(i.bearing,v):v,B="pitch"in i?+i.pitch:T,N="padding"in i?i.padding:h.padding,G=c.pointGeometry.convert(i.offset);let Y=h.centerPoint.add(G);const X=h.pointLocation(Y),J=c.LngLat.convert(i.center||X);this._normalizeCenter(J);const ae=h.project(X),pe=h.project(J).sub(ae),ve=h.zoomScale(I-_);let Q,be;i.around&&(Q=c.LngLat.convert(i.around),be=h.locationPoint(Q));const xe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||I!==_,this._rotating=this._rotating||v!==z,this._pitching=this._pitching||B!==T,this._padding=!h.isPaddingEqual(N),this._easeId=i.easeId,this._prepareEase(a,i.noMoveStart,xe),this._ease(Ae=>{if(this._zooming&&(h.zoom=c.number(_,I,Ae)),this._rotating&&(h.bearing=c.number(v,z,Ae)),this._pitching&&(h.pitch=c.number(T,B,Ae)),this._padding&&(h.interpolatePadding(C,N,Ae),Y=h.centerPoint.add(G)),Q)h.setLocationAtPoint(Q,be);else{const ze=h.zoomScale(h.zoom-_),Fe=I>_?Math.min(2,ve):Math.max(.5,ve),Ce=Math.pow(Fe,1-Ae),it=h.unproject(ae.add(pe.mult(Ae*Ce)).mult(ze));h.setLocationAtPoint(h.renderWorldCopies?it.wrap():it,Y)}this._fireMoveEvents(a)},Ae=>{this._afterEase(a,Ae)},i),this}_prepareEase(i,a,h={}){this._moving=!0,this.fire(new c.Event("freezeElevation",{freeze:!0})),a||h.moving||this.fire(new c.Event("movestart",i)),this._zooming&&!h.zooming&&this.fire(new c.Event("zoomstart",i)),this._rotating&&!h.rotating&&this.fire(new c.Event("rotatestart",i)),this._pitching&&!h.pitching&&this.fire(new c.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new c.Event("move",i)),this._zooming&&this.fire(new c.Event("zoom",i)),this._rotating&&this.fire(new c.Event("rotate",i)),this._pitching&&this.fire(new c.Event("pitch",i))}_afterEase(i,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId,this.fire(new c.Event("freezeElevation",{freeze:!1}));const h=this._zooming,_=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new c.Event("zoomend",i)),_&&this.fire(new c.Event("rotateend",i)),v&&this.fire(new c.Event("pitchend",i)),this.fire(new c.Event("moveend",i))}flyTo(i,a){if(!i.essential&&c.exported.prefersReducedMotion){const _t=c.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(_t,a)}this.stop(),i=c.extend({offset:[0,0],speed:1.2,curve:1.42,easing:c.ease},i);const h=this.transform,_=this.getZoom(),v=this.getBearing(),T=this.getPitch(),C=this.getPadding(),I="zoom"in i?c.clamp(+i.zoom,h.minZoom,h.maxZoom):_,z="bearing"in i?this._normalizeBearing(i.bearing,v):v,B="pitch"in i?+i.pitch:T,N="padding"in i?i.padding:h.padding,G=h.zoomScale(I-_),Y=c.pointGeometry.convert(i.offset);let X=h.centerPoint.add(Y);const J=h.pointLocation(X),ae=c.LngLat.convert(i.center||J);this._normalizeCenter(ae);const pe=h.project(J),ve=h.project(ae).sub(pe);let Q=i.curve;const be=Math.max(h.width,h.height),xe=be/G,Ae=ve.mag();if("minZoom"in i){const _t=c.clamp(Math.min(i.minZoom,_,I),h.minZoom,h.maxZoom),ai=be/h.zoomScale(_t-_);Q=Math.sqrt(ai/Ae*2)}const ze=Q*Q;function Fe(_t){const ai=(xe*xe-be*be+(_t?-1:1)*ze*ze*Ae*Ae)/(2*(_t?xe:be)*ze*Ae);return Math.log(Math.sqrt(ai*ai+1)-ai)}function Ce(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function it(_t){return(Math.exp(_t)+Math.exp(-_t))/2}const Ke=Fe(0);let ot=function(_t){return it(Ke)/it(Ke+Q*_t)},kt=function(_t){return be*((it(Ke)*(Ce(ai=Ke+Q*_t)/it(ai))-Ce(Ke))/ze)/Ae;var ai},Bt=(Fe(1)-Ke)/Q;if(Math.abs(Ae)<1e-6||!isFinite(Bt)){if(Math.abs(be-xe)<1e-6)return this.easeTo(i,a);const _t=xe<be?-1:1;Bt=Math.abs(Math.log(xe/be))/Q,kt=function(){return 0},ot=function(ai){return Math.exp(_t*Q*ai)}}return i.duration="duration"in i?+i.duration:1e3*Bt/("screenSpeed"in i?+i.screenSpeed/Q:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=v!==z,this._pitching=B!==T,this._padding=!h.isPaddingEqual(N),this._prepareEase(a,!1),this._ease(_t=>{const ai=_t*Bt,li=1/ot(ai);h.zoom=_t===1?I:_+h.scaleZoom(li),this._rotating&&(h.bearing=c.number(v,z,_t)),this._pitching&&(h.pitch=c.number(T,B,_t)),this._padding&&(h.interpolatePadding(C,N,_t),X=h.centerPoint.add(Y));const Xt=_t===1?ae:h.unproject(pe.add(ve.mult(kt(ai))).mult(li));h.setLocationAtPoint(h.renderWorldCopies?Xt.wrap():Xt,X),this._fireMoveEvents(a)},()=>this._afterEase(a),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,a)}if(!i){const h=this.handlers;h&&h.stop(!1)}return this}_ease(i,a,h){h.animate===!1||h.duration===0?(i(1),a()):(this._easeStart=c.exported.now(),this._easeOptions=h,this._onEaseFrame=i,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((c.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,a){i=c.wrap(i,-180,180);const h=Math.abs(i-a);return Math.abs(i-360-a)<h&&(i-=360),Math.abs(i+360-a)<h&&(i+=360),i}_normalizeCenter(i){const a=this.transform;if(!a.renderWorldCopies||a.lngRange)return;const h=i.lng-a.center.lng;i.lng+=h>180?-360:h<-180?360:0}}class Qs{constructor(i={}){this.options=i,c.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options&&this.options.compact,this._container=K.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=K.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=K.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){K.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,a){const h=this._map._getUIString(`AttributionControl.${a}`);i.title=h,i.setAttribute("aria-label",h)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(i){!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"&&i.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const a=this._map.style.sourceCaches;for(const _ in a){const v=a[_];if(v.used||v.usedForTerrain){const T=v.getSource();T.attribution&&i.indexOf(T.attribution)<0&&i.push(T.attribution)}}i=i.filter(_=>String(_).trim()),i.sort((_,v)=>_.length-v.length),i=i.filter((_,v)=>{for(let T=v+1;T<i.length;T++)if(i[T].indexOf(_)>=0)return!1;return!0});const h=i.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,i.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class s{constructor(i={}){this.options=i,c.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=K.create("div","maplibregl-ctrl mapboxgl-ctrl");const a=K.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){K.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const i=this._container.children;if(i.length){const a=i[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&a.classList.add("maplibregl-compact","mapboxgl-compact"):a.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class d{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const a=++this._id;return this._queue.push({callback:i,id:a,cancelled:!1}),a}remove(i){const a=this._currentlyRunning,h=a?this._queue.concat(a):this._queue;for(const _ of h)if(_.id===i)return void(_.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const h of a)if(!h.cancelled&&(h.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const w={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},E={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},M={showCompass:!0,showZoom:!0,visualizePitch:!1};class V{constructor(i,a,h=!1){this._clickTolerance=10,this.element=a,this.mouseRotate=new Xn({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,h&&(this.mousePitch=new nt({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),c.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),K.addEventListener(a,"mousedown",this.mousedown),K.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),K.addEventListener(a,"touchmove",this.touchmove),K.addEventListener(a,"touchend",this.touchend),K.addEventListener(a,"touchcancel",this.reset)}down(i,a){this.mouseRotate.mousedown(i,a),this.mousePitch&&this.mousePitch.mousedown(i,a),K.disableDrag()}move(i,a){const h=this.map,_=this.mouseRotate.mousemoveWindow(i,a);if(_&&_.bearingDelta&&h.setBearing(h.getBearing()+_.bearingDelta),this.mousePitch){const v=this.mousePitch.mousemoveWindow(i,a);v&&v.pitchDelta&&h.setPitch(h.getPitch()+v.pitchDelta)}}off(){const i=this.element;K.removeEventListener(i,"mousedown",this.mousedown),K.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),K.removeEventListener(i,"touchmove",this.touchmove),K.removeEventListener(i,"touchend",this.touchend),K.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){K.enableDrag(),K.removeEventListener(window,"mousemove",this.mousemove),K.removeEventListener(window,"mouseup",this.mouseup)}mousedown(i){this.down(c.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),K.mousePos(this.element,i)),K.addEventListener(window,"mousemove",this.mousemove),K.addEventListener(window,"mouseup",this.mouseup)}mousemove(i){this.move(i,K.mousePos(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=K.touchPos(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){i.targetTouches.length!==1?this.reset():(this._lastPos=K.touchPos(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function re(f,i,a){if(f=new c.LngLat(f.lng,f.lat),i){const h=new c.LngLat(f.lng-360,f.lat),_=new c.LngLat(f.lng+360,f.lat),v=a.locationPoint(f).distSqr(i);a.locationPoint(h).distSqr(i)<v?f=h:a.locationPoint(_).distSqr(i)<v&&(f=_)}for(;Math.abs(f.lng-a.center.lng)>180;){const h=a.locationPoint(f);if(h.x>=0&&h.y>=0&&h.x<=a.width&&h.y<=a.height)break;f.lng>a.center.lng?f.lng-=360:f.lng+=360}return f}const oe={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function he(f,i,a){const h=f.classList;for(const _ in oe)h.remove(`maplibregl-${a}-anchor-${_}`,`mapboxgl-${a}-anchor-${_}`);h.add(`maplibregl-${a}-anchor-${i}`,`mapboxgl-${a}-anchor-${i}`)}class Oe extends c.Evented{constructor(i,a){if(super(),(i instanceof HTMLElement||a)&&(i=c.extend({element:i},a)),c.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=c.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=K.create("div"),this._element.setAttribute("aria-label","Map marker");const h=K.createNS("http://www.w3.org/2000/svg","svg"),_=41,v=27;h.setAttributeNS(null,"display","block"),h.setAttributeNS(null,"height",`${_}px`),h.setAttributeNS(null,"width",`${v}px`),h.setAttributeNS(null,"viewBox",`0 0 ${v} ${_}`);const T=K.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"stroke","none"),T.setAttributeNS(null,"stroke-width","1"),T.setAttributeNS(null,"fill","none"),T.setAttributeNS(null,"fill-rule","evenodd");const C=K.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill-rule","nonzero");const I=K.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ve of z){const Q=K.createNS("http://www.w3.org/2000/svg","ellipse");Q.setAttributeNS(null,"opacity","0.04"),Q.setAttributeNS(null,"cx","10.5"),Q.setAttributeNS(null,"cy","5.80029008"),Q.setAttributeNS(null,"rx",ve.rx),Q.setAttributeNS(null,"ry",ve.ry),I.appendChild(Q)}const B=K.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill",this._color);const N=K.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),B.appendChild(N);const G=K.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"fill","#000000");const Y=K.createNS("http://www.w3.org/2000/svg","path");Y.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),G.appendChild(Y);const X=K.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"transform","translate(6.0, 7.0)"),X.setAttributeNS(null,"fill","#FFFFFF");const J=K.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ae=K.createNS("http://www.w3.org/2000/svg","circle");ae.setAttributeNS(null,"fill","#000000"),ae.setAttributeNS(null,"opacity","0.25"),ae.setAttributeNS(null,"cx","5.5"),ae.setAttributeNS(null,"cy","5.5"),ae.setAttributeNS(null,"r","5.4999962");const pe=K.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#FFFFFF"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962"),J.appendChild(ae),J.appendChild(pe),C.appendChild(I),C.appendChild(B),C.appendChild(G),C.appendChild(X),C.appendChild(J),h.appendChild(C),h.setAttributeNS(null,"height",_*this._scale+"px"),h.setAttributeNS(null,"width",v*this._scale+"px"),this._element.appendChild(h),this._offset=c.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",h=>{h.preventDefault()}),this._element.addEventListener("mousedown",h=>{h.preventDefault()}),he(this._element,this._anchor,"marker"),this._popup=null}addTo(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),K.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=c.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(i){const a=i.code,h=i.charCode||i.keyCode;a!=="Space"&&a!=="Enter"&&h!==32&&h!==13||this.togglePopup()}_onMapClick(i){const a=i.originalEvent.target,h=this._element;this._popup&&(a===h||h.contains(a))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this}_update(i){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=re(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let a="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?a=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(a=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let h="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?h="rotateX(0deg)":this._pitchAlignment==="map"&&(h=`rotateX(${this._map.getPitch()}deg)`),i&&i.type!=="moveend"||(this._pos=this._pos.round()),K.setTransform(this._element,`${oe[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${h} ${a}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const _=this._map.unproject(this._pos),v=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=_.distanceTo(this._lngLat)>20*v?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(i){return this._offset=c.pointGeometry.convert(i),this._update(),this}_onMove(i){if(!this._isDragging){const a=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=a}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.Event("dragstart"))),this.fire(new c.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.Event("dragend")),this._state="inactive"}_addDragHandler(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._offset),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const rt={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let wt,bt=0,Vi=!1;const on={maxWidth:100,unit:"metric"};function ea(f,i,a){const h=a&&a.maxWidth||100,_=f._container.clientHeight/2,v=f.unproject([0,_]),T=f.unproject([h,_]),C=v.distanceTo(T);if(a&&a.unit==="imperial"){const I=3.2808*C;I>5280?yn(i,h,I/5280,f._getUIString("ScaleControl.Miles")):yn(i,h,I,f._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?yn(i,h,C/1852,f._getUIString("ScaleControl.NauticalMiles")):C>=1e3?yn(i,h,C/1e3,f._getUIString("ScaleControl.Kilometers")):yn(i,h,C,f._getUIString("ScaleControl.Meters"))}function yn(f,i,a,h){const _=function(v){const T=Math.pow(10,`${Math.floor(v)}`.length-1);let C=v/T;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:function(I){const z=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*z)/z}(C),T*C}(a);f.style.width=i*(_/a)+"px",f.innerHTML=`${_}&nbsp;${h}`}const Ti={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Bi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ml(f){if(f){if(typeof f=="number"){const i=Math.round(Math.sqrt(.5*Math.pow(f,2)));return{center:new c.pointGeometry(0,0),top:new c.pointGeometry(0,f),"top-left":new c.pointGeometry(i,i),"top-right":new c.pointGeometry(-i,i),bottom:new c.pointGeometry(0,-f),"bottom-left":new c.pointGeometry(i,-i),"bottom-right":new c.pointGeometry(-i,-i),left:new c.pointGeometry(f,0),right:new c.pointGeometry(-f,0)}}if(f instanceof c.pointGeometry||Array.isArray(f)){const i=c.pointGeometry.convert(f);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:c.pointGeometry.convert(f.center||[0,0]),top:c.pointGeometry.convert(f.top||[0,0]),"top-left":c.pointGeometry.convert(f["top-left"]||[0,0]),"top-right":c.pointGeometry.convert(f["top-right"]||[0,0]),bottom:c.pointGeometry.convert(f.bottom||[0,0]),"bottom-left":c.pointGeometry.convert(f["bottom-left"]||[0,0]),"bottom-right":c.pointGeometry.convert(f["bottom-right"]||[0,0]),left:c.pointGeometry.convert(f.left||[0,0]),right:c.pointGeometry.convert(f.right||[0,0])}}return Ml(new c.pointGeometry(0,0))}const es={supported:q,setRTLTextPlugin:c.setRTLTextPlugin,getRTLTextPluginStatus:c.getRTLTextPluginStatus,Map:class extends xi{constructor(f){var i;if(c.PerformanceUtils.mark(c.PerformanceMarkers.create),(f=c.extend({},E,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new kr(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),{bearingSnap:f.bearingSnap}),this._interactive=f.interactive,this._cooperativeGestures=f.cooperativeGestures,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=f.collectResourceTiming,this._renderTaskQueue=new d,this._controls=[],this._mapId=c.uniqueId(),this._locale=c.extend({},w,f.locale),this._clickTolerance=f.clickTolerance,this._pixelRatio=(i=f.pixelRatio)!==null&&i!==void 0?i:devicePixelRatio,this._requestManager=new Ze(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),c.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new hu(this,f),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=f.hash&&new au(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Qs({customAttribution:f.customAttribution})),f.maplibreLogo&&this.addControl(new s,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new c.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new c.Event(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new c.Event("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(f,i){if(i===void 0&&(i=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=f.onAdd(this);this._controls.push(f);const h=this._controlPositions[i];return i.indexOf("bottom")!==-1?h.insertBefore(a,h.firstChild):h.appendChild(a),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(f);return i>-1&&this._controls.splice(i,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,i,a,h){return h==null&&this.style.terrain&&(h=this.transform.getElevation(a,this.style.terrain)),super.calculateCameraOptionsFromTo(f,i,a,h)}resize(f){const i=this._containerDimensions(),a=i[0],h=i[1];this._resizeCanvas(a,h,this.getPixelRatio()),this.transform.resize(a,h),this.painter.resize(a,h,this.getPixelRatio());const _=!this._moving;return _&&(this.stop(),this.fire(new c.Event("movestart",f)).fire(new c.Event("move",f))),this.fire(new c.Event("resize",f)),_&&this.fire(new c.Event("moveend",f)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(f){const[i,a]=this._containerDimensions();this._pixelRatio=f,this._resizeCanvas(i,a,f),this.painter.resize(i,a,f)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(c.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this._update()}project(f){return this.transform.locationPoint(c.LngLat.convert(f),this.style&&this.style.terrain)}unproject(f){return this.transform.pointLocation(c.pointGeometry.convert(f),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(f,i,a){if(f==="mouseenter"||f==="mouseover"){let h=!1;return{layer:i,listener:a,delegates:{mousemove:v=>{const T=this.getLayer(i)?this.queryRenderedFeatures(v.point,{layers:[i]}):[];T.length?h||(h=!0,a.call(this,new rn(f,this,v.originalEvent,{features:T}))):h=!1},mouseout:()=>{h=!1}}}}if(f==="mouseleave"||f==="mouseout"){let h=!1;return{layer:i,listener:a,delegates:{mousemove:T=>{(this.getLayer(i)?this.queryRenderedFeatures(T.point,{layers:[i]}):[]).length?h=!0:h&&(h=!1,a.call(this,new rn(f,this,T.originalEvent)))},mouseout:T=>{h&&(h=!1,a.call(this,new rn(f,this,T.originalEvent)))}}}}{const h=_=>{const v=this.getLayer(i)?this.queryRenderedFeatures(_.point,{layers:[i]}):[];v.length&&(_.features=v,a.call(this,_),delete _.features)};return{layer:i,listener:a,delegates:{[f]:h}}}}on(f,i,a){if(a===void 0)return super.on(f,i);const h=this._createDelegatedListener(f,i,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(h);for(const _ in h.delegates)this.on(_,h.delegates[_]);return this}once(f,i,a){if(a===void 0)return super.once(f,i);const h=this._createDelegatedListener(f,i,a);for(const _ in h.delegates)this.once(_,h.delegates[_]);return this}off(f,i,a){return a===void 0?super.off(f,i):(this._delegatedListeners&&this._delegatedListeners[f]&&(h=>{const _=this._delegatedListeners[f];for(let v=0;v<_.length;v++){const T=_[v];if(T.layer===i&&T.listener===a){for(const C in T.delegates)this.off(C,T.delegates[C]);return _.splice(v,1),this}}})(),this)}queryRenderedFeatures(f,i){if(!this.style)return[];let a;if(i!==void 0||f===void 0||f instanceof c.pointGeometry||Array.isArray(f)||(i=f,f=void 0),i=i||{},(f=f||[[0,0],[this.transform.width,this.transform.height]])instanceof c.pointGeometry||typeof f[0]=="number")a=[c.pointGeometry.convert(f)];else{const h=c.pointGeometry.convert(f[0]),_=c.pointGeometry.convert(f[1]);a=[h,new c.pointGeometry(_.x,h.y),_,new c.pointGeometry(h.x,_.y),h]}return this.style.queryRenderedFeatures(a,i,this.transform)}querySourceFeatures(f,i){return this.style.querySourceFeatures(f,i)}setStyle(f,i){return(i=c.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(f,i))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const i=this._locale[f];if(i==null)throw new Error(`Missing UI string '${f}'`);return i}_updateStyle(f,i){return this.style&&(this.style.setEventedParent(null),this.style._remove()),f?(this.style=new Ri(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f):this.style.loadJSON(f),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ri(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,i){if(typeof f=="string"){const a=this._requestManager.transformRequest(f,c.ResourceType.Style);c.getJSON(a,(h,_)=>{h?this.fire(new c.ErrorEvent(h)):_&&this._updateDiff(_,i)})}else typeof f=="object"&&this._updateDiff(f,i)}_updateDiff(f,i){try{this.style.setState(f)&&this._update(!0)}catch(a){c.warnOnce(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(f,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.warnOnce("There is no style added to the map.")}addSource(f,i){return this._lazyInitEmptyStyle(),this.style.addSource(f,i),this._update(!0)}isSourceLoaded(f){const i=this.style&&this.style.sourceCaches[f];if(i!==void 0)return i.loaded();this.fire(new c.ErrorEvent(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){return this.style.setTerrain(f),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const i in f){const a=f[i]._tiles;for(const h in a){const _=a[h];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(f,i,a){return this._lazyInitEmptyStyle(),this.style.addSourceType(f,i,a)}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,i,{pixelRatio:a=1,sdf:h=!1,stretchX:_,stretchY:v,content:T}={}){if(this._lazyInitEmptyStyle(),i instanceof HTMLImageElement||c.isImageBitmap(i)){const{width:C,height:I,data:z}=c.exported.getImageData(i);this.style.addImage(f,{data:new c.RGBAImage({width:C,height:I},z),pixelRatio:a,stretchX:_,stretchY:v,content:T,sdf:h,version:0})}else{if(i.width===void 0||i.height===void 0)return this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:C,height:I,data:z}=i,B=i;this.style.addImage(f,{data:new c.RGBAImage({width:C,height:I},new Uint8Array(z)),pixelRatio:a,stretchX:_,stretchY:v,content:T,sdf:h,version:0,userImage:B}),B.onAdd&&B.onAdd(this,f)}}}updateImage(f,i){const a=this.style.getImage(f);if(!a)return this.fire(new c.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=i instanceof HTMLImageElement||c.isImageBitmap(i)?c.exported.getImageData(i):i,{width:_,height:v,data:T}=h;if(_===void 0||v===void 0)return this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==a.data.width||v!==a.data.height)return this.fire(new c.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const C=!(i instanceof HTMLImageElement||c.isImageBitmap(i));a.data.replace(T,C),this.style.updateImage(f,a)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new c.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,i){c.getImage(this._requestManager.transformRequest(f,c.ResourceType.Image),i)}listImages(){return this.style.listImages()}addLayer(f,i){return this._lazyInitEmptyStyle(),this.style.addLayer(f,i),this._update(!0)}moveLayer(f,i){return this.style.moveLayer(f,i),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,i,a){return this.style.setLayerZoomRange(f,i,a),this._update(!0)}setFilter(f,i,a={}){return this.style.setFilter(f,i,a),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,i,a,h={}){return this.style.setPaintProperty(f,i,a,h),this._update(!0)}getPaintProperty(f,i){return this.style.getPaintProperty(f,i)}setLayoutProperty(f,i,a,h={}){return this.style.setLayoutProperty(f,i,a,h),this._update(!0)}getLayoutProperty(f,i){return this.style.getLayoutProperty(f,i)}setLight(f,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,i),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(f,i){return this.style.setFeatureState(f,i),this._update()}removeFeatureState(f,i){return this.style.removeFeatureState(f,i),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,i=0;return this._container&&(f=this._container.clientWidth||400,i=this._container.clientHeight||300),[f,i]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map","mapboxgl-map");const i=this._canvasContainer=K.create("div","maplibregl-canvas-container mapboxgl-canvas-container",f);this._interactive&&i.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=K.create("canvas","maplibregl-canvas mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const a=this._containerDimensions();this._resizeCanvas(a[0],a[1],this.getPixelRatio());const h=this._controlContainer=K.create("div","maplibregl-control-container mapboxgl-control-container",f),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{_[v]=K.create("div",`maplibregl-ctrl-${v} mapboxgl-ctrl-${v}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const f=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=K.create("div","maplibregl-cooperative-gesture-screen",f);let i="Control",a=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(a=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",i="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${a}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",h=>{h.key===i&&(this._metaPress=!0)}),document.addEventListener("keyup",h=>{h.key===i&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",h=>{this._onCooperativeGesture(h,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(f,i,a){this._canvas.width=a*f,this._canvas.height=a*i,this._canvas.style.width=`${f}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const f=c.extend({},q.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);i?(this.painter=new Ws(i,this.transform),c.exported$1.testSupport(i)):this.fire(new c.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new c.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(f,i,a){return!i&&a<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){let i,a=0;const h=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(i=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,i),a=c.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let _=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const T=this.transform.zoom,C=c.exported.now();this.style.zoomHistory.update(T,C);const I=new c.EvaluationParameters(T,{now:C,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),z=I.crossFadingFactor();z===1&&z===this._crossFadingFactor||(_=!0,this._crossFadingFactor=z),this.style.update(I)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new c.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.PerformanceUtils.mark(c.PerformanceMarkers.load),this.fire(new c.Event("load"))),this.style&&(this.style.hasTransitions()||_)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const T=c.exported.now()-a;h.endQueryEXT(h.TIME_ELAPSED_EXT,i),setTimeout(()=>{const C=h.getQueryObjectEXT(i,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(i),this.fire(new c.Event("gpu-timing-frame",{cpuTime:T,gpuTime:C}))},50)}if(this.listens("gpu-timing-layer")){const T=this.painter.collectGpuTimers();setTimeout(()=>{const C=this.painter.queryGpuTimers(T);this.fire(new c.Event("gpu-timing-layer",{layerTimes:C}))},50)}const v=this._sourcesDirty||this._styleDirty||this._placementDirty;return v||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.Event("idle")),!this._loaded||this._fullyLoaded||v||(this._fullyLoaded=!0,c.PerformanceUtils.mark(c.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),K.remove(this._canvasContainer),K.remove(this._controlContainer),this._cooperativeGestures&&K.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),c.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new c.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=c.exported.frame(f=>{c.PerformanceUtils.frame(f),this._frame=null,this._render(f)}))}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}_setCacheLimits(f,i){c.setCacheLimits(f,i)}get version(){return"2.4.0"}},NavigationControl:class{constructor(f){this.options=c.extend({},M,f),this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(c.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),K.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),K.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(c.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=K.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map.getZoom(),i=f===this._map.getMaxZoom(),a=f===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=a,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",a.toString())}_rotateCompassArrow(){const f=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=f}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new V(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){K.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,i){const a=K.create("button",f,this._container);return a.type="button",a.addEventListener("click",i),a}_setButtonTitle(f,i){const a=this._map._getUIString(`NavigationControl.${i}`);f.title=a,f.setAttribute("aria-label",a)}},GeolocateControl:class extends c.Evented{constructor(f){super(),this.options=c.extend({},rt,f),c.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(f){var i;return this._map=f,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,wt!==void 0?i(wt):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(a=>{wt=a.state!=="denied",i(wt)}):(wt=!!window.navigator.geolocation,i(wt)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),K.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,bt=0,Vi=!1}_isOutOfMapMaxBounds(f){const i=this._map.getMaxBounds(),a=f.coords;return i&&(a.longitude<i.getWest()||a.longitude>i.getEast()||a.latitude<i.getSouth()||a.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new c.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new c.Event("geolocate",f)),this._finish()}}_updateCamera(f){const i=new c.LngLat(f.coords.longitude,f.coords.latitude),a=f.coords.accuracy,h=this._map.getBearing(),_=c.extend({bearing:h},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(a),_,{geolocateSource:!0})}_updateMarker(f){if(f){const i=new c.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map._container.clientHeight/2,i=this._map.unproject([0,f]),a=this._map.unproject([1,f]),h=i.distanceTo(a),_=Math.ceil(2*this._accuracy/h);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&Vi)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new c.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=K.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),K.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){c.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Oe(this._dotElement),this._circleElement=K.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Oe({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new c.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return c.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":bt--,Vi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new c.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),bt++,bt>1?(f={maximumAge:6e5,timeout:0},Vi=!0):(f=this.options.positionOptions,Vi=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Qs,LogoControl:s,ScaleControl:class{constructor(f){this.options=c.extend({},on,f),c.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){ea(this._map,this._container,this.options)}onAdd(f){return this._map=f,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){K.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(f){this.options.unit=f,ea(this._map,this._container,this.options)}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:c.warnOnce("Full screen control 'container' must be a DOM element.")),c.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=K.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",c.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){K.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=K.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);K.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(f){this.options=f,c.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(f){return this._map=f,this._container=K.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=K.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),K.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){K.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends c.Evented{constructor(f){super(),this.options=c.extend(Object.create(Ti),f),c.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new c.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&K.remove(this._content),this._container&&(K.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new c.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=c.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const i=document.createDocumentFragment(),a=document.createElement("body");let h;for(a.innerHTML=f;h=a.firstChild,h;)i.appendChild(h);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=K.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){this._container&&this._container.classList.add(f)}removeClassName(f){this._container&&this._container.classList.remove(f)}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}_createCloseButton(){this.options.closeButton&&(this._closeButton=K.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(f){this._update(f.point)}_onMouseMove(f){this._update(f.point)}_onDrag(f){this._update(f.point)}_update(f){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=K.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=K.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(v=>this._container.classList.add(v)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=re(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!f))return;const i=this._pos=this._trackPointer&&f?f:this._map.project(this._lngLat);let a=this.options.anchor;const h=Ml(this.options.offset);if(!a){const v=this._container.offsetWidth,T=this._container.offsetHeight;let C;C=i.y+h.bottom.y<T?["top"]:i.y>this._map.transform.height-T?["bottom"]:[],i.x<v/2?C.push("left"):i.x>this._map.transform.width-v/2&&C.push("right"),a=C.length===0?"bottom":C.join("-")}const _=i.add(h[a]).round();K.setTransform(this._container,`${oe[a]} translate(${_.x}px,${_.y}px)`),he(this._container,a,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Bi);f&&f.focus()}_onClose(){this.remove()}},Marker:Oe,Style:Ri,LngLat:c.LngLat,LngLatBounds:c.LngLatBounds,Point:c.pointGeometry,MercatorCoordinate:c.MercatorCoordinate,Evented:c.Evented,AJAXError:c.AJAXError,config:c.config,CanvasSource:Tt,GeoJSONSource:Ji,ImageSource:vt,RasterDEMTileSource:ut,RasterTileSource:Ni,VectorTileSource:$n,VideoSource:Ge,prewarm:function(){Oo().acquire(Dn)},clearPrewarmedResources:function(){const f=Vr;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Dn),Vr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return mn.workerCount},set workerCount(f){mn.workerCount=f},get maxParallelImageRequests(){return c.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){c.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){c.clearTileCache(f)},workerUrl:"",addProtocol(f,i){c.config.REGISTERED_PROTOCOLS[f]=i},removeProtocol(f){delete c.config.REGISTERED_PROTOCOLS[f]}};return Nn.extend(es,{isSafari:c.isSafari,getPerformanceMetrics:c.PerformanceUtils.getPerformanceMetrics}),es});var k=y;return k})})(RT);const lv=Em;var BT=Te.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(e){Te.setOptions(this,e),this._throttledUpdate=Te.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(e){this._container||this._initContainer();const n=this.getPaneName();e.getPane(n).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),e.options.zoomAnimation&&Te.DomEvent.on(e._proxy,Te.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(e){this._map._proxy&&this._map.options.zoomAnimation&&Te.DomEvent.off(this._map._proxy,Te.DomUtil.TRANSITION_END,this._transitionEnd,this);const n=this.getPaneName();e.getPane(n).removeChild(this._container),this._container=null,this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getOpacity:function(){return this.options.opacity},setOpacity:function(e){this.options.opacity=e,this._container.style.opacity=e},getBounds:function(){const e=this.getSize().multiplyBy(.5),n=this._map.latLngToContainerPoint(this._map.getCenter());return Te.latLngBounds(this._map.containerPointToLatLng(n.subtract(e)),this._map.containerPointToLatLng(n.add(e)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_initContainer:function(){if(this._container)return;this._container=Te.DomUtil.create("div","leaflet-gl-layer");const e=this.getSize(),n=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=e.x+"px",this._container.style.height=e.y+"px";const l=this._map.containerPointToLayerPoint([0,0]).subtract(n);Te.DomUtil.setPosition(this._container,l)},_initGL:function(){if(this._glMap)return;const e=this._map.getCenter(),n=Te.extend({},this.options,{container:this._container,center:[e.lng,e.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new lv.Map(n),this._glMap.once("styledata",function(p){this.fire("styleLoaded")}.bind(this)),this._glMap.transform.latRange=null,this._glMap.transform.maxValidLatitude=1/0,this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;const l=this._glMap._actualCanvas;Te.DomUtil.addClass(l,"leaflet-image-layer"),Te.DomUtil.addClass(l,"leaflet-zoom-animated"),this.options.interactive&&Te.DomUtil.addClass(l,"leaflet-interactive"),this.options.className&&Te.DomUtil.addClass(l,this.options.className)},_update:function(e){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const n=this.getSize(),l=this._container,p=this._glMap,y=this._map.getSize().multiplyBy(this.options.padding),b=this._map.containerPointToLayerPoint([0,0]).subtract(y);Te.DomUtil.setPosition(l,b),this._transformGL(p),p.transform.width!==n.x||p.transform.height!==n.y?(l.style.width=n.x+"px",l.style.height=n.y+"px",p._resize!==null&&p._resize!==void 0?p._resize():p.resize()):p._update!==null&&p._update!==void 0?p._update():p.update()},_transformGL:function(e){const n=this._map.getCenter(),l=e.transform;l.center=lv.LngLat.convert([n.lng,n.lat]),l.zoom=this._map.getZoom()-1},_pinchZoom:function(e){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(e){const n=this._map.getZoomScale(e.zoom),l=this._map.getSize().multiplyBy(this.options.padding*n),p=this.getSize()._divideBy(2),y=this._map.project(e.center,e.zoom)._subtract(p)._add(this._map._getMapPanePos().add(l))._round(),b=this._map.project(this._map.getBounds().getNorthWest(),e.zoom)._subtract(y);Te.DomUtil.setTransform(this._glMap._actualCanvas,b.subtract(this._offset),n)},_zoomStart:function(e){this._zooming=!0},_zoomEnd:function(){const e=this._map.getZoomScale(this._map.getZoom());Te.DomUtil.setTransform(this._glMap._actualCanvas,null,e),this._zooming=!1,this._update()},_transitionEnd:function(e){Te.Util.requestAnimFrame(function(){const n=this._map.getZoom(),l=this._map.getCenter(),p=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());Te.DomUtil.setTransform(this._glMap._actualCanvas,p,1),this._glMap.once("moveend",Te.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:l,zoom:n-1})},this)}});function B0(e){return new BT(e)}var OT=Te.Layer.extend({options:{key:"ArcGIS:Streets"},initialize:function(e,n){if(n&&Te.setOptions(this,n),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.token&&(this.options.apikey=this.options.token),!(this.options.apikey||this.options.token))throw new Error("API Key or token is required for vectorBasemapLayer.");e&&(this.options.key=e),this._createLayer()},_createLayer:function(){const e=IT(this.options.key,this.options.apikey);this._maplibreGL=B0({style:e,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0),this._maplibreGL.on("styleLoaded",function(n){this._setupAttribution()}.bind(this))},_setupAttribution:function(){const e=this._map;if(Fc.setEsriAttribution(e),this.options.key.length===32){const n=this._maplibreGL.getMaplibreMap().style.stylesheet.sources,l=[];Object.keys(n).forEach(function(p){l.push(n[p].attribution),n[p].copyrightText&&n[p].copyrightText&&n[p].copyrightText!==""&&n[p].attribution!==n[p].copyrightText&&l.push(n[p].copyrightText)}),e.attributionControl.addAttribution('<span class="">'+l.join(", ")+"</span>")}else if(this.options.attributionUrls||(this.options.attributionUrls=this._getAttributionUrls(this.options.key)),this._map&&this.options.attributionUrls){if(this._map.attributionControl){for(let n=0;n<this.options.attributionUrls.length;n++){const l=this.options.attributionUrls[n];MT(l,e)}e.attributionControl.addAttribution('<span class="esri-dynamic-attribution"></span>')}Fc._updateMapAttribution({target:this._map})}},_getAttributionUrls:function(e){return e.indexOf("OSM:")===0?["https://static.arcgis.com/attribution/Vector/OpenStreetMap_v2"]:e.indexOf("ArcGIS:Imagery")===0?["https://static.arcgis.com/attribution/World_Imagery","https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]:["https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]},onAdd:function(e){this._map=e,this._initPane(),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},_initPane:function(){if(this.options.pane||(this.options.key.indexOf(":Labels")>-1?this.options.pane="esri-labels":this.options.pane="tilePane"),!this._map.getPane(this.options.pane)){const e=this._map.createPane(this.options.pane);e.style.pointerEvents="none",e.style.zIndex=this.options.pane==="esri-labels"?550:500}},onRemove:function(e){if(e.off("moveend",Fc._updateMapAttribution),e.removeLayer(this._maplibreGL),e.attributionControl){const n=document.getElementsByClassName("esri-dynamic-attribution");if(n&&n.length>0){const l=n[0].outerHTML;e.attributionControl.removeAttribution(l)}}},_asyncAdd:function(){const e=this._map;e.on("moveend",Fc._updateMapAttribution),this._maplibreGL.addTo(e,this)}});function FT(e,n){return new OT(e,n)}Te.Layer.extend({options:{pane:"overlayPane",portalUrl:"https://www.arcgis.com"},initialize:function(e,n){if(n&&Te.setOptions(this,n),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.apikey&&(this.options.token=this.options.apikey),!e)throw new Error("An ITEM ID or SERVICE URL is required for vectorTileLayer.");e&&(this.options.key=e),this._createLayer()},_createLayer:function(){kT(this.options.key,this.options,function(e,n,l,p){if(e)throw new Error(e);if(DT(p.tileInfo.spatialReference.wkid)||console.warn('This layer is not guaranteed to display properly because its service does not use the Web Mercator projection. The "tileInfo.spatialReference" property is:',p.tileInfo.spatialReference,`
More information is available at https://github.com/maplibre/maplibre-gl-js/issues/168 and https://github.com/Esri/esri-leaflet-vector/issues/94.`),n=zT(n,l,p,this.options.token),!this.getAttribution()){const y=Object.keys(n.sources);this.options.attribution=n.sources[y[y.length-1]].attribution,this._map&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution())}this.options.style&&typeof this.options.style=="function"&&(n=this.options.style(n)),this._maplibreGL=B0({style:n,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0)}.bind(this))},onAdd:function(e){this._map=e,this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(e){e.removeLayer(this._maplibreGL)},_asyncAdd:function(){const e=this._map;this._maplibreGL.addTo(e,this)}});const NT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",UT="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";function VT(){const e=$l.useRef(null);return $l.useEffect(()=>{const n=e.current;if(n!==null){const l=document.createElement("div");n.appendChild(l);let p=new Te.Icon({iconUrl:NT,shadowUrl:UT,iconAnchor:[12,41],popupAnchor:[0,-41]});Te.Marker.prototype.options.icon=p;const y=new Te.Map(l);y.setView([53.35014,-6.266155],8),FT("ArcGIS:Streets",{apiKey:"AAPKe1c0f115595a4e1685e572617bbf54da97_3UGXWiAjMXNKQ43_UsLkaWY1cMQ0JLOWMAR-Lxj8x1cqm3IwFWSXo6Q8Gd7Xy"}).addTo(y),new CT({url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/SampleWorldCities/MapServer/0"}).addTo(y).bindPopup(function(k){return`<p><strong>${k.feature.properties.CITY_NAME}</strong><br /> Population: ${k.feature.properties.POP.toLocaleString("en")}</p>`})}return()=>{n&&(n.innerHTML="")}},[e]),Hc("div",{className:"map",ref:e})}function ZT(){return Hc("div",{className:"App",children:Hc(VT,{})})}Pf.createRoot(document.getElementById("root")).render(Hc(Gw.StrictMode,{children:Hc(ZT,{})}));
